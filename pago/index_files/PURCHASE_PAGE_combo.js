YUI.add("yui2-storage",function(A){},"0.1");YUI.add("yui2-datasource",function(A){},"0.1");YUI.add("yui2-autocomplete",function(A){},"0.1");YUI.add("yui2-animation",function(A){},"0.1");YUI.add("yui2-calendar",function(A){},"0.1");YUI.add("wl-scc",function(A){A.components.Scc=function(C){var D=this;var F=C.compInstConfig;D.incomingEvents={hide:function(H){var G=A.Lang.isArray(H.componentsToHide)?H.componentsToHide:[];if(A.Array.indexOf(D.getId(),G)){C.state="empty";D.renderHtml(C,D.node)}},show:function(){}};D.onCreate=function(G,H){if(G.state==="text"){var I=F.textKey;if(I){D.renderHtml({textKey:I})}}};D.onRenderState={script:function(H){var G=window[F.functionName];A.log("Function "+F.functionName+" from file "+F.scriptPath+" is about to be executed.");if(typeof G==="function"){try{G(A.Node.getDOMNode(H))}catch(I){A.log("Error executing function "+F.functionName+" from file "+F.scriptPath+" Stack trace: "+I.stack,"error")}}else{A.log("Cannot find function "+F.functionName+" which supposed to be defined in file "+F.scriptPath,"error")}D.translateTemplate(C,H)},text:function(){var G=D.node.one(".scc-text");if(G){G.removeClass("hidden")}}};D.scriptConfiguredToBeLinkedStatically=function(){return -1===A.Array.indexOf(F.scriptsForcedToStayInHead,F.scriptPath)};if(C.state==="header"||C.state==="footer"){D.create=false;D.node=A.one("#"+C.getId());D.node.set("innerHTML",A.replaceTemplateData(null,D.node.get("innerHTML")));D.node.translate()}else{if(C.state==="script"){D.render=false;var B="wl-custom_script-"+C.getId();var E=sabre.config.global.commonResourcesPath+"js/"+F.scriptPath;sabre.config.groups["wl-noncombine"].modules[B]={fullpath:E};if(D.scriptConfiguredToBeLinkedStatically()){D.node=A.one("#"+B);if(D.node){D.onRenderState.script(D.node)}else{A.log("Cannot load custom script "+B+". There is no script node for "+E,"warn")}C.componentRendered()}else{A.use(B,function(H,G){if(G.success){D.onRenderState.script(D.node)}else{H.log("Cannot load custom script. "+G.msg,"warn")}C.componentRendered()})}}}}});YUI.add("wl-marketingmsg",function(A){A.components.Marketingmsg=function(C){var H=this;H.node=A.one(this.domId+" .marketing-message-container");var E=C.compInstConfig;var I=E.minimumDisplayTime;var G=E.showOnPageLoad;var J=E.showOnPageSubmit;var M=sabre.config.global.renderTime;var B;var F=function(O){var Q=new Date();var P=Q.getTime();var N=I-(P-M);if(N>0){A.later(N,O,D)}else{A.on("pageHtmlLoaded",D,O)}B=L(N)};var K=function(O){var N=O.event;N.preventDefault();H.node.removeClass("hidden");A.later(I,null,function(P){A.one("#"+P).submit()},[O.formId]);L(I)};function D(){this.addClass("hidden");if(B&&A.Lang.isFunction(B.cancel)){B.cancel()}}function L(P){var Q=new Date();var O=Q.getTime();var N=H.node.one(".counter");if(N===null){return null}else{N.setContent("&nbsp;");return A.later(300,N,function(U,R){var V=new Date();var T=V.getTime();var S=parseInt((U-(T-R))/1000,10);this.setContent(S)},[P,O],true)}}H.onRenderState={defaultAction:G?F:function(){}};H.incomingEvents={"page-submitted":J?K:function(){}};H.create=false;H.onRenderState.defaultAction(H.node)}});YUI.add("wl-prbar",function(A){A.components.Prbar=function(B,H){var G=this;var C={REINITIALIZE:"reinitialize"};G.incomingEvents={flight_changed:F,ancillary_changed:F,state_changed:function(){I(J)}};G.onRenderState={initialized:function(K){A.delegate("click",function(L){L.preventDefault()},K,".stepFuture a, .lastStep a")}};function I(L){var M="_elements";var K={data:{requestPartials:[M]},on:{end:function(){},success:function(O,N){if(N){L(N,M)}}}};G.fireEvent("to-ajax",{cfg:K,actionCode:C.REINITIALIZE})}function J(L,M){var K=G.node.one("#booking-process");K.set("innerHTML",A.decodeHtmlEntities(L.partials[M]));F()}function E(K,L){K.setAttribute("class",L.join(" "))}function D(){var N=G.node.all("li");var M=G.node.one("li.stepCurrent");var L=N.indexOf(M);var K=N._nodes.slice(L+1);return A.all(K)}function F(){var K=D();var L=K.size()-1;K.each(function(N,M){var O=["stepFuture"];if(M===0){O.push("prevCurrent");O.push("stepFuture_prevCurrent")}else{O.push("prevFuture");O.push("stepFuture_prevFuture")}if(M===L){O.push("lastStep");O.push("stepFuture_lastStep")}E(N,O)})}}});YUI.add("wl-flomes",function(A){A.components.Flomes=function(D,B){var F=this;F.incomingEvents={"add-messages":function(L){var K=L.data.messages;var J=G(K);var O="flow-messages-component-"+L.type;var N=A.one("#"+O);var I=A.one("#flow-messages-component");if(!N){N=A.Node.create('<div id="'+O+'"></div>');I.append(N)}N.set("innerHTML",J);I.translate();N.removeClass("hidden");var M=I.getXY();window.scrollTo(M[0],M[1])},"show-messages":function(L){var K=L.data.messages||[];for(var J=0;J<K.length;J++){var N=K[J];var M=N.id||N;var I=A.one("#flow-message-"+M);if(I){I.removeClass("hidden")}}var P=A.one("#flow-messages-component");var O=P.getXY();window.scrollTo(O[0],O[1])},"remove-messages":function(L){var K=L.data.messages||[];for(var J=0;J<K.length;J++){var N=K[J];var M=N.id||N;var I=A.one("#flow-message-"+M);if(I){I.addClass("hidden")}}},"remove-all-messages":function(){A.all(".flow-message-error").each(function(I){I.remove()})},"remove-all-component-messages":function(I){var K="flow-messages-component-"+I.type;var J=A.one("#"+K);if(J){J.set("innerHTML","")}},"block-discrepancy-confirm":function(J){var I=A.one("#accept-new-price-btn");if(I){I.set("disabled","disabled").addClass("disabled")}},"unblock-discrepancy-confirm":function(J){var I=A.one("#accept-new-price-btn");if(I){I.removeAttribute("disabled");I.removeClass("disabled")}}};F.onRenderState={initialized:function(K){var J=D.initData.messages;for(var I in J){if(E[J[I].id]){E[J[I].id]()}}}};function G(K){var M="";for(var I in K){var J=K[I];var L=J.id;var N=F.getHtml("_flowMessage_"+L);if(!N){N=F.getHtml("_flowMessage")}M+=F.replaceData({level:J.level,id:J.id,code:J.code,originalMessage:J.originalMessage},N);if(null!==A.one("#flow-message-"+L)){A.one("#flow-message-"+L).remove(true)}}return M}var E={priceDiscrepancyError:function(){A.on("click",H,"#select-flights-link");A.on("click",C,"#accept-new-price-btn")},ssrInsufficientInfantProvision:function(){F.fireEvent("block_submit",{forceInitialize:true})}};function H(I){location.href=A.utilsUrl.buildExecutionUrl("_eventId=goto&gotoPageCode=AIR_SELECT_PAGE")}function C(I){F.fireEvent("sbmt-after-price-discrepancy")}}});YUI.add("wl-bnpl-dom",function(E){var R="holdOptionConfirmOverlay";var q="holdOptionOverlay";var J="purchaseNowOptionId";var f;var A;var x;var O;var k;var y;var V;var S;var g;var L;function t(AA,AB,Y){O=AA;k=AB;y=Y;V=AB.initData;x=AB.initData.holdOptionSelectedId||J;T();return{initInitializedState:r,initButtonState:w,restoreSelection:m,showOverlayOption:F}}function r(){O.node.delegate("click",u,".bpnl-radioButton-link")}function w(){O.node.delegate("click",j,".bpnl-holdYourTripButton-link");N()}function N(){if(V.runDependedValidation){y.removeDependedValidationIndicator();if(z()){F()}}}function z(){var Y=E.all("form .error");return Y==null||0==Y.size()}function m(AA){x=AA;var Y=E.one("#"+AA);var AB=Y.ancestor(".bnpl-parent");Y.set("checked",true);L=true;y.updateBasket(s,Q,AA,AB)}function u(AB){var AA=AB.target;var Y=AA.ancestor(".bnpl-content");x=AA.getAttribute("id");if(U(x)){y.retrieveOverlayContent(d,Q,R,Y)}else{K(false);Z(Y,x)}}function H(){var Y=this.ancestor(".bnpl-parent");x=this.getAttribute("id");Z(Y,x)}function e(){y.gotoPayment()}function j(){var Y=E.one(".bnpl input[name='runDependedValidation']")||false;if(Y){Y.set("value","true");W();O.fireEvent("run-validation")}}function W(){var Y=E.one("#passenger-validationTrigger")||false;if(Y){Y.set("value","BNPL")}}function F(){var Y=E.one(".bnpl-parent");y.retrieveOverlayContent(p,Q,q,Y)}function d(AB){var AC=AB.partials[P(R)];var AA=AB.showConfirmOverlay||false;if(AA){M(E.decodeHtmlEntities(AC),i);X()}else{K(true);var Y=E.one(".bnpl-parent");Z(Y,x)}}function X(){if(S){S.delegate("click",B,".bnpl-onHoldConfirmation-button");S.delegate("click",b,".bpnl-cancelButton-link")}}function i(){}function b(){c();D()}function T(){var AA=E.one("#ROOT");var Y=AA.one(".prbar");if(Y){Y.delegate("click",v,"#step-ANCILLARY_PAGE");Y.delegate("click",v,"#step-SEATS_PAGE")}}function v(AA){if(U(x)){var Y=O.getPartial("_holdOptionBookingOnHold");M(Y);C();AA.preventDefault()}}function C(){if(S){S.delegate("click",c,".bnpl-bookingOnHold-okButton")}}function B(AA){c();var Y=AA.target.ancestor(".bnpl-parent");K(true);Z(Y,x)}function K(Y){O.fireEvent("update-on-hold-status",{isOnHoldEnabled:Y})}function p(Y){var AA=Y.partials[P(q)];M(E.decodeHtmlEntities(AA));A=x;o();l()}function o(){if(S){S.delegate("click",H,".bpnl-radioButton-link");S.delegate("click",G,".bpnl-cancelButton-link");S.delegate("click",e,".bpnl-gotoPaymentButton-link")}}function l(){if(S){var Y=S.one(".bpnl-gotoPaymentButton-link");if(x==J){Y.set("disabled","disabled").addClass("disabled")}else{Y.removeAttribute("disabled");Y.removeClass("disabled")}}}function M(AB,Y){n();var AA={header:"",width:"450px",height:"auto",closeHandler:Y||a,fixedcenter:true,constraintoviewport:false,needTranslation:false};if(S){g=new E.widgets.PopupWidget(S,AB,AA);g.show()}}function G(){var Y=E.one(".bnpl-parent");y.updateBasket(I,Q,A,Y);x=A}function I(){c();s()}function c(){if(g){g.hide();g=null}if(S){S.remove();S=null}}function h(){var Y=k.initData.holdOptions[x];if(Y.type==="FREE"){return true}return false}function a(){var Y=E.one(".bnpl-parent");if(x!=A){y.updateBasket(I,Q,A,Y);x=A}}function s(Y){O.fireEvent("updated");if(!L){O.fireEvent("refresh-payc",{response:Y,hidePaymentComponent:h()})}O.fireEvent("refresh-amountdue");l()}function Q(Y,AA){if(AA==undefined){AA=E.one(O.node)}if(AA){Y?AA.addClass("loading"):AA.removeClass("loading")}}function n(){if(!S){S=E.Node.create('<div class="bnplOverlays"></div>');E.one("body").appendChild(S)}}function U(Y){return Y!==J}function Z(AA,Y){Q(true,AA);L=false;y.updateBasket(s,Q,Y,AA)}function P(Y){return"__"+Y}function D(){var Y=E.one("#"+J);Y.set("checked",true);x=J}E.widgets=E.widgets||{};E.widgets.Bnpl=E.widgets.Bnpl||{};E.widgets.Bnpl.Dom=t});YUI.add("wl-bnpl-viewModel",function(B){var A=function(G,F,D){var E=G.initData;return{bnplComponent:D,retrieveOverlayContent:J,updateBasket:H,gotoPayment:C,removeDependedValidationIndicator:I};function J(L,O,N,M){O(true,M);var K={data:{requestPartials:["__"+N]},on:{end:function(){O(false,M)},success:function(Q,P){if(P){L(P)}}}};F("to-ajax",{cfg:K,actionCode:N})}function H(N,O,L,M){O(true,M);var K={data:{holdOptionSelectionId:L,requestPartials:["initialized"]},on:{end:function(){O(false,M)},success:function(Q,P){if(P){N(P)}}}};F("to-ajax",{cfg:K,actionCode:"updateHoldOptionSelection"})}function C(){F("goto-payment")}function I(){F("to-ajax",{cfg:{},actionCode:"removeDependedValidationIndicator"})}};B.widgets=B.widgets||{};B.widgets.Bnpl=B.widgets.Bnpl||{};B.widgets.Bnpl.ViewModel=A});YUI.add("wl-bnpl-viewModelMock",function(B){var A=function(F,D){var E=F.initData;return{bnplComponent:D,retrieveOverlayContent:H,updateBasket:G,gotoPayment:C};function H(J,M,L,K){M(true,K);var I={};I.partials=new Array();I.partials["__"+L]=D.getPartial("_Sandbox_holdOptionOverlay");M(false,K);J(I)}function G(K,L,I,J){L(true,J);response={};L(false,J);K(response)}function C(){fireEvent("goto-payment")}};B.widgets=B.widgets||{};B.widgets.Bnpl=B.widgets.Bnpl||{};B.widgets.Bnpl.ViewModelMock=A});YUI.add("popupWidget",function(B){var A=function(E,H,D){var G=this;var K=false;var C;var J;var I;if(D!=null&&D.header!=null){I=function(M,L){return B.Node.create('<div id="'+M+'" class="messagePopup" ><div class="hd">'+D.header+'</div><div class="bd">'+L+'</div><div class="ft">&nbsp;</div></div>')}}else{I=function(M,L){return B.Node.create('<div id="'+M+'" class="messagePopup" ><div class="hd">&nbsp;</div><div class="bd">'+L+'</div><div class="ft">&nbsp;</div></div>')}}if(YAHOO.lang.isString(H)){C="popup"+YAHOO.util.Dom.generateId();J=I(C,H);E.append(J)}else{C=H.getAttribute("id");J=H}var F={width:"400px",height:"150px",fixedcenter:true,constraintoviewport:true,close:true,visible:false,draggable:false,modal:true,zIndex:10,buttons:[],needTranslation:true};D=YAHOO.lang.merge(F,D||{});if(D.autofillheight!=null){D.height=null}G.dialog=new YAHOO.widget.Dialog(C,D);G.hide=function(){if(K){G.dialog.hide();if(J){J.addClass("hidden")}}};G.destroy=function(){if(K){G.dialog.destroy()}};G.dialog.hideEvent.subscribe(G.hide);if(D.closeHandler){G.dialog.hideEvent.subscribe(D.closeHandler)}G.addUniqueID=function(N){var M=G.dialog.getButtons();for(var L=0;L<M.length;L++){M[L].id=""+N+""+L}};G.render=function(){if(D&&D.renderInsideBody){G.dialog.render(document.body)}else{G.dialog.render()}if(J&&D.needTranslation){J.translate()}K=true};G.center=function(){if(!K){G.render()}G.dialog.center()};G.show=function(){if(!K){G.render()}if(J){J.removeClass("hidden")}G.dialog.show()};G.node=function(){return J};G.update=function(L){G.dialog.setBody(L);K=false};G.id=function(){return C}};B.widgets=B.widgets||{};B.widgets.PopupWidget=A},"1.0.0",{requires:[]});YUI.add("wl-bnpl",function(B){var A;var C;B.components.Bnpl=function(D){var E=this;if(D.initData.inSandbox){A=B.widgets.Bnpl.ViewModelMock(D,E)}else{A=B.widgets.Bnpl.ViewModel(D,function(F,G){return E.fireEvent.call(E,F,G)},E)}C=B.widgets.Bnpl.Dom(E,D,A);E.incomingEvents={"restore-selection":function(G){var F=G.data.response.previousOptionSelectionId;C.restoreSelection(F)},"block-list":function(){var F=B.one(".bnpl");if(F){F.addClass("loading")}},"remote-option-show":function(){C.showOverlayOption()}};E.onRenderState={initialized:function(F){C.initInitializedState()},button:function(F){C.initButtonState()}}}},"1.0.0",{requires:[]});YUI.add("wl-amountdue",function(A){A.components.Amountdue=function(C){var L=this;var J=C.initData;var F=C.compInstConfig;L.incomingEvents={refresh:D,"page-submitted":M,"change-visibility":H};function H(O){if(O.data.visible){A.one(".amountdue").removeClass("hidden")}else{A.one(".amountdue").addClass("hidden")}}function M(){L.addLoadingOverlay(false)}L.onCreate=function(){E();G()};function E(){L.node.addClass("disableSpinner")}function G(){if(F.integratedComponents){N();I()}}function N(){var P=B();var O=P.ancestor();O.addClass("amountdue-integrated")}function I(){var Q=B();var O=Q.siblings(".component.payc");var P=Q.ancestor();if(O.size()==1){P.insertBefore(Q,O.item(0))}}function B(){return L.node.ancestor(".component.amountdue")}function D(){var P=L.node.one("#amountdue");L.addLoadingIndicator(P);var O={data:{requestPartials:["__amountDueNowContainer"]},on:{success:function(R,Q){if(Q){K(Q)}},end:L.removeLoadingIndicator(P)}};L.fireEvent("to-ajax",{componentType:"amountdue",cfg:O,actionCode:"refresh"})}function K(P){var O=P.partials.__amountDueNowContainer;var Q=L.node.one("#amountdue");if(Q){Q.set("innerHTML",A.decodeHtmlEntities(O))}}}});YUI.add("attribute-base",function(C){C.State=function(){this.data={}};C.State.prototype={add:function(O,Y,f){var e=this.data;e[Y]=e[Y]||{};e[Y][O]=f},addAll:function(O,d){var Y;for(Y in d){if(d.hasOwnProperty(Y)){this.add(O,Y,d[Y])}}},remove:function(O,Y){var e=this.data;if(e[Y]&&(O in e[Y])){delete e[Y][O]}},removeAll:function(O,e){var Y=this.data;C.each(e||Y,function(f,d){if(C.Lang.isString(d)){this.remove(O,d)}else{this.remove(O,f)}},this)},get:function(O,Y){var e=this.data;return(e[Y]&&O in e[Y])?e[Y][O]:undefined},getAll:function(O){var e=this.data,Y;C.each(e,function(f,d){if(O in e[d]){Y=Y||{};Y[d]=f[O]}},this);return Y}};var K=C.Object,F=C.Lang,L=C.EventTarget,X=".",U="Change",N="getter",M="setter",P="readOnly",Z="writeOnce",V="initOnly",c="validator",H="value",Q="valueFn",E="broadcast",S="lazyAdd",J="_bypassProxy",b="added",B="initializing",I="initValue",W="published",T="defaultValue",A="lazy",R="isLazyAdd",G,a={};a[P]=1;a[Z]=1;a[N]=1;a[E]=1;function D(){var d=this,O=this.constructor.ATTRS,Y=C.Base;d._ATTR_E_FACADE={};L.call(d,{emitFacade:true});d._conf=d._state=new C.State();d._stateProxy=d._stateProxy||null;d._requireAddAttr=d._requireAddAttr||false;if(O&&!(Y&&d instanceof Y)){d.addAttrs(this._protectAttrs(O))}}D.INVALID_VALUE={};G=D.INVALID_VALUE;D._ATTR_CFG=[M,N,c,H,Q,Z,P,S,E,J];D.prototype={addAttr:function(Y,O,e){var f=this,h=f._state,g,d;e=(S in O)?O[S]:e;if(e&&!f.attrAdded(Y)){h.add(Y,A,O||{});h.add(Y,b,true)}else{if(!f.attrAdded(Y)||h.get(Y,R)){O=O||{};d=(H in O);if(d){g=O.value;delete O.value}O.added=true;O.initializing=true;h.addAll(Y,O);if(d){f.set(Y,g)}h.remove(Y,B)}}return f},attrAdded:function(O){return !!this._state.get(O,b)},modifyAttr:function(Y,O){var d=this,f,e;if(d.attrAdded(Y)){if(d._isLazyAttr(Y)){d._addLazyAttr(Y)}e=d._state;for(f in O){if(a[f]&&O.hasOwnProperty(f)){e.add(Y,f,O[f]);if(f===E){e.remove(Y,W)}}}}},removeAttr:function(O){this._state.removeAll(O)},get:function(O){return this._getAttr(O)},_isLazyAttr:function(O){return this._state.get(O,A)},_addLazyAttr:function(Y){var d=this._state,O=d.get(Y,A);d.add(Y,R,true);d.remove(Y,A);this.addAttr(Y,O)},set:function(O,d,Y){return this._setAttr(O,d,Y)},reset:function(O){var d=this,Y;if(O){if(d._isLazyAttr(O)){d._addLazyAttr(O)}d.set(O,d._state.get(O,I))}else{Y=d._state.data.added;C.each(Y,function(e,f){d.reset(f)},d)}return d},_set:function(O,d,Y){return this._setAttr(O,d,Y,true)},_getAttr:function(d){var e=this,i=d,f=e._state,g,O,h,Y;if(d.indexOf(X)!==-1){g=d.split(X);d=g.shift()}if(e._tCfgs&&e._tCfgs[d]){Y={};Y[d]=e._tCfgs[d];delete e._tCfgs[d];e._addAttrs(Y,e._tVals)}if(e._isLazyAttr(d)){e._addLazyAttr(d)}h=e._getStateVal(d);O=f.get(d,N);if(O&&!O.call){O=this[O]}h=(O)?O.call(e,h,i):h;h=(g)?K.getValue(h,g):h;return h},_setAttr:function(d,g,O,e){var k=true,Y=this._state,h=this._stateProxy,m=Y.data,j,n,o,f,i,l;if(d.indexOf(X)!==-1){n=d;o=d.split(X);d=o.shift()}if(this._isLazyAttr(d)){this._addLazyAttr(d)}j=(!m.value||!(d in m.value));if(h&&d in h&&!this._state.get(d,J)){j=false}if(this._requireAddAttr&&!this.attrAdded(d)){}else{i=Y.get(d,Z);l=Y.get(d,B);if(!j&&!e){if(i){k=false}if(Y.get(d,P)){k=false}}if(!l&&!e&&i===V){k=false}if(k){if(!j){f=this.get(d)}if(o){g=K.setValue(C.clone(f),o,g);if(g===undefined){k=false}}if(k){if(l){this._setAttrVal(d,n,f,g)}else{this._fireAttrChange(d,n,f,g,O)}}}}return this},_fireAttrChange:function(h,g,e,d,O){var j=this,f=h+U,Y=j._state,i;if(!Y.get(h,W)){j.publish(f,{queuable:false,defaultTargetOnly:true,defaultFn:j._defAttrChangeFn,silent:true,broadcast:Y.get(h,E)});Y.add(h,W,true)}i=(O)?C.merge(O):j._ATTR_E_FACADE;i.type=f;i.attrName=h;i.subAttrName=g;i.prevVal=e;i.newVal=d;j.fire(i)},_defAttrChangeFn:function(O){if(!this._setAttrVal(O.attrName,O.subAttrName,O.prevVal,O.newVal)){O.stopImmediatePropagation()}else{O.newVal=this.get(O.attrName)}},_getStateVal:function(O){var Y=this._stateProxy;return Y&&(O in Y)&&!this._state.get(O,J)?Y[O]:this._state.get(O,H)},_setStateVal:function(O,d){var Y=this._stateProxy;if(Y&&(O in Y)&&!this._state.get(O,J)){Y[O]=d}else{this._state.add(O,H,d)}},_setAttrVal:function(m,l,i,g){var o=this,j=true,d=o._state,e=d.get(m,c),h=d.get(m,M),k=d.get(m,B),n=this._getStateVal(m),Y=l||m,f,O;if(e){if(!e.call){e=this[e]}if(e){O=e.call(o,g,Y);if(!O&&k){g=d.get(m,T);O=true}}}if(!e||O){if(h){if(!h.call){h=this[h]}if(h){f=h.call(o,g,Y);if(f===G){j=false}else{if(f!==undefined){g=f}}}}if(j){if(!l&&(g===n)&&!F.isObject(g)){j=false}else{if(d.get(m,I)===undefined){d.add(m,I,g)}o._setStateVal(m,g)}}}else{j=false}return j},setAttrs:function(O,Y){return this._setAttrs(O,Y)},_setAttrs:function(Y,d){for(var O in Y){if(Y.hasOwnProperty(O)){this.set(O,Y[O])}}return this},getAttrs:function(O){return this._getAttrs(O)},_getAttrs:function(e){var g=this,j={},f,Y,O,h,d=(e===true);e=(e&&!d)?e:K.keys(g._state.data.added);for(f=0,Y=e.length;f<Y;f++){O=e[f];h=g.get(O);if(!d||g._getStateVal(O)!=g._state.get(O,I)){j[O]=g.get(O)}}return j},addAttrs:function(O,Y,d){var e=this;if(O){e._tCfgs=O;e._tVals=e._normAttrVals(Y);e._addAttrs(O,e._tVals,d);e._tCfgs=e._tVals=null}return e},_addAttrs:function(Y,d,e){var g=this,O,f,h;for(O in Y){if(Y.hasOwnProperty(O)){f=Y[O];f.defaultValue=f.value;h=g._getAttrInitVal(O,f,g._tVals);if(h!==undefined){f.value=h}if(g._tCfgs[O]){delete g._tCfgs[O]}g.addAttr(O,f,e)}}},_protectAttrs:function(Y){if(Y){Y=C.merge(Y);for(var O in Y){if(Y.hasOwnProperty(O)){Y[O]=C.merge(Y[O])}}}return Y},_normAttrVals:function(O){return(O)?C.merge(O):null},_getAttrInitVal:function(O,Y,e){var f,d;if(!Y[P]&&e&&e.hasOwnProperty(O)){f=e[O]}else{f=Y[H];d=Y[Q];if(d){if(!d.call){d=this[d]}if(d){f=d.call(this)}}}return f}};C.mix(D,L,false,null,1);C.Attribute=D},"3.1.2",{requires:["event-custom"]});YUI.add("attribute-complex",function(B){var A=B.Object,C=".";B.Attribute.Complex=function(){};B.Attribute.Complex.prototype={_normAttrVals:function(G){var I={},H={},J,D,F,E;if(G){for(E in G){if(G.hasOwnProperty(E)){if(E.indexOf(C)!==-1){J=E.split(C);D=J.shift();F=H[D]=H[D]||[];F[F.length]={path:J,value:G[E]}}else{I[E]=G[E]}}}return{simple:I,complex:H}}else{return null}},_getAttrInitVal:function(K,I,N){var E=I.value,M=I.valueFn,D,F,H,G,O,L,J;if(M){if(!M.call){M=this[M]}if(M){E=M.call(this)}}if(!I.readOnly&&N){D=N.simple;if(D&&D.hasOwnProperty(K)){E=D[K]}F=N.complex;if(F&&F.hasOwnProperty(K)){J=F[K];for(H=0,G=J.length;H<G;++H){O=J[H].path;L=J[H].value;A.setValue(E,O,L)}}}return E}};B.mix(B.Attribute,B.Attribute.Complex,true,null,1)},"3.1.2",{requires:["attribute-base"]});YUI.add("attribute",function(A){},"3.1.2",{use:["attribute-base","attribute-complex"]});YUI.add("base-base",function(B){var I=B.Object,K=B.Lang,J=".",G="destroy",R="init",Q="initialized",H="destroyed",D="initializer",N="bubbleTargets",E="_bubbleTargets",C=Object.prototype.constructor,M="deep",S="shallow",P="destructor",A=B.Attribute;function F(){A.call(this);var L=B.Plugin&&B.Plugin.Host;if(this._initPlugins&&L){L.call(this)}if(this._lazyAddAttrs!==false){this._lazyAddAttrs=true}this.name=this.constructor.NAME;this._eventPrefix=this.constructor.EVENT_PREFIX||this.constructor.NAME;this.init.apply(this,arguments)}F._ATTR_CFG=A._ATTR_CFG.concat("cloneDefaultValue");F.NAME="base";F.ATTRS={initialized:{readOnly:true,value:false},destroyed:{readOnly:true,value:false}};F.prototype={init:function(L){this._yuievt.config.prefix=this._eventPrefix;this.publish(R,{queuable:false,fireOnce:true,defaultTargetOnly:true,defaultFn:this._defInitFn});this._preInitEventCfg(L);this.fire(R,{cfg:L});return this},_preInitEventCfg:function(O){if(O){if(O.on){this.on(O.on)}if(O.after){this.after(O.after)}}var T,L,V,U=(O&&N in O);if(U||E in this){V=U?(O&&O.bubbleTargets):this._bubbleTargets;if(K.isArray(V)){for(T=0,L=V.length;T<L;T++){this.addTarget(V[T])}}else{if(V){this.addTarget(V)}}}},destroy:function(){this.publish(G,{queuable:false,fireOnce:true,defaultTargetOnly:true,defaultFn:this._defDestroyFn});this.fire(G);this.detachAll();return this},_defInitFn:function(L){this._initHierarchy(L.cfg);if(this._initPlugins){this._initPlugins(L.cfg)}this._set(Q,true)},_defDestroyFn:function(L){this._destroyHierarchy();if(this._destroyPlugins){this._destroyPlugins()}this._set(H,true)},_getClasses:function(){if(!this._classes){this._initHierarchyData()}return this._classes},_getAttrCfgs:function(){if(!this._attrs){this._initHierarchyData()}return this._attrs},_filterAttrCfgs:function(V,O){var T=null,L,U=V.ATTRS;if(U){for(L in U){if(U.hasOwnProperty(L)&&O[L]){T=T||{};T[L]=O[L];delete O[L]}}}return T},_initHierarchyData:function(){var T=this.constructor,O=[],L=[];while(T){O[O.length]=T;if(T.ATTRS){L[L.length]=T.ATTRS}T=T.superclass?T.superclass.constructor:null}this._classes=O;this._attrs=this._aggregateAttrs(L)},_aggregateAttrs:function(Y){var V,Z,U,L,a,O,X,T=F._ATTR_CFG,W={};if(Y){for(O=Y.length-1;O>=0;--O){Z=Y[O];for(V in Z){if(Z.hasOwnProperty(V)){U=B.mix({},Z[V],true,T);L=U.value;X=U.cloneDefaultValue;if(L){if((X===undefined&&(C===L.constructor||K.isArray(L)))||X===M||X===true){U.value=B.clone(L)}else{if(X===S){U.value=B.merge(L)}}}a=null;if(V.indexOf(J)!==-1){a=V.split(J);V=a.shift()}if(a&&W[V]&&W[V].value){I.setValue(W[V].value,a,L)}else{if(!a){if(!W[V]){W[V]=U}else{B.mix(W[V],U,true,T)}}}}}}}return W},_initHierarchy:function(W){var T=this._lazyAddAttrs,X,Y,Z,U,O,V=this._getClasses(),L=this._getAttrCfgs();for(Z=V.length-1;Z>=0;Z--){X=V[Z];Y=X.prototype;if(X._yuibuild&&X._yuibuild.exts){for(U=0,O=X._yuibuild.exts.length;U<O;U++){X._yuibuild.exts[U].apply(this,arguments)}}this.addAttrs(this._filterAttrCfgs(X,L),W,T);if(Y.hasOwnProperty(D)){Y.initializer.apply(this,arguments)}}},_destroyHierarchy:function(){var V,O,U,L,T=this._getClasses();for(U=0,L=T.length;U<L;U++){V=T[U];O=V.prototype;if(O.hasOwnProperty(P)){O.destructor.apply(this,arguments)}}},toString:function(){return this.constructor.NAME+"["+B.stamp(this)+"]"}};B.mix(F,A,false,null,1);F.prototype.constructor=F;B.Base=F},"3.1.2",{requires:["attribute-base"]});YUI.add("base-pluginhost",function(C){var A=C.Base,B=C.Plugin.Host;C.mix(A,B,false,null,1);A.plug=B.plug;A.unplug=B.unplug},"3.1.2",{requires:["base-base","pluginhost"]});YUI.add("base-build",function(D){var B=D.Base,A=D.Lang,C;B._build=function(F,L,P,T,S,O){var U=B._build,G=U._ctor(L,O),J=U._cfg(L,O),R=U._mixCust,N=J.aggregates,E=J.custom,I=G._yuibuild.dynamic,M,K,H,Q;if(I&&N){for(M=0,K=N.length;M<K;++M){H=N[M];if(L.hasOwnProperty(H)){G[H]=A.isArray(L[H])?[]:{}}}}for(M=0,K=P.length;M<K;M++){Q=P[M];D.mix(G,Q,true,null,1);R(G,Q,N,E);G._yuibuild.exts.push(Q)}if(T){D.mix(G.prototype,T,true)}if(S){D.mix(G,U._clean(S,N,E),true);R(G,S,N,E)}G.prototype.hasImpl=U._impl;if(I){G.NAME=F;G.prototype.constructor=G}return G};C=B._build;D.mix(C,{_mixCust:function(G,F,I,H){if(I){D.aggregate(G,F,true,I)}if(H){for(var E in H){if(H.hasOwnProperty(E)){H[E](E,G,F)}}}},_tmpl:function(E){function F(){F.superclass.constructor.apply(this,arguments)}D.extend(F,E);return F},_impl:function(H){var K=this._getClasses(),J,F,E,I,L,G;for(J=0,F=K.length;J<F;J++){E=K[J];if(E._yuibuild){I=E._yuibuild.exts;L=I.length;for(G=0;G<L;G++){if(I[G]===H){return true}}}}return false},_ctor:function(E,F){var G=(F&&false===F.dynamic)?false:true,H=(G)?C._tmpl(E):E;H._yuibuild={id:null,exts:[],dynamic:G};return H},_cfg:function(E,F){var G=[],J={},I,H=(F&&F.aggregates),L=(F&&F.custom),K=E;while(K&&K.prototype){I=K._buildCfg;if(I){if(I.aggregates){G=G.concat(I.aggregates)}if(I.custom){D.mix(J,I.custom,true)}}K=K.superclass?K.superclass.constructor:null}if(H){G=G.concat(H)}if(L){D.mix(J,F.cfgBuild,true)}return{aggregates:G,custom:J}},_clean:function(K,J,G){var I,F,E,H=D.merge(K);for(I in G){if(H.hasOwnProperty(I)){delete H[I]}}for(F=0,E=J.length;F<E;F++){I=J[F];if(H.hasOwnProperty(I)){delete H[I]}}return H}});B.build=function(G,E,H,F){return C(G,E,H,null,null,F)};B.create=function(E,H,G,F,I){return C(E,H,G,F,I)};B.mix=function(E,F){return C(null,E,F,null,null,{dynamic:false})};B._buildCfg={custom:{ATTRS:function(G,F,E){F[G]=F[G]||{};if(E[G]){D.aggregate(F[G],E[G],true)}}},aggregates:["_PLUG","_UNPLUG"]}},"3.1.2",{requires:["base-base"]});YUI.add("base",function(A){},"3.1.2",{use:["base-base","base-pluginhost","base-build"]});YUI.add("classnamemanager",function(C){var B="classNamePrefix",D="classNameDelimiter",A=C.config;A[B]=A[B]||"yui3";A[D]=A[D]||"-";C.ClassNameManager=function(){var E=A[B],F=A[D];return{getClassName:C.cached(function(){var G=C.Array(arguments);if(G[G.length-1]!==true){G.unshift(E)}else{G.pop()}return G.join(F)})}}()},"3.1.2");YUI.add("widget-base",function(B){var G=B.Lang,U=B.Node,E=B.ClassNameManager,b=E.getClassName,s,V=B.cached(function(L){return L.substring(0,1).toUpperCase()+L.substring(1)}),l="content",w="visible",r="hidden",d="disabled",h="focused",D="width",f="height",t="boundingBox",a="contentBox",K="parentNode",O="ownerDocument",m="offsetHeight",c="auto",J="srcNode",p="body",o="tabIndex",T="id",I="render",q="rendered",P="destroyed",A="strings",Q="<div></div>",e="Change",R="loading",k="_uiSet",j="",n=function(){},M=/(\w+):(\w+)/,Z="$2",X=true,u=false,W,N={},F=[w,d,f,D,h],i=B.UA.webkit,S=B.UA.ie,v="contentUpdate",g={},H={};function C(Y){this._strs={};this._cssPrefix=this.constructor.CSS_PREFIX||b(this.constructor.NAME.toLowerCase());C.superclass.constructor.apply(this,arguments);var x=this.get(I),L;if(x){if(x!==X){L=x}this.render(L)}}C.NAME="widget";W=C.UI_SRC="ui";C.ATTRS=N;N[T]={valueFn:"_guid",writeOnce:X};N[q]={value:u,readOnly:X};N[t]={value:null,setter:"_setBB",writeOnce:X};N[a]={valueFn:"_defaultCB",setter:"_setCB",writeOnce:X};N[o]={value:null,validator:"_validTabIndex"};N[h]={value:u,readOnly:X};N[d]={value:u};N[w]={value:X};N[f]={value:j};N[D]={value:j};N[A]={value:{},setter:"_strSetter",getter:"_strGetter"};N[I]={value:u,writeOnce:X};C.CSS_PREFIX=b(C.NAME.toLowerCase());C.getClassName=function(){return b.apply(E,[C.CSS_PREFIX].concat(B.Array(arguments),true))};s=C.getClassName;C.getByNode=function(L){var x,Y=s();L=U.one(L);if(L){L=L.ancestor("."+Y,true);if(L){x=H[B.stamp(L,X)]}}return x||null};B.extend(C,B.Base,{getClassName:function(){return b.apply(E,[this._cssPrefix].concat(B.Array(arguments),true))},getSkinName:function(){var L=this.get(a)||this.get(t),x=new RegExp("\\b"+b("skin")+"-(\\S+)"),Y;if(L){L.ancestor(function(y){Y=y.get("className").match(x);return Y})}return(Y)?Y[1]:null},initializer:function(L){H[B.stamp(this.get(t))]=this;this.publish(v,{preventable:u});if(this._applyParser){this._applyParser(L)}},destructor:function(){var L=this.get(t),x=B.stamp(L,X),Y=B.stamp(this,X);if(x in H){delete H[x]}B.each(g,function(y){if(y.instances[Y]){delete y.instances[Y];if(B.Object.size(y.instances)===0){y.handle.detach()}}});this._unbindUI(L);L.remove(X)},render:function(L){if(!this.get(P)&&!this.get(q)){this.publish(I,{queuable:u,fireOnce:X,defaultTargetOnly:X,defaultFn:this._defRenderFn});this.fire(I,{parentNode:(L)?U.one(L):null})}return this},_defRenderFn:function(L){this._parentNode=L.parentNode;this.renderer();this._set(q,X);this._removeLoadingClassNames()},renderer:function(){this._renderUI();this.renderUI();this._bindUI();this.bindUI();this._syncUI();this.syncUI()},bindUI:n,renderUI:n,syncUI:n,hide:function(){return this.set(w,u)},show:function(){return this.set(w,X)},focus:function(){return this._set(h,X)},blur:function(){return this._set(h,u)},enable:function(){return this.set(d,u)},disable:function(){return this.set(d,X)},_uiSizeCB:function(x){var z=this.get(t),Y=this.get(a),L=s("tmp","forcesize"),y=this._bbs,AA=S&&S<7;if(y){Y.toggleClass(s(l,"expanded"),x)}else{if(x){if(AA){z.addClass(L)}Y.set(m,z.get(m));if(AA){z.removeClass(L)}}else{Y.setStyle(f,j)}}},_renderBox:function(L){var Y=this.get(a),x=this.get(t),AA=this.get(J),y=this.DEF_PARENT_NODE,z=(AA&&AA.get(O))||x.get(O)||Y.get(O);if(AA&&!AA.compareTo(Y)&&!Y.inDoc(z)){AA.replace(Y)}if(!x.compareTo(Y.get(K))&&!x.compareTo(Y)){if(Y.inDoc(z)){Y.replace(x)}x.appendChild(Y)}L=L||(y&&U.one(y));if(L){L.appendChild(x)}else{if(!x.inDoc(z)){U.one(p).insert(x,0)}}this._bbs=!(S&&S<8&&z.compatMode!="BackCompat")},_setBB:function(L){return this._setBox(this.get(T),L,this.BOUNDING_TEMPLATE)},_setCB:function(L){return(this.CONTENT_TEMPLATE===null)?this.get(t):this._setBox(null,L,this.CONTENT_TEMPLATE)},_defaultCB:function(L){return this.get(J)||null},_setBox:function(x,Y,L){Y=U.one(Y)||U.create(L);if(!Y.get(T)){Y.set(T,x||B.guid())}return Y},_renderUI:function(){this._renderBoxClassNames();this._renderBox(this._parentNode)},_renderBoxClassNames:function(){var y=this._getClasses(),L,Y=this.get(t),x;Y.addClass(s());for(x=y.length-3;x>=0;x--){L=y[x];Y.addClass(L.CSS_PREFIX||b(L.NAME.toLowerCase()))}this.get(a).addClass(this.getClassName(l))},_removeLoadingClassNames:function(){var Y=this.get(t),L=this.get(a);Y.removeClass(s(R));Y.removeClass(this.getClassName(R));L.removeClass(s(R));L.removeClass(this.getClassName(R))},_bindUI:function(){this._bindAttrUI(this._BIND_UI_ATTRS);this._bindDOM()},_unbindUI:function(L){this._unbindDOM(L)},_bindDOM:function(){var L=this.get(t).get(O);this._hDocFocus=L.on("focus",this._onDocFocus,this);if(i){this._hDocMouseDown=L.on("mousedown",this._onDocMouseDown,this)}},_unbindDOM:function(L){if(this._hDocFocus){this._hDocFocus.detach()}if(i&&this._hDocMouseDown){this._hDocMouseDown.detach()}},_syncUI:function(){this._syncAttrUI(this._SYNC_UI_ATTRS)},_uiSetHeight:function(L){this._uiSetDim(f,L);this._uiSizeCB((L!==j&&L!==c))},_uiSetWidth:function(L){this._uiSetDim(D,L)},_uiSetDim:function(L,Y){this.get(t).setStyle(L,G.isNumber(Y)?Y+this.DEF_UNIT:Y)},_uiSetVisible:function(L){this.get(t).toggleClass(this.getClassName(r),!L)},_uiSetDisabled:function(L){this.get(t).toggleClass(this.getClassName(d),L)},_uiSetFocused:function(x,Y){var L=this.get(t);L.toggleClass(this.getClassName(h),x);if(Y!==W){if(x){L.focus()}else{L.blur()}}},_uiSetTabIndex:function(Y){var L=this.get(t);if(G.isNumber(Y)){L.set(o,Y)}else{L.removeAttribute(o)}},_onDocMouseDown:function(L){if(this._hasDOMFocus){this._onDocFocus(L)}},_onDocFocus:function(Y){var L=this.get(t).contains(Y.target);this._hasDOMFocus=L;this._set(h,L,{src:W})},toString:function(){return this.constructor.NAME+"["+this.get(T)+"]"},DEF_UNIT:"px",DEF_PARENT_NODE:null,CONTENT_TEMPLATE:Q,BOUNDING_TEMPLATE:Q,_guid:function(){return B.guid()},_validTabIndex:function(L){return(G.isNumber(L)||G.isNull(L))},_bindAttrUI:function(Y){var x,L=Y.length;for(x=0;x<L;x++){this.after(Y[x]+e,this._setAttrUI)}},_syncAttrUI:function(x){var y,Y=x.length,L;for(y=0;y<Y;y++){L=x[y];this[k+V(L)](this.get(L))}},_setAttrUI:function(L){this[k+V(L.attrName)](L.newVal,L.src)},_strSetter:function(L){return B.merge(this.get(A),L)},getString:function(L){return this.get(A)[L]},getStrings:function(){return this.get(A)},_BIND_UI_ATTRS:F,_SYNC_UI_ATTRS:F.concat(o),UI_EVENTS:B.Node.DOM_EVENTS,_getUIEventNode:function(){return this.get(t)},_createUIEvent:function(x){var AA=this._getUIEventNode(),L=AA.get(K),Y=(B.stamp(L)+x),z=g[Y],y;if(!z){y=L.delegate(x,function(AB){var AC=C.getByNode(this);AC.fire(AB.type,{domEvent:AB})},"."+s());g[Y]=z={instances:{},handle:y}}z.instances[B.stamp(this)]=1},_getUIEvent:function(Y){if(G.isString(Y)){var x=Y.replace(M,Z),L;if(this.UI_EVENTS[x]){L=x}return L}},_initUIEvent:function(Y){var x=this._getUIEvent(Y),L=this._uiEvtsInitQueue||{};if(x&&!L[x]){this._uiEvtsInitQueue=L[x]=1;this.after(I,function(){this._createUIEvent(x);delete this._uiEvtsInitQueue[x]})}},on:function(L){this._initUIEvent(L);return C.superclass.on.apply(this,arguments)},after:function(L){this._initUIEvent(L);return C.superclass.after.apply(this,arguments)},publish:function(Y,L){var x=this._getUIEvent(Y);if(x&&L&&L.defaultFn){this._initUIEvent(x)}return C.superclass.publish.apply(this,arguments)}});B.Widget=C},"3.1.2",{requires:["attribute","event-focus","base","node","classnamemanager","intl"]});YUI.add("widget-htmlparser",function(F){var E=F.Widget,C=F.Node,D=F.Lang,A="srcNode",B="contentBox";E.HTML_PARSER={};E._buildCfg={aggregates:["HTML_PARSER"]};E.ATTRS[A]={value:null,setter:C.one,getter:"_getSrcNode",writeOnce:true};F.mix(E.prototype,{_getSrcNode:function(G){return G||this.get(B)},_applyParsedConfig:function(I,G,H){return(H)?F.mix(G,H,false):G},_applyParser:function(G){var I=this,J=I.get(A),H=I._getHtmlParser(),L,K;if(H&&J){F.Object.each(H,function(N,M,O){K=null;if(D.isFunction(N)){K=N.call(I,J)}else{if(D.isArray(N)){K=J.all(N[0])}else{K=J.one(N)}}if(K!==null&&K!==undefined){L=L||{};L[M]=K}})}G=I._applyParsedConfig(J,G,L)},_getHtmlParser:function(){var H=this._getClasses(),J={},G,I;for(G=H.length-1;G>=0;G--){I=H[G].HTML_PARSER;if(I){F.mix(J,I,true)}}return J}})},"3.1.2",{requires:["widget-base"]});YUI.add("widget",function(A){},"3.1.2",{use:["widget-base","widget-htmlparser"]});YUI.add("substitute",function(G){var B=G.Lang,D="dump",F=" ",C="{",E="}",A=function(U,I,O,H){var M,L,K,S,R,T,Q=[],J,N,P=U.length;for(;;){M=U.lastIndexOf(C,P);if(M<0){break}L=U.indexOf(E,M);if(M+1>=L){break}J=U.substring(M+1,L);S=J;T=null;K=S.indexOf(F);if(K>-1){T=S.substring(K+1);S=S.substring(0,K)}R=I[S];if(O){R=O(S,R,T)}if(B.isObject(R)){if(!G.dump){R=R.toString()}else{if(B.isArray(R)){R=G.dump(R,parseInt(T,10))}else{T=T||"";N=T.indexOf(D);if(N>-1){T=T.substring(4)}if(R.toString===Object.prototype.toString||N>-1){R=G.dump(R,parseInt(T,10))}else{R=R.toString()}}}}else{if(!B.isString(R)&&!B.isNumber(R)){R="~-"+Q.length+"-~";Q[Q.length]=J}}U=U.substring(0,M)+R+U.substring(L+1);if(!H){P=M-1}}for(M=Q.length-1;M>=0;M=M-1){U=U.replace(new RegExp("~-"+M+"-~"),C+Q[M]+E,"g")}return U};G.substitute=A;B.substitute=A},"3.1.2",{optional:["dump"]});YUI.add("dd-ddm-base",function(B){var A=function(){A.superclass.constructor.apply(this,arguments)};A.NAME="ddm";A.ATTRS={dragCursor:{value:"move"},clickPixelThresh:{value:3},clickTimeThresh:{value:1000},throttleTime:{value:-1},dragMode:{value:"point",setter:function(C){this._setDragMode(C);return C}}};B.extend(A,B.Base,{_createPG:function(){},_active:null,_setDragMode:function(C){if(C===null){C=B.DD.DDM.get("dragMode")}switch(C){case 1:case"intersect":return 1;case 2:case"strict":return 2;case 0:case"point":return 0}return 0},CSS_PREFIX:"yui3-dd",_activateTargets:function(){},_drags:[],activeDrag:false,_regDrag:function(C){if(this.getDrag(C.get("node"))){return false}if(!this._active){this._setupListeners()}this._drags.push(C);return true},_unregDrag:function(D){var C=[];B.each(this._drags,function(F,E){if(F!==D){C[C.length]=F}});this._drags=C},_setupListeners:function(){this._createPG();this._active=true;var C=B.one(document);C.on("mousemove",B.throttle(B.bind(this._move,this),this.get("throttleTime")));C.on("mouseup",B.bind(this._end,this))},_start:function(){this.fire("ddm:start");this._startDrag()},_startDrag:function(){},_endDrag:function(){},_dropMove:function(){},_end:function(){if(this.activeDrag){this._endDrag();this.fire("ddm:end");this.activeDrag.end.call(this.activeDrag);this.activeDrag=null}},stopDrag:function(){if(this.activeDrag){this._end()}return this},_move:function(C){if(this.activeDrag){this.activeDrag._move.call(this.activeDrag,C);this._dropMove()}},cssSizestoObject:function(D){var C=D.split(" ");switch(C.length){case 1:C[1]=C[2]=C[3]=C[0];break;case 2:C[2]=C[0];C[3]=C[1];break;case 3:C[3]=C[1];break}return{top:parseInt(C[0],10),right:parseInt(C[1],10),bottom:parseInt(C[2],10),left:parseInt(C[3],10)}},getDrag:function(D){var C=false,E=B.one(D);if(E instanceof B.Node){B.each(this._drags,function(G,F){if(E.compareTo(G.get("node"))){C=G}})}return C},swapPosition:function(D,C){D=B.DD.DDM.getNode(D);C=B.DD.DDM.getNode(C);var F=D.getXY(),E=C.getXY();D.setXY(E);C.setXY(F);return D},getNode:function(C){if(C&&C.get){if(B.Widget&&(C instanceof B.Widget)){C=C.get("boundingBox")}else{C=C.get("node")}}else{C=B.one(C)}return C},swapNode:function(E,C){E=B.DD.DDM.getNode(E);C=B.DD.DDM.getNode(C);var F=C.get("parentNode"),D=C.get("nextSibling");if(D==E){F.insertBefore(E,C)}else{if(C==E.get("nextSibling")){F.insertBefore(C,E)}else{E.get("parentNode").replaceChild(C,E);F.insertBefore(E,D)}}return E}});B.namespace("DD");B.DD.DDM=new A()},"3.1.2",{requires:["node","base","yui-throttle"],skinnable:false});YUI.add("dd-drag",function(D){var E=D.DD.DDM,U="node",G="dragging",N="dragNode",C="offsetHeight",K="offsetWidth",S="mouseup",P="mousedown",M="dragstart",H="drag:mouseDown",B="drag:afterMouseDown",F="drag:removeHandle",L="drag:addHandle",R="drag:removeInvalid",T="drag:addInvalid",J="drag:start",I="drag:end",O="drag:drag",Q="drag:align",A=function(W){this._lazyAddAttrs=false;A.superclass.constructor.apply(this,arguments);var V=E._regDrag(this);if(!V){D.error("Failed to register node, already in use: "+W.node)}};A.NAME="drag";A.ATTRS={node:{setter:function(V){var W=D.one(V);if(!W){D.error("DD.Drag: Invalid Node Given: "+V)}else{W=W.item(0)}return W}},dragNode:{setter:function(V){var W=D.one(V);if(!W){D.error("DD.Drag: Invalid dragNode Given: "+V)}return W}},offsetNode:{value:true},startCentered:{value:false},clickPixelThresh:{value:E.get("clickPixelThresh")},clickTimeThresh:{value:E.get("clickTimeThresh")},lock:{value:false,setter:function(V){if(V){this.get(U).addClass(E.CSS_PREFIX+"-locked")}else{this.get(U).removeClass(E.CSS_PREFIX+"-locked")}return V}},data:{value:false},move:{value:true},useShim:{value:true},activeHandle:{value:false},primaryButtonOnly:{value:true},dragging:{value:false},parent:{value:false},target:{value:false,setter:function(V){this._handleTarget(V);return V}},dragMode:{value:null,setter:function(V){return E._setDragMode(V)}},groups:{value:["default"],getter:function(){if(!this._groups){this._groups={}}var V=[];D.each(this._groups,function(X,W){V[V.length]=W});return V},setter:function(V){this._groups={};D.each(V,function(X,W){this._groups[X]=true},this);return V}},handles:{value:null,setter:function(V){if(V){this._handles={};D.each(V,function(X,W){var Y=X;if(X instanceof D.Node||X instanceof D.NodeList){Y=X._yuid}this._handles[Y]=X},this)}else{this._handles=null}return V}},bubbles:{setter:function(V){this.addTarget(V);return V}}};D.extend(A,D.Base,{_bubbleTargets:D.DD.DDM,addToGroup:function(V){this._groups[V]=true;E._activateTargets();return this},removeFromGroup:function(V){delete this._groups[V];E._activateTargets();return this},target:null,_handleTarget:function(V){if(D.DD.Drop){if(V===false){if(this.target){E._unregTarget(this.target);this.target=null}return false}else{if(!D.Lang.isObject(V)){V={}}V.bubbleTargets=("bubbleTargets" in V)?V.bubbleTargets:D.Object.values(this._yuievt.targets);V.node=this.get(U);V.groups=V.groups||this.get("groups");this.target=new D.DD.Drop(V)}}else{return false}},_groups:null,_createEvents:function(){this.publish(H,{defaultFn:this._defMouseDownFn,queuable:false,emitFacade:true,bubbles:true,prefix:"drag"});this.publish(Q,{defaultFn:this._defAlignFn,queuable:false,emitFacade:true,bubbles:true,prefix:"drag"});this.publish(O,{defaultFn:this._defDragFn,queuable:false,emitFacade:true,bubbles:true,prefix:"drag"});this.publish(I,{preventedFn:this._prevEndFn,queuable:false,emitFacade:true,bubbles:true,prefix:"drag"});var V=[B,F,L,R,T,J,"drag:drophit","drag:dropmiss","drag:over","drag:enter","drag:exit"];D.each(V,function(X,W){this.publish(X,{type:X,emitFacade:true,bubbles:true,preventable:false,queuable:false,prefix:"drag"})},this)},_ev_md:null,_startTime:null,_endTime:null,_handles:null,_invalids:null,_invalidsDefault:{textarea:true,input:true,a:true,button:true,select:true},_dragThreshMet:null,_fromTimeout:null,_clickTimeout:null,deltaXY:null,startXY:null,nodeXY:null,lastXY:null,actXY:null,realXY:null,mouseXY:null,region:null,_handleMouseUp:function(V){this._fixIEMouseUp();if(E.activeDrag){E._end()}},_fixDragStart:function(V){V.preventDefault()},_ieSelectFix:function(){return false},_ieSelectBack:null,_fixIEMouseDown:function(){if(D.UA.ie){this._ieSelectBack=D.config.doc.body.onselectstart;D.config.doc.body.onselectstart=this._ieSelectFix}},_fixIEMouseUp:function(){if(D.UA.ie){D.config.doc.body.onselectstart=this._ieSelectBack}},_handleMouseDownEvent:function(V){this.fire(H,{ev:V})},_defMouseDownFn:function(W){var V=W.ev;this._dragThreshMet=false;this._ev_md=V;if(this.get("primaryButtonOnly")&&V.button>1){return false}if(this.validClick(V)){this._fixIEMouseDown();V.halt();this._setStartPosition([V.pageX,V.pageY]);E.activeDrag=this;this._clickTimeout=D.later(this.get("clickTimeThresh"),this,this._timeoutCheck)}this.fire(B,{ev:V})},validClick:function(Z){var Y=false,c=false,V=Z.target,X=null,W=null,a=null,b=false;if(this._handles){D.each(this._handles,function(d,e){if(d instanceof D.Node||d instanceof D.NodeList){if(!Y){a=d;if(a instanceof D.Node){a=new D.NodeList(d._node)}a.each(function(f){if(f.contains(V)){Y=true}})}}else{if(D.Lang.isString(e)){if(V.test(e+", "+e+" *")&&!X){X=e;Y=true}}}})}else{c=this.get(U);if(c.contains(V)||c.compareTo(V)){Y=true}}if(Y){if(this._invalids){D.each(this._invalids,function(d,e){if(D.Lang.isString(e)){if(V.test(e+", "+e+" *")){Y=false}}})}}if(Y){if(X){W=Z.currentTarget.all(X);b=false;W.each(function(e,d){if((e.contains(V)||e.compareTo(V))&&!b){b=true;this.set("activeHandle",e)}},this)}else{this.set("activeHandle",this.get(U))}}return Y},_setStartPosition:function(V){this.startXY=V;this.nodeXY=this.lastXY=this.realXY=this.get(U).getXY();if(this.get("offsetNode")){this.deltaXY=[(this.startXY[0]-this.nodeXY[0]),(this.startXY[1]-this.nodeXY[1])]}else{this.deltaXY=[0,0]}},_timeoutCheck:function(){if(!this.get("lock")&&!this._dragThreshMet){this._fromTimeout=this._dragThreshMet=true;this.start();this._alignNode([this._ev_md.pageX,this._ev_md.pageY],true)}},removeHandle:function(W){var V=W;if(W instanceof D.Node||W instanceof D.NodeList){V=W._yuid}if(this._handles[V]){delete this._handles[V];this.fire(F,{handle:W})}return this},addHandle:function(W){if(!this._handles){this._handles={}}var V=W;if(W instanceof D.Node||W instanceof D.NodeList){V=W._yuid}this._handles[V]=W;this.fire(L,{handle:W});return this},removeInvalid:function(V){if(this._invalids[V]){this._invalids[V]=null;delete this._invalids[V];this.fire(R,{handle:V})}return this},addInvalid:function(V){if(D.Lang.isString(V)){this._invalids[V]=true;this.fire(T,{handle:V})}return this},initializer:function(V){this.get(U).dd=this;if(!this.get(U).get("id")){var W=D.stamp(this.get(U));this.get(U).set("id",W)}this.actXY=[];this._invalids=D.clone(this._invalidsDefault,true);this._createEvents();if(!this.get(N)){this.set(N,this.get(U))}this.on("initializedChange",D.bind(this._prep,this));this.set("groups",this.get("groups"))},_prep:function(){this._dragThreshMet=false;var V=this.get(U);V.addClass(E.CSS_PREFIX+"-draggable");V.on(P,D.bind(this._handleMouseDownEvent,this));V.on(S,D.bind(this._handleMouseUp,this));V.on(M,D.bind(this._fixDragStart,this))},_unprep:function(){var V=this.get(U);V.removeClass(E.CSS_PREFIX+"-draggable");V.detachAll()},start:function(){if(!this.get("lock")&&!this.get(G)){var W=this.get(U),V,X,Y;this._startTime=(new Date()).getTime();E._start();W.addClass(E.CSS_PREFIX+"-dragging");this.fire(J,{pageX:this.nodeXY[0],pageY:this.nodeXY[1],startTime:this._startTime});W=this.get(N);Y=this.nodeXY;V=W.get(K);X=W.get(C);if(this.get("startCentered")){this._setStartPosition([Y[0]+(V/2),Y[1]+(X/2)])}this.region={"0":Y[0],"1":Y[1],area:0,top:Y[1],right:Y[0]+V,bottom:Y[1]+X,left:Y[0]};this.set(G,true)}return this},end:function(){this._endTime=(new Date()).getTime();if(this._clickTimeout){this._clickTimeout.cancel()}this._dragThreshMet=false;this._fromTimeout=false;if(!this.get("lock")&&this.get(G)){this.fire(I,{pageX:this.lastXY[0],pageY:this.lastXY[1],startTime:this._startTime,endTime:this._endTime})}this.get(U).removeClass(E.CSS_PREFIX+"-dragging");this.set(G,false);this.deltaXY=[0,0];return this},_prevEndFn:function(V){this.get(N).setXY(this.nodeXY)},_align:function(V){this.fire(Q,{pageX:V[0],pageY:V[1]})},_defAlignFn:function(V){this.actXY=[V.pageX-this.deltaXY[0],V.pageY-this.deltaXY[1]]},_alignNode:function(V){this._align(V);this._moveNode()},_moveNode:function(V){var W=[],X=[],Z=this.nodeXY,Y=this.actXY;W[0]=(Y[0]-this.lastXY[0]);W[1]=(Y[1]-this.lastXY[1]);X[0]=(Y[0]-this.nodeXY[0]);X[1]=(Y[1]-this.nodeXY[1]);this.region={"0":Y[0],"1":Y[1],area:0,top:Y[1],right:Y[0]+this.get(N).get(K),bottom:Y[1]+this.get(N).get(C),left:Y[0]};this.fire(O,{pageX:Y[0],pageY:Y[1],scroll:V,info:{start:Z,xy:Y,delta:W,offset:X}});this.lastXY=Y},_defDragFn:function(V){if(this.get("move")){if(V.scroll){V.scroll.node.set("scrollTop",V.scroll.top);V.scroll.node.set("scrollLeft",V.scroll.left)}this.get(N).setXY([V.pageX,V.pageY]);this.realXY=[V.pageX,V.pageY]}},_move:function(X){if(this.get("lock")){return false}else{this.mouseXY=[X.pageX,X.pageY];if(!this._dragThreshMet){var W=Math.abs(this.startXY[0]-X.pageX),V=Math.abs(this.startXY[1]-X.pageY);if(W>this.get("clickPixelThresh")||V>this.get("clickPixelThresh")){this._dragThreshMet=true;this.start();this._alignNode([X.pageX,X.pageY])}}else{if(this._clickTimeout){this._clickTimeout.cancel()}this._alignNode([X.pageX,X.pageY])}}},stopDrag:function(){if(this.get(G)){E._end()}return this},destructor:function(){this._unprep();this.detachAll();if(this.target){this.target.destroy()}E._unregDrag(this)}});D.namespace("DD");D.DD.Drag=A},"3.1.2",{requires:["dd-ddm-base"],skinnable:false});YUI.add("dd-constrain",function(B){var K="dragNode",M="offsetHeight",F="offsetWidth",P="host",G="tickXArray",N="tickYArray",O=B.DD.DDM,E="top",I="right",L="bottom",D="left",J="view",H=null,A=function(C){this._lazyAddAttrs=false;A.superclass.constructor.apply(this,arguments)};A.NAME="ddConstrained";A.NS="con";A.ATTRS={host:{},stickX:{value:false},stickY:{value:false},tickX:{value:false},tickY:{value:false},tickXArray:{value:false},tickYArray:{value:false},gutter:{value:"0",setter:function(C){return B.DD.DDM.cssSizestoObject(C)}},constrain:{value:J,setter:function(C){var Q=B.one(C);if(Q){C=Q}return C}},constrain2region:{setter:function(C){return this.set("constrain",C)}},constrain2node:{setter:function(C){return this.set("constrain",B.one(C))}},constrain2view:{setter:function(C){return this.set("constrain",J)}},cacheRegion:{value:true}};H={initializer:function(){this.get(P).on("drag:start",B.bind(this._handleStart,this));this.get(P).after("drag:align",B.bind(this.align,this))},_handleStart:function(){this.resetCache()},_regionCache:null,_cacheRegion:function(){this._regionCache=this.get("constrain").get("region")},resetCache:function(){this._regionCache=null},_getConstraint:function(){var C=this.get("constrain"),Q=this.get("gutter"),R;if(C){if(C instanceof B.Node){if(!this._regionCache){B.on("resize",B.bind(this._cacheRegion,this),window);this._cacheRegion()}R=B.clone(this._regionCache);if(!this.get("cacheRegion")){this.resetCache()}}else{if(B.Lang.isObject(C)){R=C}}}if(!C||!R){C=J}if(C===J){R=this.get(P).get(K).get("viewportRegion")}B.each(Q,function(S,T){if((T==I)||(T==L)){R[T]-=S}else{R[T]+=S}});return R},getRegion:function(T){var R={},S=null,C=null,Q=this.get(P);R=this._getConstraint();if(T){S=Q.get(K).get(M);C=Q.get(K).get(F);R[I]=R[I]-C;R[L]=R[L]-S}return R},_checkRegion:function(C){var R=C,T=this.getRegion(),S=this.get(P),U=S.get(K).get(M),Q=S.get(K).get(F);if(R[1]>(T[L]-U)){C[1]=(T[L]-U)}if(T[E]>R[1]){C[1]=T[E]}if(R[0]>(T[I]-Q)){C[0]=(T[I]-Q)}if(T[D]>R[0]){C[0]=T[D]}return C},inRegion:function(R){R=R||this.get(P).get(K).getXY();var Q=this._checkRegion([R[0],R[1]]),C=false;if((R[0]===Q[0])&&(R[1]===Q[1])){C=true}return C},align:function(){var R=this.get(P),C=R.actXY,Q=this.getRegion(true);if(this.get("stickX")){C[1]=(R.startXY[1]-R.deltaXY[1])}if(this.get("stickY")){C[0]=(R.startXY[0]-R.deltaXY[0])}if(Q){C=this._checkRegion(C)}C=this._checkTicks(C,Q);R.actXY=C},_checkTicks:function(V,T){var S=this.get(P),U=(S.startXY[0]-S.deltaXY[0]),R=(S.startXY[1]-S.deltaXY[1]),C=this.get("tickX"),Q=this.get("tickY");if(C&&!this.get(G)){V[0]=O._calcTicks(V[0],U,C,T[D],T[I])}if(Q&&!this.get(N)){V[1]=O._calcTicks(V[1],R,Q,T[E],T[L])}if(this.get(G)){V[0]=O._calcTickArray(V[0],this.get(G),T[D],T[I])}if(this.get(N)){V[1]=O._calcTickArray(V[1],this.get(N),T[E],T[L])}return V}};B.namespace("Plugin");B.extend(A,B.Base,H);B.Plugin.DDConstrained=A;B.mix(O,{_calcTicks:function(W,V,S,U,T){var Q=((W-V)/S),R=Math.floor(Q),C=Math.ceil(Q);if((R!==0)||(C!==0)){if((Q>=R)&&(Q<=C)){W=(V+(S*R));if(U&&T){if(W<U){W=(V+(S*(R+1)))}if(W>T){W=(V+(S*(R-1)))}}}}return W},_calcTickArray:function(X,Y,W,T){var Q=0,U=Y.length,S=0,R,C,V;if(!Y||(Y.length===0)){return X}else{if(Y[0]>=X){return Y[0]}else{for(Q=0;Q<U;Q++){S=(Q+1);if(Y[S]&&Y[S]>=X){R=X-Y[Q];C=Y[S]-X;V=(C>R)?Y[Q]:Y[S];if(W&&T){if(V>T){if(Y[Q]){V=Y[Q]}else{V=Y[U-1]}}}return V}}return Y[Y.length-1]}}}})},"3.1.2",{requires:["dd-drag"],skinnable:false});YUI.add("slider-base",function(C){var B=C.Attribute.INVALID_VALUE;function A(){A.superclass.constructor.apply(this,arguments)}C.SliderBase=C.extend(A,C.Widget,{initializer:function(){this.axis=this.get("axis");this._key={dim:(this.axis==="y")?"height":"width",minEdge:(this.axis==="y")?"top":"left",maxEdge:(this.axis==="y")?"bottom":"right",xyIndex:(this.axis==="y")?1:0};this.publish("thumbMove",{defaultFn:this._defThumbMoveFn,queuable:true})},renderUI:function(){var D=this.get("contentBox");this.rail=this.renderRail();this._uiSetRailLength(this.get("length"));this.thumb=this.renderThumb();this.rail.appendChild(this.thumb);D.appendChild(this.rail);D.addClass(this.getClassName(this.axis))},renderRail:function(){var E=this.getClassName("rail","cap",this._key.minEdge),D=this.getClassName("rail","cap",this._key.maxEdge);return C.Node.create(C.substitute(this.RAIL_TEMPLATE,{railClass:this.getClassName("rail"),railMinCapClass:E,railMaxCapClass:D}))},_uiSetRailLength:function(D){this.rail.setStyle(this._key.dim,D)},renderThumb:function(){this._initThumbUrl();var D=this.get("thumbUrl");return C.Node.create(C.substitute(this.THUMB_TEMPLATE,{thumbClass:this.getClassName("thumb"),thumbShadowClass:this.getClassName("thumb","shadow"),thumbImageClass:this.getClassName("thumb","image"),thumbShadowUrl:D,thumbImageUrl:D}))},bindUI:function(){this._bindThumbDD();this._bindValueLogic();this.after("disabledChange",this._afterDisabledChange);this.after("lengthChange",this._afterLengthChange)},_bindThumbDD:function(){var D={constrain:this.rail};D["stick"+this.axis.toUpperCase()]=true;this._dd=new C.DD.Drag({node:this.thumb,bubble:false,on:{"drag:start":C.bind(this._onDragStart,this)},after:{"drag:drag":C.bind(this._afterDrag,this),"drag:end":C.bind(this._afterDragEnd,this)}});this._dd.plug(C.Plugin.DDConstrained,D)},_bindValueLogic:function(){},_uiMoveThumb:function(D){if(this.thumb){this.thumb.setStyle(this._key.minEdge,D+"px");this.fire("thumbMove",{offset:D})}},_onDragStart:function(D){this.fire("slideStart",{ddEvent:D})},_afterDrag:function(E){var F=E.info.xy[this._key.xyIndex],D=E.target.con._regionCache[this._key.minEdge];this.fire("thumbMove",{offset:(F-D),ddEvent:E})},_afterDragEnd:function(D){this.fire("slideEnd",{ddEvent:D})},_afterDisabledChange:function(D){this._dd.set("lock",D.newVal)},_afterLengthChange:function(D){if(this.get("rendered")){this._uiSetRailLength(D.newVal);this.syncUI()}},syncUI:function(){this._dd.con.resetCache();this._syncThumbPosition()},_syncThumbPosition:function(){},_setAxis:function(D){D=(D+"").toLowerCase();return(D==="x"||D==="y")?D:B},_setLength:function(E){E=(E+"").toLowerCase();var F=parseFloat(E,10),D=E.replace(/[\d\.\-]/g,"")||this.DEF_UNIT;return F>0?(F+D):B},_initThumbUrl:function(){var E=this.get("thumbUrl"),F=this.getSkinName()||"sam",D=C.config.base+"slider/assets/skins/"+F;if(!E){E=D+"/thumb-"+this.axis+".png";this.set("thumbUrl",E)}},BOUNDING_TEMPLATE:"<span></span>",CONTENT_TEMPLATE:"<span></span>",RAIL_TEMPLATE:'<span class="{railClass}"><span class="{railMinCapClass}"></span><span class="{railMaxCapClass}"></span></span>',THUMB_TEMPLATE:'<span class="{thumbClass}" tabindex="-1"><img src="{thumbShadowUrl}" alt="Slider thumb shadow" class="{thumbShadowClass}"><img src="{thumbImageUrl}" alt="Slider thumb" class="{thumbImageClass}"></span>'},{NAME:"sliderBase",ATTRS:{axis:{value:"x",writeOnce:true,setter:"_setAxis",lazyAdd:false},length:{value:"150px",setter:"_setLength"},thumbUrl:{value:null,validator:C.Lang.isString}}})},"3.1.2",{requires:["widget","substitute","dd-constrain"]});YUI.add("slider-value-range",function(F){var B="min",E="max",D="value",C=Math.round;function A(){this._initSliderValueRange()}F.SliderValueRange=F.mix(A,{prototype:{_factor:1,_initSliderValueRange:function(){},_bindValueLogic:function(){this.after({minChange:this._afterMinChange,maxChange:this._afterMaxChange,valueChange:this._afterValueChange})},_syncThumbPosition:function(){this._calculateFactor();this._setPosition(this.get(D))},_calculateFactor:function(){var J=this.get("length"),H=this.thumb.getStyle(this._key.dim),I=this.get(B),G=this.get(E);J=parseFloat(J,10)||150;H=parseFloat(H,10)||15;this._factor=(G-I)/(J-H)},_defThumbMoveFn:function(I){var G=this.get(D),H=this._offsetToValue(I.offset);if(G!==H){this.set(D,H,{positioned:true})}},_offsetToValue:function(H){var G=C(H*this._factor)+this.get(B);return C(this._nearestValue(G))},_valueToOffset:function(G){var H=C((G-this.get(B))/this._factor);return H},getValue:function(){return this.get(D)},setValue:function(G){return this.set(D,G)},_afterMinChange:function(G){this._verifyValue();this._syncThumbPosition()},_afterMaxChange:function(G){this._verifyValue();this._syncThumbPosition()},_verifyValue:function(){var H=this.get(D),G=this._nearestValue(H);if(H!==G){this.set(D,G)}},_afterValueChange:function(G){if(!G.positioned){this._setPosition(G.newVal)}},_setPosition:function(G){this._uiMoveThumb(this._valueToOffset(G))},_validateNewMin:function(G){return F.Lang.isNumber(G)},_validateNewMax:function(G){return F.Lang.isNumber(G)},_setNewValue:function(G){return C(this._nearestValue(G))},_nearestValue:function(J){var I=this.get(B),G=this.get(E),H;H=(G>I)?G:I;I=(G>I)?I:G;G=H;return(J<I)?I:(J>G)?G:J}},ATTRS:{min:{value:0,validator:"_validateNewMin"},max:{value:100,validator:"_validateNewMax"},value:{value:0,setter:"_setNewValue"}}},true)},"3.1.2",{requires:["slider-base"]});YUI.add("clickable-rail",function(B){function A(){this._initClickableRail()}B.ClickableRail=B.mix(A,{prototype:{_initClickableRail:function(){this._evtGuid=this._evtGuid||(B.guid()+"|");this.publish("railMouseDown",{defaultFn:this._defRailMouseDownFn});this.after("render",this._bindClickableRail);this.on("destroy",this._unbindClickableRail)},_bindClickableRail:function(){this._dd.addHandle(this.rail);this.rail.on(this._evtGuid+"mousedown",this._onRailMouseDown,this)},_unbindClickableRail:function(){if(this.get("rendered")){var C=this.get("contentBox"),D=C.one("."+this.getClassName("rail"));D.detach(this.evtGuid+"*")}},_onRailMouseDown:function(C){if(this.get("clickableRail")&&!this.get("disabled")){this.fire("railMouseDown",{ev:C})}},_defRailMouseDownFn:function(I){I=I.ev;var C=this._resolveThumb(I),F=this._key.xyIndex,G=parseFloat(this.get("length"),10),E,D,H;if(C){E=C.get("dragNode");D=parseFloat(E.getStyle(this._key.dim),10);H=this._getThumbDestination(I,E);H=H[F]-this.rail.getXY()[F];H=Math.min(Math.max(H,0),(G-D));this._uiMoveThumb(H);C._handleMouseDownEvent(I)}},_resolveThumb:function(D){var E=this._dd.get("primaryButtonOnly"),C=!E||D.button<=1;return(C)?this._dd:null},_getThumbDestination:function(F,E){var D=E.get("offsetWidth"),C=E.get("offsetHeight");return[(F.pageX-Math.round((D/2))),(F.pageY-Math.round((C/2)))]}},ATTRS:{clickableRail:{value:true,validator:B.Lang.isBoolean}}},true)},"3.1.2",{requires:["slider-base"]});YUI.add("range-slider",function(A){A.Slider=A.Base.build("slider",A.SliderBase,[A.SliderValueRange,A.ClickableRail])},"3.1.2",{requires:["slider-base","clickable-rail","slider-value-range"]});YUI.add("slider",function(A){},"3.1.2",{use:["slider-base","slider-value-range","clickable-rail","range-slider"]});YUI.add("wl-paymentslider",function(A){A.components.Paymentslider=function(E){var J=this,F=E.initData,O=E.compInstConfig;var I,S,d,Z,H,P;var N,V,Y,L;var C;J.incomingEvents={"disable-slider":function(){if(I){I.lockComponent()}},"update-with-fop-surcharge":function(){if(P){P.updateSliderWithFopSurcharge()}}};J.onRenderState={initialized:function(e){if(A.one("#paymentSlider")){a();T();I.render();S.render()}if(F.failed){J.fireEvent("block_submit",{forceInitialize:true})}}};function a(){H=O.delayExecutorAfterInputKeyup||0;N=A.one(".paymentSlider_plusBoxMiles input[type=text]");V=A.one(".paymentSlider_plusBoxMiles input[type=hidden]");Y=A.one(".paymentSlider_plusBoxCash input");L=A.one(".paymentSlider_plusBoxCash input[type=hidden]");d=K();I=U();P=B(I);S=b(d)}function T(){A.on("keyup",G,N);A.on("keyup",G,Y);A.on("blur",X,N);A.on("blur",X,Y);A.on("keydown",c,N);A.on("keydown",c,Y)}function G(e){if(H){if(Z){Z.cancel()}Z=A.later(H,this,"blur")}}function c(e){P.setDisabled()}function X(j){var g=this,e=g.get("value"),i=false,h="";if(Z){Z.cancel();Z=null}if(g===N){h="getTickByAward";e=Q(e);i=d.getTickByAward(e)}else{if(g===Y){h="getTickByMonetary";e=D(e);i=d.getTickByMonetary(e)}}if(i||h===""){S.setPosition(i?i.position:S.getPosition());P.setEnabled()}else{var f={data:{actionCode:h,requestAmount:e},on:{success:M,end:function(){S.setPosition(S.getPosition());P.setEnabled();I.unlockComponent()}}};I.lockComponent();J.fireEvent("to-ajax",{cfg:f,actionCode:h})}}function M(g,e){if(e){var f=e.tick;if(d.replaceTick(f)){S.setPosition(f.position)}}}function R(e){if(false!==e){N.set("value",e.awardAmountFormatted);V.set("value",e.awardAmount);Y.set("value",e.monetaryAmountFormatted);L.set("value",e.monetaryValue)}}function W(e){var f=d.getTickByPosition(e);R(f)}function D(e){e=e.replace(",",".");e=e.replace(/[^0-9\.]/g,"");return e||"0"}function Q(e){e=e.replace(/[^0-9]/g,"");return e||"0"}var U=function(){var f=A.one(".paymentSlider_monetarySummary .prices-amount"),g=A.one(".paymentSlider_milesSummary .prices-amount");function e(){var h=A.one(".paymentSlider_msg3 .prices-alternatives");if(h){h.translate()}}return{render:function(){e()},lockComponent:function(){J.addLoadingOverlay(false)},unlockComponent:function(){J.removeLoadingOverlay()},lockApplication:function(){J.addLoadingOverlay()},unlockApplication:function(){J.removeLoadingOverlay()},setAmountsInSummary:function(h){if(false!==h){g.set("innerHTML",h.awardAmountFormatted);f.set("innerHTML",h.monetaryAmountFormatted)}}}};var K=function(){var g=F.sliderTicks||{},i=F.currentTick||{},e=g.ticks,h=g.size,f=g.axisDirection;return{getDefaultTickPosition:function(){if(this.replaceTick(i)){return i.position}else{return f==="AWARD_CASH"?this.getMinTickPosition():this.getMaxTickPosition()}},getMinTickPosition:function(){return 1},getMaxTickPosition:function(){return h},getTickByPosition:function(j){var l;j=parseFloat(j);for(var k=0;k<h;++k){l=e[k];if(j===parseFloat(l.position)){return l}}return false},getTickByAward:function(j){var l;j=parseFloat(j);for(var k=0;k<h;++k){l=e[k];if(j===parseFloat(l.awardAmount)){return l}}return false},getTickByMonetary:function(l){var k;l=parseFloat(l);for(var j=0;j<h;++j){k=e[j];if(l===parseFloat(k.monetaryAmount)){return k}}return false},replaceTick:function(l){var j=l.position||0;for(var k=0;k<h;++k){if(j===e[k].position){e[k]=l;return true}}return false}}};var b=function(g){var i=A.one("#paymentSlider-SliderPlaceholder"),f=h();function h(){var k=new A.Slider({axis:"x",length:i.getComputedStyle("width"),min:g.getMinTickPosition(),max:g.getMaxTickPosition(),value:g.getDefaultTickPosition(),after:{valueChange:e,slideEnd:j}});return k}function e(k){W(k.newVal)}function j(k){f.syncUI()}return{render:function(){f.render(i);var k=this.getPosition();W(k);C=g.getTickByPosition(k)},getPosition:function(){return f.getValue()},setPosition:function(k){if(k==this.getPosition()){W(k)}else{f.setValue(k)}}}};var B=function(f){var l=A.one(".paymentSlider_applyButton"),h=l.one("input"),g="button-disable",j="applyButton";h.on({click:e});function e(p,q){if(k()){var o={data:{actionCode:j,requestAmount:V.get("value")},on:{success:q||i,end:n}};f.lockApplication();J.fireEvent("to-ajax",{cfg:o,actionCode:j})}}function m(q,o){if(o&&o.tick){var p=o.tick;f.setAmountsInSummary(p);R(p)}}function i(q,o){if(o&&o.tick){var p=o.tick;f.setAmountsInSummary(p);C=p;R(p);J.fireEvent("apply-data",{data:{monetaryAmount:p.monetaryAmount,awardAmount:p.awardAmount}})}}function n(){f.unlockApplication()}function k(){return false===h.get("disabled")}return{updateSliderWithFopSurcharge:function(){if(C){S.setPosition(C.position);R(C)}e({},m)},setEnabled:function(){if(!k()){h.set("disabled","");l.removeClass(g)}},setDisabled:function(){if(k()){h.set("disabled","disabled");l.addClass(g)}}}}}});YUI.add("wl-simplepayment",function(A){A.components.Simplepayment=function(s){var g=this;var P="%value %currency";var D=s.initData;D.expiryDateFormat=s.compInstConfig.expiryDateFormat;var f=h(D);var l=false;function K(y,w,x){if(A.Lang.isFunction(p[y])){p[y](w,x)}}g.onCreate=function(w,x){var y=w.state;K(y,w,x)};g.incomingEvents={"logged-in":function(w){g.node.addClass("loading");i(w);q()},"logged-out":function(w){g.node.addClass("loading");i(w);u()}};function q(){N();B()}function N(){f=h(D);K(g.context.state,g.context,g.node);g.node.removeClass("loading")}function u(){N();var w=g.node.one(".create-travelbank-account");if(w){e()}}function h(x){var AA=x.fops;if(AA.length>0){if(AA.length==1){if(AA[0].type=="AWARD"){return{awardRedeemedTitle:(AA[0].price?d(AA[0].price):""),awardBalance:(AA[0].balance?d(AA[0].balance):""),awardRedeemed:(AA[0].price?"("+d(AA[0].price)+")":"")}}else{if(AA[0].type=="TRAVEL_BANK"){if(AA[0].state=="LOGGED_IN"){return{fop:AA[0].type,type:AA[0].type+"_"+AA[0].state,price:X(x.amountToRefund),currentBalance:G(AA[0].currentBalance),balanceAfterRefund:G(AA[0].balanceAfterCancellation),originalTripPrice:X(x.originalTripPrice),amountToRefund:X(x.amountToRefund),cancelFee:X(x.changeFeePrice),cancelFeeTax:X(x.changeFeeTax),refundFare:X(x.totalDuePrice),breakdowns:n(),anclPrice:a(),translationSuffix:".bt",dccRefundMessage:I()}}else{if(AA[0].state=="NEW_ACCOUNT_LOGGED_IN"){return{fop:AA[0].type,type:AA[0].state,price:X(x.amountToRefund),originalTripPrice:X(x.originalTripPrice),amountToRefund:X(x.amountToRefund),cancelFee:X(x.changeFeePrice),cancelFeeTax:X(x.changeFeeTax),refundFare:X(x.totalDuePrice),breakdowns:n(),anclPrice:a(),translationSuffix:".bt"}}else{return{fop:AA[0].type,type:AA[0].type+"_"+AA[0].state,price:X(x.amountToRefund),originalTripPrice:X(x.originalTripPrice),amountToRefund:X(x.amountToRefund),cancelFee:X(x.changeFeePrice),cancelFeeTax:X(x.changeFeeTax),refundFare:X(x.totalDuePrice),breakdowns:n(),anclPrice:a(),translationSuffix:".bt"}}}}else{if(AA[0].type=="CREDIT_CARD"){return{type:AA[0].type,fop:AA[0].type,number:AA[0].number,cardHolder:AA[0].cardHolder,expiryDate:AA[0].expiryDate,expiryDateFormat:x.expiryDateFormat,cardCode:AA[0].code.toUpperCase(),price:G(AA[0].amount),ccprice:G(AA[0].amount),originalTripPrice:X(x.originalTripPrice),amountToRefund:X(x.amountToRefund),cancelFee:X(x.changeFeePrice),cancelFeeTax:X(x.changeFeeTax),refundFare:X(x.totalDuePrice),breakdowns:n(),anclPrice:a(),translationSuffix:".cc",dccRefundMessage:o()}}else{if(AA[0].type=="PAYPAL"){return{type:AA[0].type,fop:AA[0].type,cardCode:AA[0].code.toUpperCase(),price:G(AA[0].amount),ccprice:G(AA[0].amount),originalTripPrice:X(x.originalTripPrice),amountToRefund:X(x.amountToRefund),cancelFee:X(x.changeFeePrice),cancelFeeTax:X(x.changeFeeTax),refundFare:X(x.totalDuePrice),breakdowns:n(),anclPrice:a(),translationSuffix:".paypal"}}else{if(AA[0].type=="REMOTE_PAYMENT"){return{type:AA[0].type,fop:AA[0].type,originalTripPrice:X(x.originalTripPrice),cancelFee:X(x.changeFeePrice),cancelFeeTax:X(x.changeFeeTax),price:G(AA[0].amount),amountToRefund:X(x.amountToRefund),translationSuffix:".rp"}}}}}}}else{var w=0;var z=0;for(var y=0;y<x.fops.length;y++){if(x.fops[y].type=="TRAVEL_BANK"){w=y}else{z=y}}return{fop:AA[w].type,type:AA[z].type,number:AA[z].number,cardHolder:AA[z].cardHolder,expiryDate:AA[z].expiryDate,expiryDateFormat:x.expiryDateFormat,cardCode:AA[z].code.toUpperCase(),price:G(AA[z].amount),ccprice:G(x.refundableAncillariesTotal),currentBalance:G(AA[w].currentBalance),balanceAfterRefund:G(AA[w].balanceAfterCancellation),originalTripPrice:X(x.originalTripPrice),amountToRefund:X(x.amountToRefund),cancelFee:X(x.changeFeePrice),cancelFeeTax:X(x.changeFeeTax),refundFare:X(x.totalDuePrice),breakdowns:n(),anclPrice:a(),translationSuffix:""}}}else{if(x.price){return{price:G(x.price)}}else{s.state="notAwardPayment"}}}var p={initialized:function(w,x){g.renderHtml(f,{node:x})},refund:j,refundConfirmation:function(w,x){f.translationSuffix=".confirmation";v(w,x)},awardPaymentOnly:function(w,x){g.renderHtml(f,{node:x})},notAwardPayment:function(w,x){}};function n(){if(D==null||D.ancillaryStatistics==null){return }var AD="";for(var AA=0;AA<D.ancillaryStatistics.length;++AA){var AC=D.ancillaryStatistics[AA];var w=g.getHtml("_trip_options_detail");var AB=(AC.totalAsMoney?X(AC.totalAsMoney):"");var x='<span class="label translate" wl:translate="Ancillary.name.'+AC.code+'"></span>';var z='<span class="label translate" wl:translate="Ancillary.refundStatus.'+AC.refundable+'"></span>';AD+=g.replaceData({price:AB,name:x,refundStatus:"("+z+")"},w);if(AC.hasTax){var y=(AC.taxAsMoney?X(AC.taxAsMoney):"");AD+=g.replaceData({price:y,name:x+' <span class="label translate" wl:translate="Ancillary.name.tax"></span>',refundStatus:""},w)}}return AD}function a(){var AA="";var w=g.getHtml("_breakdownAnclPrice");var z=G(D.ancillariesTotal);var x=G(D.nonRefundableAncillariesTotal);var y=G(D.refundableAncillariesTotal);AA+=g.replaceData({totalAnclPrice:z,amtForfeited:x,amtRefunded:y},w);return AA}function t(w){return A.formatPrice(w,{currencyCodeSeparator:"&nbsp;"})}function S(){var w;if(D.fops.length>1){var z,y;for(var x=0;x<D.fops.length;x++){if(D.fops[x].type=="TRAVEL_BANK"){w="_"+D.fops[x].type+"_"+D.fops[x].state;z=g.getPartial(w,f)}else{w="_"+D.fops[x].type;y=g.getPartial(w,f)}}return y+z}else{w="_"+f.type;return g.getPartial(w,f)}}function r(){var y=g.getPartial("_AIR_FARE",f);var x=D.ancillaryStatistics?g.getPartial("_TRIP_OPTIONS",f):"";var w=S();return y+x+w}function j(x,y){var z=r();g.renderHtml({paymentDetails:z},{node:y});var AA=y.one(".create-travelbank-account");if(AA){A.on("click",L,AA);e()}g.translateTemplate(x,g.node);var w=A.one(".simple-payment-login");if(w){m(w.one(".create-account-form"));Z(w)}if(M()){k();e()}}function k(){g.fireEvent("add-messages",{data:{messages:[{id:"paymentRequiredError",level:"error"}]}})}function M(){var y=D.ancillariesBreakdown;if(y){for(var z=0;z<y.length;++z){var x=y[z].ancillaries;for(var w=0;w<x.length;++w){if(x[w].paymentRequired){return true}}}}return false}function e(){g.fireEvent("block_submit",{forceInitialize:true})}function B(){g.fireEvent("unblock_submit",{forceInitialize:true})}function v(y,z){var x="_"+f.type;var AA=g.getPartial(x,f);g.renderHtml({paymentDetails:AA},{node:z});var AB=z.one(".create-travelbank-account");if(AB){A.on("click",L,AB)}g.translateTemplate(y,g.node);var w=A.one(".simple-payment-login");if(w){m(w.one(".create-account-form"));Z(w)}}function Z(w){A.wlValidation.showServerSideValidationErrors(s);A.wlValidation.errorRendering.hideAllOverlays();A.wlValidation.initializeForPartial(s.getType(),A.wlValidation.validationEngineRules,A.wlValidation.validationConfiguration,w);A.on("blur",A.wlValidation.validate,w);var y=w.one("#accountSubmit");if(y){A.on("click",U,y,this,w)}var x=w.one("#loginSubmit");if(x){A.on("click",W,x,this,w)}}function L(x){var y=A.one(".simple-payment-login");if(y){m(y.one(".login-form"));R(y.one(".create-account-form"));var w=y.one(".cancel-travelbank-account");if(w){A.on("click",C,w)}if(l){m(y.one(".wrongPassword"))}}}function C(x){m(A.one(".create-account-error"));var y=A.one(".simple-payment-login");if(y){R(y.one(".login-form"));var w=y.one(".account-fields");A.wlValidation.clearErrors(w);m(y.one(".create-account-form"))}}function b(x){var w={data:{prefix:V(x,"#account-prefix"),firstName:V(x,"#account-firstName"),lastName:V(x,"#account-lastName"),confirmPassword:V(x,"#account-confirmPassword"),email:V(x,"#account-email"),confirmEmail:V(x,"#account-confirmEmail"),username:V(x,"#account-username"),password:V(x,"#account-password"),selectedLanguage:A.getCurrentLanguage()},on:{end:function(){c(x)},success:function(z,y){E(x,y)}}};g.fireEvent("to-ajax",{componentType:"simplepayment",cfg:w,actionCode:"createAccount"})}function V(x,w){return x.one(w)!=null?escape(x.one(w).get("value")):null}function F(){g.node.addClass("loading");var w={data:{username:escape(g.node.one("#username").get("value")),password:escape(g.node.one("#password").get("value"))},on:{success:function(y,x){i(x)}}};g.fireEvent("to-ajax",{componentType:"login",cfg:w,actionCode:"login"})}function i(x){var w={data:{},on:{end:function(){g.node.removeClass("loading")},success:function(z,y){D=y.model;N();Q(x)}}};g.fireEvent("to-ajax",{cfg:w,actionCode:"refresh"})}function Q(w){if(w.authenticationResult&&(w.authenticationResult=="SUCCESSFUL"||w.authenticationResult=="TRAVEL_BANK_UNAVAILABLE")){g.fireEvent("bt-logged-in",{data:w.user});if(w.authenticationResult=="SUCCESSFUL"){q();g.fireEvent("unverified-logged-in",w);g.fireEvent("bt-logged-in",{user:w.user,updateContent:true})}}}function U(y,x){y.preventDefault();A.wlValidation.validate(null,x.one("#account-prefix"));A.wlValidation.validate(null,x.one("#account-firstName"));A.wlValidation.validate(null,x.one("#account-lastName"));A.wlValidation.validate(null,x.one("#account-username"));A.wlValidation.validate(null,x.one("#account-password"));A.wlValidation.validate(null,x.one("#account-confirmPassword"));A.wlValidation.validate(null,x.one("#account-email"));A.wlValidation.validate(null,x.one("#account-confirmEmail"));if(T(x)){Y("validationError")}else{if(y.currentTarget.ancestor(".create-account-form")){y.preventDefault();var w=y.currentTarget.ancestor(".create-account-form");J(w);b(w)}}}function W(y,x){var z=y.currentTarget.ancestor(".login-form");var w=y.currentTarget.ancestor(".simple-payment-login");if(z||w){y.preventDefault();A.wlValidation.validate(null,x.one(".username"));A.wlValidation.validate(null,x.one(".password"));if(H(x)){return }F()}}function H(y){var x=y.one("#username")&&(y.one("#username").hasClass("error"));var w=y.one("#password")&&y.one("#password").hasClass("error");return x||w}function Y(w){var y=A.getPartial("simplepayment","_createAccountStatusAdvisory",{status:w});var x=A.one(".create-account-error");x.setContent(y);R(x);A.translateNode(x)}function E(AA,z){var w=new String(z.accountApiResult);if(w=="SUCCESSFUL"){D.status="accountCreated";var y=0;for(var x=0;x<D.fops.length;x++){if(D.fops[x].type=="TRAVEL_BANK"){y=x}}D.fops[y].type="TRAVEL_BANK";D.fops[y].state="NEW_ACCOUNT_LOGGED_IN";q();g.fireEvent("bt-logged-in",{data:z.user});g.fireEvent("unverified-logged-in",z)}else{if(w=="FAILURE_USERNAME_ALREADY_EXISTS"){A.one("#account-username").addClass("error");Y("accountDuplicateUsername")}else{if(w=="FAILURE_PROFILE_ALREADY_EXISTS"){Y("accountDuplicateProfile")}else{if(w=="FAILURE_PROFILE_SYSTEM"){Y("accountProfileSystemError")}else{if(w=="FAILURE_OTHER"){Y("systemError")}}}}}c(AA)}function m(w){if(w){w.addClass("hidden")}}function R(w){if(w){w.removeClass("hidden")}}function J(w){if(w){w.addClass("loading")}}function c(w){if(w){w.removeClass("loading")}}function T(x){var w=false;if(O(x.one("#account-prefix"))){w=true}else{if(O(x.one("#account-firstName"))){w=true}else{if(O(x.one("#account-lastName"))){w=true}else{if(O(x.one("#account-username"))){w=true}else{if(O(x.one("#account-password"))){w=true}else{if(O(x.one("#account-confirmPassword"))){w=true}else{if(O(x.one("#account-email"))){w=true}else{if(O(x.one("#account-confirmEmail"))){w=true}}}}}}}}return w}function O(w){return(w&&w.hasClass("error"))}function d(w){var z=w.value;var y;if(z&&!isNaN(z)){var x={thousandsSeparator:","};y=A.DataType.Number.format(parseInt(w.value,10),x)}else{y=z}var AA={value:y,currency:w.currency,currencyCode:w.currency};return A.formatPrice(AA,{currencyCodeSeparator:"&nbsp;"})}function G(x){if(!x){return""}var w={amount:x.value,currency:{code:x.currency}};return X(w)}function X(x){if(!x){return""}var z={decimalPlaces:A.getDecimals(x.currency.code)};var w=x.amount.replace(",","");var y=A.DataType.Number.format(parseFloat(w),z);return A.formatPrice({value:y,currencyCode:x.currency.code},{currencyCodeSeparator:" "})}function I(){if(!D.dccRefundInfo){return""}var w=g.getPartial("_dccTransactionCurrencyMessage");return w}function o(){if(!D.dccRefundInfo){return""}var w=g.getPartial("_dccOriginalFopMessage",{currency:D.dccRefundInfo.cardCurrency});return w}}});YUI.add("wl-payment-abstractFOP",function(C){var A=function(F,J,I,E,G,D){this.configuration=F.configuration||{};this.modelData=D.model||{};if(this.modelData.paymentAmount){this.charged=C.DataType.Number.parse(this.modelData.paymentAmount.amount)}else{this.charged=0}this.common=G;this.level=J||0;this.code=F.code;this.codeLower=F.code.toLowerCase();this.name=F.name;this.index=E;this.sectionKey=I;this.id=I+"-"+J+"-"+this.codeLower+"-"+E;this.template=F.configuration.displayType;this.containerId="#fop-item-"+this.id;this.templateData={};this.componentModel=D.componentModel;this.componentConfiguration=D.componentConfiguration;this.layout=function(L){var M=C.widgets.payment.layouts[D.layoutType];if(M){if(D.componentConfiguration.dynamicCreditCardSelectionEnabled&&L.configuration.displayType==="creditCard"){return new M.dynamicCreditCard(L,D)}var K=M[L.configuration.displayType];if(K){return new K(L,D)}}return null}(this);this.callbacks={render:B};var H=G.getSelectedFOP(this.level);if(!H&&this.modelData.selected){this.select()}};A.prototype.onCancel=function(){this.charged=0;this.modelData.paymentAmount=null};A.prototype.onUpdate=function(){};A.prototype.onRemove=function(){};A.prototype.getHtml=function(E){if(E){this.templateData=C.merge(E,this.templateData)}var D=C.getHtml("payc","_"+this.template+"Item");return C.replaceTemplateData(this.templateData,D)};A.prototype.onUpdateSection=function(){};A.prototype.onSubmit=function(){};A.prototype.select=function(){this.common.setSelectedFOP(this,this.level)};A.prototype.deselect=function(){};A.prototype.isSelected=function(){return this.common.getSelectedFOP(this.level)===this};A.prototype.disable=function(){this.templateData.disabled="disabled";B(this.getHtml(),C.one(this.containerId));this.hideDetails()};A.prototype.remove=function(){this.onRemove();var D=C.one(this.containerId);if(D){D.purge(true);D.remove(true)}};A.prototype.disabledByConfiguration=function(){return this.configuration&&this.configuration.enabled===false};A.prototype.enable=function(){if(!this.disabledByConfiguration()){this.templateData.disabled="";B(this.getHtml(),C.one(this.containerId));this.applyEvents()}};A.prototype.applyEvents=function(){};A.prototype.hideDetails=function(D){};A.prototype.show=function(){var E=this.containerId;var D=C.one(E);D.setStyle("display","block")};A.prototype.hide=function(){var E=this.containerId;var D=C.one(E);D.setStyle("display","none")};A.prototype.applyOnInsuranceChangeAction=function(E,D){};A.prototype.isOneTabFop=function(){return false};function B(E,D){if(D){D.purge(true);var F=C.Node.create(E);D.replace(F);D.translate()}}C.widgets=C.widgets||{};C.widgets.payment=C.widgets.payment||{};C.widgets.payment.abstractFOP=A});YUI.add("array-extras",function(E){var C=E.Lang,D=Array.prototype,B=E.Array;B.lastIndexOf=(D.lastIndexOf)?function(A,F){return A.lastIndexOf(F)}:function(A,G){for(var F=A.length-1;F>=0;F=F-1){if(A[F]===G){break}}return F};B.unique=function(F,H){var A=F.slice(),G=0,J=-1,I=null;while(G<A.length){I=A[G];while((J=B.lastIndexOf(A,I))!==G){A.splice(J,1)}G+=1}if(H){if(C.isNumber(A[0])){A.sort(B.numericSort)}else{A.sort()}}return A};B.filter=(D.filter)?function(A,F,G){return D.filter.call(A,F,G)}:function(A,G,H){var F=[];B.each(A,function(K,J,I){if(G.call(H,K,J,I)){F.push(K)}});return F};B.reject=function(A,F,G){return B.filter(A,function(J,I,H){return !F.call(G,J,I,H)})};B.every=(D.every)?function(A,F,G){return D.every.call(A,F,G)}:function(F,H,I){for(var G=0,A=F.length;G<A;G=G+1){if(!H.call(I,F[G],G,F)){return false}}return true};B.map=(D.map)?function(A,F,G){return D.map.call(A,F,G)}:function(A,G,H){var F=[];B.each(A,function(K,J,I){F.push(G.call(H,K,J,I))});return F};B.reduce=(D.reduce)?function(A,H,F,G){return D.reduce.call(A,function(L,K,J,I){return F.call(G,L,K,J,I)},H)}:function(A,I,G,H){var F=I;B.each(A,function(L,K,J){F=G.call(H,F,L,K,J)});return F};B.find=function(F,H,I){for(var G=0,A=F.length;G<A;G++){if(H.call(I,F[G],G,F)){return F[G]}}return null};B.grep=function(A,F){return B.filter(A,function(H,G){return F.test(H)})};B.partition=function(A,G,H){var F={matches:[],rejects:[]};B.each(A,function(J,I){var K=G.call(H,J,I,A)?F.matches:F.rejects;K.push(J)});return F};B.zip=function(F,A){var G=[];B.each(F,function(I,H){G.push([I,A[H]])});return G};B.forEach=B.each},"3.1.2");YUI.add("linkedSelectWidget",function(F){var C=function(N,P,O,L){O=O||{};L=L||"NO_PREFIX";P=P||"";N.addClass("js:linkedSelect");function I(S){if(N&&"SELECT"===N.get("tagName").toUpperCase()){S=S||"";var R=O[S]||[];var T=[L,S].join(".");D(N);E(N,R,T);B(N);A(N,P)}}function Q(){var R=N.getAttribute("data-linkedSelectPreselectedValue");if(R){P=R;N.removeAttribute("data-linkedSelectPreselectedValue");return true}return false}function M(R){R.preventDefault();Q();I(this.get("value"))}function G(R){R.preventDefault();if(Q()){A(N,P)}}N.on("change",G);function K(R,S){if(R){R.on("change",M);if(true===S){I(R.get("value"))}}}function H(S,R){if(S){O=sabre.config.satConfiguration.statesByCountry;L="State";K(S,false);I(R)}}function J(R){P=R}return{setLinkedSelectOptions:I,setPreselectedValue:J,setListenerFor:K,setListenerForStatesAndCountries:H}};function D(G){G.all("option").each(function(H){H.remove()})}function E(H,I,G){F.Array.each(I,function(K){var J=F.Node.create("<option></option>");J.set("value",K);J.setAttribute("wl:translate",[G,K].join("."));J.addClass("translate");H.appendChild(J)})}function B(G){if(G.one("option")){G.set("disabled",false);G.translate()}else{G.set("disabled",true);G.appendChild(F.Node.create('<option value="">&nbsp;</option>'))}}function A(G,H){G.all("option").each(function(I){if(I.getAttribute("value")===H){I.set("selected",true)}else{I.set("selected",false)}})}F.widgets=F.widgets||{};F.widgets.LinkedSelectWidget=C},"1.0.0",{requires:[]});YUI.add("wl-payment-creditCard",function(D){var E=function(r,v,u,q,s,Y){E.superclass.constructor.apply(this,arguments);this.card=r;this.options={priceFormat:Y.priceFormat,fieldFilter:["cardNumber","cvcNumber"],layout:Y.layout,cardSelected:Y.cardSelected,detailsContainer:Y.detailsContainerId};this.containerId=this.layout.getMenuSelectorId();this.detailsContainerId=this.layout.getDetailsSelector();this.detailsContainerCss=Y.detailsContainerCss;this.detailsTemplateName=this.layout.getDetailsTemplateName();this.callbacks=D.merge(this.callbacks,{togglePaymentDetails:j,isInstallmentCCEnabled:I,addFormEvents:U,populateData:Z,removeDisabledFields:V,triggerShowSurcharge:d,informAboutChange:S,getExchangeMessage:T,getFraudMessage:Q});this.templateData={cardType:this.code,cssCardCode:this.codeLower,name:this.name,disabled:r.configuration.enabled?"":"disabled",preselected:this.isSelected()?"checked":"",id:this.id};this.rememberMeConfiguration=this.componentConfiguration.rememberMeFieldsConfiguration;var t={primaryRepositoryName:"paycBillingDataRepository",secondaryRepositoriesName:["psngRepository","cicRepository"]};this.billingDataOptions={sectionsSelector:".billing-data",configuration:this.rememberMeConfiguration,prefixRegexp:"selectedCards\\[[0-9]+\\]\\.",repositoryOptions:t}};D.extend(E,D.widgets.payment.abstractFOP);E.prototype.onUpdate=function(){var q="#details_"+this.id;var s=D.one(q);var r=this.common.getDueWithInsurance(this.level);var u=this.common.getDueWithoutInsurance(this.level);var w=this.common.priceMapper(r);var t=this.common.priceMapper(u);this.layout.onUpdate({detailsNode:s,price:w});if(!s){return }var v="#"+this.id+"-paymentAmount-";var Y=this.common.getPaymentAmount(this.level);if(payment.totalInCurrency>0){Y=this.common.getPaymentAmountInCurrency()}H(s,v+"amount",Y.amount);H(s,v+"value",Y.value);H(s,v+"currency",Y.currency);H(s,v+"currencyCode",Y.currencyCode);H(s,"#modifiedLevel",this.common.getModifiedLevel())};function H(Y,r,s){var q=Y.one(r);if(q){q.set("value",s)}}E.prototype.getHtml=function(Y){if(Y){this.templateData=D.merge(Y,this.templateData)}return this.layout.getHtml()};E.prototype.onUpdateSection=function(){this.layout.onUpdateSection()};E.prototype.onSubmit=function(){if(this.rememberMe){this.rememberMe.saveOrUpdateFormData()}};E.prototype.select=function(){this.common.setSelectedFOP(this,this.level);this.layout.onSelect()};E.prototype.deselect=function(){this.common.clearSelectedFOPs(this.level);this.layout.onDeselect();this.hideDetails({hideAll:true});this.common.clearRememberedValues()};E.prototype.enable=function(){if(!this.disabledByConfiguration()){this.templateData.disabled="";this.layout.onEnable();this.applyEvents()}};E.prototype.disable=function(){this.templateData.disabled="disabled";this.layout.onDisable();this.hideDetails()};E.prototype.show=function(){this.layout.onShow();this.applyEvents()};E.prototype.hide=function(){this.layout.onHide();this.hideDetails()};E.prototype.hideDetails=function(q){this.layout.onDeselect();var r=q&&q.hideAll;var s=D.one(this.detailsContainerId);var Y="#details_"+this.id;if(r||s.one(Y)){p(this,s)}};E.prototype.applyEvents=function(){this.layout.applySelectionEvent();if(!this.options.cardSelected&&this.card.code==this.layout.getPreselected()){this.select()}if(this.isSelected()&&!this.componentConfiguration.dynamicCreditCardSelectionEnabled){this.layout.onSelect();W(this);d(this)}};E.prototype.updateSurchargeInformation=function(){if(this.isSelected()){d(this)}};function j(q,Y){q.preventDefault();if(!Y.isSelected()){Y.common.confirmFOPChange(Y.level,function(){S(Y);i(Y);d(Y);Y.common.displayInsuranceAndHotelUnacceptableOverlayIfNeeded()},function(){Y.layout.onCancelOverLay()})}}function S(Y){D.fire("creditCard:fop-type-changed",{creditCardType:Y.code,level:Y.level})}function d(Y){if(sabre.config.satConfiguration.formsOfPaymentConfiguration.surchargeCheckEnabled){D.fire("creditCard:showSurchargeFee",Y,N)}}var C=function(s,v,u,r,t,q){C.superclass.constructor.apply(this,arguments);this.template="savedCard";var Y=this.modelData;this.options.fieldFilter=["cvcNumber","selected"];this.templateData=D.merge(this.templateData,{cardName:Y.cardType.name,ending:Y.cardNumber.substring(Y.cardNumber.length-4),expMonth:Y.expDate.month,expYear:Y.expDate.year,expiredCssClass:Y.expired?"expired":"",disabled:Y.expired||!s.configuration.enabled?"disabled":""})};D.extend(C,E);var a=function(r,u,t,q,s,Y){a.superclass.constructor.apply(this,arguments);this.template="creditCard"};D.extend(a,E);function i(Y){D.one(Y.detailsContainerId).addClass("loading");D.all(".fop-item").removeClass("selected");Y.select();D.later(5,D,W,Y)}function W(q){var Y=D.one(q.detailsContainerId);m(q,Y)}function p(q,Y){Y.purge(true);Y.setContent("");var r=D.one(q.containerId);if(r){r.removeClass("selected")}}function m(q,Y){if(!Y){return }Y.purge(true);if(q.rememberMe){q.rememberMe.purgeHandlers()}var t=q.common.getDueWithInsurance(q.level);var v=q.common.getDueWithoutInsurance(q.level);var w=q.common.priceMapper(t);var u=q.common.priceMapper(v);q.modelData.paymentAmount=q.common.getPaymentAmount(q.level);if(q.detailsHtml){Y.set("innerHTML",q.detailsHtml);Y.translate();L(Y,q.common.getPassengerInformationList(),q.common.getDefaultPassengerInformationIndex(),q);l(Y,q.modelData,q.options.fieldFilter);D.later(1,D,function(){q.onUpdate()})}else{var s=D.getHtml("payc",q.detailsTemplateName);var r=D.replaceTemplateData({cssCardCode:q.codeLower,paymentMethod:q.template,name:"selectedCards["+q.level+"]",id:q.id,paymentAmount:q.common.formatPrice(w),exchangeMessage:T(q),fraudMessage:Q(q),cardType:q.code,cardName:q.name,remote:q.configuration.remote,sectionName:q.sectionKey,cardNumberInputs:k(q),installmentOptions:g(q)},s);Y.set("innerHTML",r);V(Y,q,q.id);A(Y,q.common.getPassengerInformationList());L(Y,q.common.getPassengerInformationList(),q.common.getDefaultPassengerInformationIndex(),q);Y.translate();D.later(1,D,function(){q.onUpdate();var x=D.one(q.detailsContainerId);if(x&&x.one(".countriesOptions")){D.assignSelectBoxesContent(Y,{countriesOptions:D.countries})}q.detailsHtml=Y.get("innerHTML");l(Y,q.modelData,q.options.fieldFilter)})}q.common.recalculateDue(J(q,q.common.getAmountToRefund()),D.one(".exchange-payment-msg"));D.later(5,D,U,[Y,q])}function T(r){var s="";var t=r.common.getDueWithInsurance(r.level);var w=r.common.priceMapper(t);if(r.common.isDisplayExchangeMessage()){var q=r.common.getAmountToRefund();var Y=q&&q.amount!=0&&w&&w.amount!=0;var u={amountToPay:r.common.formatPrice(w),amountToRefund:r.common.formatPrice(q)};if(Y===true){s=r.common.getPartial("_paymentExchangeMsgSameFop",u)}else{s=r.common.getPartial("_paymentExchangeMsg",u)}}if(r.common.isDisplayExchangeSplitVCRAndEMDMessage()){var v=r.common.getAmountToAddCollect();var q=r.common.getAmountToRefund();var u={amountToPay:r.common.formatPrice(v),amountToRefund:r.common.formatPrice(q)};s=r.common.getPartial("_paymentExchangeMsg",u)}return s}function Q(Y){var q="";if(Y.common.isDisplayFraudMessage()){q=Y.common.getPartial("_paymentFraudMsg",{})}return q}function Z(q){var Y=D.one(q.detailsContainerId);A(Y,q.common.getPassengerInformationList());L(Y,q.common.getPassengerInformationList(),q.common.getDefaultPassengerInformationIndex(),q);D.assignSelectBoxesContent(Y,{countriesOptions:D.countries});l(Y,q.modelData,q.options.fieldFilter)}function J(q,Y){return function(u){var r=q.common.getDueWithInsurance(q.level);var t=q.common.priceMapper(r);var s={amountToPay:q.common.formatPrice(t),amountToRefund:q.common.formatPrice(Y)};if(u!=null){u.set(q.common.getPartial("_paymentExchangeMsg",s))}}}function g(Y){return I(Y)?Y.layout.createBankOptions(Y):""}function I(Y){return Y.configuration.installmentEnabled&&Y.componentModel.shoppingPath==="B2C"&&X(Y)}function X(Y){return D.DataType.Number.parse(Y.configuration.minAmount)<=D.DataType.Number.parse(Y.common.getDueWithInsurance(Y.level))}function k(r){var s=r.configuration.cardNumberFormat.split(",");var Y=[];var q=0;var t="";if(r.modelData.cardNumber!==undefined&&r.template=="savedCard"){t=r.modelData.cardNumber}D.Array.each(s,function(v){v=parseInt(v);var u=t.slice(0,v);t=t.slice(v,t.length);Y.push(o(v,q,u));++q});return Y.join("")}function o(s,r,Y){var q=D.getHtml("payc","_radioViewCreditCardInput");return D.replaceTemplateData({size:parseInt(s),index:r,value:Y},q)}function V(Y,r,v,u){var q=r.configuration;if(q){var s="#details_"+v;var t=Y.all(s+" .configurable");t.each(function(x){var z=x.get("id");var w=B(q,z.split("."));try{if(u){u(x,w)}else{if(!w){x.remove()}}}catch(y){D.log("Cant configure field with id: "+z,"error")}})}}function A(Y,q,r){var w=Y.one("#purchaserInfo-dropdown");if(q&&w!=null){var x="";var t;for(var s=0;s<q.length;s++){if(q[s].translateKey!=null){t=q[s].firstName.toUpperCase();x+="<option wl:translate="+q[s].translateKey+"value="+t+"> "+D.translateParametrized(q[s].translateKey)+"</option>"}else{var u=q[s].firstName;var v=q[s].lastName;t=u.toUpperCase()+"_"+v.toUpperCase();x+="<option value="+t+">"+u+" "+v+"</option>"}}w.prepend(x)}}function L(Y,t,r,q){var u=Y.one("#purchaserInfo-dropdown");var s=F(u,q.modelData);if(s>=0){r=s}if(t.length>0&&u!=null){u.set("selectedIndex",r);u.on("change",c(t,Y,q.common));l(Y,(t.length==r?K():t[r]))}}function F(t,q){var s=-1;var r=q.purchaserInfoDropdown;if(r&&t!=null){var Y=t.query("option[value="+r+"]")||false;if(Y){s=Y.get("index")}}return s}function K(){var r={street1:"",street2:"",city:"",country:" ",province:"",zipCode:""};var q={email:"",emailConfirm:"",phoneNumber:{number:"",phoneType:"",countryCode:" ",areaCode:"",extension:""}};var Y={purchaserContactInfo:q,billingData:r};return Y}function c(s,Y,r){function q(w){w.preventDefault();var u=Y.one("#purchaserInfo-dropdown").get("selectedIndex");if(u>=0&&u<s.length){var t=Y.one("#phoneType");D.wlValidation.clearErrors(Y.one(".billing-data"));l(Y.one(".billing-data"),s[u]);D.wlValidation.runValidationOnAllFields()}else{if(u==s.length){var v=K();l(Y.one(".billing-data"),v);if(t!=null){t.set("selectedIndex",0)}D.all(".billing-column").each(function(x){D.wlValidation.clearErrors(x)})}}r.clearRememberedValues()}return q}function l(Y,s,r){r=r||[];var q=null;if(Y&&s){q=Y.all("input:not(.credit-card-input),select:not(#purchaserInfo-dropdown):not(.bank-name)");q.each(function(w){var v=w.get("name");var u=v.split(".");var z,x;if(u[u.length-1]==="raw"){z=u[u.length-2];x=B(s,u.slice(1,u.length-1))}else{z=u[u.length-1];x=B(s,u.slice(1))}if(typeof x!=="undefined"&&D.Array.indexOf(r,z)===-1){if(x==null||typeof x!=="string"){x=""}if(w.get("nodeName")==="SELECT"){var t=w.query("option[value="+x+"]")||false;if(t){t.set("selected",true)}if(D.Lang.trim(x).length==0){P(w)}else{w.setAttribute("wl:value",x)}}else{w.set("value",x)}var y=w.get("parentNode").one(".innerLabel");if(y){y.addClass("hidden")}}})}}function P(Y){var q=/^\s*$/g;Y.get("options").each(function(){if(this.get("value").length==0||q.test(this.get("value"))){this.set("selected",true)}})}function b(q){var Y=D.one(q.detailsContainerId);H(Y,"#modifiedLevel",q.common.getModifiedLevel())}function U(Y,q){if(q.common.isRememberMeEnabled()){q.rememberMe=new D.widgets.rememberme.base(Y.ancestor("div"),q.billingDataOptions);q.rememberMe.activate(q.common.isRememberMeWriteModeEnabled())}q.common.addValueRememberingEvents(Y,q.level,function(){b(q)});D.fire("creditCard:detailsRendered",Y,q);q.layout.applyFormDetailsEvents(q);M(q)}function M(r){var s=D.one("select.countriesOptions");var Y=D.one("select.statesOptions");if(s&&Y){D.widgets.LinkedSelectWidget(Y,Y.getAttribute("wl:value")).setListenerForStatesAndCountries(s,s.getAttribute("wl:value"))}D.on("change",function(u){var t=e(s);R(r,t);h(r,t)},s);var q=e(s);if(q){R(r,q);h(r,q)}}function e(r){var q=r.get("selectedIndex");var s=r.get("options");var Y=s.item(q).get("value");return Y}function h(Y,s){var q=D.one("select.phone-countryCode");if(q){var r=Y.componentConfiguration.purchaserContactInfo.phoneNumber.countryCode.options[s];f(q,r)}}function f(Y,q){Y.all("option").each(function(r){if(r.getAttribute("value")===q){r.set("selected",true)}else{r.set("selected",false)}})}function R(q,u){var s=q.configuration.billingData.billingDataToHideCountryCode;var t=s[u];var Y=["billingData.street1Enabled","billingData.street2Enabled","billingData.cityEnabled","billingData.zipCodeEnabled","billingData.provinceEnabled"];var r;if(t){D.Array.each(t,function(v){r=new RegExp(".*"+v+".*");G(r,Y)})}else{O(q.configuration.billingData,Y)}}function O(Y,q){n(D.one(document.getElementById(q[0])),Y.street1Enabled);n(D.one(document.getElementById(q[1])),Y.street2Enabled);n(D.one(document.getElementById(q[2])),Y.cityEnabled);n(D.one(document.getElementById(q[3])),Y.zipCodeEnabled);n(D.one(document.getElementById(q[4])),Y.provinceEnabled)}function G(q,Y){D.Array.each(Y,function(r){var s=D.one(document.getElementById(r));if(q!=null&&q.test(r)){n(s,false)}})}function n(q,Y){if(q){if(Y){q.removeClass("hidden")}else{q.addClass("hidden")}}}function B(q,Y){return Y[0]&&q?B(q[Y[0]],Y.slice(1)):q}function N(r,s){var q=s.partials._surchargeNote;var Y=D.one("#surcharge-note");if(!Y){return }Y.set("innerHTML",D.decodeHtmlEntities(q))}D.widgets=D.widgets||{};D.widgets.payment=D.widgets.payment||{};D.widgets.payment.creditCard=E;D.widgets.payment.savedCard=C;D.widgets.payment.noDetails=a});YUI.add("wl-payment-oneTabFop",function(C){var A=function(F,I,H,E,G,D){A.superclass.constructor.apply(this,arguments);this.detailsContainerId="#"+D.detailsContainerId;this.paymentDetailsContainerId="#paymentDetailsFormData";this.contentContainerId=D.sharedSectionMode?this.detailsContainerId:this.containerId;this.options={priceFormat:D.priceFormat,sharedSectionMode:D.sharedSectionMode};this.templateData={cardType:this.code,cssCardCode:this.codeLower,ttlInHours:F.configuration.ttlInHours,name:this.name,sectionName:this.sectionKey,id:this.id,disabled:F.configuration.enabled?"":"disabled",preselected:this.isSelected()?"checked":"",amountCharged:G.formatPrice(G.priceMapper(G.getPayment().total)),level:I};if(this.isSelected()){this.select(null,this)}};C.extend(A,C.widgets.payment.abstractFOP);A.prototype.formDetailsFile="_paycFormDetails";A.prototype.enable=function(){var D=this.getHtml(this.templateData);B(D,this.containerId);this.applyEvents()};A.prototype.disable=function(E){var D=C.one(this.containerId);var F=C.getHtml("payc","_disabledOneTabFop");if(D){D.all("input, select, button").each(function(G){G.setAttribute("disabled","disabled");G.addClass("disabled")});D.innerHTML=F+D.innerHTML}this.hideDetails()};function B(F,E){var D=C.one(E);D.purge(true);var G=C.Node.create(F);D.replace(G);D.translate()}A.prototype.applyEvents=function(){};A.prototype.updateSurchargeInformation=function(){};A.prototype.getHtml=function(E){if(E){this.templateData=C.merge(E,this.templateData)}var D;if(this.options.sharedSectionMode){D=C.getHtml("payc","_sharedSectionFopHeader")}else{D=C.getHtml("payc","_"+this.templateData.cssCardCode.replace(/_/g,"")+"Content")}return C.replaceTemplateData(this.templateData,D)};A.prototype.onUpdate=function(){this.templateData.amountCharged=this.common.formatPrice(this.common.priceMapper(this.common.getPayment().total));var D=C.one("#fop-item-"+this.templateData.id+" .amount");if(D){D.setContent(this.templateData.amountCharged)}var E=C.one("#multi-fop-amountdue-"+this.level+"_sectionAmountDue");if(E){E.setContent(this.common.formatPrice(this.common.priceMapper(this.common.getDueWithInsurance(this.level))))}this.fillPaymentDetails(this)};A.prototype.isOneTabFop=function(){return true};A.prototype.togglePaymentDetails=function(F,D){var E=F.currentTarget.get("checked");if(F.currentTarget.get("type")==="radio"){E=true}if(E){D.select(F,D)}else{D.hidePaymentDetails({event:F,card:D})}D.common.displayInsuranceAndHotelUnacceptableOverlayIfNeeded()};A.prototype.selectCardWithoutDetails=function(E,D){D.select(E,D)};A.prototype.select=function(G,F){if(F){F.common.setSelectedFOP(F,F.level);var D=C.one(F.contentContainerId);if(D){D.addClass("selected");var E=G.currentTarget;if(E){E.set("checked","checked")}this.fillPaymentDetails(F)}}};A.prototype.fillPaymentDetails=function(E){var D=C.one(E.paymentDetailsContainerId);if(!D){return }var H=D.getAttribute("class");var I=E.common.priceMapper(E.common.getPayment().total);var F=C.getHtml("payc",this.formDetailsFile);var G={id:E.id,name:"selectedCards["+E.level+"]",sectionName:E.sectionKey,cardType:E.code,cardName:E.name,amount:I.amount,value:I.value,currency:I.currency,currencyCode:I.currencyCode,className:H,containerId:E.paymentDetailsContainerId.replace(/#/gi,""),remote:E.configuration.remote};F=C.replaceTemplateData(G,F);D.purge(true);var J=C.Node.create(F);D.replace(J)};A.prototype.hidePaymentDetails=function(F){var E=C.one(this.paymentDetailsContainerId);if(E){E.get("childNodes").remove()}var D=C.one(this.contentContainerId);if(D){D.removeClass("selected")}};A.prototype.showDetails=function(I,F){if(!F.isSelected()){F.common.clearSelectedFOPs();C.all(".fop-item").removeClass("selected");var E=C.one(F.containerId);if(E){E.addClass("selected")}var D=C.one(F.detailsContainerId);var G=C.getHtml("payc","_"+F.templateData.cssCardCode.replace(/_/g,"")+"SharedSectionContent");var H=C.merge(F.templateData,{id:F.id+"_cont"});G=C.replaceTemplateData(H,G);D.purge(true);D.set("innerHTML",G);D.translate()}};A.prototype.hideDetails=function(E){var D=C.one(this.detailsContainerId);if(D){D.get("childNodes").remove()}};C.widgets=C.widgets||{};C.widgets.payment=C.widgets.payment||{};C.widgets.payment.oneTabFop=A});YUI.add("wl-payment-travelBank",function(C){var D=function(a,W,Z,g,m,d){D.superclass.constructor.apply(this,arguments);var j=this;var o=false;var l=false;j.modelData=d.model||{};j.level=W;j.options={priceFormat:d.priceFormat};var e=j.modelData.availableFunds&&j.modelData.availableFunds.value||0;var b=j.modelData.maximumAmountForTrip&&j.modelData.maximumAmountForTrip.value||0;j.templateData={availableFunds:j.common.formatPrice(j.common.priceMapper(e)),maximumAmountForTrip:j.common.formatPrice(j.common.priceMapper(b)),currencyPrefix:j.options.priceFormat.prefix||"",currencySuffix:j.options.priceFormat.suffix||"",id:j.id,name:"travelBankCard",cardType:j.code,totalAmount:j.common.priceMapper(0)};j.wasAppliedBeforeSubmit=function(){return W<m.getPreviouslySelectedFOPBeforeSubmit().length-1};j.hasNextLevel=function(){return W<m.getSelectedFops().length-1};j.isApplied=function(){return j.charged?true:false};function f(x,w){x.preventDefault();C.wlValidation.validate(null,w.one(".username"));C.wlValidation.validate(null,w.one(".password"));if(q(w)){return }if(x.currentTarget.ancestor(".multi-fop-body")||x.currentTarget.ancestor(".fop-section")){x.preventDefault();var v=x.currentTarget.ancestor(".multi-fop-body")||x.currentTarget.ancestor(".fop-section");x.currentTarget.ancestor(".fop-section")?v.get("parentNode").addClass("loading"):v.addClass("loading");C.fire("travelBank:loginRequest",v,k)}}function u(v){o=false;v.preventDefault();var w=C.one("#bt_amount");C.wlValidation.validate(null,w);if(E(w)){if(j.common.hasServerValidationMessages()){o=true;h()}}else{U();j.common.clearServerValidationMessages()}}function r(){var w=C.one("#bt_amount");var v=N();j.common.updateChangedValue(w,j.level);j.charged=v;j.common.recalculateDue()}function U(){j.select();var v=N();V();i(v);r()}function i(w){var v=C.one("#bt_amount");if(v){if(w&&w>0){v.set("value",j.common.formatValue(w))}else{v.set("value","")}}}function T(v){v.preventDefault();o=true;h()}D.prototype.applyOnInsuranceChangeAction=function(w,v){if(C.Array.indexOf(w,this.code)===-1){return }this.deselect();if(v){if(j.modelData.loggedIn&&j.charged){h()}}};function h(){X();j.common.cancel(j.level);i(null);Q("enabled");I("");r();C.fire("multiFop:hideNextLevels",j.level);if(sabre.config.satConfiguration.formsOfPaymentConfiguration.surchargeCheckEnabled){C.fire("multipleFop:clearSurchargeFee")}}function q(w){var v=false;if(w.one("#username")&&(w.one("#username").hasClass("error"))){v=true}else{if(w.one("#password")&&w.one("#password").hasClass("error")){v=true}}return v}function k(z,y,x){var w;var v=new String(y.authenticationResult);j.modelData=m.getTravelBankCard();if(v=="SUCCESSFUL"){if(j.common.isUserLoggedToTravelBank()){n()}w=j.getHtml();x?z.one(".multi-fop-section").setContent(w):z.setContent(w);if(j.common.isUserLoggedToTravelBank()){s(z);p(z)}else{z.one(".travel-bank-form").setContent("");Y(z,"_travelBankLoginAdvisory");c()}}else{if(v=="TRAVEL_BANK_UNAVAILABLE"){j.modelData.status="TRAVEL_BANK_UNAVAILABLE";w=C.getPartial("payc","_travelBankStatusAdvisory",{status:"TRAVEL_BANK_UNAVAILABLE"});x?z.one(".multi-fop-section").setContent(w):z.setContent(w)}else{if(v=="FAILED"){Y(z,"_travelBankLoginFailedAuthentication")}else{if(v=="SYSTEM_ERROR"){Y(z,"_travelBankLoginFailedSystemError")}else{if(v=="NOT_ALLOWED"){Y(z,"_travelBankLoginFailedStatusIsNotAllowed")}}}}}z.removeClass("loading");C.translateNode(z)}function Y(w,v){var x=w.one(".travel-bank-form");if(x){if(x.one(".wrongPassword")){x.one(".wrongPassword").remove()}if(x.one(".loginSystemError")){x.one(".loginSystemError").remove()}w.one(".travel-bank-form").prepend(C.getHtml("payc",v))}}function n(){j.templateData.availableFunds=j.modelData.availableFunds.value;j.templateData.maximumAmountForTrip=j.modelData.maximumAmountForTrip.value;j.templateData.subbalances=j.modelData.subbalances}function t(){var w=C.one(".travel-bank-form");var y=w.one("#login");if(y){y.on("click",f,y,w)}var x=w.one(".travel-bank-forgot-password");if(x){x.on("click",O)}var v=w.one(".inputColumn");if(v){v.on("keyup",function(z){z.preventDefault();if(z.charCode===13){f(z,w)}})}C.later(5,C,M,[w])}function c(){X()}function p(w){if(sabre.config.satConfiguration.travelBankConfiguration.balanceUrlBTFopEnabled){var v=w.one("#paymentComponentTraveBankViewDetailsLink");if(v){C.on("click",function(x){x.preventDefault();C.fire("travelBank:travelBankViewBalance")},v)}}}function s(x){if(!x){return }var y=C.one("#bt_amount");if(y){j.common.addValueRememberingEvents(x,j.level);var w=x.one("#bt-amount-amount");if(w){w.setAttribute("wl:maxAmount",j.modelData.maximumAmountForTrip.amount);w.setAttribute("wl:currencyCode",j.modelData.availableFunds.currencyCode)}y.setAttribute("wl:maxAmount",j.modelData.maximumAmountForTrip.amount);y.setAttribute("wl:currencyCode",j.modelData.availableFunds.currencyCode);C.wlValidation.initializeForPartial("payc",C.wlValidation.validationEngineRules,C.wlValidation.validationConfiguration,x);if(j.modelData.paymentAmount&&j.modelData.paymentAmount.amount){V();i(j.modelData.paymentAmount.amount)}var v=x.all("#tbBreakdownAnchor,#tbMaxAmountAnchor");if(v){C.on("click",K,v,j,x)}C.on("blur",function(AA){var z=N();z=m.priceMapper(z);G(z);C.wlValidation.validate(AA,y)},y)}C.on("click",T,"#bt-cancel-amount",C.one("#bt-cancel-amount"),j);if(x.one(".applyButton")){C.on("click",u,x.one(".applyButton"),j)}C.on("keyup",function(z){if(z.charCode===13){y.removeClass("error");C.wlValidation.validate(z);u(z)}},"#bt_amount")}function V(){if(!l){C.fire("travelbank:logoutConfirm",{callback:j.common.confirmLogout});l=true}}function X(){if(l){C.fire("travelbank:logoutConfirm",{callback:function(){}});l=false}}j.onCancel=function(){j.wasCanceled=true;j.charged=0;j.modelData.paymentAmount=null;if(j.hasNextLevel()){C.fire("multiFop:hideNextLevel",j.level)}};j.select=function(){this.common.setSelectedFOP(this,this.level);if(!o){L(j)}};j.onUpdate=function(){if(!o){L(j);var x=j.common.getDueWithInsurance(j.level+1);var w=N();G(m.priceMapper(w));var v=w>0&&x>0;if(!j.hasNextLevel()&&v){C.fire("multiFop:showNextLevel",j.level)}if(j.hasNextLevel()&&!v){C.fire("multiFop:hideNextLevel",j.level)}}};j.onRemove=function(){X()};j.enable=function(){if(j.charged==0||j.wasCanceled){C.widgets.payment.oneTabFop.prototype.enable.call(this,arguments)}};j.applyEvents=function(){var v=C.one(".travel-bank-form");if(!v){return }if(j.modelData.loggedIn){p(v)}else{if(R){R.destroy();R=null}}if(j.modelData.status!=="TRAVEL_BANK_UNAVAILABLE"){if(j.modelData.loggedIn){s(v);if(j.wasAppliedBeforeSubmit()){U()}}else{t()}}};j.updateSurchargeInformation=function(){}};C.extend(D,C.widgets.payment.oneTabFop);D.prototype.getHtml=function(){var T="";var U=this.templateData;if(this.configuration.enabled){if(this.common.isUserLoggedToTravelBank()){T="_travelBankLoggedIn"}else{if(this.modelData.loggedIn||this.modelData.status=="USER_WITHOUT_TRAVEL_BANK"){T="_travelBankLoginAdvisory"}else{if(this.modelData.status=="TRAVEL_BANK_UNAVAILABLE"){T="_travelBankStatusAdvisory";return C.getPartial("payc",T,{status:"TRAVEL_BANK_UNAVAILABLE"})}else{if(this.modelData.status=="FAILED"){T="_travelBankLoginFailedAuthentication"}else{if(this.modelData.status=="SYSTEM_ERROR"){T="_travelBankLoginFailedSystemError"}else{if(this.modelData.status=="NOT_ALLOWED"){T="_travelBankLoginFailedStatusIsNotAllowed"}else{T="_travelBankLoggedOut"}}}}}}}else{T="_travelBankStatusAdvisory";U=C.merge(U,{status:this.common.getTravelBankStatus()})}return C.getPartial("payc",T,U)};D.prototype.deselect=function(){};function B(T,V){var U=C.one(T);if(U){U.set("value",V)}}function G(T){B("#bt-amount-amount",T.amount);B("#bt-amount-value",T.value);B("#bt-amount-currency",T.currency);B("#bt-amount-currency-code",T.currencyCode)}function E(T){return T&&T.hasClass("error")}function J(Y,V){var T=V.value||V;var X=Y.value||Y;var W={availableBalance:X,maxBalance:T};var U=C.getHtml("payc","_travelBankBreakdownOverlay");return this.common.replaceData(W,U)}function S(e,g){var Z=g.subbalances;var f=g.priceElements;var b=g.balanceElements;var W=J.call(this,g.availableFunds,g.maximumAmountForTrip);var k=C.getHtml("payc","_travelBankSubbalance");var c=C.Node.create(W);var U=c.one("#travelBank-subbalances");var j,i,a;for(j in Z){if(Z.hasOwnProperty(j)){var Y=Z[j].value||Z[j];i={name:j,value:Y};a=this.common.replaceData(i,k);U.append(a)}}var h=C.getHtml("payc","_travelBankSubbalanceAndPrice");var T=c.one("#travelBank-elements");for(j in f){if(f.hasOwnProperty(j)){var X=f[j].value||f[j];var d=b[j].value||b[j];i={name:j,priceValue:X,btValue:d};a=this.common.replaceData(i,h);T.append(a)}}var V;if(this.common.getPayment().insurance){V=this.common.getPayment()}else{V=g.insuranceAmount.amount||0}V=A(P(V,this.common,this.options.priceFormat),g.travelBankInsuranceAmount);a=this.common.replaceData(V,h);T.append(a);e.append(c);c=null}function P(U,W,X){var T=U?(U.insurance||U):0;var V=W.formatValue(T);return W.formatPrice({value:V,currency:X.prefix})}function A(V,U){var T=U.value;var W="INSURANCE";return{name:W,priceValue:V,btValue:T}}var R;function H(T){var U=this.modelData;S.call(this,T,{subbalances:U.subbalances,availableFunds:U.availableFunds,maximumAmountForTrip:U.maximumAmountForTrip,priceElements:U.priceElements,balanceElements:U.balanceElements,insuranceAmount:U.insuranceAmount,travelBankInsuranceAmount:U.travelBankInsuranceAmount});R=new YAHOO.widget.Dialog("travelBank-breakdown-overlay",{visible:false,draggable:false,fixedcenter:true,zIndex:520,width:"550px",close:true,constraintoviewport:true});C.on("travelBank-breakdown-overlay|click",function(){R.hide()},"#btn-close")}function K(X,W){X.preventDefault();if(R){var T=C.one("#travel-bank-details-overlay-INSURANCE");var U=P(this.common.getPayment().insurance,this.common,this.options.priceFormat);T.set("innerHTML",U)}else{H.call(this,W)}var V=W.one("#travelBank-breakdown-overlay");if(V){V.removeClass("hidden")}C.one(R.element).translate();R.render(document.body);R.show()}function L(W){var Y=C.getHtml("payc","_travelBankDueAmount");var d=C.one("#bt_amount");if(!d){return }var b=N();var X=W.modelData.maximumAmountForTrip;if(b==null||d.get("value")==""){I("");Q("enabled");C.fire("multiFop:hideNextLevels",W.level)}else{if(C.DataType.Number.parse(X.amount)<b){I("")}else{var V=W.common.formatPrice(W.common.priceMapper(b));var a=W.common.getDueWithInsurance(W.level+1);var T=W.common.formatPrice(W.common.priceMapper(a));var c=C.replaceTemplateData({amountCharged:V,dueAmount:T,level:W.level},Y);I(c);Q("disabled");if(a==0){var U=C.one("#travel-bank-due-info-"+W.level).ancestor(".additional_payment");var Z=C.one("#tb-fop-details");Z.removeChild(U)}}}}function Q(W){var V=C.one("#bt-apply-button");var U=C.one("#bt_amount");var T=C.one("#bt-cancel-amount");if(!V||!U||!T){return false}if(W==="disabled"){V.set("disabled","disabled");V.addClass("disabled");U.setAttribute("readonly","readonly");U.addClass("disabled");U.setAttribute("disabled","disabled");T.removeClass("hidden")}else{V.removeAttribute("disabled");V.removeClass("disabled");U.removeAttribute("readonly");U.removeAttribute("disabled");U.removeClass("disabled");T.addClass("hidden")}}function I(U){var T=C.one("#tb-fop-details");T.set("innerHTML",U)}function F(T){if(YAHOO.lang.isString(T)){return C.DataType.Number.parse(T.replace(",",""))}else{return T}}function N(){var T=C.one("#bt_amount");var U=T?T.get("value"):0;return F(U)}function M(T){C.fire("travelBank:LoginRendered",T)}function O(T){C.fire("travelBank:showForgotPassword",T)}C.widgets=C.widgets||{};C.widgets.payment=C.widgets.payment||{};C.widgets.payment.travelBank=D});YUI.add("wl-payment-poli",function(C){var A=function(F,I,H,E,G,D){A.superclass.constructor.apply(this,arguments);this.templateData.cssCardCode="poli"};C.extend(A,C.widgets.payment.oneTabFop);A.prototype.formDetailsFile="_poliDetails";function B(){C.on("click",this.togglePaymentDetails,this.contentContainerId+" input.fop-poli-checkbox",null,this);var D=C.one(this.contentContainerId+" input.fop-poli-checkbox");if(!D){this.fillPaymentDetails(this);this.selectCardWithoutDetails(this.contentContainerId+" input.fop-poli-checkbox",this)}else{if(D.get("checked")){this.fillPaymentDetails(this)}}}A.prototype.applyEvents=function(){var D=this;if(this.options.sharedSectionMode){C.on("click",D.showDetails,D.containerId+" input",null,D)}if(D.disabledByConfiguration()){D.disable()}if(!this.options.sharedSectionMode){B.call(D)}};A.prototype.updateSurchargeInformation=function(){};A.prototype.showDetails=function(E,D){C.widgets.payment.oneTabFop.prototype.showDetails(E,D);B.call(D)};C.widgets=C.widgets||{};C.widgets.payment=C.widgets.payment||{};C.widgets.payment.poli=A});YUI.add("wl-payment-smlPayNow",function(C){var B=function(F,I,H,E,G,D){B.superclass.constructor.apply(this,arguments);this.templateData.cssCardCode="smlPayNow"};C.extend(B,C.widgets.payment.oneTabFop);B.prototype.formDetailsFile="_smlDetails";B.prototype.applyEvents=function(){var D=this;if(D.options.sharedSectionMode){C.on("click",D.showDetails,D.containerId+" input",null,D)}A.call(D);if(D.disabledByConfiguration()){D.disable()}};B.prototype.updateSurchargeInformation=function(){};function A(){var F=this;var D=function(I){var H=I.get("checked");if(H){F.fillPaymentDetails(F)}};var E=function(H){H.on("click",F.togglePaymentDetails,null,F)};var G=C.one(F.contentContainerId+" input.fop-sml-pay-now-checkbox");if(G){E(G);D(G)}}B.prototype.showDetails=function(E,D){C.widgets.payment.oneTabFop.prototype.showDetails(E,D);A.call(D)};C.widgets=C.widgets||{};C.widgets.payment=C.widgets.payment||{};C.widgets.payment.smlPayNow=B});YUI.add("wl-payment-smlPayLater",function(C){var A=function(F,I,H,E,G,D){A.superclass.constructor.apply(this,arguments);this.templateData.cssCardCode="smlPayLater"};C.extend(A,C.widgets.payment.oneTabFop);A.prototype.formDetailsFile="_smlDetails";A.prototype.applyEvents=function(){var D=this;if(D.options.sharedSectionMode){C.on("click",D.showDetails,D.containerId+" input",null,D)}B.call(D);if(D.disabledByConfiguration()){D.disable()}};A.prototype.updateSurchargeInformation=function(){};function B(){var I=this;var E=function(L){var K=L.get("checked");if(K){I.fillPaymentDetails(I)}};var H=function(K){K.on("click",I.togglePaymentDetails,null,I)};var J=C.all(I.contentContainerId+" input");var D=J.size();if(D){for(var F=0,G;F<D;F++){G=J.item(F);H(G);E(G)}}}A.prototype.showDetails=function(E,D){C.widgets.payment.oneTabFop.prototype.showDetails(E,D);B.call(D)};C.widgets=C.widgets||{};C.widgets.payment=C.widgets.payment||{};C.widgets.payment.smlPayLater=A});YUI.add("forgotPassword",function(C){var R=function(T,S){T.preventDefault();L(S)};var G={NOT_AVAILABLE:"notAvailable"};var N;function L(T){var V=T.component.node;var S=V.one(".username");var X="send";var Z="label.login.forgotPasswordOverlayContinue";var U=null;var a="_forgotPasswordOverlayForm";var Y;if(S){var W=S.get("value");if(W==""){Y=T.getId()||T.initData.contextId;U={forgotPasswordError:"",contextId:Y};I(V,T,a,U,{buttonText:Z,mode:X,contextId:Y},P)}else{E(W,V,T)}}}function E(W,V,T){if(O(T.component.node)){return }I(V,T,"_loading");var U={overlayPartial:"_forgotPasswordOverlaySuccess",overlayData:null,buttonText:"label.login.close",buttonMode:"close"};var S={overlayPartial:"_forgotPasswordOverlayForm",overlayData:{forgotPasswordError:"label.login.usernameError",contextId:T.getId()},buttonText:"label.login.forgotPasswordOverlayContinue",buttonMode:"send"};M(V,T,W,U,S)}function O(S){return S.hasClass("loading")}function I(V,T,c,U,a,W){var Z=T.component;var e=A(T);var X=T.getId()||T.initData.contextId;var b="";if(c=="_forgotPasswordOverlaySuccess"){b=D()}else{if(c=="_forgotPasswordOverlayForm"){b=B(T,U.forgotPasswordError)}else{if(c=="_loading"){b=F()}}}var Y=a?K(X,a.mode,a.buttonText):"";var d=C.one(e.element);d.one(".overlay-content").set("innerHTML",b);d.one(".buttons").set("innerHTML",Y);if(C.Lang.isFunction(W)){W(V,T,d)}function S(){e.show()}Z.translateTemplate(T,C.one(e.element),S)}function M(X,V,Y,Z,U){var W=V.component;var T=function(c,b){Z=U;if(!c){Z.overlayData={forgotPasswordError:"label.login.ajaxError"}}else{if(G[b]){Z.overlayData={forgotPasswordError:"label.login."+G[b]}}}var a={buttonText:Z.buttonText,mode:Z.buttonMode};I(X,V,Z.overlayPartial,Z.overlayData,a,P)};var S={data:{username:escape((Y=="")?" ":Y)},on:{success:function(b,a){var c=a.verificationResult;if(c!=="OK"){T(true,c)}else{I(X,V,Z.overlayPartial,Z.overlayData,{buttonText:Z.buttonText,mode:Z.buttonMode},Q)}},failure:T}};W.fireEvent("to-ajax",{componentType:"login",cfg:S,actionCode:"resetPassword"})}function P(V,T,U){U.detach("forgetPassw|*");C.on("forgetPassw|click",function(W){J(W,U,V,T)},U.one(".btn-send-forgotten-password"));C.on("keypress",S,U.one(".ovUsername"));function S(W){if(W.charCode===13){J(W,U,V,T)}}}function J(V,T,U,S){V.halt();var W=T.one(".ovUsername").get("value");E(W,U,S)}function A(S){var U=S.component;if(!N){U.node.append(H());var V=U.node.one(".forgotPasswordOverlay");var T=C.Node.getDOMNode(V);U.translateTemplate(S,V);N=new YAHOO.widget.Dialog(T,{width:"320px",fixedcenter:true,draggable:false,close:true,visible:false,modal:false,zIndex:10});N.render(document.body)}return N}function Q(V,S,U){var T=A(S);U.on("forgetPassw|click",function(){T.hide()},".btn-send-forgotten-password")}function D(){return'<p class="translate" wl:translate="label.login.forgotPassword"></p>'}function B(V,U){var S=V.compInstConfig.maxLength;var T=V.getId()||V.initData.contextId;return'<p class="error translate" wl:translate="'+U+'"></p><p class="translate" wl:translate="label.login.forgotPasswordOverlayDescription"></p><p><label for="ovUsername-'+T+'" class="translate" wl:translate="label.login.forgotPasswordOverlayUsername"></label> <input id="ovUsername-'+T+'" class="textfield ovUsername" type="text" name="username" maxlength="'+S+'"/></p>'}function H(){return'<div class="forgotPasswordOverlay"><div class="forgot-password-form"><div class="hd">&nbsp;</div><div class="bd"><h3 class="translate" wl:translate="label.login.forgotPasswordOverlayHeader"></h3><div class="overlay-content"></div></div><div class="ft buttons"></div><div class="clear-both" /></div></div>'}function F(){return'<p class="loadingContainer"></p>'}function K(S,U,T){return'<div class="button button-smaller align-right"><input type="button" id="btn-send-forgotten-password-'+S+'" class="translate '+U+' btn-send-forgotten-password" wl:translate="'+T+'"/></div>'}C.widgets=C.widgets||{};C.widgets.ForgotPassword=R},"1.0.0",{requires:[]});YUI.add("wl-payment-single-fop",function(B){var A=function(L,G,N,E){var F=null;var D=null;var T=E.SAVED_CARDS_TEMPLATE;var S="_sfopSection";var V=E.layout;var Y=E.layoutType;var C=B.merge(N,{setSelectedFOP:function(b){if(D==null&&b){initialiSelectedFops=[b]}F=b},getSelectedFOP:function(){return F},clearSelectedFOPs:function(){F=null}});function R(c){var b="";B.Array.each(c,function(d){if(b==""){b=C.createMessageFopUnavailable(d)}});return b}function I(c){var b=[];B.Object.each(c,function(d){b.push({key:d,sectionContent:W(d)})});return C.getPartials(S,b).join("")}function W(d){var c=[];var b=G.sections[d];if(b){B.Array.each(b,function(h,e){if(h){var g=(function(){if(d==G.savedCardsSectionName){return T}return h.configuration.displayType})();var f=b.length>1;c.push(O(g,h,d,e,f))}})}return c.join("")}function O(d,f,h,c,e){if(h!="travelBankCardTypes"&&C.isFopRestricted(f.code)){if(C.isRestrictedFopDisabled(h)){f.configuration.enabled=false}else{return""}}else{if(f.configuration.isTravelBank&&C.isFopRestricted(f.code)){return""}}var b=N.getCardModel(h,f,c);var g=new B.widgets.payment[d](f,0,h,c,C,{detailsContainerId:"payc_paymentDetails_cont",detailsContainerCss:"single-fop-payments",priceFormat:E.priceFormat,configuration:f,model:b,travelBankStatus:G.status==="TRAVEL_BANK_UNAVAILABLE",sharedSectionMode:e,layout:V,componentModel:G,componentConfiguration:L,layoutType:Y,cardSelected:G.selectedCards[0]});C.FOPs.push(g);return g.getHtml()}function X(){return[F]}function J(){return[D]}function a(){if(F){F.onCancel()}}function K(){if(F){F.onUpdate()}Q()}function Q(){for(var b=0;b<C.FOPs.length;++b){C.FOPs[b].onUpdateSection()}}function H(){if(F){F.updateSurchargeInformation()}}function M(){var b=[];if(F){b[0]=F.charged||0}return b}function P(){var b=[];if(F){b[0]=F.code||""}return b}function U(c){var b=sabre.config.satConfiguration.formsOfPaymentConfiguration.insuranceUnacceptableFOPs;var d=N.FOPs;B.Array.each(d,function(e){e.applyOnInsuranceChangeAction(b,c)})}function Z(){var b=C.getSelectedFOP();b.deselect()}return{createPaymentWidget:I,createInitialHeaderMessage:R,applyEvents:function(){},updateActiveFops:K,updateSurchargeInformation:H,cancelActiveFops:a,getChargedPerLevel:M,getCardCodePerLevel:P,getSelectedFops:X,getInitialSelectedFops:J,changeAppearanceOnInsuranceChange:U,resetLevelToInitialSelection:Z}};B.widgets=B.widgets||{};B.widgets.payment=B.widgets.payment||{};B.widgets.payment.FOPs=B.widgets.payment.FOPs||{};B.widgets.payment.FOPs.singleFop=A});YUI.add("wl-payment-multiple-fop",function(B){var A=function(s,I,b,d){var U=[];var v=[];var o=[];var y=[];var h=d.layout;var D=d.layoutType;var P=null;var u="_multipleFopSection";var w=d.SAVED_CARDS_TEMPLATE;var Z=d.priceFormat;var g=[];var e=B.merge(b,{setSelectedFOP:function(z,AA){AA=AA||0;g[AA]=z},getSelectedFOP:function(z){return g[z]},clearSelectedFOPs:function(z){g.splice(z,1)}});function Y(AC){var AE=I.selectedCards;v=I.selectedCards;var AG=[];var AA=[];var AD="";o=AC;if(b.hasSelectedCards()){for(var AF=0,z=AE.length;AF<z;AF++){var AB=AE[AF];if(AB==null){AB=b.getTravelBankCard()}AD=AB.sectionName;AA=AF>0?r(AF):AC;AG.push(p(AA,AF,AD))}return e.getPartials(u,AG).join("")}else{return e.getPartial(u,p(AC,0,h.getInitialActiveSection(o)))}}function H(AA){for(var z=AA;z<g.length;++z){if(g[z]){g[z].onCancel()}}R(AA)}function a(){for(var AA=0;AA<e.FOPs.length;++AA){for(var z=0;z<e.FOPs[AA].length;++z){e.FOPs[AA][z].onUpdateSection()}}}function T(){for(var z=0;z<e.FOPs.length;++z){if(e.FOPs[z].length==1&&e.FOPs[z][0].isOneTabFop()){e.FOPs[z][0].onUpdate()}}}function f(){for(var z=0;z<g.length;++z){if(g[z]){g[z].onUpdate()}}}function t(){T();f();a()}function N(){return g}function O(){for(var z=0;z<g.length;++z){if(g[z]){g[z].updateSurchargeInformation()}}}function q(){return v}function c(z){return z<y.length-1}function V(){var AA=[];for(var z=0;z<g.length;++z){AA[z]=g[z]&&g[z].charged||0}return AA}function l(){var AA=[];for(var z=0;z<g.length;++z){if(g[z]){AA[z]=g[z].code||""}}return AA}function p(AD,AC,z){AC=AC||0;var AB="payc_sections_"+AC;if(z&&z!=""){U[AC]=z}y[AC]=AB;var AA=h.createSectionsMenu(AD,AC,z);return{widgetId:AB,level:AC,sectionHeader:AA,sectionBody:K(AC,z),sectionAmountDue:b.getAmountDue(AC),sectionAmountDueExchangeMessage:0===AC?b.getExchangeMessage(AC):"",sectionAmountDueDisplay:0===AC?"hidden":""}}function K(AA,z){if(!z||z==""){return""}return b.getPartial("_multipleFopBody",{sectionMessage:e.createMessageFopUnavailable(z),sectionContent:k(z,AA),sectionKey:z,level:AA})}function G(z){z.delegate("click",W,h.getSectionSelector());B.detach("multiFop:showNextLevel");B.detach("multiFop:hideNextLevels");B.on("multiFop:showNextLevel",E);B.on("multiFop:hideNextLevels",R)}function W(z){z.preventDefault();if(h.getSectionFromNode(z.currentTarget)===U[J(this)]){m(z.currentTarget)}else{e.confirmFOPChange(J(this),function(){m(z.currentTarget)})}}function L(z,AA){var AB=z.all(".fop-unavailable-msg");AB.each(function(AE){AE.remove()});var AD=e.createMessageFopUnavailable(AA);if(AD){var AC=z.one(".payment-type");AC.insert(AD,"before");z.translate()}}function m(AC){var z=h.getSectionFromNode(AC);var AD=AC.ancestor(".payc_sections");var AE=J(AD);if(z===U[AE]){return }R(AE);F(AE);var AB=AD.one(".multi-fop-body");AB.addClass("loading");x(AE,z);B.fire("multipleFop:sectionChanged",{activeSection:z});var AA=b.isInsuranceEnabled(WhiteLabel.getIbeData().insuranceCode);n(AA);AB.removeClass("loading");b.displayInsuranceAndHotelUnacceptableOverlayIfNeeded()}function F(AA){var z=e.getSelectedFOP(AA);if(z){z.hideDetails()}B.Array.each(e.FOPs[AA],function(AB){AB.remove()});e.clearSelectedFOPs(AA);e.FOPs[AA]=[]}function x(AF,AD){U[AF]=AD;var AE=B.one("#payc_sections_"+AF);var AC=AE.one(".multi-fop-body");var AA=AE.one(h.getSectionsMenuSelector());h.markActiveSection(AA,U[J(AA)]);AC.purge(true);AC.set("innerHTML",K(AF,AD));B.translateNode(AC);var AB="label.payc."+AD+".multiFopHeader";var z=AE.one(".multi-fop-section-title");if(z){z.setAttribute("wl:translate",AB);z.setContent(B.translateParametrized(AB))}if(sabre.config.satConfiguration.formsOfPaymentConfiguration.surchargeCheckEnabled){B.fire("multipleFop:clearSurchargeFee",AF,AE)}L(AC,AD);B.fire("multipleFop:refreshSbmt",AD);B.fire("confirmConditions:refresh");B.Array.each(e.FOPs[AF],function(AG){AG.applyEvents(e,I,s)})}function S(AA){F(AA);var z=h.getInitialActiveSection(r(AA));x(AA,z)}function E(AB){var AF=AB+1;var AA=B.one("#payc_sections_"+AF);if(!AA){var AD=e.getSelectedFOP(AF-1);if(!AD){AD=b.FOPs[0][0]}var z=r(AF,AD.code);if(z.length>0){var AE=p(z,AF,z[0]);var AC=e.getPartial(u,AE);P=P||B.one("#payment-wrapper");P.append(AC);AA=B.one("#payc_sections_"+AF);if(AA){AA.translate()}B.Array.each(e.FOPs[AF],function(AG){AG.applyEvents(e,I,s)})}}}function R(AA){var z=B.all(".payc_sections");z.each(function(AB){var AC=J(AB);if(AC>AA){F(AC);AB.purge(true);AB.remove(true);y.splice(AC,1);U.splice(AC,1);b.recalculateDue()}})}function J(z){var AA=z.hasClass("payc_sections")?z:z.ancestor(".payc_sections");var AC=AA.get("id");var AB=parseInt(AC.substr(AC.length-1),10);return AB>-1?AB:0}function k(AE,AD){if(!AE||AE==""){return""}AD=AD||0;var AB=[];var z=I.sections[AE];var AC="";if(e.FOPs.length>0){AC=AD>0?e.FOPs[AD-1][0].code:""}var AA=z.length>1;if(AE===I.savedCardsSectionName){B.Array.each(z,function(AG,AF){if(AG&&C(AC,AG.code,AD)){AB.push(j(w,AG,AD,AE,AF,AA))}})}else{if(z){B.Array.each(z,function(AG,AF){if(AG&&C(AC,AG.code,AD)){AB.push(j(AG.configuration.displayType,AG,AD,AE,AF,AA))}})}}return AB.join("")}function j(AB,AD,AG,AF,AA,AC){if(AF!="travelBankCardTypes"&&e.isFopRestricted(AD.code)){if(e.isRestrictedFopDisabled(AF)){AD.configuration.enabled=false}else{return""}}else{if(AD.configuration.isTravelBank&&e.isFopRestricted(AD.code)){return""}}e.FOPs[AG]=e.FOPs[AG]||[];var z=b.getCardModel(AF,AD,AA);var AE=new B.widgets.payment[AB](AD,AG,AF,AA,e,{detailsContainerId:"multi-fop-details-"+AG,detailsContainerCss:"multi-fop-details",priceFormat:Z,configuration:AD,model:z,travelBankStatus:I.status==="TRAVEL_BANK_UNAVAILABLE",sharedSectionMode:AC,cardSelected:I.selectedCards[AG],componentModel:I,componentConfiguration:s,layoutType:D});e.FOPs[AG].push(AE);return AE.getHtml()}function C(z,AC,AB){if(AB>0&&I.nonCombinableFops){var AA=I.nonCombinableFops[z];return !(AA&&B.Array.indexOf(AA,AC)>-1)}return true}function M(AC){var AB=sabre.config.satConfiguration.formsOfPaymentConfiguration.vehicleHotelReservationMultipleFormOfPaymentConfiguration;var AA=sabre.config.satConfiguration.vehicles;if(AB.enabled&&AA.airlineMerchantOfRecord&&I.carRentalSelected){var z=AB.allowedFormOfPayments;return B.Array.indexOf(z,AC)>-1}return true}function Q(AC){var AA=sabre.config.satConfiguration.hotels;if(AA.airlineMerchantOfRecord&&I.hotelReservationSelected){var AB=sabre.config.satConfiguration.formsOfPaymentConfiguration.vehicleHotelReservationMultipleFormOfPaymentConfiguration;var z=AB.allowedFormOfPayments;return B.Array.indexOf(z,AC)>-1}return true}function r(AB,AA){if(!AA){var AA=g[AB-1];if(!AA){AA="";if(b.hasSelectedTravelBankCards()){AA=b.getTravelBankCard().cardType.code}}else{AA=AB>0?AA.code:""}}var z=[];B.Array.each(o,function(AE){var AC=I.sections[AE];var AD=[];B.Array.each(AC,function(AF){var AG=AF.code;if(C(AA,AG,AB)&&M(AG)&&Q(AG)){AD.push(AG)}});if(AD.length>0||!AC){z.push(AE)}});return z}function X(AA){var AH=I.sections;var AD=[];for(var AB in AH){var AG=AH[AB];var z=(B.Array.indexOf(U,AB)>-1);var AC=0;for(var AE in AG){var AF=AG[AE];if(B.Array.indexOf(AA,AF.code)>-1){AC++}}var AI=AC==AG.length;AD.push({isActiveSection:z,allFopsAreMatched:AI,sectionName:AB})}return AD}function n(AA){var z=sabre.config.satConfiguration.formsOfPaymentConfiguration.insuranceUnacceptableFOPs;var AB=X(z);var AC=b.FOPs[0];B.Array.each(AC,function(AD){AD.applyOnInsuranceChangeAction(z,AA)})}function i(){return o}return{sectionPartial:u,createPaymentWidget:Y,createInitialHeaderMessage:function(){return""},applyEvents:G,updateActiveFops:t,cancelActiveFops:H,getChargedPerLevel:V,getCardCodePerLevel:l,getSelectedFops:N,updateSurchargeInformation:O,getInitialSelectedFops:q,hasNextPaymentWidgets:c,toggleActiveSectionAction:m,changeAppearanceOnInsuranceChange:n,resetLevelToInitialSelection:S}};B.widgets=B.widgets||{};B.widgets.payment=B.widgets.payment||{};B.widgets.payment.FOPs=B.widgets.payment.FOPs||{};B.widgets.payment.FOPs.multiFop=A});YUI.add("wl-popup",function(A){A.components.Popup=function(D){var G=this;var F=[];var E=A.translations[A.translations.lang];var C=A.utilsUrl.buildExecutionUrl("_eventId=goto&gotoPageCode=AIR_SELECT_PAGE");var B=true;if(D.id==="ProductNotAvailable"){F[0]={text:E["label.popup.prodNotAvail.backBtn"],handler:function(){location.href=C}};B=false}if(D.id==="PriceDiscrepancy"){F[0]={text:E["label.popup.priceDiscrepancy.okBtn"],handler:function(){H.hide()}};F[1]={text:E["label.popup.priceDiscrepancy.backBtn"],handler:function(){location.href=C}}}if(D.id==="ExchangeUpdateReservationErrors"){F[0]={text:E["label.popup.exchangeUpdateReservationErrors.okBtn"],handler:function(){H.hide();G.fireEvent("sbmt-after-failed-ancillaries")}};B=false}var H;G.onRenderState={initialized:function(){var M="popup"+D.id;H=new YAHOO.widget.Dialog(M,{width:"400px",fixedcenter:true,constraintoviewport:true,close:B,visible:false,draggable:false,modal:true,zIndex:10,buttons:F});G.on("popup:adjust-mask",function(){H.sizeMask()});var L=A.one(H.element);if(L&&L.one(".hidden")){L.one(".hidden").removeClass("hidden")}H.render();H.show();if(A.UA.ie&&A.UA.ie<7){var J="<iframe class=\"bgiframe\" frameborder=\"0\" tabindex=\"-1\" src=\"javascript:false;\" style=\"display:block;position:absolute;z-index:-1;filter:Alpha(Opacity='0');top:expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px');left:expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px');width:expression(this.parentNode.offsetWidth+'px');height:expression(this.parentNode.offsetHeight+'px');\"/>";var N=A.Node.create(J);var K=A.one("#"+M+"_mask");K.appendChild(N)}if(D.additionalInfo){var I=G.node.one("#additionalInfo");if(I){I.set("innerHTML",A.decodeHtmlEntities(D.additionalInfo))}}G.translateTemplate(D,G.node)}}}});YUI.add("wl-payment-paypal",function(C){var E=function(H,K,J,G,I,F){E.superclass.constructor.apply(this,arguments);this.templateData.cssCardCode="paypal"};C.extend(E,C.widgets.payment.oneTabFop);function A(){C.on("click",this.togglePaymentDetails,this.contentContainerId+" input.fop-paypal-checkbox",null,this);var F=C.one(this.contentContainerId+" input.fop-paypal-checkbox");if(!F){this.fillPaymentDetails(this);this.selectCardWithoutDetails(this.contentContainerId+" input.fop-paypal-checkbox",this)}else{if(F.get("checked")){this.fillPaymentDetails(this)}}D(this)}E.prototype.applyEvents=function(){var F=this;if(this.options.sharedSectionMode){C.on("click",F.showDetails,F.containerId+" input",null,F)}if(F.disabledByConfiguration()){F.disable()}if(!this.options.sharedSectionMode){A.call(F)}};E.prototype.updateSurchargeInformation=function(){D(this)};function D(F){if(sabre.config.satConfiguration.formsOfPaymentConfiguration.surchargeCheckEnabled){C.fire("paypal:showSurchargeFee",F,B)}}function B(H,I){var G=I.partials._surchargeNote;var F=C.one("#surcharge-note");if(!F){return }F.set("innerHTML",C.decodeHtmlEntities(G))}E.prototype.showDetails=function(G,F){C.widgets.payment.oneTabFop.prototype.showDetails(G,F);A.call(F)};C.widgets=C.widgets||{};C.widgets.payment=C.widgets.payment||{};C.widgets.payment.paypal=E});YUI.add("wl-payment-giftCard",function(B){var A=function(L,K,D,e,Y,b){A.superclass.constructor.apply(this,arguments);this.templateData.cssCardCode="giftCard";var g=false;var F=false;var P=false;var c={giftCardItem:"_giftCardItem",giftCardMessages:"_giftCardMessages"};var V=this;V.level=K;V.select=function(){this.common.setSelectedFOP(V,V.level)};V.hasNextLevel=function(){return Y.hasNextPaymentWidgets(K)};V.onUpdate=function(){if(F){return }F=true;V.applyEvents();var p=V.common.getDueWithInsurance(V.level+1);var o=p>0&&V.charged>0;if(!V.hasNextLevel()&&o){B.fire("multiFop:showNextLevel",K);if(!V.hasNextLevel()){J("notEnoughFundsOneFop","error");W();B.one(".giftCard-no-second-fop").removeClass("hidden");B.one(".giftcard-remove").addClass("hidden")}}if(V.charged>0&&!g&&P){W()}else{if(V.modelData.cardNumber&&V.modelData.expDate.notEmpty&&!P){if(V.hasNextLevel()){B.fire("multiFop:hideNextLevels",V.level)}i()}}C()};V.applyOnInsuranceChangeAction=function(p,o){if(B.Array.indexOf(p,this.code)===-1){return }this.deselect();if(o){this.onCancel()}};V.enable=function(){if(!P){var o=this.getHtml(this.templateData);d(o,this.containerId);this.applyEvents()}};function d(q,p){var o=B.one(p);o.purge(true);var r=B.Node.create(q);o.replace(r);o.translate()}V.applyEvents=function(){I(".giftcard-apply input",E);I(".giftcard-remove input",j);I(".giftCard-try-another",H);if(this.options.sharedSectionMode){B.on("click",this.showDetails,this.containerId+" input",null,this)}k()};V.updateSurchargeInformation=function(){};V.showDetails=function(p,o){B.widgets.payment.oneTabFop.prototype.showDetails(p,o);if(!o.isSelected()){o.applyEvents()}};function I(p,q){var o=B.one(p);if(o){o.detach("click",q);B.on("click",q,p)}}function k(){var o=B.one(".giftcard-applyCard");if(o){B.wlValidation.initializeForPartial("payc",B.wlValidation.validationEngineRules,B.wlValidation.validationConfiguration,o);o.delegate("blur",B.wlValidation.validate,"input,select")}}function E(p){p.preventDefault();U();if(X()){return }S();var o=M();B.fire("giftCard:applyCard",a,o)}function i(){S();var o={requestPartials:[c.giftCardItem,c.giftCardMessages],cardNumber:V.modelData.cardNumber,expDate:{day:V.modelData.expDate.day,month:V.modelData.expDate.month,year:V.modelData.expDate.year},level:K,validate:true};B.fire("giftCard:applyCard",a,o)}function U(){Q();B.all(".giftcard-applyCard input,select").each(function(p,o){if(p.get("type")!="hidden"){B.wlValidation.validate(null,p)}})}function Q(){B.all(".giftcard-applyCard .error").each(function(p,o){p.removeClass("error")})}function X(){return B.all(".giftcard-applyCard .error").size()>0}function M(){var t="selectedCards["+K+"]";var r=B.one('input[name="'+t+'.cardNumber"]').get("value");var s=B.one('select[name="'+t+'.expDate.day"]').get("value");var o=B.one('select[name="'+t+'.expDate.month"]').get("value");var p=B.one('select[name="'+t+'.expDate.year"]').get("value");var q={requestPartials:[c.giftCardItem,c.giftCardMessages],cardNumber:r,expDate:{day:s,month:o,year:p},level:K,validate:true};return q}function a(o){F=false;var q=o.validationErrors;if(q){f(q)}else{G(o.partials[c.giftCardMessages]);if(!R(o.giftCardMessages)){P=true;n(o.giftCardAmountApplied);T(o.partials[c.giftCardItem]);var p="selectedCards["+o.level+"]";B.one('input[name="'+p+'.cardNumber"]').set("value",o.cardNumber);B.one('select[name="'+p+'.expDate.day"]').set("value",o.expDate.day);B.one('select[name="'+p+'.expDate.month"]').set("value",o.expDate.month);B.one('select[name="'+p+'.expDate.year"]').set("value",o.expDate.year)}else{g=true;C()}}}function f(q){for(var p=0;p<q.length;p++){var o=q[p];B.all(".giftcard-applyCard input,select").each(function(r){B.wlValidation.displayServerSideValidation(r,o.fieldErrors)})}}function R(p){for(var o in p){if(p[o].levelType=="ERROR"){return true}}return false}function G(p,q){var o=B.one(".giftCard-messages");if(o){o.set("innerHTML",B.translateParametrized(B.decodeHtmlEntities(p)));if(q){N(o)}}}function J(r,o){var p={translationCode:r,levelType:o};var q=B.getPartial("payc","_giftCardSingleMessage",p);if(o=="error"){g=true}G(q,true)}function N(o){if(o){o.all(".translate").each(function(r){var q=r.get("innerHTML");var p=B.translateParametrized(q);r.set("innerHTML",p)})}}function C(){var o=B.one(".giftCard-messages");if(o){o.removeClass("hidden")}if(g){Z()}}function n(o){V.select();V.charged=o;V.common.recalculateDue();l()}function l(){V.common.rememberInitialState("giftCard-applied",false,K);V.common.updateChangedValueByKey("giftCard-applied",true,K)}function T(p){var o=B.one(".giftcard-applied");if(o){o.set("innerHTML",B.translateParametrized(B.decodeHtmlEntities(p)))}}function W(){var p=B.one(".giftcard-applyCard");if(p){p.addClass("hidden")}var o=B.one(".giftcard-applied");if(o){o.removeClass("hidden")}}function j(o){o.preventDefault();if(V.hasNextLevel()){V.common.confirmFOPChange(V.level)}else{V.common.clearFops(V.level)}}V.onCancel=function(){if(P){B.fire("giftCard:removeCard",{removeCardOnSuccess:O,level:V.level})}};function O(){var o=B.one(".giftCard-no-second-fop");if(o){o.addClass("hidden")}V.common.updateChangedValueByKey("giftCard-applied",false,V.level);F=true;V.charged=0;V.modelData.paymentAmount=null;S();m();P=false}function S(){var o=B.one(".giftCard-messages");if(o){o.addClass("hidden")}G("");g=false;h()}function m(){var q=B.one(".giftcard-applyCard");if(q){q.removeClass("hidden");var o="selectedCards["+K+"]";B.one('input[name="'+o+'.cardNumber"]').set("value","");B.one('select[name="'+o+'.expDate.day"]').set("selectedIndex",0);B.one('select[name="'+o+'.expDate.month"]').set("selectedIndex",0);B.one('select[name="'+o+'.expDate.year"]').set("selectedIndex",0)}var p=B.one(".giftcard-applied");if(p){p.addClass("hidden")}}function H(o){B.one(".giftCard-no-second-fop").removeClass("hidden");j(o)}function Z(){B.one("#confirm").setAttribute("disabled","disabled")}function h(){B.one("#confirm").removeAttribute("disabled")}};B.extend(A,B.widgets.payment.oneTabFop);A.prototype.formDetailsFile="_giftCardContent";B.widgets=B.widgets||{};B.widgets.payment=B.widgets.payment||{};B.widgets.payment.giftCard=A});YUI.add("wl-payment-abstractLayout",function(B){var A=function(F,E,D,C){this.configuration=F;this.common=E;this.model=D;this.options=C;A.prototype.createSectionsMenu=function(I,H,G){};A.prototype.markActiveSection=function(H,G){};A.prototype.getSectionsMenuSelector=function(){};A.prototype.getSectionSelector=function(){};A.prototype.getSectionSelectorByTag=function(G){};A.prototype.getActiveSectionSelector=function(){};A.prototype.getSectionFromNode=function(G){};A.prototype.getInitialActiveSection=function(G){};A.prototype.getActiveSection=function(){var G=this.options.componentNode.one(this.getActiveSectionSelector());return G?this.getSectionFromNode(G):null};A.prototype.applyEvents=function(){};A.prototype.setActiveSection=function(I,G){if(!I){return }var H=this.options.componentNode.one(this.getSectionSelectorByTag(I));if(H){G.toggleActiveSectionAction(H)}}};B.widgets=B.widgets||{};B.widgets.payment=B.widgets.payment||{};B.widgets.payment.layouts=B.widgets.payment.layouts||{};B.widgets.payment.layouts.abstractLayout=A});YUI.add("wl-payment-tabLayout",function(B){var A=function(H,E,D,C){A.superclass.constructor.apply(this,arguments);A.prototype.createSectionsMenu=function(K,J,I){return K.length>1?F(K,J,I):G(I)};function F(M,L,J){var K=B.getHtml("payc","_multipleFopTab");var I=[];B.Array.each(M,function(N){I.push(B.replaceTemplateData({isActive:N===J?"tab-current":"",sectionKey:N,level:L},K))});return E.getPartial("_multipleFopList",{list:I.join("")})}function G(I){return E.getPartial("_multipleFopHeader",{sectionName:I})}A.prototype.markActiveSection=function(K,I){var J=K.one(".fop-tab-"+I);K.all(".fop-tab").removeClass("tab-current");if(J){J.addClass("tab-current")}};A.prototype.getSectionsMenuSelector=function(){return".component-tabs"};A.prototype.getSectionSelector=function(){return".fop-tab a"};A.prototype.getSectionSelectorByTag=function(I){return this.getSectionSelector()+"[rel="+I+"]"};A.prototype.getActiveSectionSelector=function(){return".tab-current a"};A.prototype.getSectionFromNode=function(I){return I.get("rel")};A.prototype.getInitialActiveSection=function(I){return I[0]}};B.extend(A,B.widgets.payment.layouts.abstractLayout);B.widgets=B.widgets||{};B.widgets.payment=B.widgets.payment||{};B.widgets.payment.layouts=B.widgets.payment.layouts||{};B.widgets.payment.layouts.tabLayout=B.widgets.payment.layouts.tabLayout||{};B.widgets.payment.layouts.tabLayout.base=A});YUI.add("wl-payment-radioLayout",function(B){var A=function(C,H,F,L){A.superclass.constructor.apply(this,arguments);var I=K(C.sections);A.prototype.createSectionsMenu=function(Q,P,N){var O=B.getHtml("payc","_radioViewSection");var M=[];B.Array.each(Q,function(S){var R=I[S].learnMoreEnabled;M.push(B.replaceTemplateData({isActive:S===N?"checked":"",sectionKey:S,level:P,isEnabled:(R?"":"disabledLink"),icons:J(S)},O))});return this.common.getPartial("_radioViewSectionsList",{list:M.join("")})};function J(N){var M=B.getHtml("payc","_radioViewIcon");var O=[];B.Array.each(F.sections[N],function(P){if(P.configuration.iconEnabled&&!H.isFopRestricted(P.code)){O.push(B.replaceTemplateData({fopKey:P.code.toLowerCase()},M))}});return O.join("")}A.prototype.markActiveSection=function(O,M){var N=O.one(".fop-item-radio-"+M);O.all(".fop-item-radio").set("checked",false);if(N){N.set("checked",true)}};A.prototype.getSectionsMenuSelector=function(){return".sections-list"};A.prototype.getSectionSelector=function(){return".fop-item-radio"};A.prototype.getSectionSelectorByTag=function(M){return this.getSectionSelector()+"[value="+M+"]"};A.prototype.getActiveSectionSelector=function(){return".fop-item-radio:checked"};A.prototype.getSectionFromNode=function(M){return M.get("value")};A.prototype.getInitialActiveSection=function(N){var M="";B.Array.each(N,function(O){if(O==C.preselectedFop){M=O}});return M};var G;A.prototype.applyEvents=function(){if(C.paymentMultiFopEnabled){if(G){G.detach()}G=B.delegate("click",E,"#payment","a.learnMoreLink")}};function K(N){var M={};B.Array.each(N,function(O){M[O.label]=O});return M}function E(Q){Q.preventDefault();var M=Q.currentTarget.get("rel");var P=D(M);var O={width:"",height:""};var N=new B.widgets.PopupWidget(B.one("div.radio-view"),P,O);N.show()}function D(O){var R=I[O];if(R.learnMoreSource==="URL"){var Q=B.one("body").get("lang");var N=B.replaceTemplateData({lang:Q},R.learnMoreUrl);var M="_learnMoreIframe";var P={url:N}}else{var M="_learnMore";var P={sectionName:O}}return B.getPartial("payc",M,P)}};B.extend(A,B.widgets.payment.layouts.abstractLayout);B.widgets=B.widgets||{};B.widgets.payment=B.widgets.payment||{};B.widgets.payment.layouts=B.widgets.payment.layouts||{};B.widgets.payment.layouts.radioLayout=B.widgets.payment.layouts.radioLayout||{};B.widgets.payment.layouts.radioLayout.base=A});YUI.add("wl-payment-abstractFopLayout",function(B){var A=function(D,C){this.card=D;this.level=D.level;this.model=D.componentModel;this.configuration=C.componentConfiguration;this.common=D.common;this.options=C;A.prototype.getHtml=function(E){};A.prototype.applySelectionEvent=function(E){};A.prototype.onSelect=function(E){};A.prototype.onDeselect=function(E){};A.prototype.onUpdateSection=function(E){};A.prototype.onUpdate=function(E){};A.prototype.onCancelOverLay=function(E){};A.prototype.onEnable=function(E){};A.prototype.onDisable=function(E){};A.prototype.onShow=function(E){};A.prototype.onHide=function(E){}};B.widgets=B.widgets||{};B.widgets.payment=B.widgets.payment||{};B.widgets.payment.layouts=B.widgets.payment.layouts||{};B.widgets.payment.layouts.abstractFopLayout=A});YUI.add("wl-phone-validation-preprocessor",function(E){var D={registerPhonesPreprocessing:function(H,F,G){H.all('div.phone-input input[type="text"][id$=-raw]').each(function(I){I.setAttribute("visited","false");C(I,F,G)})}};function C(H,F,G){H.detach("blur",A);H.on("blur",A,{phonesCommonConfiguration:F,onPreprocessingEndCallback:G});H.detach("focus",B);H.on("focus",B)}function B(F){F.currentTarget.setAttribute("visited","true")}function A(F){var K={allowedDividingCharacters:this.phonesCommonConfiguration.allowedDividingCharacters,numberOfZerosToRemovePerCountry:this.phonesCommonConfiguration.numberOfZerosToRemovePerCountry};function J(O){if(O){var S=O.get("id");var Q=4;var P=S.substr(0,S.length-Q);var R=O.siblings("#hidden_parsed_phones").item(0).all('input[type="text"][id^="'+P+'"]').item(0);return R}return null}function M(O,P){var Q=O.get("value");if(Q){E.Array.each(K.allowedDividingCharacters,function(R){Q=Q.split(R).join("")})}P.set("value",Q)}function H(P,R){var Q=R.get("value");for(var O=1;O<=P;O++){if(Q.substring(0,1)!=="0"){break}Q=Q.substring(1)}R.set("value",Q)}function I(){if(!K.currentCountryCodeNode){return }var Q=K.currentCountryCodeNode.get("value");if(!Q||!E.Lang.trim(Q)){return }var P=K.currentCountryCodeNode.get("options");var R=P.item(K.currentCountryCodeNode.get("selectedIndex"));var O=R.getAttribute("wl:translate").substring(13,15);return K.numberOfZerosToRemovePerCountry[O]}function L(){var O=I();if(!O){return }if(K.areaCodeHiddenInput&&K.areaCodeHiddenInput.get("value")){H(O,K.areaCodeHiddenInput)}else{if(K.numberHiddenInput&&K.numberHiddenInput.get("value")){H(O,K.numberHiddenInput)}}}function N(O){E.Array.each([[K.areaCodeRawInput,K.areaCodeHiddenInput],[K.numberRawInput,K.numberHiddenInput],[K.extensionRawInput,K.extensionHiddenInput]],function(P){if(P[0]&&(P[0].getAttribute("visited")!=="false")&&P[1]){O(P)}})}var G=F.currentTarget.ancestor();K.currentCountryCodeNode=G.one("select.phone-countryCode");K.areaCodeRawInput=G.one("input.phone-areaCode:not(.corresponding-hidden-input)");K.numberRawInput=G.one("input.phone-number:not(.corresponding-hidden-input)");K.extensionRawInput=G.one("input.phone-extension:not(.corresponding-hidden-input)");K.areaCodeHiddenInput=J(K.areaCodeRawInput);K.numberHiddenInput=J(K.numberRawInput);K.extensionHiddenInput=J(K.extensionRawInput);N(function(O){M(O[0],O[1])});L();N(function(O){E.wlValidation.validateAndAttachErrors(O[1],O[0])});if(this.onPreprocessingEndCallback){this.onPreprocessingEndCallback()}}E.widgets=E.widgets||{};E.widgets.PhonePreprocessor=D},"1.0.0",{requires:[]});YUI.add("wl-payment-abstractFopLayout-creditCard",function(A){var B=function(P,O){B.superclass.constructor.apply(this,arguments);B.prototype.getDetailsTemplateName=function(R){};B.prototype.getPreselected=function(R){return""};B.prototype.getMenuSelectorId=function(R){};B.prototype.getDetailsSelector=function(R){};B.prototype.onUpdate=function(R){G(this.card)};var Q;B.prototype.applyFormDetailsEvents=function(S){if(Q){Q.detach()}var T=A.one(S.detailsContainerId);var R=S.layout.configuration.purchaserContactInfo.phonesCommonConfiguration;A.widgets.PhonePreprocessor.registerPhonesPreprocessing(T,R);var U=new A.widgets.PhoneTooltip(T.all("select[name$=phoneType]"),T);Q=T.delegate("click",U.onLearnMoreClickHandler,"a.phone-tooltip-learnmore-link");if(S.configuration.installmentEnabled&&S.componentModel.shoppingPath==="B2C"){A.delegate("click",H,S.detailsContainerId,"a[rel='bankName']");A.delegate("change",function(){J(S,false)},S.detailsContainerId,".installment-data select");A.delegate("click",function(V){I(V,S)},S.detailsContainerId,".installment-item-radio")}};B.prototype.creditCardNumberChanged=function(T,S){if(N(T,S)){var U=S.common.getDueWithoutInsurance(S.level);var R=S.common.currentCurrency();A.fire("creditCard:card-number-changed",{creditCardNumber:T,creditCardType:S.code,amountDue:U,amountDueCurrency:R,id:containerId?containerId:"div#details_"+S.id})}};B.prototype.createBankOptions=function(R){var S=A.getHtml("payc","_creditCardInstallmentItem");var U=[];var T=A.Object.keys(R.configuration.installmentMonthsPerBankName);A.Array.each(T,function(V){U.push(E(V))},this);return A.replaceTemplateData({level:R.level,bankOptions:U.join("")},S)}};function N(P,O){var R=0;var Q=O.configuration.cardNumberFormat.split(",");A.Array.each(Q,function(S){R=R+parseInt(S)});return P&&P.length==R}function E(O){var P=A.getHtml("payc","_bankNameOption");return A.replaceTemplateData({name:O,value:O,preselected:""},P)}function G(O){if(O.configuration.installmentEnabled&&O.componentModel.shoppingPath==="B2C"){J(O,true)}}function J(S,Q){if(Q&&A.one(".installment-item-radio:checked")&&S.callbacks.isInstallmentCCEnabled(S)){return }var P=A.one(".installment-data select");if(P===null){return }var O=P.get("selectedIndex");if(O===0){A.one(".installment-data .payment-months").set("innerHTML","");M(Q);return }var R=P.get("options").item(O).getAttribute("value");if(R==="not-listed"){A.one(".installment-data .payment-months").set("innerHTML",C());M(Q);return }var T=K(R,S);A.one(".installment-data .payment-months").set("innerHTML",T)}function M(O){if(O){return }D(0)}function I(Q,P){var O=Q.currentTarget.get("value");D(O)}function D(Q){var P=A.one(".installment-data select");var O=P.get("selectedIndex");var R=P.get("options").item(O).getAttribute("value");A.fire("creditCard:installment-months-selected",{selectedBank:R,months:Q})}function C(){var O=A.getHtml("payc","_installmentMonthForBankNotListed");return A.replaceTemplateData({},O)}function K(O,P){var Q=A.getHtml("payc","_installmentMonthSectionsList");var R=[];R.push(F(P));if(P.callbacks.isInstallmentCCEnabled(P)){A.Array.each(P.configuration.installmentMonthsPerBankName[O],function(S){R.push(L(S,P))})}return A.replaceTemplateData({list:R.join("")},Q)}function F(O){var P=A.getHtml("payc","_installmentMonthDefaultSection");return A.replaceTemplateData({level:O.level,monthsKey:0},P)}function L(Q,O){var P=A.getHtml("payc","_installmentMonthSection");return A.replaceTemplateData({level:O.level,monthsKey:Q,isActive:""},P)}function H(R){R.preventDefault();var Q=A.getPartial("payc","_bankNameOverlay");var P={width:"",height:""};var O=new A.widgets.PopupWidget(A.one("div.payment-details.credit-card-form"),Q,P);O.show()}A.extend(B,A.widgets.payment.layouts.abstractFopLayout);A.widgets=A.widgets||{};A.widgets.payment=A.widgets.payment||{};A.widgets.payment.layouts=A.widgets.payment.layouts||{};A.widgets.payment.layouts.abstractLayoutCreditCard=B});YUI.add("wl-payment-tabLayout-creditCard",function(C){var B=function(E,D){B.superclass.constructor.apply(this,arguments);B.prototype.getHtml=function(F){var G=C.getHtml("payc","_creditCardItem");return C.replaceTemplateData(this.card.templateData,G)};B.prototype.applySelectionEvent=function(G){var F="input, label";C.one(this.card.containerId).delegate("click",this.card.callbacks.togglePaymentDetails,F,null,this.card)};B.prototype.onSelect=function(H){var F=C.one(this.card.containerId);if(F){F.addClass("selected");var G=F.one("input");if(G){G.set("checked","checked")}}};B.prototype.onDeselect=function(H){var F=C.one(this.card.containerId);if(F){F.removeClass("selected");var G=F.one("input");if(G){G.set("checked","")}}};B.prototype.getDetailsTemplateName=function(F){return"_paymentDetails"};B.prototype.onUpdate=function(G){if(!G.detailsNode){return }var F=G.detailsNode.one(".payment-amount-right")||G.detailsNode.get("parentNode").one(".amount-charged .payment-amount-right");if(F){F.setContent(this.common.formatPrice(G.price))}};B.prototype.onEnable=function(F){this.card.callbacks.render(this.card.getHtml(),C.one(this.card.containerId))};B.prototype.onDisable=function(F){this.card.callbacks.render(this.card.getHtml(),C.one(this.card.containerId))};B.prototype.onShow=function(G){var H=this.card.containerId;var F=C.one(H);F.setStyle("display","block")};B.prototype.onHide=function(G){var H=this.card.containerId;var F=C.one(H);F.setStyle("display","none")};B.prototype.getMenuSelectorId=function(F){return this.card.containerId};B.prototype.getDetailsSelector=function(F){return"#"+this.card.options.detailsContainer};B.prototype.applyFormDetailsEvents=function(F){B.superclass.applyFormDetailsEvents(F);C.delegate("blur",function(G){B.superclass.creditCardNumberChanged(G.currentTarget.get("value"),F)},F.detailsContainerId,"input#"+F.id+"_cardNumber")}};C.extend(B,C.widgets.payment.layouts.abstractLayoutCreditCard);var A=function(E,D){A.superclass.constructor.apply(this,arguments);A.prototype.getDetailsTemplateName=function(F){return"_paymentDetailsOther"}};C.extend(A,B);C.widgets=C.widgets||{};C.widgets.payment=C.widgets.payment||{};C.widgets.payment.layouts=C.widgets.payment.layouts||{};C.widgets.payment.layouts.tabLayout=C.widgets.payment.layouts.tabLayout||{};C.widgets.payment.layouts.tabLayout.creditCard=B;C.widgets.payment.layouts.tabLayout.noDetails=A;C.widgets.payment.layouts.tabLayout.savedCard=B});YUI.add("wl-payment-radioLayout-creditCard",function(C){var A=function(G,Q){A.superclass.constructor.apply(this,arguments);A.prototype.getHtml=function(R){if(!this.isLast()){return""}var S=C.getHtml("payc","_radioViewCreditCardTypes");var T=this.common.priceMapper(this.common.getDueWithInsurance(this.level));return C.replaceTemplateData({icons:this.createIcons(),paymentAmount:this.common.formatPrice(T),cardOptions:this.createOptions(),level:this.level,detailsContainerCss:this.card.detailsContainerCss},S)};this.createIcons=function(){var R=C.getHtml("payc","_radioViewIcon");var S=[];C.Array.each(this.model.sections[this.card.sectionKey],function(T){if(T.configuration.iconEnabled&&!this.common.isFopRestricted(T.code)){S.push(C.replaceTemplateData({fopKey:T.code.toLowerCase()},R))}},this);return S.join("")};this.getMaxUnrestrictedIndex=function(){var T=this.card.sectionKey;var S=this.model.sections[T];var R=-1;if(S&&S.length){C.Array.each(S,function(U){if(!this.common.isFopRestricted(U.code)){R=C.Array.indexOf(S,U)}},this)}return R};this.isLast=function(){var R=this.getMaxUnrestrictedIndex();return(this.card.index==R)};this.getCreditCardsList=function(){var R=this.common.FOPs[this.level];if(!C.Lang.isArray(R)){R=this.common.FOPs}return R};this.createOptions=function(){var S=[];var R=this.getCreditCardsList();C.Array.each(R,function(T){S.push(this.createOption(T))},this);return S.join("")};this.createOption=function(R){var S=C.getHtml("payc","_radioViewCreditCardOption");return C.replaceTemplateData({name:R.name,value:R.id,preselected:(R.isSelected()?"selected":"")},S)};this.getDropDownSelector=function(){return"#creditCardSelect-"+this.level};A.prototype.applySelectionEvent=function(S){var R=this.getDropDownSelector();if(C.one(R)){C.on("change",this.selectionEvent,R,null,{layout:this})}};this.isCurrentCard=function(){var T=this.getDropDownSelector();var S=C.one(T);var R=S.get("selectedIndex");var U=S.get("options").item(R).getAttribute("value");return this.card.id==U};this.notSelectedCards=function(){var T=this.getDropDownSelector();var S=C.one(T);var R=S.get("selectedIndex");return R==0};this.selectionEvent=function(U,S){U.preventDefault();var T=S.layout;var R=T.card;if(T.notSelectedCards()){if(R.isSelected()){T.common.confirmFOPChange(T.level,function(){R.deselect();if(sabre.config.satConfiguration.formsOfPaymentConfiguration.surchargeCheckEnabled){C.fire("multipleFop:clearSurchargeFee",R.level,C.one("#payc_sections"+R.level))}},function(){T.onSelect()})}}else{if(T.isCurrentCard()){R.callbacks.togglePaymentDetails(U,T.card)}}};A.prototype.onSelect=function(R){this.selectOption(this.card.id)};A.prototype.onDeselect=function(R){this.selectOption("not-selected")};this.getSelectOptionNode=function(){return C.one("option[value="+this.card.id+"]")};A.prototype.onEnable=function(R){var S=this.getSelectOptionNode();if(S){S.set("disabled","")}};A.prototype.onDisable=function(R){var S=this.getSelectOptionNode();if(S){S.set("disabled","disabled")}};A.prototype.onShow=function(R){var S=this.getSelectOptionNode();if(S){S.removeClass("hidden")}};A.prototype.onHide=function(R){var S=this.getSelectOptionNode();if(S){S.addClass("hidden")}};this.selectOption=function(T){var S=this.getDropDownSelector();var R=C.one(S);if(R){R.set("value",T)}};A.prototype.getDetailsTemplateName=function(R){return"_radioViewCreditCardDetails"};this.getCardCodes=function(){var R=[];C.Array.each(this.getCreditCardsList(),function(S){R.push(S.code)});return R};this.onSurchargeShow=function(R,S){var U=S.layout;var T=R.surchargePrices;C.Array.each(U.getCreditCardsList(),function(X){var W=T[X.code]||0;if(W>0){var V=this.common.priceMapper(W);var Y=C.one("option[value="+X.id+"]");if(Y){var Z="label.payc.creditCards.optionWithSurcharge|"+X.name+"|"+this.common.formatPrice(V);Y.set("innerHTML",C.translateParametrized(Z))}}},U)};A.prototype.onUpdateSection=function(S){if(!this.isLast()){return }if(this.configuration.surchargeAmountEnabled&&sabre.config.satConfiguration.formsOfPaymentConfiguration.surchargeCheckEnabled){this.common.getSurcharge(this.getCardCodes(),this.onSurchargeShow,{layout:this})}var R=C.one(".radio-view .amount-charged");if(R){var T=this.common.getDueWithInsurance(this.level);var U=this.common.priceMapper(T);R.setContent(this.common.formatPrice(U))}};A.prototype.getPreselected=function(R){return this.configuration.preselectedCard};A.prototype.onCancelOverLay=function(R){var S=this.common.getSelectedFOP(this.level);S.layout.onSelect()};A.prototype.getDetailsSelector=function(R){return"#card-details-"+this.level};A.prototype.applyFormDetailsEvents=function(S){A.superclass.applyFormDetailsEvents(S);C.delegate("blur",function(V){var U=M(V);A.superclass.creditCardNumberChanged(U,S)},S.detailsContainerId,"input.credit-card-input");if(C.UA.ie>0&&C.UA.ie<=8){C.delegate("keyup",P,S.detailsContainerId,"input.credit-card-input");C.delegate("change",P,S.detailsContainerId,"input.credit-card-input")}else{C.delegate("input",P,S.detailsContainerId,"input.credit-card-input")}C.delegate("keypress",E,S.detailsContainerId,"input.credit-card-input");C.delegate("click",H,S.detailsContainerId,"a[rel='securityCode']");var R=S.configuration.cardNumberFormat;K=new Array(R.split(",").length);for(var T=0;T<K.length;++T){K[T]=""}};var K=[];function M(R){return F()}function E(S){var R=8;if(S.button===R){L(S.currentTarget)}}function P(R){N(R.currentTarget)}function F(){var T=C.one("#cardNumberEnabled .fullCardNumber");var R=C.all("input.credit-card-input");var S="";R.each(function(U){S+=U.get("value")});T.set("value",S);return S}function L(R){var T=R.get("value").length;var S=parseInt(R.get("id").split("_")[1]);K[S]=R.get("value");if(T===0){var U=R.previous(".credit-card-input");if(U){U.focus();U.value=U.value}else{F()}}}function J(R){return R.next(".credit-card-input")}function I(R,X){if(R&&X.length>0){var T=R.get("size");var V=R.get("value");var W=X.substring(0,T);var U=X.substring(W.length,X.length);var S=parseInt(R.get("id").split("_")[1]);W+=V.substring(W.length,T);R.focus();R.set("value",W);K[S]=W;I(J(R),U)}}function O(V,S){var R=0;var U=Math.min(V.length,S.length);for(var T=0;T<U;++T){if(V.charAt(T)!==S.charAt(T)){break}else{++R}}return R}function D(V,T){var R=0;var S=V.length-1;var U=T.length-1;while(S>=0&&U>=0){if(V.charAt(S)!==T.charAt(U)){break}else{++R;--S;--U}}return R}function N(Z){var a=Z.get("value").replace(/ /g,"");var c=Z.get("size");var U=parseInt(Z.get("id").split("_")[1]);var S=K[U];var W=O(a,S);var T=a.substring(0,W);a=a.substring(W,a.length);S=S.substring(W,S.length);var X=D(a,S);var V="";var b="";var R="";var Y="";if(a.length<=S.length){R=T+a}else{V=a.substring(0,a.length-X);b=S.substring(S.length-X,S.length);if(W+V.length<=c){R=T+V+b.substring(T.length+V.length,c)}else{R=T+V.substring(0,c-T.length);Y=V.substring(c-T.length,V.length)}}K[U]=R;Z.set("value",R);I(J(Z),Y);F()}function H(U){U.preventDefault();var T=C.getPartial("payc","_securityCodeOverlay");var S={width:"",height:""};var R=new C.widgets.PopupWidget(C.one("div.radio-view"),T,S);R.show()}};C.extend(A,C.widgets.payment.layouts.abstractLayoutCreditCard);var B=function(E,D){B.superclass.constructor.apply(this,arguments);B.prototype.getDetailsTemplateName=function(F){return"_paymentDetailsOther"}};C.extend(B,A);C.widgets=C.widgets||{};C.widgets.payment=C.widgets.payment||{};C.widgets.payment.layouts=C.widgets.payment.layouts||{};C.widgets.payment.layouts.radioLayout=C.widgets.payment.layouts.radioLayout||{};C.widgets.payment.layouts.radioLayout.creditCard=A;C.widgets.payment.layouts.radioLayout.noDetails=B;C.widgets.payment.layouts.radioLayout.savedCard=A});YUI.add("wl-masked-input",function(B){var A={};(function(C){C.MaskedInput=function(H){if(!H||!H.elm||!H.format){return null}if(!(this instanceof C.MaskedInput)){return new C.MaskedInput(H)}var P=this,F=H.elm,T=H.format,J=H.allowed||"0123456789",Q=H.separator||"/:-",O=H.typeon||"_YMDhms",E=H.onbadkey||function(){},R=H.onfilled||function(){},X=H.badkeywait||0,b=H.hasOwnProperty("preserve")?!!H.preserve:true,M=true,Y=false,U=T,K=(function(){if(window.addEventListener){return function(f,d,e,c){f.addEventListener(d,e,(c===undefined)?false:c)}}if(window.attachEvent){return function(e,c,d){e.attachEvent("on"+c,d)}}return function(e,c,d){e["on"+c]=d}}()),V=function(){for(var e=F.value.length-1;e>=0;e--){for(var g=0,f=O.length;g<f;g++){if(F.value[e]===O[g]){return false}}}return true},Z=function(d){try{d.focus();if(d.selectionStart>=0){return d.selectionStart}if(document.selection){var c=document.selection.createRange();return -c.moveStart("character",-d.value.length)}return -1}catch(f){return -1}},D=function(d,g){try{if(d.selectionStart){d.focus();d.setSelectionRange(g,g)}else{if(d.createTextRange){var c=d.createTextRange();c.move("character",g);c.select()}}}catch(f){return false}return true},N=function(e){e=e||window.event;var d="",f=e.which,c=e.type;if(f===undefined||f===null){f=e.keyCode}if(f===undefined||f===null){return""}switch(f){case 8:d="bksp";break;case 46:d=(c==="keydown")?"del":".";break;case 16:d="shift";break;case 0:case 9:case 13:d="etc";break;case 37:case 38:case 39:case 40:d=(!e.shiftKey&&(e.charCode!==39&&e.charCode!==undefined))?"etc":String.fromCharCode(f);break;default:d=String.fromCharCode(f);break}return d},W=function(c,d){if(c.preventDefault){c.preventDefault()}c.returnValue=d||false},L=function(d){var f=Z(F),h=F.value,g="",e=true;switch(e){case (J.indexOf(d)!==-1):f=f+1;if(f>T.length){return false}while(Q.indexOf(h.charAt(f-1))!==-1&&f<=T.length){f=f+1}g=h.substr(0,f-1)+d+h.substr(f);if(J.indexOf(h.charAt(f))===-1&&O.indexOf(h.charAt(f))===-1){f=f+1}break;case (d==="bksp"):f=f-1;if(f<0){return false}while(J.indexOf(h.charAt(f))===-1&&O.indexOf(h.charAt(f))===-1&&f>1){f=f-1}g=h.substr(0,f)+T.substr(f,1)+h.substr(f+1);break;case (d==="del"):if(f>=h.length){return false}while(Q.indexOf(h.charAt(f))!==-1&&h.charAt(f)!==""){f=f+1}g=h.substr(0,f)+T.substr(f,1)+h.substr(f+1);f=f+1;break;case (d==="etc"):return true;default:return false}F.value="";F.value=g;D(F,f);return false},I=function(c){if(J.indexOf(c)===-1&&c!=="bksp"&&c!=="del"&&c!=="etc"){var d=Z(F);Y=true;E(c);setTimeout(function(){Y=false;D(F,d)},X);return false}return true},a=function(d){if(!M){return true}if(Y){W(d);return false}d=d||event;var c=N(d);if((d.metaKey||d.ctrlKey)&&(c==="X"||c==="V")){W(d);return false}if(d.metaKey||d.ctrlKey){return true}if(F.value===""){F.value=T;D(F,0)}if(c==="bksp"||c==="del"){L(c);W(d);return false}return true},G=function(d){if(!M){return true}if(Y){W(d);return false}d=d||event;var c=N(d);if(c==="etc"||d.metaKey||d.ctrlKey||d.altKey){return true}if(c!=="bksp"&&c!=="del"&&c!=="shift"){if(!I(c)){W(d);return false}if(L(c)){if(V()){R()}W(d,true);return true}if(V()){R()}W(d);return false}return false},S=function(){if(!F.tagName||(F.tagName.toUpperCase()!=="INPUT"&&F.tagName.toUpperCase()!=="TEXTAREA")){return null}if(!b||F.value===""){F.value=T}K(F,"keydown",function(c){a(c)});K(F,"keypress",function(c){G(c)});K(F,"focus",function(){U=F.value});K(F,"blur",function(){if(F.value!==U&&F.onchange){F.onchange()}});return P};P.resetField=function(){F.value=T};P.setAllowed=function(c){J=c;P.resetField()};P.setFormat=function(c){T=c;P.resetField()};P.setSeparator=function(c){Q=c;P.resetField()};P.setTypeon=function(c){O=c;P.resetField()};P.setEnabled=function(c){M=c};return S()}}(A));B.widgets=B.widgets||{};B.widgets.MaskedInput=A.MaskedInput},"1.0.0");YUI.add("wl-payment-radioLayout-dynamicCreditCard",function(B){var A=function(F,J){A.superclass.constructor.apply(this,arguments);A.prototype.getHtml=function(h){if(!this.isLast()){return""}var i=B.getHtml("payc",this.getDetailsTemplateName(h));var j=F.common.priceMapper(F.common.getDueWithInsurance(F.level));return B.replaceTemplateData({level:this.level,detailsContainerCss:this.card.detailsContainerCss,icons:this.createIcons(),cssCardCode:F.codeLower,paymentMethod:F.template,name:"selectedCards["+F.level+"]",id:F.id,paymentAmount:F.common.formatPrice(j),exchangeMessage:"",fraudMessage:"",cardType:F.code,cardName:F.name,remote:F.configuration.remote,sectionName:F.sectionKey,cardNumberInputs:'<input type="text" class="disable-rule-based-validation credit-card-input masked-input"><span class="surcharge-info"/>',installmentOptions:""},i)};A.prototype.getDetailsTemplateName=function(h){return"_radioViewDynamicCreditCardType"};this.createIcons=function(){var h=B.getHtml("payc","_radioViewIcon");var i=[];B.Array.each(this.model.sections[this.card.sectionKey],function(j){if(j.configuration.binRanges&&!this.common.isFopRestricted(j.code)){i.push(B.replaceTemplateData({fopKey:j.code.toLowerCase()},h))}},this);return i.join("")};this.getMaxUnrestrictedIndex=function(){var j=this.card.sectionKey;var i=this.model.sections[j];var h=-1;if(i&&i.length){B.Array.each(i,function(k){if(!this.common.isFopRestricted(k.code)){h=B.Array.indexOf(i,k)}},this)}return h};this.isLast=function(){var h=this.getMaxUnrestrictedIndex();return(this.card.index==h)};this.getCreditCardsList=function(){var h=this.common.FOPs[this.level];if(!B.Lang.isArray(h)){h=this.common.FOPs}return h};this.getCardCodes=function(){var h=[];B.Array.each(this.getCreditCardsList(),function(i){h.push(i.code)});return h};this.onSurchargeShow=function(p,o){var m=F.common.getSelectedFOP(F.level);if(!m||m.code!==o.layout.card.code){return }var k=o.layout;var j=p.surchargePrices;var i=j[k.card.code]||0;var h=B.one("#cardsNumberInputs span.surcharge-info");if(i>0){var l=k.common.priceMapper(i);h.addClass("hidden");if(h.hasClass("hidden")){h.removeClass("hidden")}if(h){var n="label.payc.creditCards.optionWithSurcharge|"+k.card.name+"|"+k.common.formatPrice(l);h.set("innerHTML",B.translateParametrized(n))}}else{h.addClass("hidden")}};var Q=F.componentModel.sections.creditCardTypes;var R=Q.length;var c,g,E,M,a,Y;var O=function(h){h.on("contextmenu",function(i){i.halt()});h.on("key",function(i){if(i.ctrlKey){i.halt()}},"down");h.on("key",function(i){if(i.ctrlKey){i.halt()}},"up")};A.prototype.applySelectionEvent=function(i){if(!this.isLast()){return }var h=B.one(F.detailsContainerId);h.one(".billing-data").addClass("hidden");B.delegate("click",V,F.detailsContainerId,"a[rel='securityCode']");a=B.one("#cardsNumberInputs input");a.on("key",P,"up");a.on("click",function(){O(a)});var j=F.common.getSelectedFOP(F.level);if(j){T(j.code,j.configuration.cardNumberFormat,"")}a.on("blur",function(){var l=F.common.getSelectedFOP(F.level);var k=d();A.superclass.creditCardNumberChanged(k,l,"#card-details-"+F.level+" div.payment-type")})};function d(){var h=B.one("#cardNumberEnabled .fullCardNumber");var i=a.get("value").replace(/-|_/g,"");h.set("value",i);return i}var D=function(l,n){var h=l.length,m,o,j;for(var k=0;k<h;k++){j=l[k].split("-");m=j[0].length;o=n.toString().substr(0,m);if(j[0]<=o&&o<=j[1]){return true}}return false};var f=function(k){var l=k.toString();for(var j=0;j<R;j++){var h=Q[j].configuration.binRanges;if(h){if(D(h,l)){return[Q[j].code,Q[j].configuration.cardNumberFormat]}}}return false};var S=function(k,n,o){splitFormatCount=k.split(",");var p="";var m=0,h=splitFormatCount.length;while(m<h){for(var l=0;l<splitFormatCount[m];l++){p=p+o}m++;if(m<h){p=p+n}}return p};var I=function(i,j,k){if(i.setSelectionRange){i.setSelectionRange(j,k)}else{if(i.createTextRange){var h=i.createTextRange();h.collapse(true);h.moveEnd("character",k);h.moveStart("character",j);h.select()}}};var b=function(i,h){var j=i.toString();var k=j.length;var l=j+h.slice(k);a.set("value",l);I(B.Node.getDOMNode(a),k,k)};var X=function(i){var h=S(i,"-","_");if(g!=i){if(!Y){Y=B.widgets.MaskedInput({elm:B.Node.getDOMNode(a),format:h,separator:"-",typeon:"_1234567890"})}else{Y.setFormat(h)}}return h};var e=function(h){var i=B.all(".multi-fop-section .dynamic .fop-icon");if(!h){i.each(function(j){if(j.hasClass("gray")){j.removeClass("gray")}});c="";return }if(c!=h){i.each(function(j){if(!j.hasClass("gray")){j.addClass("gray")}if(j.hasClass("fop-icon-"+h.toLowerCase())){if(j.hasClass("gray")){j.removeClass("gray")}}})}};var P=function(){var h=parseInt(a.get("value"));if(h){var l=f(h);if(l){var i=l[0];var k=l[1];T(i,k,h)}else{e(l)}}else{a.set("value","");var j=B.one("#cvcNumberEnabled input");j.set("value","");c="";e()}};function T(i,k,j){if(i!=c){var h=X(k);b(j,h);e(i);c=i;g=k;Z(c)}}function Z(i){var j=G(i);j.callbacks.informAboutChange(j);F.common.setSelectedFOP(j,F.level);var h=B.one(j.detailsContainerId);if(j.rememberMe){j.rememberMe.purgeHandlers()}j.modelData.paymentAmount=F.common.getPaymentAmount(F.level);C(h,j);H(h,j);U(h,j);W(h,j);j.callbacks.removeDisabledFields(h,j,F.id,function(l,k){if(k){if(l.hasClass("hidden")){l.all("input, select").set("disabled",false);l.removeClass("hidden")}}else{if(!l.hasClass("hidden")){l.addClass("hidden");l.all("input, select").set("disabled",true)}}});F.onUpdate();N(h,j);j.onUpdateSection();j.callbacks.addFormEvents(h,j);j.callbacks.triggerShowSurcharge(j);F.common.displayInsuranceAndHotelUnacceptableOverlayIfNeeded()}function U(h,k){var j=h.one(".installment-data");if(k.callbacks.isInstallmentCCEnabled(k)){var i=k.layout.createBankOptions(k);if(j){j.replace(i)}else{h.one(".payment-details").insert(i,"after")}}else{if(j){j.remove()}}}function W(h,j){var i=h.one(".billing-data");if(i.hasClass("hidden")){i.removeClass("hidden");j.callbacks.populateData(j)}}var L=function(h,i){var k=i.one('[name="'+h+'"]');if(!k){var j=document.getElementsByName(h);if(j.length>0){k=i.one("#"+j[0].id)}}return k};function C(h,i){K(h,i,i.callbacks.getExchangeMessage,"exchangePaymentMsg")}function H(h,i){K(h,i,i.callbacks.getFraudMessage,"payment-fraud-message")}function K(h,n,k,m){var j=h.one(".payment-details");var l=k(n);var i=j.one("#"+m);if(l){if(i){i.replace(l)}else{j.prepend(l)}}else{if(i){i.remove()}}}function N(h,j){var i="selectedCards["+j.level+"]";L(i+".cardType.code",h).set("value",j.code);L(i+".cardType.name",h).set("value",j.name)}function G(h){return B.Array.find(F.common.FOPs[F.level],function(i){return i.code===h})}A.prototype.onUpdateSection=function(i){if(this.configuration.surchargeAmountEnabled&&sabre.config.satConfiguration.formsOfPaymentConfiguration.surchargeCheckEnabled){this.common.getSurcharge(this.getCardCodes(),this.onSurchargeShow,{layout:this})}var h=B.one(".radio-view .amount-charged");if(h){var j=this.common.getDueWithInsurance(this.level);var k=this.common.priceMapper(j);h.setContent(this.common.formatPrice(k))}};A.prototype.getPreselected=function(h){return this.configuration.preselectedCard};A.prototype.onCancelOverLay=function(h){var i=this.common.getSelectedFOP(this.level);i.layout.onSelect()};A.prototype.getDetailsSelector=function(h){return"#card-details-"+this.level};A.prototype.applyFormDetailsEvents=function(h){A.superclass.applyFormDetailsEvents(h)};function V(k){k.preventDefault();var j=B.getPartial("payc","_securityCodeOverlay");var i={width:"",height:""};var h=new B.widgets.PopupWidget(B.one("div.radio-view"),j,i);h.show()}};B.extend(A,B.widgets.payment.layouts.abstractLayoutCreditCard);B.widgets=B.widgets||{};B.widgets.payment=B.widgets.payment||{};B.widgets.payment.layouts=B.widgets.payment.layouts||{};B.widgets.payment.layouts.radioLayout=B.widgets.payment.layouts.radioLayout||{};B.widgets.payment.layouts.radioLayout.dynamicCreditCard=A});YUI.add("wl-phone-tooltip",function(B){var A=function(E,I,D,J){var H=this;var D=D;var G=["mobile","cellular"];E.each(function(K){K.on("change",C)});function C(L){var T=L.currentTarget;var Q=T.ancestor().siblings(".phone-tooltip-container").item(0);var O=Q.one(".phone-tooltip-type");var P=T.get("selectedIndex");var V=T.get("value");var S=T.get("options").item(P).get("text");var K=O.getAttribute("wl:translate");var N=K.lastIndexOf(".");var M=K.substring(0,N+1);var R=M+V;O.set("text",S);O.setAttribute("wl:translate",R);var U=Q.one(".phone-tooltip-area-code-container");if(U){if(G.indexOf(V)!==-1){U.addClass("hidden")}else{U.removeClass("hidden")}}}this.onLearnMoreClickHandler=function(K){K.preventDefault();F(K.currentTarget)};function F(N){var P="";var M=null;var O={width:"",height:""};if(N.hasClass("urlSource")){M=N.get("href");P='<iframe style="width:600px;height:800px" src="'+M+'"></iframe>'}else{if(N.hasClass("newTab")){M=N.get("href");window.open(M,"_newTab");return }else{P='<p><span class="translate" wl:translate="label.phone.tooltip.source"/></p>'}}var L=new B.widgets.PopupWidget(I,P,O);L.show();if(J){L.node().setStyle("border","1px grey solid")}if(D){var K="#"+L.id()+"_mask";B.one(K).remove()}}};B.widgets=B.widgets||{};B.widgets.PhoneTooltip=A},"1.0.0",{requires:["popupWidget"]});YUI.add("wl-rememberme-repository-abstract",function(B){var A=function(F,C){var E=sabre.config.global.airlineCode;this.primaryRepositoryName=C.primaryRepositoryName||"SSW_global";this.primaryRepositoryName=this.primaryRepositoryName+E;var D=[];B.Array.each(C.secondaryRepositoriesName,function(G){D.push(G+E)});this.secondaryRepositoriesName=D};A.prototype.commit=function(){};A.prototype.set=function(C){};A.prototype.setWriteModeEnabled=function(C){};A.prototype.getAll=function(){};A.prototype.clear=function(){};A.prototype.deleteItem=function(C){};A.prototype.getKeyFieldsNames=function(){};B.widgets=B.widgets||{};B.widgets.rememberme=B.widgets.rememberme||{};B.widgets.rememberme.repository=B.widgets.rememberme.repository||{};B.widgets.rememberme.repository.abstractRepository=A},"1.0.0",{requires:[]});YUI.add("wl-rememberme-storage-abstract",function(B){var A=function(){};A.prototype.getItem=function(C){};A.prototype.setItem=function(C,D){};B.widgets=B.widgets||{};B.widgets.rememberme=B.widgets.rememberme||{};B.widgets.rememberme.storage=B.widgets.rememberme.storage||{};B.widgets.rememberme.storage.base=A},"1.0.0",{requires:[]});(function(){var D=YAHOO,B=D.util,A=D.lang,C;if(!B.Storage){C=function(E){D.log("Exception in YAHOO.util.Storage.?? - must be extended by a storage engine".replace("??",E).replace("??",this.getName?this.getName():"Unknown"),"error")};B.Storage=function(E,G,F){var H=this;D.env._id_counter+=1;H._cfg=A.isObject(F)?F:{};H._location=E;H._name=G;H.isReady=false;H.createEvent(H.CE_READY,{scope:H});H.createEvent(H.CE_CHANGE,{scope:H});H.subscribe(H.CE_READY,function(){H.isReady=true})};B.Storage.prototype={CE_READY:"YUIStorageReady",CE_CHANGE:"YUIStorageChange",DELIMITER:"__",_cfg:"",_name:"",_location:"",length:0,isReady:false,clear:function(){this._clear();this.length=0},getItem:function(E){D.log("Fetching item at  "+E);var F=this._getItem(E);return A.isValue(F)?this._getValue(F):null},getName:function(){return this._name},hasKey:function(E){return A.isString(E)&&this._hasKey(E)},key:function(E){D.log("Fetching key at "+E);if(A.isNumber(E)&&-1<E&&this.length>E){var F=this._key(E);if(F){return F}}throw ("INDEX_SIZE_ERR - Storage.setItem - The provided index ("+E+") is not available")},removeItem:function(F){D.log("removing "+F);if(this.hasKey(F)){var E=this._getItem(F);if(!E){E=null}this._removeItem(F);this.fireEvent(this.CE_CHANGE,new B.StorageEvent(this,F,E,null,B.StorageEvent.TYPE_REMOVE_ITEM))}else{}},setItem:function(G,H){D.log("SETTING "+H+" to "+G);if(A.isString(G)){var F=this.hasKey(G)?B.StorageEvent.TYPE_UPDATE_ITEM:B.StorageEvent.TYPE_ADD_ITEM,E=this._getItem(G);if(!E){E=null}if(this._setItem(G,this._createValue(H))){this.fireEvent(this.CE_CHANGE,new B.StorageEvent(this,G,E,H,F))}else{throw ("QUOTA_EXCEEDED_ERROR - Storage.setItem - The choosen storage method ("+this.getName()+") has exceeded capacity")}}else{}},_clear:function(){C("_clear");return""},_createValue:function(F){var E=(A.isNull(F)||A.isUndefined(F))?(""+F):typeof F;return"string"===E?F:E+this.DELIMITER+F},_getItem:function(E){C("_getItem");return""},_getValue:function(F){var E=F?F.split(this.DELIMITER):[];if(1==E.length){return F}switch(E[0]){case"boolean":return"true"===E[1];case"number":return parseFloat(E[1]);case"null":return null;default:return E[1]}},_key:function(E){C("_key");return""},_hasKey:function(E){return null!==this._getItem(E)},_removeItem:function(E){C("_removeItem");return""},_setItem:function(E,F){C("_setItem");return""}};A.augmentProto(B.Storage,B.EventProvider)}}());(function(){var H=YAHOO.util,B=YAHOO.lang,E={},G=[],F={},C=function(I){return(I&&I.isAvailable())?I:null},A=function(J,I,K){var L=E[J+I.ENGINE_NAME];if(!L){L=new I(J,K);E[J+I.ENGINE_NAME]=L}return L},D=function(I){switch(I){case H.StorageManager.LOCATION_LOCAL:case H.StorageManager.LOCATION_SESSION:return I;default:return H.StorageManager.LOCATION_SESSION}};H.StorageManager={LOCATION_SESSION:"sessionStorage",LOCATION_LOCAL:"localStorage",get:function(O,J,M){var K=B.isObject(M)?M:{},I=C(F[O]);if(!I&&!K.force){var N,L;if(K.order){L=K.order.length;for(N=0;N<L&&!I;N+=1){I=C(K.order[N])}}if(!I){L=G.length;for(N=0;N<L&&!I;N+=1){I=C(G[N])}}}if(I){return A(D(J),I,K.engine)}throw ("YAHOO.util.StorageManager.get - No engine available, please include an engine before calling this function.")},getByteSize:function(I){return encodeURIComponent(""+I).length},register:function(I){if(B.isFunction(I)&&B.isFunction(I.isAvailable)&&B.isString(I.ENGINE_NAME)){F[I.ENGINE_NAME]=I;G.push(I);return true}return false}};YAHOO.register("StorageManager",H.SWFStore,{version:"2.8.0r4",build:"2449"})}());(function(){YAHOO.util.StorageEvent=function(D,B,A,E,C){this.key=B;this.oldValue=A;this.newValue=E;this.url=window.location.href;this.window=window;this.storageArea=D;this.type=C};YAHOO.lang.augmentObject(YAHOO.util.StorageEvent,{TYPE_ADD_ITEM:"addItem",TYPE_REMOVE_ITEM:"removeItem",TYPE_UPDATE_ITEM:"updateItem"});YAHOO.util.StorageEvent.prototype={key:null,newValue:null,oldValue:null,source:null,storageArea:null,type:null,url:null}}());(function(){var B=YAHOO.util,A=YAHOO.lang;B.StorageEngineKeyed=function(){B.StorageEngineKeyed.superclass.constructor.apply(this,arguments);this._keys=[];this._keyMap={}};A.extend(B.StorageEngineKeyed,B.Storage,{_keys:null,_keyMap:null,_addKey:function(C){this._keyMap[C]=this.length;this._keys.push(C);this.length=this._keys.length},_indexOfKey:function(D){var C=this._keyMap[D];return undefined===C?-1:C},_removeKey:function(E){var D=this._indexOfKey(E),F=this._keys.slice(D+1);delete this._keyMap[E];for(var C in this._keyMap){if(D<this._keyMap[C]){this._keyMap[C]-=1}}this._keys.length=D;this._keys=this._keys.concat(F);this.length=this._keys.length}})}());(function(){var D=YAHOO.util,B=YAHOO.lang,A=function(E){if(E.begin){E.begin()}},C=function(E){if(E.commit){E.commit()}};D.StorageEngineHTML5=function(E,F){var G=this;D.StorageEngineHTML5.superclass.constructor.call(G,E,D.StorageEngineHTML5.ENGINE_NAME,F);G._engine=window[E];G.length=G._engine.length;B.later(250,G,function(){G.fireEvent(G.CE_READY)})};YAHOO.lang.extend(D.StorageEngineHTML5,D.Storage,{_engine:null,_clear:function(){var G=this;if(G._engine.clear){G._engine.clear()}else{for(var F=G.length,E;0<=F;F-=1){E=G._key(F);G._removeItem(E)}}},_getItem:function(E){var F=this._engine.getItem(E);return B.isObject(F)?F.value:F},_key:function(E){return this._engine.key(E)},_removeItem:function(E){var F=this;A(F._engine);F._engine.removeItem(E);C(F._engine);F.length=F._engine.length},_setItem:function(E,F){var H=this;try{A(H._engine);H._engine.setItem(E,F);C(H._engine);H.length=H._engine.length;return true}catch(G){return false}}},true);D.StorageEngineHTML5.ENGINE_NAME="html5";D.StorageEngineHTML5.isAvailable=function(){return window.localStorage};D.StorageManager.register(D.StorageEngineHTML5)}());(function(){var G=YAHOO.util,B=YAHOO.lang,D=9948,C="YUIStorageEngine",F=null,E=encodeURIComponent,A=decodeURIComponent;G.StorageEngineGears=function(I,L){var O=this;G.StorageEngineGears.superclass.constructor.call(O,I,G.StorageEngineGears.ENGINE_NAME,L);if(!F){F=google.gears.factory.create(G.StorageEngineGears.GEARS);F.open(window.location.host+"-"+G.StorageEngineGears.DATABASE);F.execute("CREATE TABLE IF NOT EXISTS "+C+" (key TEXT, location TEXT, value TEXT)")}var K=G.StorageManager.LOCATION_SESSION===O._location,H=G.Cookie.get("sessionKey"+G.StorageEngineGears.ENGINE_NAME);if(!H){F.execute("BEGIN");F.execute("DELETE FROM "+C+' WHERE location="'+E(G.StorageManager.LOCATION_SESSION)+'"');F.execute("COMMIT")}var J=F.execute("SELECT key FROM "+C+' WHERE location="'+E(O._location)+'"'),N={};try{while(J.isValidRow()){var M=A(J.field(0));if(!N[M]){N[M]=true;O._addKey(M)}J.next()}}finally{J.close()}if(K){G.Cookie.set("sessionKey"+G.StorageEngineGears.ENGINE_NAME,true)}O.length=O._keys.length;B.later(250,O,function(){O.fireEvent(O.CE_READY)})};B.extend(G.StorageEngineGears,G.StorageEngineKeyed,{_clear:function(){F.execute("BEGIN");F.execute("DELETE FROM "+C+' WHERE location="'+E(this._location)+'"');F.execute("COMMIT");this._keys=[];this.length=0},_getItem:function(J){var I=F.execute("SELECT value FROM "+C+' WHERE key="'+E(J)+'" AND location="'+E(this._location)+'"'),K="";try{while(I.isValidRow()){var H=I.field(0);K+=I.field(0);I.next()}}finally{I.close()}return K?A(K):null},_key:function(H){return this._keys[H]},_removeItem:function(H){YAHOO.log("removing "+H);F.execute("BEGIN");F.execute("DELETE FROM "+C+' WHERE key="'+E(H)+'" AND location="'+E(this._location)+'"');F.execute("COMMIT");this._removeKey(H)},_setItem:function(P,M){YAHOO.log("SETTING "+M+" to "+P);if(!this.hasKey(P)){this._addKey(P)}var H=E(P),Q=E(this._location),R=E(M),K=[],O=D-(H+Q).length;if(O<R.length){for(var N=0,L=R.length;N<L;N+=O){K.push(R.substr(N,O))}}else{K.push(R)}F.execute("BEGIN");F.execute("DELETE FROM "+C+' WHERE key="'+E(P)+'" AND location="'+E(this._location)+'"');for(var J=0,I=K.length;J<I;J+=1){F.execute("INSERT INTO "+C+' VALUES ("'+H+'", "'+Q+'", "'+K[J]+'")')}F.execute("COMMIT");return true}});G.Event.on("unload",function(){if(F){F.close()}});G.StorageEngineGears.ENGINE_NAME="gears";G.StorageEngineGears.GEARS="beta.database";G.StorageEngineGears.DATABASE="yui.database";G.StorageEngineGears.isAvailable=function(){if(window.google&&window.google.gears){try{google.gears.factory.create(G.StorageEngineGears.GEARS);return true}catch(H){}}return false};G.StorageManager.register(G.StorageEngineGears)}());(function(){var G=YAHOO.util,B=YAHOO.lang,H=G.Dom,C=215,E=138,F=null,D=function(J,I){return J._location+J.DELIMITER+I},A=function(J){if(!F){if(!B.isString(J.swfURL)){J.swfURL=G.StorageEngineSWF.SWFURL}if(!J.containerID){var K=document.getElementsByTagName("body")[0],I=K.appendChild(document.createElement("div"));J.containerID=H.generateId(I)}if(!J.attributes){J.attributes={}}if(!J.attributes.flashVars){J.attributes.flashVars={}}J.attributes.flashVars.useCompression="true";J.attributes.version=9.115;F=new YAHOO.widget.SWF(J.containerID,J.swfURL,J.attributes)}};G.StorageEngineSWF=function(I,J){var K=this;G.StorageEngineSWF.superclass.constructor.call(K,I,G.StorageEngineSWF.ENGINE_NAME,J);A(K._cfg);F.unsubscribe("contentReady");F.addListener("contentReady",function(){K._swf=F._swf;F.initialized=true;var N=G.StorageManager.LOCATION_SESSION===K._location,M=G.Cookie.get("sessionKey"+G.StorageEngineSWF.ENGINE_NAME);for(var P=F.callSWF("getLength",[])-1;0<=P;P-=1){var O=F.callSWF("getNameAt",[P]),L=-1<O.indexOf(G.StorageManager.LOCATION_SESSION+K.DELIMITER);if(N&&!M){F.callSWF("removeItem",[O])}else{if(N===L){K._addKey(O)}}}if(N){G.Cookie.set("sessionKey"+G.StorageEngineSWF.ENGINE_NAME,true)}K.length=K._keys.length;K.fireEvent(K.CE_READY)});if(F.initialized){F.fireEvent("contentReady")}};B.extend(G.StorageEngineSWF,G.StorageEngineKeyed,{_swf:null,_clear:function(){for(var J=this._keys.length-1;0<=J;J-=1){var I=this._keys[J];F.callSWF("removeItem",[I])}this._keys=[];this.length=0},_getItem:function(I){var J=D(this,I);return F.callSWF("getValueOf",[J])},_key:function(I){return(this._keys[I]||"").replace(/^.*?__/,"")},_removeItem:function(I){var J=D(this,I);F.callSWF("removeItem",[J]);this._removeKey(J)},_setItem:function(I,K){var J=D(this,I),L;if(F.callSWF("getValueOf",[J])){this._removeItem(I)}this._addKey(J);if(F.callSWF("setItem",[J,K])){return true}else{L=H.get(F._id);if(C>H.getStyle(L,"width").replace(/\D+/g,"")){H.setStyle(L,"width",C+"px")}if(E>H.getStyle(L,"height").replace(/\D+/g,"")){H.setStyle(L,"height",E+"px")}return F.callSWF("displaySettings",[])}}});G.StorageEngineSWF.SWFURL="swfstore.swf";G.StorageEngineSWF.ENGINE_NAME="swf";G.StorageEngineSWF.isAvailable=function(){return(6<=YAHOO.env.ua.flash&&YAHOO.widget.SWF)};G.StorageManager.register(G.StorageEngineSWF)}());YAHOO.register("storage",YAHOO.util.Storage,{version:"2.8.0r4",build:"2449"});YUI.add("wl-rememberme-storage-local",function(B){var A=function(C,E,D){A.superclass.constructor.apply(this,arguments);E=E||YAHOO.util.StorageEngineHTML5.ENGINE_NAME;C=C||YAHOO.util.StorageManager.LOCATION_LOCAL;D=D||{force:false,order:[YAHOO.util.StorageEngineSWF,YAHOO.util.StorageEngineGears]};this.storageEngine=YAHOO.util.StorageManager.get(E,C,D)};B.extend(A,B.widgets.rememberme.storage.base);A.instance;A.getDefaultInstance=function(){if(!A.instance){A.instance=new A()}return A.instance};A.prototype.getItem=function(D){var C=this.storageEngine.getItem(D);try{return JSON.parse(C)}catch(E){B.log("Invalid local storage data ["+D+"].","warn")}return{}};A.prototype.setItem=function(D,E){var C=JSON.stringify(E);this.storageEngine.setItem(D,C)};B.widgets=B.widgets||{};B.widgets.rememberme=B.widgets.rememberme||{};B.widgets.rememberme.storage=B.widgets.rememberme.storage||{};B.widgets.rememberme.storage.local=A},"1.0.0",{requires:[]});YUI.add("wl-rememberme-repository-storage",function(F){var E=function(I,Q){E.superclass.constructor.call(this,I,Q);Q=Q||{};var N=this;this.storage=(Q.storage instanceof F.widgets.rememberme.storage.base)?Q.storage:F.widgets.rememberme.storage.local.getDefaultInstance();this.autoCommit=(F.Lang.isBoolean(Q.autoCommit))?Q.autoCommit:true;this.keyFields=[];this.localToGlobalFieldsMapping={};this.mappedPrimaryRepositoryData={};this.mappedSecondaryRepositoriesData={};this.writeModeEnabled=false;this.getKey=function(S){var R=[];F.Array.each(N.keyFields,function(T){R.push(S[T].toLowerCase())});return R.join()};function H(){var R={};var S;N.mappedPrimaryRepositoryData=K(N.primaryRepositoryName);L(R,N.mappedPrimaryRepositoryData);F.Array.each(N.secondaryRepositoriesName,function(T){S=K(T);N.mappedSecondaryRepositoriesData[T]=S;L(R,S)});return R}function J(R){var S={};F.Array.each(R,function(T){S[N.getKey(T)]=T});return S}function K(S){var U=N.storage.getItem(S);if(F.Lang.isArray(U)){var T=[];var R;F.Array.each(U,function(V){R=P(V);if(M(R)){T.push(R)}})}else{F.log("Invalid local storage data ["+S+"]. Array expected.","warn");return{}}return J(T)}function P(T){var S={};var R;F.Object.each(N.localToGlobalFieldsMapping,function(U,V){F.Array.some(U,function(W){R=T[W];if(F.Lang.isValue(R)){S[V]=R;return true}return false})});return S}function L(R,S){F.Object.each(S,function(U,T){if(!R.hasOwnProperty(T)){R[T]=U}})}function M(S){var T=true;var R;F.Array.some(N.keyFields,function(U){R=S[U];if(R&&R!=""){return false}else{T=false;return true}});return T}function O(){F.Array.each(I,function(R){if(R.enabled){if(R.key){N.keyFields.push(R.localName)}N.localToGlobalFieldsMapping[R.localName]=R.globalNames}})}O();this.data=H()};F.extend(E,F.widgets.rememberme.repository.abstractRepository);E.prototype.commit=function(){if(this.writeModeEnabled){var H=[];F.Object.each(this.data,function(I,J){if(C(J,I,this.mappedPrimaryRepositoryData,this.mappedSecondaryRepositoriesData)){H.push(B(this.localToGlobalFieldsMapping,I))}},this);this.storage.setItem(this.primaryRepositoryName,H)}};function A(J,I){var H=true;F.Object.some(J,function(L,K){if(I[K]!==L){H=false;return true}});return H}function D(I,H){return I&&I.hasOwnProperty(H)}function G(L,I,H){var K=true;var J=false;F.Object.some(L,function(O){var M=O.hasOwnProperty(I);var N=O[I];if(M){K=false;if(!A(H,N)){J=true;return true}}});return K||J}function C(I,H,K,J){return D(K,I)||G(J,I,H)}function B(H,I){var J={};F.Object.each(H,function(K,L){var M=K[0];J[M]=I[L]});return J}E.prototype.getKeyFieldsNames=function(){return this.keyFields};E.prototype.set=function(H){var I=this.getKey(H);this.data[I]=F.merge(this.data[I],H);if(this.autoCommit){this.commit()}};E.prototype.setWriteModeEnabled=function(H){this.writeModeEnabled=H};E.prototype.getAll=function(){var H=[];for(var I in this.data){H.push(this.data[I])}return H};E.prototype.deleteItem=function(H){var I=this.getKey(H);if(this.data[I]){delete this.data[I]}};E.prototype.clear=function(){this.data={};if(this.autoCommit){this.save()}};F.widgets=F.widgets||{};F.widgets.rememberme=F.widgets.rememberme||{};F.widgets.rememberme.repository=F.widgets.rememberme.repository||{};F.widgets.rememberme.repository.storage=E},"1.0.0",{requires:[]});(function(){var lang=YAHOO.lang,util=YAHOO.util,Ev=util.Event;util.DataSourceBase=function(oLiveData,oConfigs){if(oLiveData===null||oLiveData===undefined){YAHOO.log("Could not instantiate DataSource due to invalid live database","error",this.toString());return }this.liveData=oLiveData;this._oQueue={interval:null,conn:null,requests:[]};this.responseSchema={};if(oConfigs&&(oConfigs.constructor==Object)){for(var sConfig in oConfigs){if(sConfig){this[sConfig]=oConfigs[sConfig]}}}var maxCacheEntries=this.maxCacheEntries;if(!lang.isNumber(maxCacheEntries)||(maxCacheEntries<0)){maxCacheEntries=0}this._aIntervals=[];this.createEvent("cacheRequestEvent");this.createEvent("cacheResponseEvent");this.createEvent("requestEvent");this.createEvent("responseEvent");this.createEvent("responseParseEvent");this.createEvent("responseCacheEvent");this.createEvent("dataErrorEvent");this.createEvent("cacheFlushEvent");var DS=util.DataSourceBase;this._sName="DataSource instance"+DS._nIndex;DS._nIndex++;YAHOO.log("DataSource initialized","info",this.toString())};var DS=util.DataSourceBase;lang.augmentObject(DS,{TYPE_UNKNOWN:-1,TYPE_JSARRAY:0,TYPE_JSFUNCTION:1,TYPE_XHR:2,TYPE_JSON:3,TYPE_XML:4,TYPE_TEXT:5,TYPE_HTMLTABLE:6,TYPE_SCRIPTNODE:7,TYPE_LOCAL:8,ERROR_DATAINVALID:"Invalid data",ERROR_DATANULL:"Null data",_nIndex:0,_nTransactionId:0,_getLocationValue:function(field,context){var locator=field.locator||field.key||field,xmldoc=context.ownerDocument||context,result,res,value=null;try{if(!lang.isUndefined(xmldoc.evaluate)){result=xmldoc.evaluate(locator,context,xmldoc.createNSResolver(!context.ownerDocument?context.documentElement:context.ownerDocument.documentElement),0,null);while(res=result.iterateNext()){value=res.textContent}}else{xmldoc.setProperty("SelectionLanguage","XPath");result=context.selectNodes(locator)[0];value=result.value||result.text||null}return value}catch(e){}},issueCallback:function(callback,params,error,scope){if(lang.isFunction(callback)){callback.apply(scope,params)}else{if(lang.isObject(callback)){scope=callback.scope||scope||window;var callbackFunc=callback.success;if(error){callbackFunc=callback.failure}if(callbackFunc){callbackFunc.apply(scope,params.concat([callback.argument]))}}}},parseString:function(oData){if(!lang.isValue(oData)){return null}var string=oData+"";if(lang.isString(string)){return string}else{YAHOO.log("Could not convert data "+lang.dump(oData)+" to type String","warn",this.toString());return null}},parseNumber:function(oData){if(!lang.isValue(oData)||(oData==="")){return null}var number=oData*1;if(lang.isNumber(number)){return number}else{YAHOO.log("Could not convert data "+lang.dump(oData)+" to type Number","warn",this.toString());return null}},convertNumber:function(oData){YAHOO.log("The method YAHOO.util.DataSourceBase.convertNumber() has been deprecated in favor of YAHOO.util.DataSourceBase.parseNumber()","warn",this.toString());return DS.parseNumber(oData)},parseDate:function(oData){var date=null;if(!(oData instanceof Date)){date=new Date(oData)}else{return oData}if(date instanceof Date){return date}else{YAHOO.log("Could not convert data "+lang.dump(oData)+" to type Date","warn",this.toString());return null}},convertDate:function(oData){YAHOO.log("The method YAHOO.util.DataSourceBase.convertDate() has been deprecated in favor of YAHOO.util.DataSourceBase.parseDate()","warn",this.toString());return DS.parseDate(oData)}});DS.Parser={string:DS.parseString,number:DS.parseNumber,date:DS.parseDate};DS.prototype={_sName:null,_aCache:null,_oQueue:null,_aIntervals:null,maxCacheEntries:0,liveData:null,dataType:DS.TYPE_UNKNOWN,responseType:DS.TYPE_UNKNOWN,responseSchema:null,useXPath:false,toString:function(){return this._sName},getCachedResponse:function(oRequest,oCallback,oCaller){var aCache=this._aCache;if(this.maxCacheEntries>0){if(!aCache){this._aCache=[];YAHOO.log("Cache initialized","info",this.toString())}else{var nCacheLength=aCache.length;if(nCacheLength>0){var oResponse=null;this.fireEvent("cacheRequestEvent",{request:oRequest,callback:oCallback,caller:oCaller});for(var i=nCacheLength-1;i>=0;i--){var oCacheElem=aCache[i];if(this.isCacheHit(oRequest,oCacheElem.request)){oResponse=oCacheElem.response;this.fireEvent("cacheResponseEvent",{request:oRequest,response:oResponse,callback:oCallback,caller:oCaller});if(i<nCacheLength-1){aCache.splice(i,1);this.addToCache(oRequest,oResponse);YAHOO.log('Refreshed cache position of the response for "'+oRequest+'"',"info",this.toString())}oResponse.cached=true;break}}YAHOO.log('The cached response for "'+lang.dump(oRequest)+'" is '+lang.dump(oResponse),"info",this.toString());return oResponse}}}else{if(aCache){this._aCache=null;YAHOO.log("Cache destroyed","info",this.toString())}}return null},isCacheHit:function(oRequest,oCachedRequest){return(oRequest===oCachedRequest)},addToCache:function(oRequest,oResponse){var aCache=this._aCache;if(!aCache){return }while(aCache.length>=this.maxCacheEntries){aCache.shift()}var oCacheElem={request:oRequest,response:oResponse};aCache[aCache.length]=oCacheElem;this.fireEvent("responseCacheEvent",{request:oRequest,response:oResponse});YAHOO.log('Cached the response for "'+oRequest+'"',"info",this.toString())},flushCache:function(){if(this._aCache){this._aCache=[];this.fireEvent("cacheFlushEvent");YAHOO.log("Flushed the cache","info",this.toString())}},setInterval:function(nMsec,oRequest,oCallback,oCaller){if(lang.isNumber(nMsec)&&(nMsec>=0)){YAHOO.log('Enabling polling to live data for "'+oRequest+'" at interval '+nMsec,"info",this.toString());var oSelf=this;var nId=setInterval(function(){oSelf.makeConnection(oRequest,oCallback,oCaller)},nMsec);this._aIntervals.push(nId);return nId}else{YAHOO.log('Could not enable polling to live data for "'+oRequest+'" at interval '+nMsec,"info",this.toString())}},clearInterval:function(nId){var tracker=this._aIntervals||[];for(var i=tracker.length-1;i>-1;i--){if(tracker[i]===nId){tracker.splice(i,1);clearInterval(nId)}}},clearAllIntervals:function(){var tracker=this._aIntervals||[];for(var i=tracker.length-1;i>-1;i--){clearInterval(tracker[i])}tracker=[]},sendRequest:function(oRequest,oCallback,oCaller){var oCachedResponse=this.getCachedResponse(oRequest,oCallback,oCaller);if(oCachedResponse){DS.issueCallback(oCallback,[oRequest,oCachedResponse],false,oCaller);return null}YAHOO.log('Making connection to live data for "'+oRequest+'"',"info",this.toString());return this.makeConnection(oRequest,oCallback,oCaller)},makeConnection:function(oRequest,oCallback,oCaller){var tId=DS._nTransactionId++;this.fireEvent("requestEvent",{tId:tId,request:oRequest,callback:oCallback,caller:oCaller});var oRawResponse=this.liveData;this.handleResponse(oRequest,oRawResponse,oCallback,oCaller,tId);return tId},handleResponse:function(oRequest,oRawResponse,oCallback,oCaller,tId){this.fireEvent("responseEvent",{tId:tId,request:oRequest,response:oRawResponse,callback:oCallback,caller:oCaller});YAHOO.log('Received live data response for "'+oRequest+'"',"info",this.toString());var xhr=(this.dataType==DS.TYPE_XHR)?true:false;var oParsedResponse=null;var oFullResponse=oRawResponse;if(this.responseType===DS.TYPE_UNKNOWN){var ctype=(oRawResponse&&oRawResponse.getResponseHeader)?oRawResponse.getResponseHeader["Content-Type"]:null;if(ctype){if(ctype.indexOf("text/xml")>-1){this.responseType=DS.TYPE_XML}else{if(ctype.indexOf("application/json")>-1){this.responseType=DS.TYPE_JSON}else{if(ctype.indexOf("text/plain")>-1){this.responseType=DS.TYPE_TEXT}}}}else{if(YAHOO.lang.isArray(oRawResponse)){this.responseType=DS.TYPE_JSARRAY}else{if(oRawResponse&&oRawResponse.nodeType&&(oRawResponse.nodeType===9||oRawResponse.nodeType===1||oRawResponse.nodeType===11)){this.responseType=DS.TYPE_XML}else{if(oRawResponse&&oRawResponse.nodeName&&(oRawResponse.nodeName.toLowerCase()=="table")){this.responseType=DS.TYPE_HTMLTABLE}else{if(YAHOO.lang.isObject(oRawResponse)){this.responseType=DS.TYPE_JSON}else{if(YAHOO.lang.isString(oRawResponse)){this.responseType=DS.TYPE_TEXT}}}}}}}switch(this.responseType){case DS.TYPE_JSARRAY:if(xhr&&oRawResponse&&oRawResponse.responseText){oFullResponse=oRawResponse.responseText}try{if(lang.isString(oFullResponse)){var parseArgs=[oFullResponse].concat(this.parseJSONArgs);if(lang.JSON){oFullResponse=lang.JSON.parse.apply(lang.JSON,parseArgs)}else{if(window.JSON&&JSON.parse){oFullResponse=JSON.parse.apply(JSON,parseArgs)}else{if(oFullResponse.parseJSON){oFullResponse=oFullResponse.parseJSON.apply(oFullResponse,parseArgs.slice(1))}else{while(oFullResponse.length>0&&(oFullResponse.charAt(0)!="{")&&(oFullResponse.charAt(0)!="[")){oFullResponse=oFullResponse.substring(1,oFullResponse.length)}if(oFullResponse.length>0){var arrayEnd=Math.max(oFullResponse.lastIndexOf("]"),oFullResponse.lastIndexOf("}"));oFullResponse=oFullResponse.substring(0,arrayEnd+1);oFullResponse=eval("("+oFullResponse+")")}}}}}}catch(e1){}oFullResponse=this.doBeforeParseData(oRequest,oFullResponse,oCallback);oParsedResponse=this.parseArrayData(oRequest,oFullResponse);break;case DS.TYPE_JSON:if(xhr&&oRawResponse&&oRawResponse.responseText){oFullResponse=oRawResponse.responseText}try{if(lang.isString(oFullResponse)){var parseArgs=[oFullResponse].concat(this.parseJSONArgs);if(lang.JSON){oFullResponse=lang.JSON.parse.apply(lang.JSON,parseArgs)}else{if(window.JSON&&JSON.parse){oFullResponse=JSON.parse.apply(JSON,parseArgs)}else{if(oFullResponse.parseJSON){oFullResponse=oFullResponse.parseJSON.apply(oFullResponse,parseArgs.slice(1))}else{while(oFullResponse.length>0&&(oFullResponse.charAt(0)!="{")&&(oFullResponse.charAt(0)!="[")){oFullResponse=oFullResponse.substring(1,oFullResponse.length)}if(oFullResponse.length>0){var objEnd=Math.max(oFullResponse.lastIndexOf("]"),oFullResponse.lastIndexOf("}"));oFullResponse=oFullResponse.substring(0,objEnd+1);oFullResponse=eval("("+oFullResponse+")")}}}}}}catch(e){}oFullResponse=this.doBeforeParseData(oRequest,oFullResponse,oCallback);oParsedResponse=this.parseJSONData(oRequest,oFullResponse);break;case DS.TYPE_HTMLTABLE:if(xhr&&oRawResponse.responseText){var el=document.createElement("div");el.innerHTML=oRawResponse.responseText;oFullResponse=el.getElementsByTagName("table")[0]}oFullResponse=this.doBeforeParseData(oRequest,oFullResponse,oCallback);oParsedResponse=this.parseHTMLTableData(oRequest,oFullResponse);break;case DS.TYPE_XML:if(xhr&&oRawResponse.responseXML){oFullResponse=oRawResponse.responseXML}oFullResponse=this.doBeforeParseData(oRequest,oFullResponse,oCallback);oParsedResponse=this.parseXMLData(oRequest,oFullResponse);break;case DS.TYPE_TEXT:if(xhr&&lang.isString(oRawResponse.responseText)){oFullResponse=oRawResponse.responseText}oFullResponse=this.doBeforeParseData(oRequest,oFullResponse,oCallback);oParsedResponse=this.parseTextData(oRequest,oFullResponse);break;default:oFullResponse=this.doBeforeParseData(oRequest,oFullResponse,oCallback);oParsedResponse=this.parseData(oRequest,oFullResponse);break}oParsedResponse=oParsedResponse||{};if(!oParsedResponse.results){oParsedResponse.results=[]}if(!oParsedResponse.meta){oParsedResponse.meta={}}if(!oParsedResponse.error){oParsedResponse=this.doBeforeCallback(oRequest,oFullResponse,oParsedResponse,oCallback);this.fireEvent("responseParseEvent",{request:oRequest,response:oParsedResponse,callback:oCallback,caller:oCaller});this.addToCache(oRequest,oParsedResponse)}else{oParsedResponse.error=true;this.fireEvent("dataErrorEvent",{request:oRequest,response:oRawResponse,callback:oCallback,caller:oCaller,message:DS.ERROR_DATANULL});YAHOO.log(DS.ERROR_DATANULL,"error",this.toString())}oParsedResponse.tId=tId;DS.issueCallback(oCallback,[oRequest,oParsedResponse],oParsedResponse.error,oCaller)},doBeforeParseData:function(oRequest,oFullResponse,oCallback){return oFullResponse},doBeforeCallback:function(oRequest,oFullResponse,oParsedResponse,oCallback){return oParsedResponse},parseData:function(oRequest,oFullResponse){if(lang.isValue(oFullResponse)){var oParsedResponse={results:oFullResponse,meta:{}};YAHOO.log("Parsed generic data is "+lang.dump(oParsedResponse),"info",this.toString());return oParsedResponse}YAHOO.log("Generic data could not be parsed: "+lang.dump(oFullResponse),"error",this.toString());return null},parseArrayData:function(oRequest,oFullResponse){if(lang.isArray(oFullResponse)){var results=[],i,j,rec,field,data;if(lang.isArray(this.responseSchema.fields)){var fields=this.responseSchema.fields;for(i=fields.length-1;i>=0;--i){if(typeof fields[i]!=="object"){fields[i]={key:fields[i]}}}var parsers={},p;for(i=fields.length-1;i>=0;--i){p=(typeof fields[i].parser==="function"?fields[i].parser:DS.Parser[fields[i].parser+""])||fields[i].converter;if(p){parsers[fields[i].key]=p}}var arrType=lang.isArray(oFullResponse[0]);for(i=oFullResponse.length-1;i>-1;i--){var oResult={};rec=oFullResponse[i];if(typeof rec==="object"){for(j=fields.length-1;j>-1;j--){field=fields[j];data=arrType?rec[j]:rec[field.key];if(parsers[field.key]){data=parsers[field.key].call(this,data)}if(data===undefined){data=null}oResult[field.key]=data}}else{if(lang.isString(rec)){for(j=fields.length-1;j>-1;j--){field=fields[j];data=rec;if(parsers[field.key]){data=parsers[field.key].call(this,data)}if(data===undefined){data=null}oResult[field.key]=data}}}results[i]=oResult}}else{results=oFullResponse}var oParsedResponse={results:results};YAHOO.log("Parsed array data is "+lang.dump(oParsedResponse),"info",this.toString());return oParsedResponse}YAHOO.log("Array data could not be parsed: "+lang.dump(oFullResponse),"error",this.toString());return null},parseTextData:function(oRequest,oFullResponse){if(lang.isString(oFullResponse)){if(lang.isString(this.responseSchema.recordDelim)&&lang.isString(this.responseSchema.fieldDelim)){var oParsedResponse={results:[]};var recDelim=this.responseSchema.recordDelim;var fieldDelim=this.responseSchema.fieldDelim;if(oFullResponse.length>0){var newLength=oFullResponse.length-recDelim.length;if(oFullResponse.substr(newLength)==recDelim){oFullResponse=oFullResponse.substr(0,newLength)}if(oFullResponse.length>0){var recordsarray=oFullResponse.split(recDelim);for(var i=0,len=recordsarray.length,recIdx=0;i<len;++i){var bError=false,sRecord=recordsarray[i];if(lang.isString(sRecord)&&(sRecord.length>0)){var fielddataarray=recordsarray[i].split(fieldDelim);var oResult={};if(lang.isArray(this.responseSchema.fields)){var fields=this.responseSchema.fields;for(var j=fields.length-1;j>-1;j--){try{var data=fielddataarray[j];if(lang.isString(data)){if(data.charAt(0)=='"'){data=data.substr(1)}if(data.charAt(data.length-1)=='"'){data=data.substr(0,data.length-1)}var field=fields[j];var key=(lang.isValue(field.key))?field.key:field;if(!field.parser&&field.converter){field.parser=field.converter;YAHOO.log("The field property converter has been deprecated in favor of parser","warn",this.toString())}var parser=(typeof field.parser==="function")?field.parser:DS.Parser[field.parser+""];if(parser){data=parser.call(this,data)}if(data===undefined){data=null}oResult[key]=data}else{bError=true}}catch(e){bError=true}}}else{oResult=fielddataarray}if(!bError){oParsedResponse.results[recIdx++]=oResult}}}}}YAHOO.log("Parsed text data is "+lang.dump(oParsedResponse),"info",this.toString());return oParsedResponse}}YAHOO.log("Text data could not be parsed: "+lang.dump(oFullResponse),"error",this.toString());return null},parseXMLResult:function(result){var oResult={},schema=this.responseSchema;try{for(var m=schema.fields.length-1;m>=0;m--){var field=schema.fields[m];var key=(lang.isValue(field.key))?field.key:field;var data=null;if(this.useXPath){data=YAHOO.util.DataSource._getLocationValue(field,result)}else{var xmlAttr=result.attributes.getNamedItem(key);if(xmlAttr){data=xmlAttr.value}else{var xmlNode=result.getElementsByTagName(key);if(xmlNode&&xmlNode.item(0)){var item=xmlNode.item(0);data=(item)?((item.text)?item.text:(item.textContent)?item.textContent:null):null;if(!data){var datapieces=[];for(var j=0,len=item.childNodes.length;j<len;j++){if(item.childNodes[j].nodeValue){datapieces[datapieces.length]=item.childNodes[j].nodeValue}}if(datapieces.length>0){data=datapieces.join("")}}}}}if(data===null){data=""}if(!field.parser&&field.converter){field.parser=field.converter;YAHOO.log("The field property converter has been deprecated in favor of parser","warn",this.toString())}var parser=(typeof field.parser==="function")?field.parser:DS.Parser[field.parser+""];if(parser){data=parser.call(this,data)}if(data===undefined){data=null}oResult[key]=data}}catch(e){YAHOO.log("Error while parsing XML result: "+e.message)}return oResult},parseXMLData:function(oRequest,oFullResponse){var bError=false,schema=this.responseSchema,oParsedResponse={meta:{}},xmlList=null,metaNode=schema.metaNode,metaLocators=schema.metaFields||{},i,k,loc,v;try{if(this.useXPath){for(k in metaLocators){oParsedResponse.meta[k]=YAHOO.util.DataSource._getLocationValue(metaLocators[k],oFullResponse)}}else{metaNode=metaNode?oFullResponse.getElementsByTagName(metaNode)[0]:oFullResponse;if(metaNode){for(k in metaLocators){if(lang.hasOwnProperty(metaLocators,k)){loc=metaLocators[k];v=metaNode.getElementsByTagName(loc)[0];if(v){v=v.firstChild.nodeValue}else{v=metaNode.attributes.getNamedItem(loc);if(v){v=v.value}}if(lang.isValue(v)){oParsedResponse.meta[k]=v}}}}}xmlList=(schema.resultNode)?oFullResponse.getElementsByTagName(schema.resultNode):null}catch(e){YAHOO.log("Error while parsing XML data: "+e.message)}if(!xmlList||!lang.isArray(schema.fields)){bError=true}else{oParsedResponse.results=[];for(i=xmlList.length-1;i>=0;--i){var oResult=this.parseXMLResult(xmlList.item(i));oParsedResponse.results[i]=oResult}}if(bError){YAHOO.log("XML data could not be parsed: "+lang.dump(oFullResponse),"error",this.toString());oParsedResponse.error=true}else{YAHOO.log("Parsed XML data is "+lang.dump(oParsedResponse),"info",this.toString())}return oParsedResponse},parseJSONData:function(oRequest,oFullResponse){var oParsedResponse={results:[],meta:{}};if(lang.isObject(oFullResponse)&&this.responseSchema.resultsList){var schema=this.responseSchema,fields=schema.fields,resultsList=oFullResponse,results=[],metaFields=schema.metaFields||{},fieldParsers=[],fieldPaths=[],simpleFields=[],bError=false,i,len,j,v,key,parser,path;var buildPath=function(needle){var path=null,keys=[],i=0;if(needle){needle=needle.replace(/\[(['"])(.*?)\1\]/g,function(x,$1,$2){keys[i]=$2;return".@"+(i++)}).replace(/\[(\d+)\]/g,function(x,$1){keys[i]=parseInt($1,10)|0;return".@"+(i++)}).replace(/^\./,"");if(!/[^\w\.\$@]/.test(needle)){path=needle.split(".");for(i=path.length-1;i>=0;--i){if(path[i].charAt(0)==="@"){path[i]=keys[parseInt(path[i].substr(1),10)]}}}else{YAHOO.log("Invalid locator: "+needle,"error",this.toString())}}return path};var walkPath=function(path,origin){var v=origin,i=0,len=path.length;for(;i<len&&v;++i){v=v[path[i]]}return v};path=buildPath(schema.resultsList);if(path){resultsList=walkPath(path,oFullResponse);if(resultsList===undefined){bError=true}}else{bError=true}if(!resultsList){resultsList=[]}if(!lang.isArray(resultsList)){resultsList=[resultsList]}if(!bError){if(schema.fields){var field;for(i=0,len=fields.length;i<len;i++){field=fields[i];key=field.key||field;parser=((typeof field.parser==="function")?field.parser:DS.Parser[field.parser+""])||field.converter;path=buildPath(key);if(parser){fieldParsers[fieldParsers.length]={key:key,parser:parser}}if(path){if(path.length>1){fieldPaths[fieldPaths.length]={key:key,path:path}}else{simpleFields[simpleFields.length]={key:key,path:path[0]}}}else{YAHOO.log("Invalid key syntax: "+key,"warn",this.toString())}}for(i=resultsList.length-1;i>=0;--i){var r=resultsList[i],rec={};if(r){for(j=simpleFields.length-1;j>=0;--j){rec[simpleFields[j].key]=(r[simpleFields[j].path]!==undefined)?r[simpleFields[j].path]:r[j]}for(j=fieldPaths.length-1;j>=0;--j){rec[fieldPaths[j].key]=walkPath(fieldPaths[j].path,r)}for(j=fieldParsers.length-1;j>=0;--j){var p=fieldParsers[j].key;rec[p]=fieldParsers[j].parser(rec[p]);if(rec[p]===undefined){rec[p]=null}}}results[i]=rec}}else{results=resultsList}for(key in metaFields){if(lang.hasOwnProperty(metaFields,key)){path=buildPath(metaFields[key]);if(path){v=walkPath(path,oFullResponse);oParsedResponse.meta[key]=v}}}}else{YAHOO.log("JSON data could not be parsed due to invalid responseSchema.resultsList or invalid response: "+lang.dump(oFullResponse),"error",this.toString());oParsedResponse.error=true}oParsedResponse.results=results}else{YAHOO.log("JSON data could not be parsed: "+lang.dump(oFullResponse),"error",this.toString());oParsedResponse.error=true}return oParsedResponse},parseHTMLTableData:function(oRequest,oFullResponse){var bError=false;var elTable=oFullResponse;var fields=this.responseSchema.fields;var oParsedResponse={results:[]};if(lang.isArray(fields)){for(var i=0;i<elTable.tBodies.length;i++){var elTbody=elTable.tBodies[i];for(var j=elTbody.rows.length-1;j>-1;j--){var elRow=elTbody.rows[j];var oResult={};for(var k=fields.length-1;k>-1;k--){var field=fields[k];var key=(lang.isValue(field.key))?field.key:field;var data=elRow.cells[k].innerHTML;if(!field.parser&&field.converter){field.parser=field.converter;YAHOO.log("The field property converter has been deprecated in favor of parser","warn",this.toString())}var parser=(typeof field.parser==="function")?field.parser:DS.Parser[field.parser+""];if(parser){data=parser.call(this,data)}if(data===undefined){data=null}oResult[key]=data}oParsedResponse.results[j]=oResult}}}else{bError=true;YAHOO.log("Invalid responseSchema.fields","error",this.toString())}if(bError){YAHOO.log("HTML TABLE data could not be parsed: "+lang.dump(oFullResponse),"error",this.toString());oParsedResponse.error=true}else{YAHOO.log("Parsed HTML TABLE data is "+lang.dump(oParsedResponse),"info",this.toString())}return oParsedResponse}};lang.augmentProto(DS,util.EventProvider);util.LocalDataSource=function(oLiveData,oConfigs){this.dataType=DS.TYPE_LOCAL;if(oLiveData){if(YAHOO.lang.isArray(oLiveData)){this.responseType=DS.TYPE_JSARRAY}else{if(oLiveData.nodeType&&oLiveData.nodeType==9){this.responseType=DS.TYPE_XML}else{if(oLiveData.nodeName&&(oLiveData.nodeName.toLowerCase()=="table")){this.responseType=DS.TYPE_HTMLTABLE;oLiveData=oLiveData.cloneNode(true)}else{if(YAHOO.lang.isString(oLiveData)){this.responseType=DS.TYPE_TEXT}else{if(YAHOO.lang.isObject(oLiveData)){this.responseType=DS.TYPE_JSON}}}}}}else{oLiveData=[];this.responseType=DS.TYPE_JSARRAY}util.LocalDataSource.superclass.constructor.call(this,oLiveData,oConfigs)};lang.extend(util.LocalDataSource,DS);lang.augmentObject(util.LocalDataSource,DS);util.FunctionDataSource=function(oLiveData,oConfigs){this.dataType=DS.TYPE_JSFUNCTION;oLiveData=oLiveData||function(){};util.FunctionDataSource.superclass.constructor.call(this,oLiveData,oConfigs)};lang.extend(util.FunctionDataSource,DS,{scope:null,makeConnection:function(oRequest,oCallback,oCaller){var tId=DS._nTransactionId++;this.fireEvent("requestEvent",{tId:tId,request:oRequest,callback:oCallback,caller:oCaller});var oRawResponse=(this.scope)?this.liveData.call(this.scope,oRequest,this):this.liveData(oRequest);if(this.responseType===DS.TYPE_UNKNOWN){if(YAHOO.lang.isArray(oRawResponse)){this.responseType=DS.TYPE_JSARRAY}else{if(oRawResponse&&oRawResponse.nodeType&&oRawResponse.nodeType==9){this.responseType=DS.TYPE_XML}else{if(oRawResponse&&oRawResponse.nodeName&&(oRawResponse.nodeName.toLowerCase()=="table")){this.responseType=DS.TYPE_HTMLTABLE}else{if(YAHOO.lang.isObject(oRawResponse)){this.responseType=DS.TYPE_JSON}else{if(YAHOO.lang.isString(oRawResponse)){this.responseType=DS.TYPE_TEXT}}}}}}this.handleResponse(oRequest,oRawResponse,oCallback,oCaller,tId);return tId}});lang.augmentObject(util.FunctionDataSource,DS);util.ScriptNodeDataSource=function(oLiveData,oConfigs){this.dataType=DS.TYPE_SCRIPTNODE;oLiveData=oLiveData||"";util.ScriptNodeDataSource.superclass.constructor.call(this,oLiveData,oConfigs)};lang.extend(util.ScriptNodeDataSource,DS,{getUtility:util.Get,asyncMode:"allowAll",scriptCallbackParam:"callback",generateRequestCallback:function(id){return"&"+this.scriptCallbackParam+"=YAHOO.util.ScriptNodeDataSource.callbacks["+id+"]"},doBeforeGetScriptNode:function(sUri){return sUri},makeConnection:function(oRequest,oCallback,oCaller){var tId=DS._nTransactionId++;this.fireEvent("requestEvent",{tId:tId,request:oRequest,callback:oCallback,caller:oCaller});if(util.ScriptNodeDataSource._nPending===0){util.ScriptNodeDataSource.callbacks=[];util.ScriptNodeDataSource._nId=0}var id=util.ScriptNodeDataSource._nId;util.ScriptNodeDataSource._nId++;var oSelf=this;util.ScriptNodeDataSource.callbacks[id]=function(oRawResponse){if((oSelf.asyncMode!=="ignoreStaleResponses")||(id===util.ScriptNodeDataSource.callbacks.length-1)){if(oSelf.responseType===DS.TYPE_UNKNOWN){if(YAHOO.lang.isArray(oRawResponse)){oSelf.responseType=DS.TYPE_JSARRAY}else{if(oRawResponse.nodeType&&oRawResponse.nodeType==9){oSelf.responseType=DS.TYPE_XML}else{if(oRawResponse.nodeName&&(oRawResponse.nodeName.toLowerCase()=="table")){oSelf.responseType=DS.TYPE_HTMLTABLE}else{if(YAHOO.lang.isObject(oRawResponse)){oSelf.responseType=DS.TYPE_JSON}else{if(YAHOO.lang.isString(oRawResponse)){oSelf.responseType=DS.TYPE_TEXT}}}}}}oSelf.handleResponse(oRequest,oRawResponse,oCallback,oCaller,tId)}else{YAHOO.log("DataSource ignored stale response for tId "+tId+"("+oRequest+")","info",oSelf.toString())}delete util.ScriptNodeDataSource.callbacks[id]};util.ScriptNodeDataSource._nPending++;var sUri=this.liveData+oRequest+this.generateRequestCallback(id);sUri=this.doBeforeGetScriptNode(sUri);YAHOO.log("DataSource is querying URL "+sUri,"info",this.toString());this.getUtility.script(sUri,{autopurge:true,onsuccess:util.ScriptNodeDataSource._bumpPendingDown,onfail:util.ScriptNodeDataSource._bumpPendingDown});return tId}});lang.augmentObject(util.ScriptNodeDataSource,DS);lang.augmentObject(util.ScriptNodeDataSource,{_nId:0,_nPending:0,callbacks:[]});util.XHRDataSource=function(oLiveData,oConfigs){this.dataType=DS.TYPE_XHR;this.connMgr=this.connMgr||util.Connect;oLiveData=oLiveData||"";util.XHRDataSource.superclass.constructor.call(this,oLiveData,oConfigs)};lang.extend(util.XHRDataSource,DS,{connMgr:null,connXhrMode:"allowAll",connMethodPost:false,connTimeout:0,makeConnection:function(oRequest,oCallback,oCaller){var oRawResponse=null;var tId=DS._nTransactionId++;this.fireEvent("requestEvent",{tId:tId,request:oRequest,callback:oCallback,caller:oCaller});var oSelf=this;var oConnMgr=this.connMgr;var oQueue=this._oQueue;var _xhrSuccess=function(oResponse){if(oResponse&&(this.connXhrMode=="ignoreStaleResponses")&&(oResponse.tId!=oQueue.conn.tId)){YAHOO.log("Ignored stale response","warn",this.toString());return null}else{if(!oResponse){this.fireEvent("dataErrorEvent",{request:oRequest,response:null,callback:oCallback,caller:oCaller,message:DS.ERROR_DATANULL});YAHOO.log(DS.ERROR_DATANULL,"error",this.toString());DS.issueCallback(oCallback,[oRequest,{error:true}],true,oCaller);return null}else{if(this.responseType===DS.TYPE_UNKNOWN){var ctype=(oResponse.getResponseHeader)?oResponse.getResponseHeader["Content-Type"]:null;if(ctype){if(ctype.indexOf("text/xml")>-1){this.responseType=DS.TYPE_XML}else{if(ctype.indexOf("application/json")>-1){this.responseType=DS.TYPE_JSON}else{if(ctype.indexOf("text/plain")>-1){this.responseType=DS.TYPE_TEXT}}}}}this.handleResponse(oRequest,oResponse,oCallback,oCaller,tId)}}};var _xhrFailure=function(oResponse){this.fireEvent("dataErrorEvent",{request:oRequest,response:oResponse,callback:oCallback,caller:oCaller,message:DS.ERROR_DATAINVALID});YAHOO.log(DS.ERROR_DATAINVALID+": "+oResponse.statusText,"error",this.toString());if(lang.isString(this.liveData)&&lang.isString(oRequest)&&(this.liveData.lastIndexOf("?")!==this.liveData.length-1)&&(oRequest.indexOf("?")!==0)){YAHOO.log('DataSources using XHR no longer automatically supply a "?" between the host and query parameters -- please check that the request URL is correct',"warn",this.toString())}oResponse=oResponse||{};oResponse.error=true;DS.issueCallback(oCallback,[oRequest,oResponse],true,oCaller);return null};var _xhrCallback={success:_xhrSuccess,failure:_xhrFailure,scope:this};if(lang.isNumber(this.connTimeout)){_xhrCallback.timeout=this.connTimeout}if(this.connXhrMode=="cancelStaleRequests"){if(oQueue.conn){if(oConnMgr.abort){oConnMgr.abort(oQueue.conn);oQueue.conn=null;YAHOO.log("Canceled stale request","warn",this.toString())}else{YAHOO.log("Could not find Connection Manager abort() function","error",this.toString())}}}if(oConnMgr&&oConnMgr.asyncRequest){var sLiveData=this.liveData;var isPost=this.connMethodPost;var sMethod=(isPost)?"POST":"GET";var sUri=(isPost||!lang.isValue(oRequest))?sLiveData:sLiveData+oRequest;var sRequest=(isPost)?oRequest:null;if(this.connXhrMode!="queueRequests"){oQueue.conn=oConnMgr.asyncRequest(sMethod,sUri,_xhrCallback,sRequest)}else{if(oQueue.conn){var allRequests=oQueue.requests;allRequests.push({request:oRequest,callback:_xhrCallback});if(!oQueue.interval){oQueue.interval=setInterval(function(){if(oConnMgr.isCallInProgress(oQueue.conn)){return }else{if(allRequests.length>0){sUri=(isPost||!lang.isValue(allRequests[0].request))?sLiveData:sLiveData+allRequests[0].request;sRequest=(isPost)?allRequests[0].request:null;oQueue.conn=oConnMgr.asyncRequest(sMethod,sUri,allRequests[0].callback,sRequest);allRequests.shift()}else{clearInterval(oQueue.interval);oQueue.interval=null}}},50)}}else{oQueue.conn=oConnMgr.asyncRequest(sMethod,sUri,_xhrCallback,sRequest)}}}else{YAHOO.log("Could not find Connection Manager asyncRequest() function","error",this.toString());DS.issueCallback(oCallback,[oRequest,{error:true}],true,oCaller)}return tId}});lang.augmentObject(util.XHRDataSource,DS);util.DataSource=function(oLiveData,oConfigs){oConfigs=oConfigs||{};var dataType=oConfigs.dataType;if(dataType){if(dataType==DS.TYPE_LOCAL){lang.augmentObject(util.DataSource,util.LocalDataSource);return new util.LocalDataSource(oLiveData,oConfigs)}else{if(dataType==DS.TYPE_XHR){lang.augmentObject(util.DataSource,util.XHRDataSource);return new util.XHRDataSource(oLiveData,oConfigs)}else{if(dataType==DS.TYPE_SCRIPTNODE){lang.augmentObject(util.DataSource,util.ScriptNodeDataSource);return new util.ScriptNodeDataSource(oLiveData,oConfigs)}else{if(dataType==DS.TYPE_JSFUNCTION){lang.augmentObject(util.DataSource,util.FunctionDataSource);return new util.FunctionDataSource(oLiveData,oConfigs)}}}}}if(YAHOO.lang.isString(oLiveData)){lang.augmentObject(util.DataSource,util.XHRDataSource);return new util.XHRDataSource(oLiveData,oConfigs)}else{if(YAHOO.lang.isFunction(oLiveData)){lang.augmentObject(util.DataSource,util.FunctionDataSource);return new util.FunctionDataSource(oLiveData,oConfigs)}else{lang.augmentObject(util.DataSource,util.LocalDataSource);return new util.LocalDataSource(oLiveData,oConfigs)}}};lang.augmentObject(util.DataSource,DS)})();YAHOO.util.Number={format:function(B,E){if(!isFinite(+B)){return""}B=!isFinite(+B)?0:+B;E=YAHOO.lang.merge(YAHOO.util.Number.format.defaults,(E||{}));var C=B<0,F=Math.abs(B),A=E.decimalPlaces,I=E.thousandsSeparator,H,G,D;if(A<0){H=F-(F%1)+"";D=H.length+A;if(D>0){H=Number("."+H).toFixed(D).slice(2)+new Array(H.length-D+1).join("0")}else{H="0"}}else{H=F<1&&F>=0.5&&!A?"1":F.toFixed(A)}if(F>1000){G=H.split(/\D/);D=G[0].length%3||3;G[0]=G[0].slice(0,D)+G[0].slice(D).replace(/(\d{3})/g,I+"$1");H=G.join(E.decimalSeparator)}H=E.prefix+H+E.suffix;return C?E.negativeFormat.replace(/#/,H):H}};YAHOO.util.Number.format.defaults={decimalSeparator:".",decimalPlaces:null,thousandsSeparator:"",prefix:"",suffix:"",negativeFormat:"-#"};(function(){var A=function(C,E,D){if(typeof D==="undefined"){D=10}for(;parseInt(C,10)<D&&D>1;D/=10){C=E.toString()+C}return C.toString()};var B={formats:{a:function(D,C){return C.a[D.getDay()]},A:function(D,C){return C.A[D.getDay()]},b:function(D,C){return C.b[D.getMonth()]},B:function(D,C){return C.B[D.getMonth()]},C:function(C){return A(parseInt(C.getFullYear()/100,10),0)},d:["getDate","0"],e:["getDate"," "],g:function(C){return A(parseInt(B.formats.G(C)%100,10),0)},G:function(E){var F=E.getFullYear();var D=parseInt(B.formats.V(E),10);var C=parseInt(B.formats.W(E),10);if(C>D){F++}else{if(C===0&&D>=52){F--}}return F},H:["getHours","0"],I:function(D){var C=D.getHours()%12;return A(C===0?12:C,0)},j:function(G){var F=new Date(""+G.getFullYear()+"/1/1 GMT");var D=new Date(""+G.getFullYear()+"/"+(G.getMonth()+1)+"/"+G.getDate()+" GMT");var C=D-F;var E=parseInt(C/60000/60/24,10)+1;return A(E,0,100)},k:["getHours"," "],l:function(D){var C=D.getHours()%12;return A(C===0?12:C," ")},m:function(C){return A(C.getMonth()+1,0)},M:["getMinutes","0"],p:function(D,C){return C.p[D.getHours()>=12?1:0]},P:function(D,C){return C.P[D.getHours()>=12?1:0]},s:function(D,C){return parseInt(D.getTime()/1000,10)},S:["getSeconds","0"],u:function(C){var D=C.getDay();return D===0?7:D},U:function(F){var C=parseInt(B.formats.j(F),10);var E=6-F.getDay();var D=parseInt((C+E)/7,10);return A(D,0)},V:function(F){var E=parseInt(B.formats.W(F),10);var C=(new Date(""+F.getFullYear()+"/1/1")).getDay();var D=E+(C>4||C<=1?0:1);if(D===53&&(new Date(""+F.getFullYear()+"/12/31")).getDay()<4){D=1}else{if(D===0){D=B.formats.V(new Date(""+(F.getFullYear()-1)+"/12/31"))}}return A(D,0)},w:"getDay",W:function(F){var C=parseInt(B.formats.j(F),10);var E=7-B.formats.u(F);var D=parseInt((C+E)/7,10);return A(D,0,10)},y:function(C){return A(C.getFullYear()%100,0)},Y:"getFullYear",z:function(E){var D=E.getTimezoneOffset();var C=A(parseInt(Math.abs(D/60),10),0);var F=A(Math.abs(D%60),0);return(D>0?"-":"+")+C+F},Z:function(C){var D=C.toString().replace(/^.*:\d\d( GMT[+-]\d+)? \(?([A-Za-z ]+)\)?\d*$/,"$2").replace(/[a-z ]/g,"");if(D.length>4){D=B.formats.z(C)}return D},"%":function(C){return"%"}},aggregates:{c:"locale",D:"%m/%d/%y",F:"%Y-%m-%d",h:"%b",n:"\n",r:"locale",R:"%H:%M",t:"\t",T:"%H:%M:%S",x:"locale",X:"locale"},format:function(G,F,D){F=F||{};if(!(G instanceof Date)){return YAHOO.lang.isValue(G)?G:""}var H=F.format||"%m/%d/%Y";if(H==="YYYY/MM/DD"){H="%Y/%m/%d"}else{if(H==="DD/MM/YYYY"){H="%d/%m/%Y"}else{if(H==="MM/DD/YYYY"){H="%m/%d/%Y"}}}D=D||"en";if(!(D in YAHOO.util.DateLocale)){if(D.replace(/-[a-zA-Z]+$/,"") in YAHOO.util.DateLocale){D=D.replace(/-[a-zA-Z]+$/,"")}else{D="en"}}var J=YAHOO.util.DateLocale[D];var C=function(L,K){var M=B.aggregates[K];return(M==="locale"?J[K]:M)};var E=function(L,K){var M=B.formats[K];if(typeof M==="string"){return G[M]()}else{if(typeof M==="function"){return M.call(G,G,J)}else{if(typeof M==="object"&&typeof M[0]==="string"){return A(G[M[0]](),M[1])}else{return K}}}};while(H.match(/%[cDFhnrRtTxX]/)){H=H.replace(/%([cDFhnrRtTxX])/g,C)}var I=H.replace(/%([aAbBCdegGHIjklmMpPsSuUVwWyYzZ%])/g,E);C=E=undefined;return I}};YAHOO.namespace("YAHOO.util");YAHOO.util.Date=B;YAHOO.util.DateLocale={a:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],A:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],b:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],B:["January","February","March","April","May","June","July","August","September","October","November","December"],c:"%a %d %b %Y %T %Z",p:["AM","PM"],P:["am","pm"],r:"%I:%M:%S %p",x:"%d/%m/%y",X:"%T"};YAHOO.util.DateLocale.en=YAHOO.lang.merge(YAHOO.util.DateLocale,{});YAHOO.util.DateLocale["en-US"]=YAHOO.lang.merge(YAHOO.util.DateLocale.en,{c:"%a %d %b %Y %I:%M:%S %p %Z",x:"%m/%d/%Y",X:"%I:%M:%S %p"});YAHOO.util.DateLocale["en-GB"]=YAHOO.lang.merge(YAHOO.util.DateLocale.en,{r:"%l:%M:%S %P %Z"});YAHOO.util.DateLocale["en-AU"]=YAHOO.lang.merge(YAHOO.util.DateLocale.en)})();YAHOO.register("datasource",YAHOO.util.DataSource,{version:"2.8.0r4",build:"2449"});YAHOO.widget.DS_JSArray=YAHOO.util.LocalDataSource;YAHOO.widget.DS_JSFunction=YAHOO.util.FunctionDataSource;YAHOO.widget.DS_XHR=function(B,A,D){var C=new YAHOO.util.XHRDataSource(B,D);C._aDeprecatedSchema=A;return C};YAHOO.widget.DS_ScriptNode=function(B,A,D){var C=new YAHOO.util.ScriptNodeDataSource(B,D);C._aDeprecatedSchema=A;return C};YAHOO.widget.DS_XHR.TYPE_JSON=YAHOO.util.DataSourceBase.TYPE_JSON;YAHOO.widget.DS_XHR.TYPE_XML=YAHOO.util.DataSourceBase.TYPE_XML;YAHOO.widget.DS_XHR.TYPE_FLAT=YAHOO.util.DataSourceBase.TYPE_TEXT;YAHOO.widget.AutoComplete=function(G,B,J,C){if(G&&B&&J){if(J&&YAHOO.lang.isFunction(J.sendRequest)){this.dataSource=J}else{YAHOO.log("Could not instantiate AutoComplete due to an invalid DataSource","error",this.toString());return }this.key=0;var D=J.responseSchema;if(J._aDeprecatedSchema){var K=J._aDeprecatedSchema;if(YAHOO.lang.isArray(K)){if((J.responseType===YAHOO.util.DataSourceBase.TYPE_JSON)||(J.responseType===YAHOO.util.DataSourceBase.TYPE_UNKNOWN)){D.resultsList=K[0];this.key=K[1];D.fields=(K.length<3)?null:K.slice(1)}else{if(J.responseType===YAHOO.util.DataSourceBase.TYPE_XML){D.resultNode=K[0];this.key=K[1];D.fields=K.slice(1)}else{if(J.responseType===YAHOO.util.DataSourceBase.TYPE_TEXT){D.recordDelim=K[0];D.fieldDelim=K[1]}}}J.responseSchema=D}}if(YAHOO.util.Dom.inDocument(G)){if(YAHOO.lang.isString(G)){this._sName="instance"+YAHOO.widget.AutoComplete._nIndex+" "+G;this._elTextbox=document.getElementById(G)}else{this._sName=(G.id)?"instance"+YAHOO.widget.AutoComplete._nIndex+" "+G.id:"instance"+YAHOO.widget.AutoComplete._nIndex;this._elTextbox=G}YAHOO.util.Dom.addClass(this._elTextbox,"yui-ac-input")}else{YAHOO.log("Could not instantiate AutoComplete due to an invalid input element","error",this.toString());return }if(YAHOO.util.Dom.inDocument(B)){if(YAHOO.lang.isString(B)){this._elContainer=document.getElementById(B)}else{this._elContainer=B}if(this._elContainer.style.display=="none"){YAHOO.log('The container may not display properly if display is set to "none" in CSS',"warn",this.toString())}var E=this._elContainer.parentNode;var A=E.tagName.toLowerCase();if(A=="div"){YAHOO.util.Dom.addClass(E,"yui-ac")}else{YAHOO.log("Could not find the wrapper element for skinning","warn",this.toString())}}else{YAHOO.log("Could not instantiate AutoComplete due to an invalid container element","error",this.toString());return }if(this.dataSource.dataType===YAHOO.util.DataSourceBase.TYPE_LOCAL){this.applyLocalFilter=true}if(C&&(C.constructor==Object)){for(var I in C){if(I){this[I]=C[I]}}}this._initContainerEl();this._initProps();this._initListEl();this._initContainerHelperEls();var H=this;var F=this._elTextbox;YAHOO.util.Event.addListener(F,"keyup",H._onTextboxKeyUp,H);YAHOO.util.Event.addListener(F,"keydown",H._onTextboxKeyDown,H);YAHOO.util.Event.addListener(F,"focus",H._onTextboxFocus,H);YAHOO.util.Event.addListener(F,"blur",H._onTextboxBlur,H);YAHOO.util.Event.addListener(B,"mouseover",H._onContainerMouseover,H);YAHOO.util.Event.addListener(B,"mouseout",H._onContainerMouseout,H);YAHOO.util.Event.addListener(B,"click",H._onContainerClick,H);YAHOO.util.Event.addListener(B,"scroll",H._onContainerScroll,H);YAHOO.util.Event.addListener(B,"resize",H._onContainerResize,H);YAHOO.util.Event.addListener(F,"keypress",H._onTextboxKeyPress,H);YAHOO.util.Event.addListener(window,"unload",H._onWindowUnload,H);this.textboxFocusEvent=new YAHOO.util.CustomEvent("textboxFocus",this);this.textboxKeyEvent=new YAHOO.util.CustomEvent("textboxKey",this);this.dataRequestEvent=new YAHOO.util.CustomEvent("dataRequest",this);this.dataReturnEvent=new YAHOO.util.CustomEvent("dataReturn",this);this.dataErrorEvent=new YAHOO.util.CustomEvent("dataError",this);this.containerPopulateEvent=new YAHOO.util.CustomEvent("containerPopulate",this);this.containerExpandEvent=new YAHOO.util.CustomEvent("containerExpand",this);this.typeAheadEvent=new YAHOO.util.CustomEvent("typeAhead",this);this.itemMouseOverEvent=new YAHOO.util.CustomEvent("itemMouseOver",this);this.itemMouseOutEvent=new YAHOO.util.CustomEvent("itemMouseOut",this);this.itemArrowToEvent=new YAHOO.util.CustomEvent("itemArrowTo",this);this.itemArrowFromEvent=new YAHOO.util.CustomEvent("itemArrowFrom",this);this.itemSelectEvent=new YAHOO.util.CustomEvent("itemSelect",this);this.unmatchedItemSelectEvent=new YAHOO.util.CustomEvent("unmatchedItemSelect",this);this.selectionEnforceEvent=new YAHOO.util.CustomEvent("selectionEnforce",this);this.containerCollapseEvent=new YAHOO.util.CustomEvent("containerCollapse",this);this.textboxBlurEvent=new YAHOO.util.CustomEvent("textboxBlur",this);this.textboxChangeEvent=new YAHOO.util.CustomEvent("textboxChange",this);F.setAttribute("autocomplete","off");YAHOO.widget.AutoComplete._nIndex++;YAHOO.log("AutoComplete initialized","info",this.toString())}else{YAHOO.log("Could not instantiate AutoComplete due invalid arguments","error",this.toString())}};YAHOO.widget.AutoComplete.prototype.dataSource=null;YAHOO.widget.AutoComplete.prototype.applyLocalFilter=null;YAHOO.widget.AutoComplete.prototype.queryMatchCase=false;YAHOO.widget.AutoComplete.prototype.queryMatchContains=false;YAHOO.widget.AutoComplete.prototype.queryMatchSubset=false;YAHOO.widget.AutoComplete.prototype.minQueryLength=1;YAHOO.widget.AutoComplete.prototype.maxResultsDisplayed=10;YAHOO.widget.AutoComplete.prototype.queryDelay=0.2;YAHOO.widget.AutoComplete.prototype.typeAheadDelay=0.5;YAHOO.widget.AutoComplete.prototype.queryInterval=500;YAHOO.widget.AutoComplete.prototype.highlightClassName="yui-ac-highlight";YAHOO.widget.AutoComplete.prototype.prehighlightClassName=null;YAHOO.widget.AutoComplete.prototype.delimChar=null;YAHOO.widget.AutoComplete.prototype.autoHighlight=true;YAHOO.widget.AutoComplete.prototype.typeAhead=false;YAHOO.widget.AutoComplete.prototype.animHoriz=false;YAHOO.widget.AutoComplete.prototype.animVert=true;YAHOO.widget.AutoComplete.prototype.animSpeed=0.3;YAHOO.widget.AutoComplete.prototype.forceSelection=false;YAHOO.widget.AutoComplete.prototype.allowBrowserAutocomplete=true;YAHOO.widget.AutoComplete.prototype.alwaysShowContainer=false;YAHOO.widget.AutoComplete.prototype.useIFrame=false;YAHOO.widget.AutoComplete.prototype.useShadow=false;YAHOO.widget.AutoComplete.prototype.suppressInputUpdate=false;YAHOO.widget.AutoComplete.prototype.resultTypeList=true;YAHOO.widget.AutoComplete.prototype.queryQuestionMark=true;YAHOO.widget.AutoComplete.prototype.autoSnapContainer=true;YAHOO.widget.AutoComplete.prototype.toString=function(){return"AutoComplete "+this._sName};YAHOO.widget.AutoComplete.prototype.getInputEl=function(){return this._elTextbox};YAHOO.widget.AutoComplete.prototype.getContainerEl=function(){return this._elContainer};YAHOO.widget.AutoComplete.prototype.isFocused=function(){return this._bFocused};YAHOO.widget.AutoComplete.prototype.isContainerOpen=function(){return this._bContainerOpen};YAHOO.widget.AutoComplete.prototype.getListEl=function(){return this._elList};YAHOO.widget.AutoComplete.prototype.getListItemMatch=function(A){if(A._sResultMatch){return A._sResultMatch}else{return null}};YAHOO.widget.AutoComplete.prototype.getListItemData=function(A){if(A._oResultData){return A._oResultData}else{return null}};YAHOO.widget.AutoComplete.prototype.getListItemIndex=function(A){if(YAHOO.lang.isNumber(A._nItemIndex)){return A._nItemIndex}else{return null}};YAHOO.widget.AutoComplete.prototype.setHeader=function(B){if(this._elHeader){var A=this._elHeader;if(B){A.innerHTML=B;A.style.display=""}else{A.innerHTML="";A.style.display="none"}}};YAHOO.widget.AutoComplete.prototype.setFooter=function(B){if(this._elFooter){var A=this._elFooter;if(B){A.innerHTML=B;A.style.display=""}else{A.innerHTML="";A.style.display="none"}}};YAHOO.widget.AutoComplete.prototype.setBody=function(A){if(this._elBody){var B=this._elBody;YAHOO.util.Event.purgeElement(B,true);if(A){B.innerHTML=A;B.style.display=""}else{B.innerHTML="";B.style.display="none"}this._elList=null}};YAHOO.widget.AutoComplete.prototype.generateRequest=function(B){var A=this.dataSource.dataType;if(A===YAHOO.util.DataSourceBase.TYPE_XHR){if(!this.dataSource.connMethodPost){B=(this.queryQuestionMark?"?":"")+(this.dataSource.scriptQueryParam||"query")+"="+B+(this.dataSource.scriptQueryAppend?("&"+this.dataSource.scriptQueryAppend):"")}else{B=(this.dataSource.scriptQueryParam||"query")+"="+B+(this.dataSource.scriptQueryAppend?("&"+this.dataSource.scriptQueryAppend):"")}}else{if(A===YAHOO.util.DataSourceBase.TYPE_SCRIPTNODE){B="&"+(this.dataSource.scriptQueryParam||"query")+"="+B+(this.dataSource.scriptQueryAppend?("&"+this.dataSource.scriptQueryAppend):"")}}return B};YAHOO.widget.AutoComplete.prototype.sendQuery=function(B){this._bFocused=true;var A=(this.delimChar)?this._elTextbox.value+B:B;this._sendQuery(A)};YAHOO.widget.AutoComplete.prototype.snapContainer=function(){var A=this._elTextbox,B=YAHOO.util.Dom.getXY(A);B[1]+=YAHOO.util.Dom.get(A).offsetHeight+2;YAHOO.util.Dom.setXY(this._elContainer,B)};YAHOO.widget.AutoComplete.prototype.expandContainer=function(){this._toggleContainer(true)};YAHOO.widget.AutoComplete.prototype.collapseContainer=function(){this._toggleContainer(false)};YAHOO.widget.AutoComplete.prototype.clearList=function(){var B=this._elList.childNodes,A=B.length-1;for(;A>-1;A--){B[A].style.display="none"}};YAHOO.widget.AutoComplete.prototype.getSubsetMatches=function(E){var D,C,A;for(var B=E.length;B>=this.minQueryLength;B--){A=this.generateRequest(E.substr(0,B));this.dataRequestEvent.fire(this,D,A);YAHOO.log('Searching for query subset "'+D+'" in cache',"info",this.toString());C=this.dataSource.getCachedResponse(A);if(C){YAHOO.log('Found match for query subset "'+D+'": '+YAHOO.lang.dump(C),"info",this.toString());return this.filterResults.apply(this.dataSource,[E,C,C,{scope:this}])}}YAHOO.log('Did not find subset match for query subset "'+E+'"',"info",this.toString());return null};YAHOO.widget.AutoComplete.prototype.preparseRawResponse=function(C,B,A){var D=((this.responseStripAfter!=="")&&(B.indexOf))?B.indexOf(this.responseStripAfter):-1;if(D!=-1){B=B.substring(0,D)}return B};YAHOO.widget.AutoComplete.prototype.filterResults=function(K,M,Q,L){if(L&&L.argument&&L.argument.query){K=L.argument.query}if(K&&K!==""){Q=YAHOO.widget.AutoComplete._cloneObject(Q);var I=L.scope,P=this,C=Q.results,N=[],B=I.maxResultsDisplayed,J=(P.queryMatchCase||I.queryMatchCase),A=(P.queryMatchContains||I.queryMatchContains);for(var D=0,H=C.length;D<H;D++){var F=C[D];var E=null;if(YAHOO.lang.isString(F)){E=F}else{if(YAHOO.lang.isArray(F)){E=F[0]}else{if(this.responseSchema.fields){var O=this.responseSchema.fields[0].key||this.responseSchema.fields[0];E=F[O]}else{if(this.key){E=F[this.key]}}}}if(YAHOO.lang.isString(E)){var G=(J)?E.indexOf(decodeURIComponent(K)):E.toLowerCase().indexOf(decodeURIComponent(K).toLowerCase());if((!A&&(G===0))||(A&&(G>-1))){N.push(F)}}if(H>B&&N.length===B){break}}Q.results=N;YAHOO.log("Filtered "+N.length+' results against query "'+K+'": '+YAHOO.lang.dump(N),"info",this.toString())}else{YAHOO.log("Did not filter results against query","info",this.toString())}return Q};YAHOO.widget.AutoComplete.prototype.handleResponse=function(C,A,B){if((this instanceof YAHOO.widget.AutoComplete)&&this._sName){this._populateList(C,A,B)}};YAHOO.widget.AutoComplete.prototype.doBeforeLoadData=function(C,A,B){return true};YAHOO.widget.AutoComplete.prototype.formatResult=function(B,D,A){var C=(A)?A:"";return C};YAHOO.widget.AutoComplete.prototype.doBeforeExpandContainer=function(D,A,C,B){return true};YAHOO.widget.AutoComplete.prototype.destroy=function(){var B=this.toString();var A=this._elTextbox;var D=this._elContainer;this.textboxFocusEvent.unsubscribeAll();this.textboxKeyEvent.unsubscribeAll();this.dataRequestEvent.unsubscribeAll();this.dataReturnEvent.unsubscribeAll();this.dataErrorEvent.unsubscribeAll();this.containerPopulateEvent.unsubscribeAll();this.containerExpandEvent.unsubscribeAll();this.typeAheadEvent.unsubscribeAll();this.itemMouseOverEvent.unsubscribeAll();this.itemMouseOutEvent.unsubscribeAll();this.itemArrowToEvent.unsubscribeAll();this.itemArrowFromEvent.unsubscribeAll();this.itemSelectEvent.unsubscribeAll();this.unmatchedItemSelectEvent.unsubscribeAll();this.selectionEnforceEvent.unsubscribeAll();this.containerCollapseEvent.unsubscribeAll();this.textboxBlurEvent.unsubscribeAll();this.textboxChangeEvent.unsubscribeAll();YAHOO.util.Event.purgeElement(A,true);YAHOO.util.Event.purgeElement(D,true);D.innerHTML="";for(var C in this){if(YAHOO.lang.hasOwnProperty(this,C)){this[C]=null}}YAHOO.log("AutoComplete instance destroyed: "+B)};YAHOO.widget.AutoComplete.prototype.textboxFocusEvent=null;YAHOO.widget.AutoComplete.prototype.textboxKeyEvent=null;YAHOO.widget.AutoComplete.prototype.dataRequestEvent=null;YAHOO.widget.AutoComplete.prototype.dataReturnEvent=null;YAHOO.widget.AutoComplete.prototype.dataErrorEvent=null;YAHOO.widget.AutoComplete.prototype.containerPopulateEvent=null;YAHOO.widget.AutoComplete.prototype.containerExpandEvent=null;YAHOO.widget.AutoComplete.prototype.typeAheadEvent=null;YAHOO.widget.AutoComplete.prototype.itemMouseOverEvent=null;YAHOO.widget.AutoComplete.prototype.itemMouseOutEvent=null;YAHOO.widget.AutoComplete.prototype.itemArrowToEvent=null;YAHOO.widget.AutoComplete.prototype.itemArrowFromEvent=null;YAHOO.widget.AutoComplete.prototype.itemSelectEvent=null;YAHOO.widget.AutoComplete.prototype.unmatchedItemSelectEvent=null;YAHOO.widget.AutoComplete.prototype.selectionEnforceEvent=null;YAHOO.widget.AutoComplete.prototype.containerCollapseEvent=null;YAHOO.widget.AutoComplete.prototype.textboxBlurEvent=null;YAHOO.widget.AutoComplete.prototype.textboxChangeEvent=null;YAHOO.widget.AutoComplete._nIndex=0;YAHOO.widget.AutoComplete.prototype._sName=null;YAHOO.widget.AutoComplete.prototype._elTextbox=null;YAHOO.widget.AutoComplete.prototype._elContainer=null;YAHOO.widget.AutoComplete.prototype._elContent=null;YAHOO.widget.AutoComplete.prototype._elHeader=null;YAHOO.widget.AutoComplete.prototype._elBody=null;YAHOO.widget.AutoComplete.prototype._elFooter=null;YAHOO.widget.AutoComplete.prototype._elShadow=null;YAHOO.widget.AutoComplete.prototype._elIFrame=null;YAHOO.widget.AutoComplete.prototype._bFocused=false;YAHOO.widget.AutoComplete.prototype._oAnim=null;YAHOO.widget.AutoComplete.prototype._bContainerOpen=false;YAHOO.widget.AutoComplete.prototype._bOverContainer=false;YAHOO.widget.AutoComplete.prototype._elList=null;YAHOO.widget.AutoComplete.prototype._nDisplayedItems=0;YAHOO.widget.AutoComplete.prototype._sCurQuery=null;YAHOO.widget.AutoComplete.prototype._sPastSelections="";YAHOO.widget.AutoComplete.prototype._sInitInputValue=null;YAHOO.widget.AutoComplete.prototype._elCurListItem=null;YAHOO.widget.AutoComplete.prototype._elCurPrehighlightItem=null;YAHOO.widget.AutoComplete.prototype._bItemSelected=false;YAHOO.widget.AutoComplete.prototype._nKeyCode=null;YAHOO.widget.AutoComplete.prototype._nDelayID=-1;YAHOO.widget.AutoComplete.prototype._nTypeAheadDelayID=-1;YAHOO.widget.AutoComplete.prototype._iFrameSrc="javascript:false;";YAHOO.widget.AutoComplete.prototype._queryInterval=null;YAHOO.widget.AutoComplete.prototype._sLastTextboxValue=null;YAHOO.widget.AutoComplete.prototype._initProps=function(){var B=this.minQueryLength;if(!YAHOO.lang.isNumber(B)){this.minQueryLength=1}var E=this.maxResultsDisplayed;if(!YAHOO.lang.isNumber(E)||(E<1)){this.maxResultsDisplayed=10}var F=this.queryDelay;if(!YAHOO.lang.isNumber(F)||(F<0)){this.queryDelay=0.2}var C=this.typeAheadDelay;if(!YAHOO.lang.isNumber(C)||(C<0)){this.typeAheadDelay=0.2}var A=this.delimChar;if(YAHOO.lang.isString(A)&&(A.length>0)){this.delimChar=[A]}else{if(!YAHOO.lang.isArray(A)){this.delimChar=null}}var D=this.animSpeed;if((this.animHoriz||this.animVert)&&YAHOO.util.Anim){if(!YAHOO.lang.isNumber(D)||(D<0)){this.animSpeed=0.3}if(!this._oAnim){this._oAnim=new YAHOO.util.Anim(this._elContent,{},this.animSpeed)}else{this._oAnim.duration=this.animSpeed}}if(this.forceSelection&&A){YAHOO.log("The forceSelection feature has been enabled with delimChar defined.","warn",this.toString())}};YAHOO.widget.AutoComplete.prototype._initContainerHelperEls=function(){if(this.useShadow&&!this._elShadow){var A=document.createElement("div");A.className="yui-ac-shadow";A.style.width=0;A.style.height=0;this._elShadow=this._elContainer.appendChild(A)}if(this.useIFrame&&!this._elIFrame){var B=document.createElement("iframe");B.src=this._iFrameSrc;B.frameBorder=0;B.scrolling="no";B.style.position="absolute";B.style.width=0;B.style.height=0;B.style.padding=0;B.tabIndex=-1;B.role="presentation";B.title="Presentational iframe shim";this._elIFrame=this._elContainer.appendChild(B)}};YAHOO.widget.AutoComplete.prototype._initContainerEl=function(){YAHOO.util.Dom.addClass(this._elContainer,"yui-ac-container");if(!this._elContent){var C=document.createElement("div");C.className="yui-ac-content";C.style.display="none";this._elContent=this._elContainer.appendChild(C);var B=document.createElement("div");B.className="yui-ac-hd";B.style.display="none";this._elHeader=this._elContent.appendChild(B);var D=document.createElement("div");D.className="yui-ac-bd";this._elBody=this._elContent.appendChild(D);var A=document.createElement("div");A.className="yui-ac-ft";A.style.display="none";this._elFooter=this._elContent.appendChild(A)}else{YAHOO.log("Could not initialize the container","warn",this.toString())}};YAHOO.widget.AutoComplete.prototype._initListEl=function(){var C=this.maxResultsDisplayed,A=this._elList||document.createElement("ul"),B;while(A.childNodes.length<C){B=document.createElement("li");B.style.display="none";B._nItemIndex=A.childNodes.length;A.appendChild(B)}if(!this._elList){var D=this._elBody;YAHOO.util.Event.purgeElement(D,true);D.innerHTML="";this._elList=D.appendChild(A)}this._elBody.style.display=""};YAHOO.widget.AutoComplete.prototype._focus=function(){var A=this;setTimeout(function(){try{A._elTextbox.focus()}catch(B){}},0)};YAHOO.widget.AutoComplete.prototype._enableIntervalDetection=function(){var A=this;if(!A._queryInterval&&A.queryInterval){A._queryInterval=setInterval(function(){A._onInterval()},A.queryInterval);YAHOO.log("Interval set","info",this.toString())}};YAHOO.widget.AutoComplete.prototype.enableIntervalDetection=YAHOO.widget.AutoComplete.prototype._enableIntervalDetection;YAHOO.widget.AutoComplete.prototype._onInterval=function(){var A=this._elTextbox.value;var B=this._sLastTextboxValue;if(A!=B){this._sLastTextboxValue=A;this._sendQuery(A)}};YAHOO.widget.AutoComplete.prototype._clearInterval=function(){if(this._queryInterval){clearInterval(this._queryInterval);this._queryInterval=null;YAHOO.log("Interval cleared","info",this.toString())}};YAHOO.widget.AutoComplete.prototype._isIgnoreKey=function(A){if((A==9)||(A==13)||(A==16)||(A==17)||(A>=18&&A<=20)||(A==27)||(A>=33&&A<=35)||(A>=36&&A<=40)||(A>=44&&A<=45)||(A==229)){return true}return false};YAHOO.widget.AutoComplete.prototype._sendQuery=function(D){if(this.minQueryLength<0){this._toggleContainer(false);YAHOO.log("Property minQueryLength is less than 0","info",this.toString());return }if(this.delimChar){var A=this._extractQuery(D);D=A.query;this._sPastSelections=A.previous}if((D&&(D.length<this.minQueryLength))||(!D&&this.minQueryLength>0)){if(this._nDelayID!=-1){clearTimeout(this._nDelayID)}this._toggleContainer(false);YAHOO.log('Query "'+D+'" is too short',"info",this.toString());return }D=encodeURIComponent(D);this._nDelayID=-1;if(this.dataSource.queryMatchSubset||this.queryMatchSubset){var C=this.getSubsetMatches(D);if(C){this.handleResponse(D,C,{query:D});return }}if(this.dataSource.responseStripAfter){this.dataSource.doBeforeParseData=this.preparseRawResponse}if(this.applyLocalFilter){this.dataSource.doBeforeCallback=this.filterResults}var B=this.generateRequest(D);this.dataRequestEvent.fire(this,D,B);YAHOO.log('Sending query "'+B+'"',"info",this.toString());this.dataSource.sendRequest(B,{success:this.handleResponse,failure:this.handleResponse,scope:this,argument:{query:D}})};YAHOO.widget.AutoComplete.prototype._populateListItem=function(B,A,C){B.innerHTML=this.formatResult(A,C,B._sResultMatch)};YAHOO.widget.AutoComplete.prototype._populateList=function(K,F,C){if(this._nTypeAheadDelayID!=-1){clearTimeout(this._nTypeAheadDelayID)}K=(C&&C.query)?C.query:K;var H=this.doBeforeLoadData(K,F,C);if(H&&!F.error){this.dataReturnEvent.fire(this,K,F.results);if(this._bFocused){var M=decodeURIComponent(K);this._sCurQuery=M;this._bItemSelected=false;var R=F.results,A=Math.min(R.length,this.maxResultsDisplayed),J=(this.dataSource.responseSchema.fields)?(this.dataSource.responseSchema.fields[0].key||this.dataSource.responseSchema.fields[0]):0;if(A>0){if(!this._elList||(this._elList.childNodes.length<A)){this._initListEl()}this._initContainerHelperEls();var I=this._elList.childNodes;for(var Q=A-1;Q>=0;Q--){var P=I[Q],E=R[Q];if(this.resultTypeList){var B=[];B[0]=(YAHOO.lang.isString(E))?E:E[J]||E[this.key];var L=this.dataSource.responseSchema.fields;if(YAHOO.lang.isArray(L)&&(L.length>1)){for(var N=1,S=L.length;N<S;N++){B[B.length]=E[L[N].key||L[N]]}}else{if(YAHOO.lang.isArray(E)){B=E}else{if(YAHOO.lang.isString(E)){B=[E]}else{B[1]=E}}}E=B}P._sResultMatch=(YAHOO.lang.isString(E))?E:(YAHOO.lang.isArray(E))?E[0]:(E[J]||"");P._oResultData=E;this._populateListItem(P,E,M);P.style.display=""}if(A<I.length){var G;for(var O=I.length-1;O>=A;O--){G=I[O];G.style.display="none"}}this._nDisplayedItems=A;this.containerPopulateEvent.fire(this,K,R);if(this.autoHighlight){var D=this._elList.firstChild;this._toggleHighlight(D,"to");this.itemArrowToEvent.fire(this,D);YAHOO.log("Arrowed to first item","info",this.toString());this._typeAhead(D,K)}else{this._toggleHighlight(this._elCurListItem,"from")}H=this._doBeforeExpandContainer(this._elTextbox,this._elContainer,K,R);this._toggleContainer(H)}else{this._toggleContainer(false)}YAHOO.log("Container populated with "+A+" list items","info",this.toString());return }}else{this.dataErrorEvent.fire(this,K,F)}YAHOO.log("Could not populate list","info",this.toString())};YAHOO.widget.AutoComplete.prototype._doBeforeExpandContainer=function(D,A,C,B){if(this.autoSnapContainer){this.snapContainer()}return this.doBeforeExpandContainer(D,A,C,B)};YAHOO.widget.AutoComplete.prototype._clearSelection=function(){var A=(this.delimChar)?this._extractQuery(this._elTextbox.value):{previous:"",query:this._elTextbox.value};this._elTextbox.value=A.previous;this.selectionEnforceEvent.fire(this,A.query);YAHOO.log("Selection enforced","info",this.toString())};YAHOO.widget.AutoComplete.prototype._textMatchesOption=function(){var A=null;for(var B=0;B<this._nDisplayedItems;B++){var C=this._elList.childNodes[B];var D=(""+C._sResultMatch).toLowerCase();if(D==this._sCurQuery.toLowerCase()){A=C;break}}return(A)};YAHOO.widget.AutoComplete.prototype._typeAhead=function(B,D){if(!this.typeAhead||(this._nKeyCode==8)){return }var A=this,C=this._elTextbox;if(C.setSelectionRange||C.createTextRange){this._nTypeAheadDelayID=setTimeout(function(){var F=C.value.length;A._updateValue(B);var G=C.value.length;A._selectText(C,F,G);var E=C.value.substr(F,G);A.typeAheadEvent.fire(A,D,E);YAHOO.log('Typeahead occured with prefill string "'+E+'"',"info",A.toString())},(this.typeAheadDelay*1000))}};YAHOO.widget.AutoComplete.prototype._selectText=function(D,A,B){if(D.setSelectionRange){D.setSelectionRange(A,B)}else{if(D.createTextRange){var C=D.createTextRange();C.moveStart("character",A);C.moveEnd("character",B-D.value.length);C.select()}else{D.select()}}};YAHOO.widget.AutoComplete.prototype._extractQuery=function(H){var C=this.delimChar,F=-1,G,E,B=C.length-1,D;for(;B>=0;B--){G=H.lastIndexOf(C[B]);if(G>F){F=G}}if(C[B]==" "){for(var A=C.length-1;A>=0;A--){if(H[F-1]==C[A]){F--;break}}}if(F>-1){E=F+1;while(H.charAt(E)==" "){E+=1}D=H.substring(0,E);H=H.substr(E)}else{D=""}return{previous:D,query:H}};YAHOO.widget.AutoComplete.prototype._toggleContainerHelpers=function(D){var E=this._elContent.offsetWidth+"px";var B=this._elContent.offsetHeight+"px";if(this.useIFrame&&this._elIFrame){var C=this._elIFrame;if(D){C.style.width=E;C.style.height=B;C.style.padding="";YAHOO.log("Iframe expanded","info",this.toString())}else{C.style.width=0;C.style.height=0;C.style.padding=0;YAHOO.log("Iframe collapsed","info",this.toString())}}if(this.useShadow&&this._elShadow){var A=this._elShadow;if(D){A.style.width=E;A.style.height=B;YAHOO.log("Shadow expanded","info",this.toString())}else{A.style.width=0;A.style.height=0;YAHOO.log("Shadow collapsed","info",this.toString())}}};YAHOO.widget.AutoComplete.prototype._toggleContainer=function(I){YAHOO.log("Toggling container "+((I)?"open":"closed"),"info",this.toString());var D=this._elContainer;if(this.alwaysShowContainer&&this._bContainerOpen){return }if(!I){this._toggleHighlight(this._elCurListItem,"from");this._nDisplayedItems=0;this._sCurQuery=null;if(this._elContent.style.display=="none"){return }}var A=this._oAnim;if(A&&A.getEl()&&(this.animHoriz||this.animVert)){if(A.isAnimated()){A.stop(true)}var G=this._elContent.cloneNode(true);D.appendChild(G);G.style.top="-9000px";G.style.width="";G.style.height="";G.style.display="";var F=G.offsetWidth;var C=G.offsetHeight;var B=(this.animHoriz)?0:F;var E=(this.animVert)?0:C;A.attributes=(I)?{width:{to:F},height:{to:C}}:{width:{to:B},height:{to:E}};if(I&&!this._bContainerOpen){this._elContent.style.width=B+"px";this._elContent.style.height=E+"px"}else{this._elContent.style.width=F+"px";this._elContent.style.height=C+"px"}D.removeChild(G);G=null;var H=this;var J=function(){A.onComplete.unsubscribeAll();if(I){H._toggleContainerHelpers(true);H._bContainerOpen=I;H.containerExpandEvent.fire(H);YAHOO.log("Container expanded","info",H.toString())}else{H._elContent.style.display="none";H._bContainerOpen=I;H.containerCollapseEvent.fire(H);YAHOO.log("Container collapsed","info",H.toString())}};this._toggleContainerHelpers(false);this._elContent.style.display="";A.onComplete.subscribe(J);A.animate()}else{if(I){this._elContent.style.display="";this._toggleContainerHelpers(true);this._bContainerOpen=I;this.containerExpandEvent.fire(this);YAHOO.log("Container expanded","info",this.toString())}else{this._toggleContainerHelpers(false);this._elContent.style.display="none";this._bContainerOpen=I;this.containerCollapseEvent.fire(this);YAHOO.log("Container collapsed","info",this.toString())}}};YAHOO.widget.AutoComplete.prototype._toggleHighlight=function(A,C){if(A){var B=this.highlightClassName;if(this._elCurListItem){YAHOO.util.Dom.removeClass(this._elCurListItem,B);this._elCurListItem=null}if((C=="to")&&B){YAHOO.util.Dom.addClass(A,B);this._elCurListItem=A}}};YAHOO.widget.AutoComplete.prototype._togglePrehighlight=function(B,C){var A=this.prehighlightClassName;if(this._elCurPrehighlightItem){YAHOO.util.Dom.removeClass(this._elCurPrehighlightItem,A)}if(B==this._elCurListItem){return }if((C=="mouseover")&&A){YAHOO.util.Dom.addClass(B,A);this._elCurPrehighlightItem=B}else{YAHOO.util.Dom.removeClass(B,A)}};YAHOO.widget.AutoComplete.prototype._updateValue=function(C){if(!this.suppressInputUpdate){var F=this._elTextbox;var E=(this.delimChar)?(this.delimChar[0]||this.delimChar):null;var B=C._sResultMatch;var D="";if(E){D=this._sPastSelections;D+=B+E;if(E!=" "){D+=" "}}else{D=B}F.value=D;if(F.type=="textarea"){F.scrollTop=F.scrollHeight}var A=F.value.length;this._selectText(F,A,A);this._elCurListItem=C}};YAHOO.widget.AutoComplete.prototype._selectItem=function(A){this._bItemSelected=true;this._updateValue(A);this._sPastSelections=this._elTextbox.value;this._clearInterval();this.itemSelectEvent.fire(this,A,A._oResultData);YAHOO.log("Item selected: "+YAHOO.lang.dump(A._oResultData),"info",this.toString());this._toggleContainer(false)};YAHOO.widget.AutoComplete.prototype._jumpSelection=function(){if(this._elCurListItem){this._selectItem(this._elCurListItem)}else{this._toggleContainer(false)}};YAHOO.widget.AutoComplete.prototype._moveSelection=function(G){if(this._bContainerOpen){var H=this._elCurListItem,D=-1;if(H){D=H._nItemIndex}var E=(G==40)?(D+1):(D-1);if(E<-2||E>=this._nDisplayedItems){return }if(H){this._toggleHighlight(H,"from");this.itemArrowFromEvent.fire(this,H);YAHOO.log("Item arrowed from: "+H._nItemIndex,"info",this.toString())}if(E==-1){if(this.delimChar){this._elTextbox.value=this._sPastSelections+this._sCurQuery}else{this._elTextbox.value=this._sCurQuery}return }if(E==-2){this._toggleContainer(false);return }var F=this._elList.childNodes[E],B=this._elContent,C=YAHOO.util.Dom.getStyle(B,"overflow"),I=YAHOO.util.Dom.getStyle(B,"overflowY"),A=((C=="auto")||(C=="scroll")||(I=="auto")||(I=="scroll"));if(A&&(E>-1)&&(E<this._nDisplayedItems)){if(G==40){if((F.offsetTop+F.offsetHeight)>(B.scrollTop+B.offsetHeight)){B.scrollTop=(F.offsetTop+F.offsetHeight)-B.offsetHeight}else{if((F.offsetTop+F.offsetHeight)<B.scrollTop){B.scrollTop=F.offsetTop}}}else{if(F.offsetTop<B.scrollTop){this._elContent.scrollTop=F.offsetTop}else{if(F.offsetTop>(B.scrollTop+B.offsetHeight)){this._elContent.scrollTop=(F.offsetTop+F.offsetHeight)-B.offsetHeight}}}}this._toggleHighlight(F,"to");this.itemArrowToEvent.fire(this,F);YAHOO.log("Item arrowed to "+F._nItemIndex,"info",this.toString());if(this.typeAhead){this._updateValue(F)}}};YAHOO.widget.AutoComplete.prototype._onContainerMouseover=function(A,C){var D=YAHOO.util.Event.getTarget(A);var B=D.nodeName.toLowerCase();while(D&&(B!="table")){switch(B){case"body":return ;case"li":if(C.prehighlightClassName){C._togglePrehighlight(D,"mouseover")}else{C._toggleHighlight(D,"to")}C.itemMouseOverEvent.fire(C,D);YAHOO.log("Item moused over "+D._nItemIndex,"info",C.toString());break;case"div":if(YAHOO.util.Dom.hasClass(D,"yui-ac-container")){C._bOverContainer=true;return }break;default:break}D=D.parentNode;if(D){B=D.nodeName.toLowerCase()}}};YAHOO.widget.AutoComplete.prototype._onContainerMouseout=function(A,C){var D=YAHOO.util.Event.getTarget(A);var B=D.nodeName.toLowerCase();while(D&&(B!="table")){switch(B){case"body":return ;case"li":if(C.prehighlightClassName){C._togglePrehighlight(D,"mouseout")}else{C._toggleHighlight(D,"from")}C.itemMouseOutEvent.fire(C,D);YAHOO.log("Item moused out "+D._nItemIndex,"info",C.toString());break;case"ul":C._toggleHighlight(C._elCurListItem,"to");break;case"div":if(YAHOO.util.Dom.hasClass(D,"yui-ac-container")){C._bOverContainer=false;return }break;default:break}D=D.parentNode;if(D){B=D.nodeName.toLowerCase()}}};YAHOO.widget.AutoComplete.prototype._onContainerClick=function(A,C){var D=YAHOO.util.Event.getTarget(A);var B=D.nodeName.toLowerCase();while(D&&(B!="table")){switch(B){case"body":return ;case"li":C._toggleHighlight(D,"to");C._selectItem(D);return ;default:break}D=D.parentNode;if(D){B=D.nodeName.toLowerCase()}}};YAHOO.widget.AutoComplete.prototype._onContainerScroll=function(A,B){B._focus()};YAHOO.widget.AutoComplete.prototype._onContainerResize=function(A,B){B._toggleContainerHelpers(B._bContainerOpen)};YAHOO.widget.AutoComplete.prototype._onTextboxKeyDown=function(A,B){var C=A.keyCode;if(B._nTypeAheadDelayID!=-1){clearTimeout(B._nTypeAheadDelayID)}switch(C){case 9:if(!YAHOO.env.ua.opera&&(navigator.userAgent.toLowerCase().indexOf("mac")==-1)||(YAHOO.env.ua.webkit>420)){if(B._elCurListItem){if(B.delimChar&&(B._nKeyCode!=C)){if(B._bContainerOpen){YAHOO.util.Event.stopEvent(A)}}B._selectItem(B._elCurListItem)}else{B._toggleContainer(false)}}break;case 13:if(!YAHOO.env.ua.opera&&(navigator.userAgent.toLowerCase().indexOf("mac")==-1)||(YAHOO.env.ua.webkit>420)){if(B._elCurListItem){if(B._nKeyCode!=C){if(B._bContainerOpen){YAHOO.util.Event.stopEvent(A)}}B._selectItem(B._elCurListItem)}else{B._toggleContainer(false)}}break;case 27:B._toggleContainer(false);return ;case 39:B._jumpSelection();break;case 38:if(B._bContainerOpen){YAHOO.util.Event.stopEvent(A);B._moveSelection(C)}break;case 40:if(B._bContainerOpen){YAHOO.util.Event.stopEvent(A);B._moveSelection(C)}break;default:B._bItemSelected=false;B._toggleHighlight(B._elCurListItem,"from");B.textboxKeyEvent.fire(B,C);YAHOO.log("Textbox keyed","info",B.toString());break}if(C===18){B._enableIntervalDetection()}B._nKeyCode=C};YAHOO.widget.AutoComplete.prototype._onTextboxKeyPress=function(A,B){var C=A.keyCode;if(YAHOO.env.ua.opera||(navigator.userAgent.toLowerCase().indexOf("mac")!=-1)&&(YAHOO.env.ua.webkit<420)){switch(C){case 9:if(B._bContainerOpen){if(B.delimChar){YAHOO.util.Event.stopEvent(A)}if(B._elCurListItem){B._selectItem(B._elCurListItem)}else{B._toggleContainer(false)}}break;case 13:if(B._bContainerOpen){YAHOO.util.Event.stopEvent(A);if(B._elCurListItem){B._selectItem(B._elCurListItem)}else{B._toggleContainer(false)}}break;default:break}}else{if(C==229){B._enableIntervalDetection()}}};YAHOO.widget.AutoComplete.prototype._onTextboxKeyUp=function(A,C){var B=this.value;C._initProps();var D=A.keyCode;if(C._isIgnoreKey(D)){return }if(C._nDelayID!=-1){clearTimeout(C._nDelayID)}C._nDelayID=setTimeout(function(){C._sendQuery(B)},(C.queryDelay*1000))};YAHOO.widget.AutoComplete.prototype._onTextboxFocus=function(A,B){if(!B._bFocused){B._elTextbox.setAttribute("autocomplete","off");B._bFocused=true;B._sInitInputValue=B._elTextbox.value;B.textboxFocusEvent.fire(B);YAHOO.log("Textbox focused","info",B.toString())}};YAHOO.widget.AutoComplete.prototype._onTextboxBlur=function(A,C){if(!C._bOverContainer||(C._nKeyCode==9)){if(!C._bItemSelected){var B=C._textMatchesOption();if(!C._bContainerOpen||(C._bContainerOpen&&(B===null))){if(C.forceSelection){C._clearSelection()}else{C.unmatchedItemSelectEvent.fire(C,C._sCurQuery);YAHOO.log("Unmatched item selected: "+C._sCurQuery,"info",C.toString())}}else{if(C.forceSelection){C._selectItem(B)}}}C._clearInterval();C._bFocused=false;if(C._sInitInputValue!==C._elTextbox.value){C.textboxChangeEvent.fire(C)}C.textboxBlurEvent.fire(C);YAHOO.log("Textbox blurred","info",C.toString());C._toggleContainer(false)}else{C._focus()}};YAHOO.widget.AutoComplete.prototype._onWindowUnload=function(A,B){if(B&&B._elTextbox&&B.allowBrowserAutocomplete){B._elTextbox.setAttribute("autocomplete","on")}};YAHOO.widget.AutoComplete.prototype.doBeforeSendQuery=function(A){return this.generateRequest(A)};YAHOO.widget.AutoComplete.prototype.getListItems=function(){var C=[],B=this._elList.childNodes;for(var A=B.length-1;A>=0;A--){C[A]=B[A]}return C};YAHOO.widget.AutoComplete._cloneObject=function(D){if(!YAHOO.lang.isValue(D)){return D}var F={};if(YAHOO.lang.isFunction(D)){F=D}else{if(YAHOO.lang.isArray(D)){var E=[];for(var C=0,B=D.length;C<B;C++){E[C]=YAHOO.widget.AutoComplete._cloneObject(D[C])}F=E}else{if(YAHOO.lang.isObject(D)){for(var A in D){if(YAHOO.lang.hasOwnProperty(D,A)){if(YAHOO.lang.isValue(D[A])&&YAHOO.lang.isObject(D[A])||YAHOO.lang.isArray(D[A])){F[A]=YAHOO.widget.AutoComplete._cloneObject(D[A])}else{F[A]=D[A]}}}}else{F=D}}}return F};YAHOO.register("autocomplete",YAHOO.widget.AutoComplete,{version:"2.8.0r4",build:"2449"});YUI.add("wl-rememberme-formmanager",function(D){var C=function(K,I,G,F){var J=this;J.node=K;J.repository=I;J.data=[];J.fields=[];J.keyFields=[];function H(){var M="";D.Array.some(F,function(O){var Q=O.localName;var N=J.node.all('input[name$="'+Q+'"],select[name$="'+Q+'"]');if(N.size()>0){var P=G+Q;N.some(function(S){var R=S.get("name");if(R.match(P)){M=R.substring(0,R.length-Q.length);return true}return false});return true}return false});return M}J.prefix=H();function L(){var M=J.repository.getKeyFieldsNames();D.Array.each(F,function(P){var N=P.localName;var Q=J.prefix+N;var O=K.all("input[name='"+Q+"'],select[name='"+Q+"']");O.each(function(R){J.fields.push({fieldNode:R,populateOnlyWhenEmpty:P.populateOnlyWhenEmpty});if(D.Array.indexOf(M,N)!=-1){J.keyFields.push(R)}})})}L()};C.prototype.getKeyFields=function(){return this.keyFields};function E(F,G){var H=false;D.Array.some(F,function(J){var I=!G[J];if(I){H=true;return true}});return H}C.prototype.save=function(){var G={};var F=this.repository.getKeyFieldsNames();D.Array.each(this.fields,function(L){var H=L.fieldNode;var I=H.get("name").replace(this.prefix,"");var K=H.get("value");var J=H.get("type");if(!H.getAttribute("disabled")||(D.Array.indexOf(F,I)>-1)){if(J==="radio"){if(H.get("checked")===true){G[I]=K}}else{if(J==="checkbox"){G[I]=L.get("checked")}else{G[I]=K}}}},this);if(!E(F,G)){this.repository.set(G)}};function A(I,H,G){var F=false;if(I.populateOnlyWhenEmpty){if((!G||G===" ")&&H){F=true}}else{if(H!==G){F=true}}return F}function B(L,K){var G=L.fieldNode;var H=G.get("value");var J=!G.getAttribute("disabled");var F=G.get("type");var I=false;if(J){G.removeClass("disable-generic-js-validation");if(F==="radio"){if(G.get("value")===K){G.set("checked",true);I=true}}else{if(F==="checkbox"){G.set("checked",!K);G.simulate("click");I=true}else{if(A(L,K,H)){G.set("value",K);G.simulate("change");I=true}}}if(I){D.wlValidation.validate(null,G)}}}C.prototype.load=function(F){D.Array.each(this.fields,function(J){var G=J.fieldNode;var H=G.get("name").replace(this.prefix,"");var I=F[H];if(H&&D.Lang.isValue(I)){B(J,I);if(G.hasClass("js:linkedSelect")){G.setAttribute("data-linkedSelectPreselectedValue",I);G.simulate("change")}}},this)};D.widgets=D.widgets||{};D.widgets.rememberme=D.widgets.rememberme||{};D.widgets.rememberme.formManager=C},"1.0.0",{requires:[]});YUI.add("wl-rememberme-widget",function(E){E.one("body").addClass("yui-skin-sam");var D=function(H,S){var L=this;var R=[];var M=false;L.options=S;L.repository=new E.widgets.rememberme.repository.storage(S.configuration,S.repositoryOptions);L.keyFields=L.repository.getKeyFieldsNames();L.prefixRegexp=S.prefixRegexp||"";L.node=H;L.sections=L.node.all(L.options.sectionsSelector);function Q(){L.nodeFormManagerMap={};L.sections.each(function(V){var U=new E.widgets.rememberme.formManager(V,L.repository,L.prefixRegexp,S.configuration);L.nodeFormManagerMap[V]=U})}function G(){L.dataSource=new YAHOO.util.FunctionDataSource(function(U){return L.repository.getAll()})}function T(){L.sections.each(function(V){var U=L.nodeFormManagerMap[V];O(U.getKeyFields())})}function O(U){E.Array.each(U,function(V){var W=V.get("type");if(W=="text"){F(V,A(V))}})}function F(U,W){var V=new YAHOO.widget.AutoComplete(U.get("id"),W,L.dataSource,L.options);V.generateRequest=function(X){return decodeURI(X)};V.autoHighlight=false;V.resultTypeList=false;V.applyLocalFilter=true;V.formatResult=K;V.itemSelectEvent.subscribe(N);V.filterResults=P;V.context=U;R.push(V)}function P(Z,W,a,V){var X=V.scope;var U=X.context;var Y=[];E.Array.each(a.results,function(c){var b=L.options.matcher(U,c,Z);if(b){c.match=b;Y.push(c)}});a.results=Y;return a}function K(X,Y,W){var U=[];E.Array.each(L.keyFields,function(Z){U.push(X[Z])});var V=C(X.match,Y,"<b>"+Y+"</b>");return V+" ["+U.join(" ")+"]"}function I(){L.options=L.options||{};L.options.animSpeed=L.options.animSpeed||0.1;L.options.queryDelay=L.options.queryDelay||0.01;L.options.minQueryLength=L.options.minQueryLength||0;L.options.maxResultsDisplayed=L.options.maxResultsDisplayed||10;L.options.matcher=L.options.matcher||J,L.options.strCmp=L.options.strCmp||B}function J(U,W,Z){var V=U.get("name");var X=V.replace(new RegExp(L.options.prefixRegexp),"");var Y=L.options.strCmp(W[X],Z);if(Y){return W[X]}return""}function N(W,Y){var X=Y[0],V=Y[2];var U=X.context;var a=U.ancestor(L.options.sectionsSelector);var Z=L.nodeFormManagerMap[a];Z.load(V)}L.activate=function(U){if(!M){T();M=true}L.repository.setWriteModeEnabled(U)};L.purgeHandlers=function(){for(var U in R){R[U].destroy();R[U]=null}R=[];M=false};L.saveOrUpdateFormData=function(){if(M===true){L.sections.each(function(V){var U=L.nodeFormManagerMap[V];U.save()})}};Q();G();I()};function B(G,F){return G&&F&&G.toLowerCase().indexOf(F.toLowerCase())!=-1}function C(F,H,G){return F.replace(RegExp(H,"gi"),G)}function A(F){var G=F.ancestor();var I=F.get("id")+"_div";var H=E.Node.create('<div id="'+I+'"></div>');G.appendChild(H);return I}E.widgets=E.widgets||{};E.widgets.rememberme=E.widgets.rememberme||{};E.widgets.rememberme.base=D},"1.0.0",{requires:[]});YUI.add("event-simulate",function(A){(function(){var K=A.Lang,J=A.Array,F=K.isFunction,D=K.isString,G=K.isBoolean,P=K.isObject,O=K.isNumber,N=A.config.doc,Q={click:1,dblclick:1,mouseover:1,mouseout:1,mousedown:1,mouseup:1,mousemove:1},M={keydown:1,keyup:1,keypress:1},C={blur:1,change:1,focus:1,resize:1,scroll:1,select:1},E={scroll:1,resize:1,reset:1,submit:1,change:1,select:1,error:1,abort:1};A.mix(E,Q);A.mix(E,M);function I(V,Z,U,S,b,R,L,a,X,d,c){if(!V){A.error("simulateKeyEvent(): Invalid target.")}if(D(Z)){Z=Z.toLowerCase();switch(Z){case"textevent":Z="keypress";break;case"keyup":case"keydown":case"keypress":break;default:A.error("simulateKeyEvent(): Event type '"+Z+"' not supported.")}}else{A.error("simulateKeyEvent(): Event type must be a string.")}if(!G(U)){U=true}if(!G(S)){S=true}if(!P(b)){b=window}if(!G(R)){R=false}if(!G(L)){L=false}if(!G(a)){a=false}if(!G(X)){X=false}if(!O(d)){d=0}if(!O(c)){c=0}var Y=null;if(F(N.createEvent)){try{Y=N.createEvent("KeyEvents");Y.initKeyEvent(Z,U,S,b,R,L,a,X,d,c)}catch(W){try{Y=N.createEvent("Events")}catch(T){Y=N.createEvent("UIEvents")}finally{Y.initEvent(Z,U,S);Y.view=b;Y.altKey=L;Y.ctrlKey=R;Y.shiftKey=a;Y.metaKey=X;Y.keyCode=d;Y.charCode=c}}V.dispatchEvent(Y)}else{if(P(N.createEventObject)){Y=N.createEventObject();Y.bubbles=U;Y.cancelable=S;Y.view=b;Y.ctrlKey=R;Y.altKey=L;Y.shiftKey=a;Y.metaKey=X;Y.keyCode=(c>0)?c:d;V.fireEvent("on"+Z,Y)}else{A.error("simulateKeyEvent(): No event simulation framework present.")}}}function B(a,f,X,U,g,Z,W,V,T,R,S,L,e,c,Y,b){if(!a){A.error("simulateMouseEvent(): Invalid target.")}if(D(f)){f=f.toLowerCase();if(!Q[f]){A.error("simulateMouseEvent(): Event type '"+f+"' not supported.")}}else{A.error("simulateMouseEvent(): Event type must be a string.")}if(!G(X)){X=true}if(!G(U)){U=(f!="mousemove")}if(!P(g)){g=window}if(!O(Z)){Z=1}if(!O(W)){W=0}if(!O(V)){V=0}if(!O(T)){T=0}if(!O(R)){R=0}if(!G(S)){S=false}if(!G(L)){L=false}if(!G(e)){e=false}if(!G(c)){c=false}if(!O(Y)){Y=0}var d=null;if(F(N.createEvent)){d=N.createEvent("MouseEvents");if(d.initMouseEvent){d.initMouseEvent(f,X,U,g,Z,W,V,T,R,S,L,e,c,Y,b)}else{d=N.createEvent("UIEvents");d.initEvent(f,X,U);d.view=g;d.detail=Z;d.screenX=W;d.screenY=V;d.clientX=T;d.clientY=R;d.ctrlKey=S;d.altKey=L;d.metaKey=c;d.shiftKey=e;d.button=Y;d.relatedTarget=b}if(b&&!d.relatedTarget){if(f=="mouseout"){d.toElement=b}else{if(f=="mouseover"){d.fromElement=b}}}a.dispatchEvent(d)}else{if(P(N.createEventObject)){d=N.createEventObject();d.bubbles=X;d.cancelable=U;d.view=g;d.detail=Z;d.screenX=W;d.screenY=V;d.clientX=T;d.clientY=R;d.ctrlKey=S;d.altKey=L;d.metaKey=c;d.shiftKey=e;switch(Y){case 0:d.button=1;break;case 1:d.button=4;break;case 2:break;default:d.button=0}d.relatedTarget=b;a.fireEvent("on"+f,d)}else{A.error("simulateMouseEvent(): No event simulation framework present.")}}}function H(W,V,S,R,L,U){if(!W){A.error("simulateUIEvent(): Invalid target.")}if(D(V)){V=V.toLowerCase();if(!C[V]){A.error("simulateUIEvent(): Event type '"+V+"' not supported.")}}else{A.error("simulateUIEvent(): Event type must be a string.")}var T=null;if(!G(S)){S=(V in E)}if(!G(R)){R=(V=="submit")}if(!P(L)){L=window}if(!O(U)){U=1}if(F(N.createEvent)){T=N.createEvent("UIEvents");T.initUIEvent(V,S,R,L,U);W.dispatchEvent(T)}else{if(P(N.createEventObject)){T=N.createEventObject();T.bubbles=S;T.cancelable=R;T.view=L;T.detail=U;W.fireEvent("on"+V,T)}else{A.error("simulateUIEvent(): No event simulation framework present.")}}}A.Event.simulate=function(S,R,L){L=L||{};if(Q[R]){B(S,R,L.bubbles,L.cancelable,L.view,L.detail,L.screenX,L.screenY,L.clientX,L.clientY,L.ctrlKey,L.altKey,L.shiftKey,L.metaKey,L.button,L.relatedTarget)}else{if(M[R]){I(S,R,L.bubbles,L.cancelable,L.view,L.ctrlKey,L.altKey,L.shiftKey,L.metaKey,L.keyCode,L.charCode)}else{if(C[R]){H(S,R,L.bubbles,L.cancelable,L.view,L.detail)}else{A.error("simulate(): Event '"+R+"' can't be simulated.")}}}}})()},"3.1.2",{requires:["event-base"]});YUI.add("node-event-simulate",function(A){A.Node.prototype.simulate=function(C,B){A.Event.simulate(A.Node.getDOMNode(this),C,B)}},"3.1.2",{requires:["node-base","event-simulate"]});YUI.add("wl-payc",function(C){var B="savedCardTypes";var A="savedCard";C.components.Payc=function(AH){var m=this;m.validationMessages=AH.validationMessages;var i=sabre.config.satConfiguration.insuranceConfiguration;var U=AH.initData;var AY=AH.compInstConfig;var f=(AH.state==="paymentMultiFop");var X=(AY.layoutType=="TAB_LAYOUT"?"tabLayout":"radioLayout");var AM,w=[];var AN=-1;var y;var AE;var v;var AP;var M;var V;var z=-1;var AQ;var W=0,c=null;var AV=false;var p=false;function S(){AM=[];w=[];AN=U.modifiedLevel;y=null;AE=null;v={total:U.paymentAmount.amount||0,totalInCurrency:0,currency:U.paymentAmount.currency,insurance:0,dueWithInsurance:[U.paymentAmount.amount],dueWithoutInsurance:[U.paymentAmount.amount]};AP=C.getDecimals(U.paymentAmount.currencyCode);M={prefix:U.paymentAmount?U.paymentAmount.currency+" ":"",currencyCodeSeparator:"&nbsp;"};V={thousandsSeparator:",",decimalSeparator:".",decimalPlaces:AP}}var h={FOPs:[],resetFops:function(){h.FOPs.length=0},hasSelectedCards:function(){for(var Ac in U.selectedCards){var Ad=U.selectedCards[Ac];if(Ad&&Ad.selected){return true}}return false},hasSelectedTravelBankCards:function(){if(U.travelBankCard){return U.travelBankCard.selected}return false},hasNextPaymentWidgets:function(Ac){return f&&y.hasNextPaymentWidgets(Ac)},getAmountToRefund:function(){return U.amountToRefund},getAmountToAddCollect:function(){return U.amountToAddCollect},getNetAmount:function(){return U.netAmount},isDisplayExchangeSplitVCRAndEMDMessage:function(){return U.displayExchangeSplitVCRAndEMDMessage},isDisplayExchangeMessage:function(){return U.displayExchangeMessage},isDisplayFraudMessage:function(){return AY.fraudMessagePresented},getPreviouslySelectedFOPBeforeSubmit:function(){return U.selectedCards},getTravelBankCard:function(){return U.travelBankCard},getCardModel:function(Ag,Ae,Ad){var Af=Ag==U.savedCardsSectionName;var Ac;if(Ae.configuration.travelBank){Ac=U.travelBankCard}else{if(Af){Ac=AU(Ae.code,Ad)}else{Ac=F(Ae.code)}}return Ac},getSelectedFops:function(){return y.getSelectedFops()},getInitialSelectedFops:function(){return y.getInitialSelectedFops()},getPayment:function(){return v},getDueWithInsurance:function(Ac){return v.dueWithInsurance[Ac]||0},getDueWithoutInsurance:function(Ac){return v.dueWithoutInsurance[Ac]||0},cancel:function(Ad){C.one(".payc").addClass("loading");var Ac={data:{level:Ad},on:{end:function(){C.one(".payc").removeClass("loading")},success:function(){y.cancelActiveFops(Ad)}}};m.fireEvent("to-ajax",{cfg:Ac,actionCode:"cancel"})},clearFops:function(Ac){h.recalculateDue();y.cancelActiveFops(Ac);g(Ac);h.clearPurchaserInfoData(Ac)},clearSelectedCard:function(Ae,Ad,Ac){m.fireEvent("to-ajax",{cfg:{data:{},on:{end:function(){},success:function(){if(Ac){Ac.hide()}h.clearFops(Ae);if(Ad){Ad()}}}},actionCode:"clearSelectedCard"})},recalculateDue:function(Ae,Ad){C.one(".payc").addClass("loading");var Ac={data:u(v),on:{end:function(){C.one(".payc").removeClass("loading")},success:function(Ag,Af){if(Af){o(Af,v);y.updateActiveFops();AI();C.Array.each(AW(),function(Ah){if(Ah){j(Ah.level)}});if(Ae){Ae(Ad)}}}}};m.fireEvent("to-ajax",{cfg:Ac,actionCode:"calculateDue"})},getSurcharge:function(Ae,Af,Ad){C.one(".payc").addClass("loading");var Ac={data:{cardCodes:Ae,total:v.total},on:{end:function(){C.one(".payc").removeClass("loading")},success:function(Ah,Ag){if(Ag){Af(Ag,Ad)}}}};m.fireEvent("to-ajax",{cfg:Ac,actionCode:"getSurcharge"})},priceMapper:function(Ac,Ad){return{amount:Ac||0,value:Ad||h.formatValue(Ac),currency:U.paymentAmount.currency||"",currencyCode:U.paymentAmount.currencyCode||""}},priceMapperWithCurrency:function(Ad,Ac,Ae){return{amount:Ad||0,value:Ae||h.formatValue(Ad),currency:Ac||"",currencyCode:Ac||""}},currentCurrency:function(){return U.paymentAmount.currencyCode},formatValue:function(Ad,Ae){var Ac=C.merge(Ae,V);return C.DataType.Number.format(parseFloat(Ad)||0,Ac)},formatPrice:function(Ae,Ad){var Af=C.merge(Ad,M);function Ac(Ag){return Ae&&Ae[Ag]}return C.formatPrice({value:Ac("value")||h.formatValue(Ac("amount")),currency:Ac("currency"),currencyCode:Ac("currency")},Af)},confirmLogout:function(Ae){var Af=[{text:'<span class="translate" wl:translate="label.payc.fopTBConfirmLogout.ok"></span>',handler:function(){Ae();this.hide()}},{text:'<span class="translate" wl:translate="label.payc.fopTBConfirmLogout.cancel"></span>',handler:function(){this.hide()}}];var Ad={buttons:Af,close:false};var Ac=new C.widgets.PopupWidget(C.one(document.body),'<p><span class="translate" wl:translate="label.payc.fopTBConfirmLogout.message"></span></p>',Ad);Ac.show();return true},confirmFOPChange:function(Ah,Ad,Af){if((D(Ah)||h.getSubmittedModifiedLevel()==Ah)&&AY.confirmFopChangeWhenDataEntered===true){var Ag=[{text:'<span class="translate" wl:translate="label.payc.fopChangePopup.ok"></span>',handler:function(){h.clearSelectedCard(Ah,Ad,this)}},{text:'<span class="translate" wl:translate="label.payc.fopChangePopup.cancel"></span>',handler:function(){if(Af){Af()}this.hide()}}];var Ae={buttons:Ag,close:false};var Ac=new C.widgets.PopupWidget(C.one(document.body),'<p><span class="translate" wl:translate="label.payc.fopChangePopup.message"></span></p>',Ae);Ac.show()}else{h.clearSelectedCard(Ah,Ad)}},clearRememberedValues:g,addValueRememberingEvents:function(Ac,Ae,Ad){C.on("focus",x,Ac,Ac,Ae);C.on("blur",K,Ac,Ac,Ae,Ad)},rememberInitialState:N,getPartial:function(Ac,Ad){return m.getPartial(Ac,Ad)},updateChangedValue:s,getPartial:function(Ac,Ad){return m.getPartial(Ac,Ad)},updateChangedValueByKey:Q,getPartial:function(Ac,Ad){return m.getPartial(Ac,Ad)},getPartials:function(Ac,Ad){return m.getPartials(Ac,Ad)},replaceData:function(Ad,Ac){return m.replaceData(Ad,Ac)},clearServerValidationMessages:function(){m.context.validationMessages={}},hasServerValidationMessages:function(){return C.Object.size(m.context.validationMessages)>0},isFopRestricted:function(Ac){return C.Array.indexOf(U.restrictedFOPs,Ac)!=-1},isAnyFOPRestricted:function(Ad){var Ac=false;C.Array.each(U.sections[Ad],function(Ae){if(h.isFopRestricted(Ae.code)){Ac=true}});return Ac},isRestrictedFopDisabled:function(Ac){return"SHOW_DISABLED"==AY.restrictedFOPActionPerCardType[Ac]},createMessageFopUnavailable:function(Ac){if(AY.restrictedFOPMessagePresented&&h.isAnyFOPRestricted(Ac)){return h.getPartial("_paycFopUnavailableMessage")}return""},isUserLoggedToTravelBank:function(){if(U.hasTravelBankCards){var Ae=U.travelBankCard;var Ad=Ae.loggedIn;var Ac=false;if(Ae.availableFunds){Ac=true}return Ad&&Ac}return false},getTravelBankStatus:function(){if(U.hasTravelBankCards){return U.travelBankCard.status}return"TRAVEL_BANK_UNAVAILABLE"},isAirlineMor:function(){return i.airlineMerchantOfRecord},getPaymentAmount:function(Ad){var Ac=v.dueWithoutInsurance[Ad]||0;if(i.airlineMerchantOfRecord){Ac=v.dueWithInsurance[Ad]||0}return this.priceMapper(Ac)},getPaymentAmountInCurrency:function(){return this.priceMapperWithCurrency(v.totalInCurrency,v.currency)},getPassengerInformationList:function(){return U.availablePassengerInformationList},getDefaultPassengerInformationIndex:function(){return U.defaultPassengerInformationIndex},getModifiedLevel:function(){return AN},getSubmittedModifiedLevel:function(){return U.modifiedLevel},clearPurchaserInfoData:function(Ag){var Af=h.getSelectedFops();for(var Ad=Ag;Ad<Af.length;Ad++){var Ae=Af[Ad];if(!Ae||Ae.level!=Ag){continue}if(Ae.componentModel.selectedCards.length>0){var Ac=Ae.componentModel.selectedCards[0];if(Ac.purchaserContactInfo!=undefined){Ac.purchaserInfoDropdown="";Ac.purchaserContactInfo={};Ac.billingData={};Ae.detailsHtml=false}Ac.nameOnCard="";Ac.expDate.date=null;Ac.expDate.day="";Ac.expDate.month="";Ac.expDate.year="";AH.validationMessages={};m.validationMessages={}}}},isInsuranceEnabled:function(Ac){return Ac&&Ac!=="NO"},isRememberMeEnabled:function(){return AV},isRememberMeWriteModeEnabled:function(){return p},displayInsuranceAndHotelUnacceptableOverlayIfNeeded:function(){function Af(Aq,Ap){return C.Array.indexOf(Aq,Ap)!==-1}var Ae=sabre.config.satConfiguration.formsOfPaymentConfiguration.insuranceUnacceptableFOPs;var Am=sabre.config.satConfiguration.formsOfPaymentConfiguration.hotelUnacceptableFOPs;var Ad={insurance:false,hotel:false};function Ah(Aq){function Ar(A5){var A2=[];for(var A4=0,A1=A5.length;A4<A1;A4++){var A3=C.translateParametrized("creditCard."+A5[A4]);A2.push(A3)}return A2}var Ap="";var Ay;if(Aq.insurance&&Aq.hotel){Ap=C.translateParametrized("label.sbmt.insuranceAndHotelOverlay.ti")+"/"+C.translateParametrized("label.sbmt.insuranceAndHotelOverlay.hr");var Az=C.Array.unique(Ae.concat(Am));Ay=Ar(Az)}else{if(Aq.insurance){Ap=C.translateParametrized("label.sbmt.insuranceAndHotelOverlay.ti");Ay=Ar(Ae)}else{if(Aq.hotel){Ap=C.translateParametrized("label.sbmt.insuranceAndHotelOverlay.hr");Ay=Ar(Am)}}}var Aw='<span class="translate" wl:translate="label.sbmt.insuranceAndHotelOverlay.title|'+Ap+'"></span>';var Av='<span class="translate" wl:translate="label.sbmt.insuranceAndHotelOverlay.howToProceed|'+Ap+'"></span>';var Au='<span class="translate" wl:translate="label.sbmt.insuranceAndHotelOverlay.remove.link|'+Ap+'"></span>';var A0;if(Ay.length===1){A0='<p><span class="translate" wl:translate="label.sbmt.insuranceAndHotelOverlay.unacceptableInfo.single|'+Ap+"|"+Ay[0]+'"></span></p>'}else{var Ax="";for(var As=0,At=Ay.length;As<At-1;As++){Ax+=Ay[As];if(As!==At-2){Ax+=", "}}A0='<p><span class="translate" wl:translate="label.sbmt.insuranceAndHotelOverlay.unacceptableInfo.multiple|'+Ap+"|"+Ax+"|"+Ay[Ay.length-1]+'"></span></p>'}return m.getPartial("_insuranceAndHotelUnacceptableOverlay",{message:A0,title:Aw,howToProceed:Av,removeLink:Au})}function Ak(Ax,As){var Ap;function At(Az){m.fireEvent("decline-insurance",{callback:Az})}function Av(){Ax.sort();Ax.reverse();C.Array.each(Ax,function(Az){y.resetLevelToInitialSelection(Az)});Ap.destroy()}function Ar(){m.fireEvent("to-ajax",{cfg:{data:{},on:{success:function(){m.fireEvent("refresh-cart");m.fireEvent("refresh-amountDue");U.hotelReservationSelected=false;Ap.destroy()}}},actionCode:"clearHotelReservation"})}var Au;var Ay;if(As.insurance&&As.hotel){Ay=function(){Ar()};Au=function(){At(Ay)}}else{if(As.insurance){Ay=function(){Ap.destroy()};Au=function(){At(Ay)}}else{if(As.hotel){Au=Ar}}}C.delegate("click",Au,"#insurance-unacceptable-overlay","#remove-link");C.delegate("click",Av,"#insurance-unacceptable-overlay","#change-button");var Aw=Ah(As);var Aq={width:"430px",height:"",close:false,renderInsideBody:true};Ap=new C.widgets.PopupWidget(C.one("#payment"),Aw,Aq);Ap.show()}function Ag(Aq){var As=y.getSelectedFops();for(var At=0,Ap=As.length;At<Ap&&As[At];At++){var Ar=As[At].code;if(As[At] instanceof C.widgets.payment.creditCard&&!Af(Aq,Ar)){return true}}return false}function An(Au){var Av=[];var Ax=h.FOPs;for(var Aq=0,At=Ax.length;Aq<At;Aq++){var Az=true;for(var As=0,Ar=Ax[Aq].length;As<Ar;As++){var Ay=Ax[Aq][As].code;if(!Af(Au,Ay)){Az=false}}if(Az&&Ax[Aq].length>0){Av.push(Aq)}}var Aw=y.getSelectedFops();for(var Aq=0,At=Aw.length;Aq<At&&Aw[Aq];Aq++){if(!Af(Av,Aq)){var Ap=Aw[Aq].code;if(Af(Au,Ap)){Av.push(Aq)}}}return Av}var Al=[];var Ao=h.isInsuranceEnabled(WhiteLabel.getIbeData().insuranceCode);if(Ao){Al=An(Ae);if(Al.length>0){Ad.insurance=true}}var Aj=[];var Ac=U.hotelReservationSelected;if(Ac){Aj=An(Am);if(Aj.length>0){if(sabre.config.satConfiguration.hotels.displayAuxCreditCardSelectEnabled&&"PROVIDER"==sabre.config.satConfiguration.hotels.mor){if(!Ag(Am)){m.fireEvent("show-auxccselect-for-hotel",{})}else{m.fireEvent("hide-auxccselect-for-hotel",{})}Ad.hotel=false;Aj=[]}else{Ad.hotel=true}}else{if(sabre.config.satConfiguration.hotels.displayAuxCreditCardSelectEnabled){m.fireEvent("hide-auxccselect-for-hotel",{})}}}var Ai=C.Array.unique(Al.concat(Aj));if(Ai.length>0){Ak(Ai,Ad);return false}return true},getExchangeMessage:function(Ai){var Af="";var Ad=this.getAmountToRefund();var Ag=this.getDueWithInsurance(Ai);var Ah=this.priceMapper(Ag);if(this.isDisplayExchangeSplitVCRAndEMDMessage()){var Ae={amountToPay:this.formatPrice(Ah),amountToRefund:this.formatPrice(Ad)};Af=this.getPartial("_paymentExchangeMsg",Ae)}else{if(this.isDisplayExchangeMessage()){var Ac=Ad&&Ad.amount!=0&&Ah&&Ah.amount!=0;var Ae={amountToPay:this.formatPrice(Ah),amountToRefund:this.formatPrice(Ad)};if(Ac){Af=this.getPartial("_paymentExchangeMsgSameFop",Ae)}else{Af=this.getPartial("_paymentExchangeMsg",Ae)}}}return Af},getAmountDue:function(Ae){var Ad;var Ac=this.getNetAmount();if(0===Ae&&Ac){Ad=this.formatPrice(this.priceMapper(Ac.amount))}else{Ad=this.formatPrice(this.priceMapper(this.getDueWithInsurance(Ae)))}return Ad}};function F(Af){var Ad,Ac;for(Ad in U.selectedCards){var Ae=U.selectedCards[Ad];if(Ae){if(Ae.cardType!=null){Ac=Ae.cardType.code==Af}if(Ac){return Ae}}}return null}function AU(Af,Ag){var Ad,Ac;Ag=Ag||0;for(Ad in U.savedCards){var Ae=U.savedCards[Ad];Ac=Ae.cardType.code==Af&&Ad==Ag;if(Ac){return Ae}}return null}function K(Ad,Af,Ae){Af=Af||0;var Ac=Ad.target;s(Ac,Af);if(D(Af)){AN=Af}else{a(Af)}if(Ae){Ae()}}function s(Ac,Af){var Ae=Ac.get("id");var Ad=Ac.get("value");Q(Ae,Ad,Af)}function Q(Ac,Ad,Ae){Ae=Ae||0;w[Ae]=w[Ae]||{};w[Ae][Ac]=Ad}function N(Ac,Ad,Ae){Ae=Ae||0;AM[Ae]=AM[Ae]||{};if(!C.Object.hasKey(AM[Ae],Ac)){AM[Ae][Ac]=Ad}}function x(Ae,Ag){Ag=Ag||0;var Ac=Ae.target;var Ad=Ac.get("id");var Af=Ac.get("value");N(Ad,Af,Ag)}function g(Ac){Ac=Ac||0;AM[Ac]={};w[Ac]={};a(Ac);h.clearPurchaserInfoData(Ac)}function a(Ac){U.modifiedLevel=-1;AN=-1}function D(Aj){Aj=Aj||0;var Af;var Ad=AM[Aj];var Ai=w[Aj];if(Ad){var Ag=C.Object.keys(Ad);for(Af=0;Af<Ag.length;Af++){var Ae=Ag[Af];if(C.Object.hasKey(Ai,Ae)){if(Ai[Ae]!=Ad[Ae]){return true}}}}if(Ai){var Ac=C.Object.size(Ai);var Ah=0;if(Ad){Ah=C.Object.size(Ad)}if(Ac>Ah){return true}}return false}function AK(Ad){for(var Ac in Ad){if(Ad[Ac].travelBank){return true}}return false}function R(Ac){return !AK(Ac)}function L(Ad){if(z>=0){var Ac=C.Array.indexOf(Ad,"travelBankCardTypes");if(Ac>=0){Ad.splice(Ac,1);Ad.splice(z,0,"travelBankCardTypes")}}return Ad}function Y(){if(U.sections.length===0){return[]}var Ac=[];for(var Ad in U.sections){if(R(U.sections[Ad])){Ac.push(Ad)}}return L(Ac)}function AC(){if(!U.disableForFlatFeeUpgrade){var Ad=f?"multiFop":"singleFop";S();var Ac=Y();h.resetFops();AE=new C.widgets.payment.layouts[X].base(AY,h,U,{componentNode:m.node});y=C.widgets.payment.FOPs[Ad](AY,U,h,{SAVED_CARDS_SECTION_KEY:B,SAVED_CARDS_TEMPLATE:A,priceFormat:M,layout:AE,layoutType:X});var Ae={message:y.createInitialHeaderMessage(Ac),fopList:y.createPaymentWidget(Ac)}}else{Ae={}}return Ae}m.onCreate=function(){AX();var Ac=AC();m.renderHtml(Ac)};m.onRenderState={initialized:r,paymentMultiFop:r,paymentNotRequired:AD};function AX(){if(AY.integratedComponents){var Ac=m.node.ancestor(".component.payc");var Ad=Ac.ancestor();Ad.addClass("payc-integrated")}}function u(Ac){return y?{charged:y.getChargedPerLevel(),cardTypes:y.getCardCodePerLevel(),dueWithInsurance:[],dueWithoutInsurance:[],selectedInsuranceCode:Ac.selectedInsuranceCode}:{}}function o(Ad,Ac){Ac.total=Ad.total;Ac.totalInCurrency=Ad.totalInCurrency;Ac.insurance=Ad.insurance;Ac.dueWithInsurance=Ad.dueWithInsurance;Ac.dueWithoutInsurance=Ad.dueWithoutInsurance;Ac.currency=Ad.currency}m.incomingEvents={"update-with-insurance":function(Af){var Ad=Af.data;v.insuranceOffer=Ad.offerPrice;v.selectedInsuranceCode=Ad.offerCode;var Ae=C.one(".payc");Ae.addClass("loading");var Ac=h.isInsuranceEnabled(Ad.offerCode);y.changeAppearanceOnInsuranceChange(Ac);Ae.removeClass("loading");h.displayInsuranceAndHotelUnacceptableOverlayIfNeeded();h.recalculateDue();Aa();C.Array.each(AW(),function(Ag){if(Ag){Ag.updateSurchargeInformation()}})},"update-with-slider":function(Ac){Aa();h.recalculateDue();AS()},"block-list":function(){var Ac=C.one(".payc");if(Ac){Ac.addClass("loading")}},"page-submitted":function(){C.Array.each(h.getSelectedFops(),function(Ac){Ac.onSubmit()})},"logged-in":function(Ac){AS(false)},"logged-out":function(){AS(true)},"refresh-for-bnpl":function(Ac){AA(Ac)},"rememberme-activated":function(Ac){AV=true;p=Ac.writeModeEnabled;AS(false)},"update-amount-to-charge":function(){h.recalculateDue()},"refresh-after-auxcc-removal":function(){AS(true)}};function Ab(Ae){if(D()){var Af=[{text:'<span class="translate" wl:translate="label.payc.fopChangePopup.ok"></span>',handler:function(){AS(true,null,true);this.hide()}},{text:'<span class="translate" wl:translate="label.payc.fopChangePopup.cancel"></span>',handler:function(){this.hide();m.fireEvent("restore-selection",{data:Ae})}}];var Ad={buttons:Af,close:false};var Ac=new C.widgets.PopupWidget(C.one(document.body),'<p><span class="translate" wl:translate="label.payc.fopChangePopup.onHoldMessage"></span></p>',Ad);Ac.show()}else{AS(true,null,true)}}function AA(Ac){if(Ac.hidePaymentComponent){Ab(Ac);AD()}else{AI();Ab(Ac)}}function P(Ac){y.applyEvents(Ac);C.Array.each(AW(),function(Ad){if(Ad){Ad.applyEvents()}})}function AR(){C.detach("creditCard:detailsRendered");C.detach("multipleFop:clearSurchargeFee");C.detach("multipleFop:refreshSbmt");C.detach("creditCard:showSurchargeFee");C.detach("travelbank:logoutConfirm");C.detach("travelBank:LoginRendered");C.detach("travelBank:loginRequest");C.detach("travelBank:showForgotPassword");C.detach("travelBank:travelBankViewBalance");C.detach("giftCard:applyCard");C.detach("giftCard:removeCard");C.detach("paypal:showSurchargeFee");C.detach("multipleFop:sectionChanged");C.detach("confirmConditions:refresh");C.on("creditCard:detailsRendered",AO);C.on("multipleFop:clearSurchargeFee",Aa);C.on("multipleFop:refreshSbmt",AL);C.on("creditCard:showSurchargeFee",n);C.on("travelbank:logoutConfirm",O);C.on("travelBank:LoginRendered",AG);C.on("travelBank:loginRequest",b);C.on("travelBank:showForgotPassword",Z);C.on("travelBank:travelBankViewBalance",function(){m.fireEvent("travelBankViewBalance")});C.on("giftCard:applyCard",J);C.on("giftCard:removeCard",k);C.on("paypal:showSurchargeFee",n);C.on("creditCard:card-number-changed",function(Ac){m.fireEvent("card-number-changed",{data:Ac})});C.on("creditCard:fop-type-changed",function(Ac){m.fireEvent("fop-type-changed",{data:Ac})});C.on("multipleFop:sectionChanged",function(Ac){m.fireEvent("fop-type-changed",{data:Ac})});C.on("confirmConditions:refresh",T);C.on("creditCard:installment-months-selected",function(Ad){var Ac={data:Ad,on:{end:function(){},success:function(){m.fireEvent("installment-months-selected",{data:Ad})}}};m.fireEvent("to-ajax",{cfg:Ac,actionCode:"installmentMonthsSelected"})})}function r(Ac){if(U.disableForFlatFeeUpgrade){t()}else{AR();P(Ac);AE.applyEvents();Aa();C.Array.each(AW(),function(Ad){if(Ad){Ad.updateSurchargeInformation()}});AI()}}function AD(){if(U.bnplchosen){if(U.showComponentWithoutHoldFee){var Ae=h.formatPrice(U.paymentAmount);var Ac=m.getPartial("_paycPaymentNotRequired",{price:Ae});var Ad=C.one("#payment");if(Ad){Ad.set("innerHTML",C.decodeHtmlEntities(Ac))}}else{t()}}}function AW(){return Array.prototype.concat.apply([],h.FOPs)}function t(){C.one(".payc").addClass("hidden");q({visible:false})}function q(Ac){if(AY.integratedComponents){m.fireEvent("change-visibility",{data:Ac})}}function I(){var Ae=h.getSelectedFops();for(var Ac=0;Ac<Ae.length;Ac++){var Ad=Ae[Ac];h.cancel(Ad.level)}}function AI(){var Ac=C.DataType.Number.format(parseFloat(v.dueWithInsurance[0]));if(Ac>0||U.bnplchosen){C.one(".payc").removeClass("hidden");q({visible:true})}else{t();I()}}function AO(Ad,Ac){e(Ac);AG(Ad)}function e(Ad){var Ae=h.getInitialSelectedFops();if(Ad&&Ae[0]){var Af=false;for(var Ac=0;Ac<Ae.length;Ac++){if(Ae[Ac].cardType&&Ae[Ac].cardType.code&&Ad.code===Ae[Ac].cardType.code){Af=true}}if(Af){AH.validationMessages=m.validationMessages;m.fireEvent("show-messages",{data:{messages:[{id:"validationError",code:"",level:"error"}]}})}else{AH.validationMessages=null;m.fireEvent("remove-messages",{data:{messages:["validationError"]}})}}}function AG(Ac){m.fireEvent("adjust-popup-mask");C.wlValidation.errorRendering.hideAllOverlays();C.wlValidation.showServerSideValidationErrors(AH);C.wlValidation.initializeForPartial(AH.getType(),C.wlValidation.validationEngineRules,C.wlValidation.validationConfiguration,Ac);C.on("blur",C.wlValidation.validate,Ac);Ac.removeClass("loading")}function O(Ac){m.fireEvent("logout-confirm",Ac)}function AL(Ac){m.fireEvent("refresh-sbmt",Ac)}function b(Ae,Ac){var Ad={data:{username:escape(Ae.one("#username").get("value")),password:escape(Ae.one("#password").get("value"))},on:{end:d,success:function(Ag,Af){var Ah=function(){Ac(Ae,Af,f)};if(Af.authenticationResult&&(Af.authenticationResult=="SUCCESSFUL"||Af.authenticationResult=="TRAVEL_BANK_UNAVAILABLE")){m.fireEvent("bt-logged-in",{user:Af.user,updateContent:true});AS(true,Ah)}else{Ah()}}}};m.fireEvent("to-ajax",{componentType:"login",cfg:Ad,actionCode:"login"})}function d(){var Ac=C.one(".payc");f?Ac.removeClass("loading"):Ac.get("parentNode").removeClass("loading")}function Z(Ad){var Ac=new C.widgets.ForgotPassword(Ad,AH)}function AF(){return C.Array.indexOf(C.Object.keys(U.sections),"travelBankCardTypes")}function AB(){if(z<0){z=AF()}return U.sections.travelBankCardTypes}function E(Ac){U.sections.travelBankCardTypes=Ac}function AJ(Ae,Ad){var Ac=Ad&&AB();U=Ae.refreshedModel;if(Ac){E(Ac)}}function l(Ac){AH.state=Ac.currentComponentStateCode;f=(AH.state==="paymentMultiFop")}function n(Ac,Ad){AQ=C.later(300,this,AZ,[Ac,Ad])}function AZ(Ad,Ae){if(AQ){AQ=null}G();var Af=u(v);Af.creditCardCode=Ad.code;Af.requestPartials=["_surchargeNote"];Af.charged[Ad.level]=0;var Ac={data:Af,on:{end:function(){AT()},success:function(Ah,Ag){if(Ag&&!Ag.refreshedModel.surchargePrices.empty){Ae(Ad,Ag)}U=Ag.refreshedModel;o(Ag,v);y.updateActiveFops();j(Ad.level);if(Ad.level>0){j(0)}m.fireEvent("update-with-fop-surcharge")}}};m.fireEvent("to-ajax",{cfg:Ac,actionCode:"calculateSurcharge"})}function G(){++W;if(!c){var Ac=C.one(".payc");c=C.Node.create('<div class="componentLoadingContainer componentLoadingContainerOnlyComponent loading"></div>');Ac.prepend(c);Ac.setStyle("position","relative")}}function AT(){if(c&&0===--W){c.remove();c=null}}function Aa(Af,Ae){C.one(".payc").addClass("loading");var Ad=u(v);var Ac={data:Ad,on:{end:function(){C.one(".payc").removeClass("loading")},success:function(Ah,Ag){U=Ag.refreshedModel;o(Ag,v);y.updateActiveFops();j(Af,Ae);m.fireEvent("update-with-fop-surcharge")}}};m.fireEvent("to-ajax",{cfg:Ac,actionCode:"removeSurcharge"})}function J(Ae,Ad){C.one(".payc").addClass("loading");var Ac={data:Ad,on:{end:function(){C.one(".payc").removeClass("loading")},success:function(Ag,Af){Ae(Af)}}};m.fireEvent("to-ajax",{componentType:"payc",cfg:Ac,actionCode:"applyGiftCard"})}function k(Ad){C.one(".payc").addClass("loading");var Ac={data:{},on:{end:function(){C.one(".payc").removeClass("loading");if(sabre.config.satConfiguration.formsOfPaymentConfiguration.surchargeCheckEnabled){C.fire("multipleFop:clearSurchargeFee",Ad.level)}},success:function(Af,Ae){Ad.removeCardOnSuccess()}}};m.fireEvent("to-ajax",{componentType:"payc",cfg:Ac,actionCode:"removeGiftCard"})}function AS(Af,Ag,Ae){var Ac={data:{},on:{end:d,success:function(Ak,Ai){try{var Ah=AE.getActiveSection();AJ(Ai,Af);l(Ai);m.onCreate();if(typeof Ag==="function"){Ag()}AE.setActiveSection(Ah,y)}catch(Aj){C.log("Error during refreshing: "+Aj,"error")}}}};var Ad="refresh";if(Ae){Ad="refreshAndClear"}m.fireEvent("to-ajax",{componentType:"payc",cfg:Ac,actionCode:Ad})}function H(Ae,Ad,Ag){if(Ae){return Ae.one(Ad)}else{var Ac=C.one("#multi-fop-details-"+Ag);if(Ac){var Af=".payment-amount-right";return Ac.one(Af)}return null}}function j(Ac,Ah){G();if(Ac||Ac===0){var Aj="#multi-fop-amountdue-"+Ac+"_sectionAmountDue";var Ad=Ah?Ah.one(Aj):C.one(Aj);var Af=h.getAmountDue(Ac);var Ag=H(Ah,Aj,Ac);var Af;if(v.totalInCurrency>0){Af=h.formatPrice(h.priceMapperWithCurrency(v.totalInCurrency,v.currency))}else{Af=h.formatPrice(h.priceMapper(h.getDueWithInsurance(Ac)))}if(Ad){Ad.set("innerHTML",C.decodeHtmlEntities(Af))}if(Ac===0){var Ak="#multi-fop-amountdue-exchange-"+Ac;var Ai=C.one(Ak);if(Ai){var Ae=h.getExchangeMessage(Ac);Ai.set("innerHTML",C.decodeHtmlEntities(Ae))}}if(Ag){Ag.set("innerHTML",C.decodeHtmlEntities(Af))}}AT()}function T(){C.one("#confirm").removeAttribute("disabled")}}});YUI.add("wl-farerules",function(A){A.components.Farerules=function(C){var K=this;var L;var M={};var P=false;var D=C.compInstConfig;K.incomingEvents={showFareRules:B};K.onRenderState={initialized:function(Q){H(Q);if(D.tabHash){A.on("pageHtmlLoaded",function(){K.fireEvent("add_tabs_callback",{data:{tabHash:D.tabHash,additionalCallback:function(R){if(R.newValue){Q.removeClass("hidden")}else{Q.addClass("hidden")}}}})})}},ajax:function(R){if(D.enabled){function Q(){R.removeClass("loading")}R.addClass("loading");O(I,Q,true)}},overlay:function(Q){N()}};function B(R){if(C.state!="overlay"){return }var S=R.data||{};var Q=A.Lang.isFunction(S.callback)&&S.callback;O(G,Q,S.allFlightsSelected)}function O(U,R,T){var S=T?"__fareRulesContent":"__unavailableFareRules";var Q={data:{requestPartials:[S],flightsSelected:T},on:{end:R||function(){},success:function(X,W){if(W){var V=W.partials[S];U(V);H(K.node)}},failure:U}};K.fireEvent("to-ajax",{context:C,type:"farerules",cfg:Q,actionCode:"getFareRules"})}function E(Q){M[C.state]=Q.one(".fare-rules-container")}function H(R){var Q=R.one("ul");if(Q){Q.delegate("click",J,"li")}E(R);F()}function J(S){S.preventDefault();var T=S.currentTarget;if(T.hasClass("selected")){return }T.addClass("selected");T.siblings().removeClass("selected");var Q=T.get("parentNode").get("children").indexOf(T);var R=K.node.one(".yui-content").get("children");R.addClass("yui-hidden");R.item(Q).removeClass("yui-hidden")}function N(){L=new YAHOO.widget.Dialog("fare-rules-overlay",{visible:false,draggable:false,fixedcenter:"contained",zIndex:520,width:"700px",close:true});L.hideEvent.subscribe(function(){P=false;if(!M[C.state]){E(currentNode)}if(!M[C.state]){return }M[C.state].purge(true);M[C.state].set("innerHTML","")})}function I(Q){K.node.one(".fare-rules-list").set("innerHTML",A.decodeHtmlEntities(Q))}function G(Q){if(C.state=="overlay"){if(P){return }P=true;A.one("#fare-rules-overlay").removeClass("hidden");L.render(document.body);L.show();var R=A.one(L.element);if(R){K.node=R;I(Q)}L.center()}}function F(){var Q=C.compInstConfig;K.fireEvent("cssFareRules",{forceInitialize:true,data:{status:Q.status}})}}});YUI.add("wl-customhtml",function(A){A.components.Customhtml=function(B){}});YUI.add("wl-tcc",function(A){A.components.Tcc=function(G){var H=this;H.incomingEvents={cssFareRules:D,blockCheckbox:F};H.onRenderState={initialized:function(J){J.delegate("click",B,"#confirm");A.on("click",I,J.one("#fare-restrictions"),J);A.on("pageHtmlLoaded",function(){B.call(J)})}};G.initData=G.initData||{};if(A.UA.ie&&A.UA.ie<8){}else{A.each(A.all("span.iebreak"),function(J){J.remove()})}function B(L){var K=this;var J=K.one("#confirm")||(L&&L.currentTarget);if(J.get("checked")===true){C()}else{E()}}function I(J){J.preventDefault();H.fireEvent("show_rules",{forceInitialize:true})}function C(){H.fireEvent("unblock_submit",{forceInitialize:true})}function F(){A.one("#confirm").setAttribute("disabled","disabled")}function E(){H.fireEvent("block_submit",{forceInitialize:true})}function D(J){var K=J.data||{};if(K.status!="DISABLED"){A.one("#terms_and_conditions").removeClass("farerules-inline-disabled")}}}});YUI.add("wl-fraudnet",function(Y){Y.components.Fraudnet=function(context){var that=this;var jscFromIdAndName="jscData";var browserTimestamp="browserTimestamp";that.incomingEvents={"page-submitted":collectJSCData};function collectJSCData(data){collectBrowserTimestamp();invokeJSC();formfactor.pasedina(jscFromIdAndName)}function toISOString(now){return now.getUTCFullYear()+"-"+pad(now.getUTCMonth()+1)+"-"+pad(now.getUTCDate())+"T"+pad(now.getUTCHours())+":"+pad(now.getUTCMinutes())+":"+pad(now.getUTCSeconds())+"."+String((now.getUTCMilliseconds()/1000).toFixed(3)).slice(2,5)+"Z"}function pad(number){var r=String(number);if(r.length===1){r="0"+r}return r}function collectBrowserTimestamp(){var browserTimestampObj=document.getElementById(browserTimestamp);if(browserTimestampObj!=null&&browserTimestampObj!="undefined"){var now=new Date();if(Date.prototype.toISOString){browserTimestampObj.value=now.toISOString()}else{browserTimestampObj.value=toISOString(now)}}}function invokeJSC(){(function(){function c(b){try{if(navigator.plugins&&navigator.plugins.length){for(var d=0;d<navigator.plugins.length;d++){var a=navigator.plugins[d];if(0<=a.name.indexOf(b)){return a.name+(a.description?"|"+a.description:"")}}}}catch(c){}return""}function p(){for(var b=new Date,d=new Date,a=[function(){return"TF1"},function(){return"015"},function(){return ScriptEngineMajorVersion()},function(){return ScriptEngineMinorVersion()},function(){return ScriptEngineBuildVersion()},function(){return e("{7790769C-0471-11D2-AF11-00C04FA35D02}")},function(){return e("{89820200-ECBD-11CF-8B85-00AA005B4340}")},function(){return e("{283807B5-2C60-11D0-A31D-00AA00B92C03}")},function(){return e("{4F216970-C90C-11D1-B5C7-0000F8051515}")},function(){return e("{44BBA848-CC51-11CF-AAFA-00AA00B6015C}")},function(){return e("{9381D8F2-0288-11D0-9501-00AA00B911A5}")},function(){return e("{4F216970-C90C-11D1-B5C7-0000F8051515}")},function(){return e("{5A8D6EE0-3E18-11D0-821E-444553540000}")},function(){return e("{89820200-ECBD-11CF-8B85-00AA005B4383}")},function(){return e("{08B0E5C0-4FCB-11CF-AAA5-00401C608555}")},function(){return e("{45EA75A0-A269-11D1-B5BF-0000F8051515}")},function(){return e("{DE5AED00-A4BF-11D1-9948-00C04F98BBC9}")},function(){return e("{22D6F312-B0F6-11D0-94AB-0080C74C7E95}")},function(){return e("{44BBA842-CC51-11CF-AAFA-00AA00B6015B}")},function(){return e("{3AF36230-A269-11D1-B5BF-0000F8051515}")},function(){return e("{44BBA840-CC51-11CF-AAFA-00AA00B6015C}")},function(){return e("{CC2A9BA0-3BDD-11D0-821E-444553540000}")},function(){return e("{08B0E5C0-4FCB-11CF-AAA5-00401C608500}")},function(){return eval("navigator.appCodeName")},function(){return eval("navigator.appName")},function(){return eval("navigator.appVersion")},function(){return q(["navigator.productSub","navigator.appMinorVersion"])},function(){return eval("navigator.browserLanguage")},function(){return eval("navigator.cookieEnabled")},function(){return q(["navigator.oscpu","navigator.cpuClass"])},function(){return eval("navigator.onLine")},function(){return eval("navigator.platform")},function(){return eval("navigator.systemLanguage")},function(){return eval("navigator.userAgent")},function(){return q(["navigator.language","navigator.userLanguage"])},function(){return eval("document.defaultCharset")},function(){return eval("document.domain")},function(){return eval("screen.deviceXDPI")},function(){return eval("screen.deviceYDPI")},function(){return eval("screen.fontSmoothingEnabled")},function(){return eval("screen.updateInterval")},function(){return 0!==Math.abs(k-m)},function(){return t(b)},function(){return"@UTC@"},function(){var a=0,a=0;t(b)&&(a=Math.abs(k-m));return a=-(b.getTimezoneOffset()+a)/60},function(){return(new Date(2005,5,7,21,33,44,888)).toLocaleString()},function(){return eval("screen.width")},function(){return eval("screen.height")},function(){return h.Acrobat},function(){return h.Flash},function(){return h.QuickTime},function(){return h["Java Plug-in"]},function(){return h.Director},function(){return h.Office},function(){return(new Date).getTime()-d.getTime()},function(){return k},function(){return m},function(){return b.toLocaleString()},function(){return eval("screen.colorDepth")},function(){return eval("window.screen.availWidth")},function(){return eval("window.screen.availHeight")},function(){return eval("window.screen.availLeft")},function(){return eval("window.screen.availTop")},function(){return c("Acrobat")},function(){return c("Adobe SVG")},function(){return c("Authorware")},function(){return c("Citrix ICA")},function(){return c("Director")},function(){return c("Flash")},function(){return c("MapGuide")},function(){return c("MetaStream")},function(){return c("PDFViewer")},function(){return c("QuickTime")},function(){return c("RealOne")},function(){return c("RealPlayer Enterprise")},function(){return c("RealPlayer Plugin")},function(){return c("Seagate Software Report")},function(){return c("Silverlight")},function(){return c("Windows Media")},function(){return c("iPIX")},function(){return c("nppdf.so")},function(){var a=document.createElement("span");a.innerHTML="&nbsp;";a.style.position="absolute";a.style.left="-9999px";document.body.appendChild(a);var b=a.offsetHeight;document.body.removeChild(a);return b}],i="Acrobat;Flash;QuickTime;Java Plug-in;Director;Office".split(";"),j=0;j<i.length;j++){var l=i[j],f=h,v=l,g=l,l="";try{if(navigator.plugins&&navigator.plugins.length){for(var u=RegExp(g+".* ([0-9._]+)"),g=0;g<navigator.plugins.length;g++){var o=u.exec(navigator.plugins[g].name);null===o&&(o=u.exec(navigator.plugins[g].description));o&&(l=o[1])}}else{if(window.ActiveXObject&&r[g]){try{var p=new ActiveXObject(r[g][0]),l=r[g][1](p)}catch(x){l=""}}}}catch(w){l=w.message}f[v]=l}i="";for(j=0;j<a.length;j++){var n;try{n=a[j](this)}catch(y){n=""}i+=escape(n);i+=";"}var a=i,s;n=escape("@UTC@");i=(new Date).getTime();"boolean"!==typeof s&&(s=!1);for(j=!0;0<=(f=a.indexOf(n))&&(s||j);){a=a.substr(0,f)+i+a.substr(f+n.length),j=!1}return a}function t(b){var d=Math.min(k,m);return 0!==Math.abs(k-m)&&b.getTimezoneOffset()===d}function q(b){for(var d=0;d<b.length;d++){try{var a=eval(b[d]);if(a){return a}}catch(c){}}return""}function e(b){var d="";try{"undefined"!==typeof f.a.getComponentVersion&&(d=f.a.getComponentVersion(b,"ComponentID"))}catch(a){b=a.message.length,d=escape(a.message.substr(0,40<b?40:b))}return d}var f={},k=(new Date(2005,0,15)).getTimezoneOffset(),m=(new Date(2005,6,15)).getTimezoneOffset(),h=[],r={Flash:["ShockwaveFlash.ShockwaveFlash",function(b){return b.getVariable("$version")}],Director:["SWCtl.SWCtl",function(b){return b.ShockwaveVersion("")}]};try{f.a=document.createElement("span"),"undefined"!==typeof f.a.addBehavior&&f.a.addBehavior("#default#clientCaps")}catch(x){}h={};f.pasedina=function(b){try{if(!b){return p()}var d;a:{var a;try{a=document.getElementById(b)}catch(c){}if(null===a||"undefined"===typeof a){try{a=document.getElementsByName(b)[0]}catch(e){}}if(null===a||"undefined"===typeof a){for(var f=0;f<document.forms.length;f++){for(var h=document.forms[f],k=0;k<h.elements.length;k++){var g=h[k];if(g.name===b||g.id===b){d=g;break a}}}}d=a}if(null!==d){try{d.value=p()}catch(m){d.value=escape(m.message)}}}catch(o){}};window.formfactor=f})()}}});YUI.add("wl-sbmt",function(A){A.components.Sbmt=function(E){var I=this;var X;I.incomingEvents={unblock:O,block:L,"show-in-seats":N,"remote-submit":H,"show-popup":Q,refresh:D,"update-on-hold-status":J,"validate-submit":C};E.initData=E.initData||{};E.initData.pageCode=sabre.config.pageCode;var V=E.initData.componentCodesUnblockDependency;var G=E.initData.disableSubmitPermanently;I.onRenderState={initialized:function(Z){R()},refund:function(Z){K(["label.sbmt.comfirmButton.yes","label.sbmt.comfirmButton.no"]);R()},exchange:function(Z){K(["label.sbmt.exchange.confirmButton.yes","label.sbmt.exchange.confirmButton.no"]);R()},changePaxDetails:function(Z){K(["label.sbmt.changePaxDetails.confirmButton.yes","label.sbmt.changePaxDetails.confirmButton.no"]);R()},upgrade:function(Z){K(["label.sbmt.upgrade.confirmButton.yes","label.sbmt.upgrade.confirmButton.no"]);R()}};function F(){return A.utilsUrl.buildExecutionUrl(E.initData.returnUrlSuffix)}function R(){T(I.node)}function T(a){var Z=a.ancestor("form");if(Z){Z.on("submit",function(b){Y(Z.get("id"),b);S()})}}function Y(a,Z){I.fireEvent("page-submitted",{cfg:{},actionCode:"ignoreTransaction",formId:a,event:Z})}function S(){A.all("a").each(function(a){a.set("href","#");a.set("onclick",function(){})});var Z=A.all('input[type="submit"]');Z.each(function(a){a.set("disabled","disabled");a.addClass("disabled")})}function H(Z){I.node.ancestor("form").submit()}function C(a){var Z=I.node.ancestor("form");Z.all("input[name=_eventId_next]").each(function(b){b.setAttribute("name","_eventId_runValidation")});Z.submit()}function N(b){var c=1;var a=A.all(b.selector);var Z=I.node.one(".sbmt-seats");a.each(function(e){e.set("innerHTML",Z.get("innerHTML"));var d=e.one("input.btn-next");d.setAttribute("id","btn-next-id"+c++);d.setAttribute("wl:translate",b.translationKey||E.initData.textKey);e.translate();T(e);I.fireEvent("seats-loaded",{node:e})})}function D(b){var a=I.node.one("input#btn-search");if(a){var Z=E.initData.textKey;if(X){Z+=".onHold"}if(b==="paypal"){Z="label.sbmt.submitPayment.paypal"}a.setAttribute("wl:translate",Z);a.set("value",A.translateParametrized(Z));A.translateNode(a)}}function J(Z){X=Z.isOnHoldEnabled;D("")}function P(a){var Z=A.Array.indexOf(V,a);if(Z!==-1){V.splice(Z,1)}}function W(a){var Z=A.Array.indexOf(V,a);if(Z===-1){V.push(a)}}function M(){return V.length==0&&!G}function O(a){if(a.data&&a.data.forceUnblock===true){G=false}if(a.type){P(a.type)}if(M()){var Z=I.node.one("input#btn-search");if(Z){Z.removeAttribute("disabled");Z.removeClass("disabled");I.fireEvent("unblocked")}}}function L(a){if(a.type){W(a.type)}var Z=I.node.one("input#btn-search");if(Z){Z.set("disabled","disabled").addClass("disabled");I.fireEvent("blocked")}}function K(b){var e;var a=A.Node.create('<div class="modalWrapper"></div>');var d=[];var c=A.getCurrentTranslations();var Z=I.node.one("#ignoreFlowPopup");d[0]={text:c[b[0]],handler:function(){if(E.compInstConfig.callIgnoreAction){B(a)}else{a.addClass("loading");location.href=F()}}};d[1]={text:c[b[1]],handler:function(){e.hide()}};e=new YAHOO.widget.Dialog("ignoreFlowPopup",{visible:false,draggable:false,zIndex:100,fixedcenter:true,modal:true,close:false,buttons:d,hideaftersubmit:false});U=function(f){f.preventDefault();btn_0=e.firstButton;btn_1=e.lastButton;btn_0.setAttribute("class","translate");btn_1.setAttribute("class","translate");btn_0.setAttribute("wl:translate",b[0]);btn_1.setAttribute("wl:translate",b[1]);Z.translate();Z.removeClass("hidden");a.removeClass("loading");e.center();e.show()};A.on("click",U,"#ignoreFlow");e.renderEvent.subscribe(function(){var f=Z.get("children");f.each(function(g){a.append(g)});Z.append(a)});e.render(document.body)}var U=function(){};function Q(Z){U(Z)}function B(a){var Z={on:{success:function(){location.href=A.utilsUrl.buildExecutionUrl("_eventId_redirectToCameFromURL")},failure:function(){a.removeClass("loading");A.log("Ajax call failed!","error")}}};a.addClass("loading");I.fireEvent("to-ajax",{cfg:Z,actionCode:"ignoreTransaction"})}}});YUI.add("wl-login",function(A){A.components.Login=function(t){var b=this;t.form=true;var h=false;var E;var k=false;b.incomingEvents={loginCheck:function(){if(k){b.fireEvent("logged-in");return true}return false},"block-submit":function(){h=true},travelBankViewBalance:function(){w()},"in-logged-out":function(y){if(x()){if(t.initData.redemptionSearch){b.node.one(".login-component").removeClass("hidden");e();k=false;t.initData.user=null}}else{u()}},"in-internal-logged-in":function(y){t.initData.user=y.user;k=true;if(x()){if(t.initData.redemptionSearch){b.node.one(".login-component").addClass("hidden");e()}}else{if(y.updateContent){b.node.addClass("loading");N(y.user)}}},"set-logout-confirm":function(y){H=y.callback}};b.onRenderState={initialized:function(y){i(y)},rbeSelectFlights:function(y){i(y);q()},mybLanding:function(z){z.removeClass("loading");z.purge(true,"submit");A.on("login|submit",g,z);A.on("blur",A.wlValidation.validate,z.all("input.textfield"));if(t.compInstConfig.forgotPasswordPopUpEnabled){A.on("click",a,z.all(".forgot-password"))}var y=t.initData.loginActionResult.authenticationResult;if(y&&y!="SUCCESSFUL"){O(y,z)}else{z.one("input.username").setAttribute("wl:value","")}}};function i(y){D(y);if(t.initData.loggedIn){S(y,t.initData.user)}}function e(){b.node.one("input.username").set("value","");b.node.one("input.password").set("value","");p(b.node.one(".component-section-error"),"")}function S(AA,z){k=true;if(z.travelBankCredentials){V(z)}if(sabre.config.satConfiguration.travelBankConfiguration.balanceUrlEnabled&&z.travelBankCredentials){var y=AA.one("#loginComponentTraveBankViewDetailsLink");if(y){A.on("click",v,y)}}else{F()}J(z);AA.removeClass("loading");if(B()){A.on("login|click",P,AA.all(".logout"))}else{if(t.compInstConfig.agentUserConfiguration.logoutRedirectToAgentHome){A.on("login|click",Y,AA.all(".logout"))}}}function B(){return t.compInstConfig.byAjaxLogout}var H=function(){return false};function V(y){var AA=A.one("#ExternalForms");if(AA){var z=AA.one("#TravelBankViewDetailsForm");if(z){G(AA,y)}else{s(AA,y)}}else{A.log("Cannot find #ExternalForms node.","warn")}}function G(z,y){var AB=z.one("#loginComponentTraveBankViewDetailsUsername");if(AB){AB.set("value",y.travelBankCredentials.username)}else{A.log("Cannot find #loginComponentTraveBankViewDetailsUsername node.","warn")}var AA=z.one("#loginComponentTraveBankViewDetailsPassword");if(AA){AA.set("value",y.travelBankCredentials.password)}else{A.log("Cannot find #loginComponentTraveBankViewDetailsPassword node.","warn")}}function F(){var y=A.one("#TravelBankViewDetailsForm");if(y){y.remove()}}function s(z,y){var AA={username:y.travelBankCredentials.username,password:y.travelBankCredentials.password};b.renderPartialInNode("_travelBankViewDetailsForm",AA,z,false)}function v(y){y.preventDefault();w();return false}function w(){document.TBDetails.action=sabre.config.satConfiguration.travelBankConfiguration.balanceUrlKey;document.TBDetails.method="POST";document.TBDetails.submit()}function J(AD){if(!AD){return }if(AD.frequentFlyerProfile){A.one("#loginComponentLoyaltyDiv").removeClass("hidden")}else{A.one("#loginComponentLoyaltyDiv").addClass("hidden")}if(AD.travelBankCredentials&&(sabre.config.satConfiguration.travelBankConfiguration.balanceUrlEnabled||R(AD))){A.one("#loginComponentTraveBankDiv").removeClass("hidden")}else{A.one("#loginComponentTraveBankDiv").addClass("hidden")}var AF=AD.loyaltyTier;if(AF){var z=A.translateParametrized("TierLevel."+AF);var AK="label.login.member|"+z;var AI=A.translateParametrized(AK);var AG=A.one("#loyaltyTier");AG.setAttribute("wl:translate",AK);AG.setContent(AI)}if(AD.loyaltyBalanceRetrievalError){A.one("#balanceNotAvailable").removeClass("hidden");return }if(AD.agentProfile){var AH=false;A.one("#loginComponentAgencyBalanceDiv").removeClass("hidden");var AA=AD.agentInfoTO.superUser;T(AA,AH,"agentName","agentNameEnabled",AD.firstName+" "+AD.lastName);T(AA,AH,"agencyName","agencyNameEnabled",AD.agencyInfoTO.travelAgencyName);T(AA,AH,"agencyIdentifier","agencyIATAEnabled",AD.agencyInfoTO.travelAgencyIdentifier);if(AD.creditLimitRetrievalError){A.one("#loginComponentAgencyBalanceDiv").addClass("hidden");return }T(AA,AH,"agencyCreditLimit","creditLimitEnabled",X(AD.creditLimitInformationTO.nonConvertedAccountCreditLimit),"creditLimitDd");T(AA,AH,"agencyBalance","balanceEnabled",X(AD.creditLimitInformationTO.nonConvertedAccountBalance),"balanceDd");if(AD.creditLimitInformationTO.differentBalanceAndBookingCurrency&&sabre.config.satConfiguration.travelBankConfiguration.convertAgentCreditLimit){T(AA,AH,"creditLimitInBookingCurrency","creditLimitEnabled");T(AA,AH,"convertedAgencyCreditLimit","creditLimitEnabled",X(AD.creditLimitInformationTO.accountCreditLimit),"convertedCreditLimitDd");T(AA,AH,"convertedAgencyBalance","balanceEnabled",X(AD.creditLimitInformationTO.accountBalance),"convertedBalanceDd")}}else{if(AD.agencyProfile){var AH=true;A.one("#loginComponentAgencyBalanceDiv").removeClass("hidden");T(AA,AH,"agencyContactName","agencyContactNameEnabled",AD.firstName+" "+AD.lastName);T(AA,AH,"agencyName","agencyNameEnabled",AD.agencyInfoTO.travelAgencyName);T(AA,AH,"agencyCreditLimit","creditLimitEnabled",X(AD.creditLimitInformationTO.nonConvertedAccountCreditLimit),"creditLimitDd");T(AA,AH,"agencyBalance","balanceEnabled",X(AD.creditLimitInformationTO.nonConvertedAccountBalance),"balanceDd")}else{A.one("#loginComponentAgencyBalanceDiv").addClass("hidden")}}if(AD.loyaltyBalance==""){return }A.one("#balanceAmount").removeClass("hidden");A.one("#balanceAvailable").removeClass("hidden");var AL={thousandsSeparator:","};var AE=A.DataType.Number.format(parseInt(AD.loyaltyBalance,10),AL);K(AE);var AC=AD.balanceDate;if(AC!=0){var y=sabre.config.satConfiguration.dateFormat;var AB=A.DataType.Date.format(new Date(AC),{format:y});var AN="label.login.balanceDate|"+AB;var AJ=A.translateParametrized(AN);var AM=A.one("#balanceDate");if(AM){AM.setContent(AJ);AM.setAttribute("wl:translate",AN);AM.removeClass("hidden")}}}function T(AC,AF,AA,AE,AB,y){var AD=A.one("#"+AA);var z=t.compInstConfig.agentUserConfiguration;if(AC){z=t.compInstConfig.agentSuperUserConfiguration}else{if(AF){z=t.compInstConfig.agencyUserConfiguration}}if(z[AE]){if(y!=undefined){A.one("#"+y).setContent(AB)}else{if(AB!=undefined){AD.setContent(AB)}}AD.removeClass("hidden")}else{AD.addClass("hidden")}}function R(y){if(y.agentProfile){var z=t.compInstConfig.agentUserConfiguration;if(y.agentInfoTO.superUser){z=t.compInstConfig.agentSuperUserConfiguration}return z.viewBalanceEnabled}else{if(y.agencyProfile){return t.compInstConfig.agencyUserConfiguration.viewBalanceEnabled}}return false}function X(y){if(!y){return""}var AA={decimalPlaces:A.getDecimals(y.currency.code)};var z=A.DataType.Number.format(parseFloat(y.amount),AA);return A.formatPrice({value:z,currencyCode:y.currency.code},{currencyCodeSeparator:" "})}function K(z){var y=A.one("#amount");y.setContent(z);var AB=sabre.config.satConfiguration.frequentFlyer.denomination||"";var AA=A.one("#denomination");AA.setContent("&nbsp;"+A.translateParametrized(AB));AA.setAttribute("wl:translate",AB)}function D(y){y.removeClass("loading");y.purge(true,"submit");A.on("login|submit",Z,y);if(t.compInstConfig.forgotPasswordPopUpEnabled){y.delegate("click",a,".forgot-password")}y.delegate("click",W,".toggler");y.delegate("blur",A.wlValidation.validate,"input.textfield")}function O(z,AB){var y;switch(z){case"FAILED":y="_loginFailedAuthentication";break;case"SYSTEM_ERROR":y="_loginFailedSystemError";break;case"NOT_ALLOWED":y="_loginFailedStatusIsNotAllowed";break;default:var AA="No such result implemented "+z;A.log(AA,"error");throw AA}AB.one(".login-mybooking .field").prepend(b.getHtml(y));b.translateTemplate(t,AB.one(".login-mybooking .field"))}function Q(){var z=b.node;var y={togglee:z.one(".togglee"),toggler:z.one(".toggler a")};return y.togglee&&y.toggler?y:null}function W(){var y=Q();if(y){y.togglee.toggleClass("hidden");y.toggler.toggleClass("open")}}function I(){var y=Q();if(y){y.togglee.removeClass("hidden");y.toggler.addClass("open")}}function r(){return h||b.node.hasClass("loading")}function Z(y){y.preventDefault();if(r()){return }if(!o()){return }b.node.addClass("loading");n();var z=b.node.ancestor("form");if(x()){f(z)}else{U(z)}}function x(){return t.state==="rbeSelectFlights"}function g(y){y.preventDefault();if(!o()){return }var z=b.node.ancestor("form");z.submit()}function o(){A.wlValidation.validate(null,b.node.one(".username"));A.wlValidation.validate(null,b.node.one(".password"));return !b.node.one(".username").hasClass("error")&&!b.node.one(".password").hasClass("error")}function Y(AA){var AC=[{text:'<span class="translate" wl:translate="label.login.logoutPopup.cancel"></span>',handler:function(){this.hide()}},{text:"<span class='translate' wl:translate='label.login.logoutPopup.continue'></span>",handler:function(){window.location.href=t.initData.logoutUrl;this.hide()}}];var z={buttons:AC,close:true,needTranslation:true};var AB='<h3><span class="translate" wl:translate="label.login.logoutPopup.title"></span></h3><p><span class="translate" wl:translate="label.login.logoutPopup.message"></span></p>';var y=new A.widgets.PopupWidget(A.one(document.body),AB,z);y.show();AA.preventDefault()}function P(y){y.preventDefault();if(r()||H(M)){return }M()}function M(){b.node.addClass("loading");j()}function q(){var y=A.one("#login_2");if(y&&!k&&t.initData.redemptionSearch){var z=A.one("#flow-message-ffNotLoggedIn");if(z&&z.hasClass("hidden")){z.removeClass("hidden")}I()}}function c(){A.wlValidation.initializeForPartial(t.getType(),A.wlValidation.validationEngineRules,A.wlValidation.validationConfiguration,b.node)}function a(y){new A.widgets.ForgotPassword(y,t)}function n(){if(E){E.destroy();E=null}}function u(){k=false;t.initData.user=null;W();c();D(b.node)}function j(){var y={data:{requestPartials:["initialized"]},on:{success:function(AD,AC){var AA=AC.partials.initialized;L(AA);b.fireEvent("remove-all-messages");b.fireEvent("add-messages",{data:{messages:AC.flowMessagesToEnable}});b.fireEvent("logged-out");var AB=null;C(AB);if(!t.compInstConfig.folded){I()}}}};var z={cfg:y,actionCode:"logout"};if(!B()){z.url=t.initData.logoutUrl}b.fireEvent("to-ajax",z)}function C(y){b.fireEvent("update-data",{data:{loggedUser:y}})}function N(z){var y={data:{requestPartials:["initialized"]},on:{end:function(){b.node.removeClass("loading")},success:function(AC,AB){var AA=AB.partials.initialized;L(AA);S(b.node,z)}}};b.fireEvent("to-ajax",{cfg:y,actionCode:"getLoginContent"})}function d(y){return{username:escape(y.one(".username").get("value")),password:escape(y.one(".password").get("value"))}}function f(z){var y={data:d(z),on:{end:function(){b.node.removeClass("loading")},success:function(AB,AA){switch(AA.authenticationResult){case"SUCCESSFUL":k=true;m(AA,true);break;case"TRAVEL_BANK_UNAVAILABLE":k=true;m(AA,true);break;case"FAILED":t.initData.username=AA.username;l("_loginFailedAuthentication");break;case"SYSTEM_ERROR":I();l("_loginFailedSystemError");break;case"NOT_ALLOWED":I();l("_loginFailedStatusIsNotAllowed");break;default:break}}}};b.fireEvent("to-ajax",{cfg:y,actionCode:"login"})}function U(z){var AA=d(z);AA.requestPartials=["initialized"];var y={data:AA,on:{end:function(){b.node.removeClass("loading")},success:function(AD,AC){var AB=AC.partials.initialized;L(AB);switch(AC.authenticationResult){case"SUCCESSFUL":S(b.node,AC.user);m(AC,false);break;case"TRAVEL_BANK_UNAVAILABLE":S(b.node,AC.user);m(AC,false);break;case"FAILED":t.initData.username=AC.username;l("_loginFailedAuthentication");break;case"SYSTEM_ERROR":l("_loginFailedSystemError");break;case"NOT_ALLOWED":l("_loginFailedStatusIsNotAllowed");break;default:break}}}};b.fireEvent("to-ajax",{cfg:y,actionCode:"login"})}function l(z){I();var y=b.node.one(".component-section-error");p(y,b.getHtml(z));b.translateTemplate(t,y);c()}function L(y){p(b.node,A.decodeHtmlEntities(y));b.translateTemplate(t,b.node)}function p(z,y){z.set("innerHTML",y)}function m(AA,y){b.fireEvent("remove-all-messages");b.fireEvent("add-messages",{data:{messages:AA.flowMessagesToEnable}});b.fireEvent("out-internal-logged-in",{user:AA.user,updateContent:y});if(AA.user.frequentFlyerProfile){b.fireEvent("ff-logged-in",{data:{forceRedemptionFaresReload:false}})}b.fireEvent("logged-in",AA);var z={prefix:AA.user.prefix,firstName:AA.user.firstName,lastName:AA.user.lastName,tierLevel:AA.user.loyaltyTier,ffNumber:AA.user.ffNumber,emails:AA.user.emails};C(z);if(!t.compInstConfig.byAjaxLogin){window.location.reload()}}}});YUI.add("wl-lang",function(A){A.components.Lang=function(E){var G=this;G.onRenderState={initialized:function(){L();if(sabre.config.satConfiguration.globalCurrencyConfiguration.currencySelectionEnabled){G.fireEvent("add-me-to-pos-change",{trigger:"fsc",actionCode:"changePointOfSale"})}},hidden:function(){L()}};G.incomingEvents={changeLanguage:D,change_lang:function(){O()},"before-changePointOfSale":F};function L(){A.on("change",K,"#select-language");if(A.one("#select-currency")){A.on("change",P,"#select-currency")}H();I(E.initData.currency)}function O(){var R=A.config.locale;var Q="pageTitle."+sabre.config.pageCode;if(A.translations[R]&&A.translations[R][Q]){document.title=A.translations[R][Q]}}function P(R){var Q=R.currentTarget.get("value");N(Q)}function I(R){var Q=G.node.one("#select-currency");if(Q){Q.setStyle("visibility","visible");if(R){A.config.currency=R;Q.set("value",R)}}return R}function D(R){var Q=R.currentTarget.get("id");B(Q)}function K(R){var Q=R.currentTarget.get("value");B(Q)}function H(T){T=T||sabre.config.global.language||sabre.config.defaultLang;var S=T.replace("_","-");A.one("html").setAttribute("lang",S);var Q=A.one("body");if(A.config.locale&&A.config.locale!==T){Q.removeClass("LANGUAGE_"+A.config.locale)}Q.addClass("LANGUAGE_"+T);Q.setAttribute("lang",S);A.config.locale=T;sabre.config.global.language=T;var R=G.node.one("#select-language");if(R){R.set("value",T);if(E.state!="hidden"){R.setStyle("visibility","visible")}}return T}function B(S){var R="wl-lang-"+S;var Q=sabre.config.global.storefrontResourcesPath;if(sabre.config.global.configurationVersion){Q+=sabre.config.global.configurationVersion+"/"}Q+=sabre.config.templateFolder+sabre.config.translationDir+"/";sabre.config.groups["wl-noncombine"].modules[R]={fullpath:Q+S+".js"+sabre.config.global.versionNumber};A.use(R,function(U,T){U.translations[S]=T.success?U.translations[S]:"Translations not found";J(S)})}function J(S){var Q=sabre.config.global.language;H(S);var R={data:{selectedLang:S},on:{success:function(){G.fireEvent("change_lang",{data:S});A.wlValidation.refreshOverlaysAlignment(Q);G.fireEvent("update-data",{data:{language:S}})},complete:function(){var T=A.one("#progressContainer");if(T){T.remove()}}}};G.fireEvent("to-ajax",{cfg:R,actionCode:"setSelectedLang"})}function N(S){var R=G.node.one("#language-content");R.addClass("loading");M();var Q={data:{selectedCurrency:S},on:{complete:function(){R.removeClass("loading")},success:function(){C();G.fireEvent("change_currency",{data:S});G.fireEvent("update-data",{data:{currency:S}})}}};G.fireEvent("to-ajax",{cfg:Q,actionCode:"setSelectedCurrency"})}function M(){G.fireEvent("block_submit")}function C(){G.fireEvent("unblock_submit",{data:{}})}function F(){var R=G.node.one("#language-content");R.addClass("loading");M();var S="__currency";var Q={data:{requestPartials:[S]},on:{end:function(){R.removeClass("loading")},success:function(X,V){C();var U=G.node.one(".currency-section");if(U){var W=A.Node.create(A.decodeHtmlEntities(V.partials[S]));U.replace(W);var T=G.node.one("#select-currency").get("value");G.fireEvent("change_currency",{data:T});G.fireEvent("update-data",{data:{currency:T}})}}}};G.fireEvent("to-ajax",{cfg:Q,actionCode:"setDefaultCurrency"})}}});YUI.add("wl-ibedata",function(A){A.components.Ibedata=function(C){var D=this;var B=C.initData;D.onRenderState={initialized:function(){WhiteLabel.setIbeData(B)}};D.incomingEvents={"update-data":function(E){if(E.data){B=A.merge(B,E.data);WhiteLabel.setIbeData(B)}}}}});(function(){var D=YAHOO.util;var C=function(G,H,B,A){if(!G){}this.init(G,H,B,A)};C.NAME="Anim";C.prototype={toString:function(){var B=this.getEl()||{};var A=B.id||B.tagName;return(this.constructor.NAME+": "+A)},patterns:{noNegatives:/width|height|opacity|padding/i,offsetAttribute:/^((width|height)|(top|left))$/,defaultUnit:/width|height|top$|bottom$|left$|right$/i,offsetUnit:/\d+(em|%|en|ex|pt|in|cm|mm|pc)$/i},doMethod:function(F,A,B){return this.method(this.currentFrame,A,B-A,this.totalFrames)},setAttribute:function(H,A,B){var G=this.getEl();if(this.patterns.noNegatives.test(H)){A=(A>0)?A:0}if(H in G&&!("style" in G&&H in G.style)){G[H]=A}else{D.Dom.setStyle(G,H,A+B)}},getAttribute:function(L){var J=this.getEl();var B=D.Dom.getStyle(J,L);if(B!=="auto"&&!this.patterns.offsetUnit.test(B)){return parseFloat(B)}var K=this.patterns.offsetAttribute.exec(L)||[];var A=!!(K[3]);var I=!!(K[2]);if("style" in J){if(I||(D.Dom.getStyle(J,"position")=="absolute"&&A)){B=J["offset"+K[0].charAt(0).toUpperCase()+K[0].substr(1)]}else{B=0}}else{if(L in J){B=J[L]}}return B},getDefaultUnit:function(A){if(this.patterns.defaultUnit.test(A)){return"px"}return""},setRuntimeAttribute:function(M){var A;var L;var K=this.attributes;this.runtimeAttributes[M]={};var B=function(E){return(typeof E!=="undefined")};if(!B(K[M]["to"])&&!B(K[M]["by"])){return false}A=(B(K[M]["from"]))?K[M]["from"]:this.getAttribute(M);if(B(K[M]["to"])){L=K[M]["to"]}else{if(B(K[M]["by"])){if(A.constructor==Array){L=[];for(var J=0,N=A.length;J<N;++J){L[J]=A[J]+K[M]["by"][J]*1}}else{L=A+K[M]["by"]*1}}}this.runtimeAttributes[M].start=A;this.runtimeAttributes[M].end=L;this.runtimeAttributes[M].unit=(B(K[M].unit))?K[M]["unit"]:this.getDefaultUnit(M);return true},init:function(T,O,P,B){var A=false;var S=null;var Q=0;T=D.Dom.get(T);this.attributes=O||{};this.duration=!YAHOO.lang.isUndefined(P)?P:1;this.method=B||D.Easing.easeNone;this.useSeconds=true;this.currentFrame=0;this.totalFrames=D.AnimMgr.fps;this.setEl=function(E){T=D.Dom.get(E)};this.getEl=function(){return T};this.isAnimated=function(){return A};this.getStartTime=function(){return S};this.runtimeAttributes={};this.animate=function(){if(this.isAnimated()){return false}this.currentFrame=0;this.totalFrames=(this.useSeconds)?Math.ceil(D.AnimMgr.fps*this.duration):this.duration;if(this.duration===0&&this.useSeconds){this.totalFrames=1}D.AnimMgr.registerElement(this);return true};this.stop=function(E){if(!this.isAnimated()){return false}if(E){this.currentFrame=this.totalFrames;this._onTween.fire()}D.AnimMgr.stop(this)};var M=function(){this.onStart.fire();this.runtimeAttributes={};for(var E in this.attributes){this.setRuntimeAttribute(E)}A=true;Q=0;S=new Date()};var N=function(){var E={duration:new Date()-this.getStartTime(),currentFrame:this.currentFrame};E.toString=function(){return("duration: "+E.duration+", currentFrame: "+E.currentFrame)};this.onTween.fire(E);var F=this.runtimeAttributes;for(var G in F){this.setAttribute(G,this.doMethod(G,F[G].start,F[G].end),F[G].unit)}Q+=1};var R=function(){var F=(new Date()-S)/1000;var E={duration:F,frames:Q,fps:Q/F};E.toString=function(){return("duration: "+E.duration+", frames: "+E.frames+", fps: "+E.fps)};A=false;Q=0;this.onComplete.fire(E)};this._onStart=new D.CustomEvent("_start",this,true);this.onStart=new D.CustomEvent("start",this);this.onTween=new D.CustomEvent("tween",this);this._onTween=new D.CustomEvent("_tween",this,true);this.onComplete=new D.CustomEvent("complete",this);this._onComplete=new D.CustomEvent("_complete",this,true);this._onStart.subscribe(M);this._onTween.subscribe(N);this._onComplete.subscribe(R)}};D.Anim=C})();YAHOO.util.AnimMgr=new function(){var I=null;var J=[];var F=0;this.fps=1000;this.delay=1;this.registerElement=function(A){J[J.length]=A;F+=1;A._onStart.fire();this.start()};this.unRegister=function(A,B){B=B||G(A);if(!A.isAnimated()||B===-1){return false}A._onComplete.fire();J.splice(B,1);F-=1;if(F<=0){this.stop()}return true};this.start=function(){if(I===null){I=setInterval(this.run,this.delay)}};this.stop=function(A){if(!A){clearInterval(I);for(var B=0,C=J.length;B<C;++B){this.unRegister(J[0],0)}J=[];I=null;F=0}else{this.unRegister(A)}};this.run=function(){for(var A=0,C=J.length;A<C;++A){var B=J[A];if(!B||!B.isAnimated()){continue}if(B.currentFrame<B.totalFrames||B.totalFrames===null){B.currentFrame+=1;if(B.useSeconds){H(B)}B._onTween.fire()}else{YAHOO.util.AnimMgr.stop(B,A)}}};var G=function(A){for(var B=0,C=J.length;B<C;++B){if(J[B]===A){return B}}return -1};var H=function(E){var B=E.totalFrames;var C=E.currentFrame;var D=(E.currentFrame*E.duration*1000/E.totalFrames);var L=(new Date()-E.getStartTime());var A=0;if(L<E.duration*1000){A=Math.round((L/D-1)*E.currentFrame)}else{A=B-(C+1)}if(A>0&&isFinite(A)){if(E.currentFrame+A>=B){A=B-(C+1)}E.currentFrame+=A}};this._queue=J;this._getIndex=G};YAHOO.util.Bezier=new function(){this.getPosition=function(I,J){var H=I.length;var K=[];for(var L=0;L<H;++L){K[L]=[I[L][0],I[L][1]]}for(var G=1;G<H;++G){for(L=0;L<H-G;++L){K[L][0]=(1-J)*K[L][0]+J*K[parseInt(L+1,10)][0];K[L][1]=(1-J)*K[L][1]+J*K[parseInt(L+1,10)][1]}}return[K[0][0],K[0][1]]}};(function(){var E=function(C,D,B,A){E.superclass.constructor.call(this,C,D,B,A)};E.NAME="ColorAnim";E.DEFAULT_BGCOLOR="#fff";var G=YAHOO.util;YAHOO.extend(E,G.Anim);var F=E.superclass;var H=E.prototype;H.patterns.color=/color$/i;H.patterns.rgb=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i;H.patterns.hex=/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i;H.patterns.hex3=/^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i;H.patterns.transparent=/^transparent|rgba\(0, 0, 0, 0\)$/;H.parseColor=function(B){if(B.length==3){return B}var A=this.patterns.hex.exec(B);if(A&&A.length==4){return[parseInt(A[1],16),parseInt(A[2],16),parseInt(A[3],16)]}A=this.patterns.rgb.exec(B);if(A&&A.length==4){return[parseInt(A[1],10),parseInt(A[2],10),parseInt(A[3],10)]}A=this.patterns.hex3.exec(B);if(A&&A.length==4){return[parseInt(A[1]+A[1],16),parseInt(A[2]+A[2],16),parseInt(A[3]+A[3],16)]}return null};H.getAttribute=function(J){var C=this.getEl();if(this.patterns.color.test(J)){var A=YAHOO.util.Dom.getStyle(C,J);var B=this;if(this.patterns.transparent.test(A)){var D=YAHOO.util.Dom.getAncestorBy(C,function(I){return !B.patterns.transparent.test(A)});if(D){A=G.Dom.getStyle(D,J)}else{A=E.DEFAULT_BGCOLOR}}}else{A=F.getAttribute.call(this,J)}return A};H.doMethod=function(K,A,D){var B;if(this.patterns.color.test(K)){B=[];for(var C=0,L=A.length;C<L;++C){B[C]=F.doMethod.call(this,K,A[C],D[C])}B="rgb("+Math.floor(B[0])+","+Math.floor(B[1])+","+Math.floor(B[2])+")"}else{B=F.doMethod.call(this,K,A,D)}return B};H.setRuntimeAttribute=function(K){F.setRuntimeAttribute.call(this,K);if(this.patterns.color.test(K)){var C=this.attributes;var A=this.parseColor(this.runtimeAttributes[K].start);var D=this.parseColor(this.runtimeAttributes[K].end);if(typeof C[K]["to"]==="undefined"&&typeof C[K]["by"]!=="undefined"){D=this.parseColor(C[K].by);for(var B=0,L=A.length;B<L;++B){D[B]=A[B]+D[B]}}this.runtimeAttributes[K].start=A;this.runtimeAttributes[K].end=D}};G.ColorAnim=E})();YAHOO.util.Easing={easeNone:function(H,E,F,G){return F*H/G+E},easeIn:function(H,E,F,G){return F*(H/=G)*H+E},easeOut:function(H,E,F,G){return -F*(H/=G)*(H-2)+E},easeBoth:function(H,E,F,G){if((H/=G/2)<1){return F/2*H*H+E}return -F/2*((--H)*(H-2)-1)+E},easeInStrong:function(H,E,F,G){return F*(H/=G)*H*H*H+E},easeOutStrong:function(H,E,F,G){return -F*((H=H/G-1)*H*H*H-1)+E},easeBothStrong:function(H,E,F,G){if((H/=G/2)<1){return F/2*H*H*H*H+E}return -F/2*((H-=2)*H*H*H-2)+E},elasticIn:function(M,H,I,J,N,K){if(M==0){return H}if((M/=J)==1){return H+I}if(!K){K=J*0.3}if(!N||N<Math.abs(I)){N=I;var L=K/4}else{var L=K/(2*Math.PI)*Math.asin(I/N)}return -(N*Math.pow(2,10*(M-=1))*Math.sin((M*J-L)*(2*Math.PI)/K))+H},elasticOut:function(M,H,I,J,N,K){if(M==0){return H}if((M/=J)==1){return H+I}if(!K){K=J*0.3}if(!N||N<Math.abs(I)){N=I;var L=K/4}else{var L=K/(2*Math.PI)*Math.asin(I/N)}return N*Math.pow(2,-10*M)*Math.sin((M*J-L)*(2*Math.PI)/K)+I+H},elasticBoth:function(M,H,I,J,N,K){if(M==0){return H}if((M/=J/2)==2){return H+I}if(!K){K=J*(0.3*1.5)}if(!N||N<Math.abs(I)){N=I;var L=K/4}else{var L=K/(2*Math.PI)*Math.asin(I/N)}if(M<1){return -0.5*(N*Math.pow(2,10*(M-=1))*Math.sin((M*J-L)*(2*Math.PI)/K))+H}return N*Math.pow(2,-10*(M-=1))*Math.sin((M*J-L)*(2*Math.PI)/K)*0.5+I+H},backIn:function(J,F,G,H,I){if(typeof I=="undefined"){I=1.70158}return G*(J/=H)*J*((I+1)*J-I)+F},backOut:function(J,F,G,H,I){if(typeof I=="undefined"){I=1.70158}return G*((J=J/H-1)*J*((I+1)*J+I)+1)+F},backBoth:function(J,F,G,H,I){if(typeof I=="undefined"){I=1.70158}if((J/=H/2)<1){return G/2*(J*J*(((I*=(1.525))+1)*J-I))+F}return G/2*((J-=2)*J*(((I*=(1.525))+1)*J+I)+2)+F},bounceIn:function(H,E,F,G){return F-YAHOO.util.Easing.bounceOut(G-H,0,F,G)+E},bounceOut:function(H,E,F,G){if((H/=G)<(1/2.75)){return F*(7.5625*H*H)+E}else{if(H<(2/2.75)){return F*(7.5625*(H-=(1.5/2.75))*H+0.75)+E}else{if(H<(2.5/2.75)){return F*(7.5625*(H-=(2.25/2.75))*H+0.9375)+E}}}return F*(7.5625*(H-=(2.625/2.75))*H+0.984375)+E},bounceBoth:function(H,E,F,G){if(H<G/2){return YAHOO.util.Easing.bounceIn(H*2,0,F,G)*0.5+E}return YAHOO.util.Easing.bounceOut(H*2-G,0,F,G)*0.5+F*0.5+E}};(function(){var G=function(C,D,B,A){if(C){G.superclass.constructor.call(this,C,D,B,A)}};G.NAME="Motion";var I=YAHOO.util;YAHOO.extend(G,I.ColorAnim);var H=G.superclass;var K=G.prototype;K.patterns.points=/^points$/i;K.setAttribute=function(C,A,B){if(this.patterns.points.test(C)){B=B||"px";H.setAttribute.call(this,"left",A[0],B);H.setAttribute.call(this,"top",A[1],B)}else{H.setAttribute.call(this,C,A,B)}};K.getAttribute=function(B){if(this.patterns.points.test(B)){var A=[H.getAttribute.call(this,"left"),H.getAttribute.call(this,"top")]}else{A=H.getAttribute.call(this,B)}return A};K.doMethod=function(E,A,D){var B=null;if(this.patterns.points.test(E)){var C=this.method(this.currentFrame,0,100,this.totalFrames)/100;B=I.Bezier.getPosition(this.runtimeAttributes[E],C)}else{B=H.doMethod.call(this,E,A,D)}return B};K.setRuntimeAttribute=function(A){if(this.patterns.points.test(A)){var S=this.getEl();var Q=this.attributes;var T;var E=Q.points["control"]||[];var R;var D,B;if(E.length>0&&!(E[0] instanceof Array)){E=[E]}else{var F=[];for(D=0,B=E.length;D<B;++D){F[D]=E[D]}E=F}if(I.Dom.getStyle(S,"position")=="static"){I.Dom.setStyle(S,"position","relative")}if(J(Q.points["from"])){I.Dom.setXY(S,Q.points["from"])}else{I.Dom.setXY(S,I.Dom.getXY(S))}T=this.getAttribute("points");if(J(Q.points["to"])){R=L.call(this,Q.points["to"],T);var C=I.Dom.getXY(this.getEl());for(D=0,B=E.length;D<B;++D){E[D]=L.call(this,E[D],T)}}else{if(J(Q.points["by"])){R=[T[0]+Q.points["by"][0],T[1]+Q.points["by"][1]];for(D=0,B=E.length;D<B;++D){E[D]=[T[0]+E[D][0],T[1]+E[D][1]]}}}this.runtimeAttributes[A]=[T];if(E.length>0){this.runtimeAttributes[A]=this.runtimeAttributes[A].concat(E)}this.runtimeAttributes[A][this.runtimeAttributes[A].length]=R}else{H.setRuntimeAttribute.call(this,A)}};var L=function(C,A){var B=I.Dom.getXY(this.getEl());C=[C[0]-B[0]+A[0],C[1]-B[1]+A[1]];return C};var J=function(A){return(typeof A!=="undefined")};I.Motion=G})();(function(){var F=function(C,D,B,A){if(C){F.superclass.constructor.call(this,C,D,B,A)}};F.NAME="Scroll";var H=YAHOO.util;YAHOO.extend(F,H.ColorAnim);var G=F.superclass;var E=F.prototype;E.doMethod=function(D,A,C){var B=null;if(D=="scroll"){B=[this.method(this.currentFrame,A[0],C[0]-A[0],this.totalFrames),this.method(this.currentFrame,A[1],C[1]-A[1],this.totalFrames)]}else{B=G.doMethod.call(this,D,A,C)}return B};E.getAttribute=function(C){var A=null;var B=this.getEl();if(C=="scroll"){A=[B.scrollLeft,B.scrollTop]}else{A=G.getAttribute.call(this,C)}return A};E.setAttribute=function(D,A,B){var C=this.getEl();if(D=="scroll"){C.scrollLeft=A[0];C.scrollTop=A[1]}else{G.setAttribute.call(this,D,A,B)}};H.Scroll=F})();YAHOO.register("animation",YAHOO.util.Anim,{version:"2.8.0r4",build:"2449"});YUI.add("wl-cart-stick-to-screen",function(B){var L=function(N){var M=N;while(true){var O=M.ancestor(".lay > .lay");if(O!==null){M=O}else{return M}}};var D=function(M){return M.all("> .lay")};var F=function(O,N){for(var M=0;M<O.size();M++){if(O.item(M).contains(N)){return O.item(M)}}return null};var I=function(M){return M.getY()};var K=function(M){return M.get("offsetHeight")};var A=function(M){return I(M)+K(M)};var H=function(M){window.setTimeout(M,1)};var G=function(M){M()};var E=(function(g){var Z=g.ancestor(".lay").ancestor(".lay");var a=g.getY();var b="initial";var U=L(g);var c=D(U);var e=F(c,g);var T=function(){return K(g)};var j=function(){return A(Z)};var Y=function(){return B.DOM.docScrollY()};var S=function(){return B.DOM.winHeight()};var k=function(){return Y()+S()};var P=function(){return T()>S()};var X=function(m,n){g.setStyle("position",m);g.setStyle("top",(n!=null)?n+"px":null)};var M=function(m,n){if(b!==m){n();b=m}};var l=function(){M("bottomOfContainer",function(){B.log("Fixing cart position at the bottom of the container","debug");var m=function(){X("relative",(j()-a-T()))};if(B.UA.ie>0&&B.UA.ie<8){X(null,null);H(m)}else{G(m)}})};var Q=function(){M("initial",function(){B.log("Fixing cart position at the original position","debug");X(null,null)})};var O=function(){M("topOfViewport",function(){B.log("Sticking cart to the top of the viewport","debug");X("fixed",0)})};var h=function(){M("bottomOfViewport",function(){B.log("Sticking cart to the bottom of the viewport","debug");X("fixed",S()-T())})};var i=function(){if(Y()<a){Q()}else{if(Y()+T()>=j()){l()}else{O()}}};var V=function(){if(k()>=j()){l()}else{if(a+T()<k()){h()}else{Q()}}};var R=function(){var n=0;var m=null;c.each(function(p){var o=K(p);if(o>=n){m=p;n=o}});return m};var d=function(){return e.compareTo(R())};var N=function(){if(P()){V()}else{i()}};var W=function(m){if(d()){return }else{N()}};var f=function(m){b="unknown";N()};return{onScroll:W,onSizeChanged:f}});var C=function(){var M=B.Node.create("<div></div>");M.setStyle("position","fixed");return(M.getStyle("position")==="fixed")};var J=function(N){B.log("Attaching scroll handler for shopping cart movement","debug");var M=E(N);B.on("scroll",M.onScroll);B.on("resize",M.onSizeChanged);B.on("cart:sizeChanged",M.onSizeChanged)};B.on("cart:stickToScreen",function(M){if(C()){J(M.container.ancestor(".lay"))}else{B.log("Running on browser that doesn't support position: fixed. Skipping scroll handler for shopping cart movement attachment","warn")}})});YUI.add("wl-cart",function(A){A.components.Cart=function(AK){var k=this;var Ak=AK.compInstConfig;var W=AK.initData;var Aj=AK.state;var AY=Ak.insuranceEnabled;var L=AY&&Ak.insuranceAPartOfFareBreakdown;var Af=!!W.retainedDirection;var a={};var V="bookingFee";var g=[];var I=W.itineraryParts;var AS=W.itineraryParts.length;var AD=[];var AB="";var d,o;var f="initialized";k.incomingEvents={show_rules:l,modify_search_rendered:function(){Ae(false)},change_state_unbundled:Ab,change_state:p,clear_invalid_selected_flights:U,update_for_lazy_flc:n,"update-with-insurance":AI,"update-with-ancillary":Q,"update-with-hotel":AR,"update-with-seat-selected":u,"update-with-fop-surcharge":AG,"update-with-slider":AQ,"before-completedCarSelectAjax":AP,"update-with-bnpl":AW,clear_cart:K,refresh:b,change_lang:function(){var An=k.node.all(".fare-family-name");An.each(function(Ar){var Aq=Ar.getAttribute("wl:translate"),Ap,As;if(Aq){Ap=Aq.split("|");As=Ar.getAttribute("wl:ff");Ap[1]=AU(As);Aq=Ap.join("|");Ar.setAttribute("wl:translate",Aq);Ar.setContent(A.translateParametrized(Aq))}});var Ao=k.node.all(".fare-summary");Ao.each(function(Aq){var Ar=Aq.getAttribute("wl:ff");var Ap=AO(Ar);Ap=A.decodeHtmlEntities(Ap);Aq.setContent(Ap)})}};function x(){k.node.removeClass("ftl-created");k.getDomEvents()}function J(){return(Ak.stickToScreen===true)}function AV(){A.fire("cart:stickToScreen",{container:k.node})}k.onCreate=function(An,Ao){Aa();x();if(J()){AV()}};k.onRenderState={initialized:function(An){AF(An);t(An);AL(An);A.fire("cart:sizeChanged");k.fireEvent("cart-updated-with-seats-price",{});k.fireEvent("add-me-to-car-select",{trigger:"car",actionCode:"completedCarSelect"});k.fireEvent("add-me-to-car-select",{trigger:"car",actionCode:"reload"});k.fireEvent("add-me-to-car-select",{trigger:"car",actionCode:"removeCar"})},flightChanged:function(An){AF(An);t(An);A.fire("cart:sizeChanged")},exchangeReview:function(An){AF(An);t(An);A.fire("cart:sizeChanged")},exchange:function(An){AF(An);t(An);A.fire("cart:sizeChanged")},exchangeFlightSelect:function(An){f="exchangeFlightSelect";AF(An);t(An);A.fire("cart:sizeChanged")}};function AL(Ar){var An=W.retainedPart;var Aq=W.retainedDirection;var Ap=W.retainedPart;if(An&&An.length&&Aq&&Ap&&Ap.length){var Ao=Ar.one("#cart_itinerariesDetails").one("."+Aq.toLowerCase());if(Ao){A.Event.purgeElement(Ao,true);Ao.setContent(X(An));Ar.translate()}}}function AF(Ao){AA(Ao);var Ap=A.all("#fare-rules-anchor");Ap.each(function(Aq){Aq.on("click",Ad)});var An=A.one("#modify-search-trigger");if(An){An.on("click",AT)}A.delegate("click",z,"#cart-component","em.crossToggler");A.delegate("click",e,"#cart-component","em.toggler");A.delegate("click",Ag,"#cart-component",".fare-family-toggler");A.delegate("click",P,"#cart-component","em.paxToggler")}function AA(An){if(a.flightFare){var Ao=An.one(".price-details");if(Ao){Ao.removeClass("hidden")}}}function t(An){if(An){An.delegate("mouseover",C,".fare-indicator-icon");An.delegate("mouseout",T,".fare-indicator-icon")}}function C(Ar){Ar.preventDefault();if(d==null){var Au=Ar.currentTarget;var Ap={header:"",context:[Ar.currentTarget.get("id"),"tl","bl",["beforeShow","windowResize"],[Ak.fareIndicatorOverlayHorizontalPosition,Ak.fareIndicatorOverlayVerticalPosition]],underlay:"none",modal:false,fixedcenter:false,constraintoviewport:false,effect:{effect:YAHOO.widget.ContainerEffect.FADE,duration:0.2}};var An=Au.ancestor();var At=An.one(".fiTranslation").get("innerHTML");var Ao=An.ancestor();var Aq=new A.Node.create('<div class="fare-indicator-overlay hidden"></div>');o=new A.Node.create('<div id="fare-indicator-overlay-container"></div>');Ao.appendChild(Aq);Ao.appendChild(o);var As='<div class="fare-indicator-overlay-content">'+At+"</div>";Ap.width=Aq.getStyle("width");Ap.height=Aq.getStyle("height");d=new A.widgets.PopupWidget(o,As,Ap);d.show()}}function T(Aq){Aq.preventDefault();var Ar=Aq.currentTarget;if(d){d.hide();d=null;var An=Ar.ancestor();var Ao=An.ancestor();var Ap=Ao.one(".fare-indicator-overlay");Ao.removeChild(Ap);Ao.removeChild(o)}}function S(){if(W.itineraryParts.length===2){g[0]=g[0]||W.itineraryParts[0].shoppingBasketHash;g[1]=g[1]||W.itineraryParts[1].shoppingBasketHash}else{if(W.itineraryParts.length===1){g[0]=g[0]||W.itineraryParts[0].shoppingBasketHash}else{if(W.itineraryParts.length===0){g[0]=g[0]||W.outboundsSelectedBasketHash;g[1]=g[1]||W.inboundsSelectedBasketHash}}}}function Aa(){if(W.itineraryParts.length===2){g[0]=g[0]||W.itineraryParts[0].shoppingBasketHash;g[1]=g[1]||W.itineraryParts[1].shoppingBasketHash}else{if(W.itineraryParts.length===1){g[0]=g[0]||W.itineraryParts[0].shoppingBasketHash}}}function n(Aq){var Ap=Aq.data.step;g[Ap]=Aq.data.selectedHashRef||Aq.data.offerHashCode;g=g.slice(0,Ap+1);if(AS===g.length){W.itinerarySelected=true;var An=g[g.length-1];var Ao={selectedBasketRefs:[An]};F(Ao,"lazy",An)}else{W.itinerarySelected=false;A.Array.each(I,function(As,Ar){if(Ar===Ap){I[Ar]=Aq.data.itinerary}else{if(Ar>Ap){I[Ar].segments=null}}});W.itineraryParts=I;M(W.itineraryParts);AH();j(Aq.data.index);AC([W.itineraryParts])}c()}function Ab(Ap){S();var An=Ap.data.direction==="inbounds"?1:0;g[An]=Ap.data.selectedBasketRefs;AD[An]=Ap.data.itinerary.price;if(g[0]&&g[1]){var Ao={selectedBasketRefs:g};F(Ao,Ap.data.direction,Ap.data.selectedBasketRefs,true)}else{D(Ap.data.itinerary,An);var Aq=[null,null];Aq[An]=Ap.data.itinerary;AC(Aq,true);AJ(Ap.data.direction,Ap.data.selectedBasketRefs)}c();A.fire("cart:sizeChanged")}function p(Ao){g=[Ao.data.selectedBasketRefs];AD[0]=Ao.data.itinerary.price;var An={selectedBasketRefs:g};F(An,Ao.data.direction,Ao.data.selectedBasketRefs);c();A.fire("cart:sizeChanged")}function U(Aq){var Ap=Aq.data.revisedSelectedHashRefs||[];var Ar=false;var Ao;for(Ao=0;Ao<W.itineraryParts.length;Ao++){W.itineraryParts[Ao]={departureDate:W.itineraryParts[Ao].departureDate};Ar=true}if(Ar){W.itinerarySelected=false;M(W.itineraryParts);AH()}else{var An;if(data.context.state=="lazy"){An={selectedBasketRefs:[Ap[Ap.length-1]]};F(An,"checkPrice",[Ap[Ap.length-1]])}else{An={selectedBasketRefs:Ap};F(An,"checkPrice",Ap)}}}function M(Ao){var An=k.node.one("#cart_itinerariesDetails");if(!An){return }A.Array.each(Ao,function(Ap,Aq){D(Ap,Aq)})}function D(Ap,An){An=An||0;var Aq=k.node.one("#cart_itinerariesDetails");if(!Aq){return }var Ar=Aq.all(".cart_itinerariesDetails_itinerary");var Ao=Ar.item(An);var As=A.Node.create(X(Ap));Ao.replace(As);As.translate();Ao.destroy()}function AI(An){AB=An.data.offerCode;r()}function AQ(An){r()}function u(An){G(An)}function AP(An){h(An)}function Q(An){Y(An)}function AR(An){N(An)}function AW(An){q(An)}function AG(An){R(An.data)}function l(){S();y()}function Ad(An){An.preventDefault();l()}function y(){Ae(true);k.fireEvent("showFareRules",{forceInitialize:true,data:{allFlightsSelected:Am(),callback:function(){Ae(false)}}})}function Ae(Ao){var An=A.one("#cart-component");if(An){Ao?An.addClass("loading"):An.removeClass("loading")}}function Am(){return W.itinerarySelected}function AT(An){An.preventDefault();Ae(true);k.fireEvent("modify_search",{forceInitialize:true})}function i(An){k.node.set("innerHTML",A.decodeHtmlEntities(An));x()}function s(Ap,Ao){Ae(true);var An={data:{requestPartials:[Aj]},on:{end:function(){Ae(false)},success:function(Ar,Aq){if(Aq){W=Aq.model;i(Aq.partials[Aj])}if(Ap.cfg&&"function"==typeof Ap.cfg.callback){Ap.cfg.callback()}}}};k.fireEvent("to-ajax",{cfg:An,actionCode:Ao})}function Y(An){s(An,"updatePriceWithAncillary")}function N(An){s(An,"updatePriceWithHotel")}function q(An){s(An,"updatePriceWithBNPL")}function w(Ao){var An=[];A.Object.each(Ao,function(Ar,Aq){var Ap=new Number(Aq);if(isFinite(Ap)){An.push(Ar)}});return An}function G(Ap){Ae(true);Ap=w(Ap);var Ao={selectedSeats:Ap,requestPartials:[Aj]};var An={data:Ao,on:{end:function(){Ae(false);k.fireEvent("cart-updated-with-seats-price",{})},success:function(Ar,Aq){if(Aq){W=Aq.model;i(Aq.partials[Aj])}}}};k.fireEvent("to-ajax",{cfg:An,actionCode:"updatePriceWithSeatSelected"})}function h(Ap){var Ao={requestPartials:[Aj]};var An={data:Ao,on:{success:function(Ar,Aq){if(Aq){W=Aq.model;i(Aq.partials[Aj])}}}};k.fireEvent("to-ajax",{cfg:An,actionCode:"updatePriceWithCarSelected"})}function r(){Ae(true);var An={data:{selectedInsuranceCode:AB,requestPartials:["initialized"]},on:{end:function(){Ae(false)},success:function(Aq,Ao){if(Ao){W=Ao.model;var Ap=Ao.partials.initialized;i(Ap)}}}};k.fireEvent("to-ajax",{cfg:An,actionCode:"updatePriceWithInsuranceOrSlider"})}function R(Ao){Ae(true);var An={data:{selectedInsuranceCode:AB,requestPartials:[Aj]},on:{end:function(){Ae(false)},success:function(Aq,Ap){if(Ap){W=Ap.model;i(Ap.partials[Aj])}}}};k.fireEvent("to-ajax",{cfg:An,actionCode:"updatePriceWithFopSurcharge"})}function F(Aq,As,An,Ar){Ae(true);var Ao={data:A.merge({requestPartials:[f]},Aq),on:{end:function(){Ae(false)},success:function(Av,At){if(At){W=At.model;var Au=At.partials[f];i(Au);if(At.model.itinerarySelected){AJ(As,An);if(!At.model.redemptionUserCannotAffordItinerary){Al()}}else{Z()}if(A.Lang.isArray(At.messages)&&At.messages.length>0){k.fireEvent("add-messages",{data:{messages:At.messages}})}AC(W.itineraryParts,Ar);Ac(W.total)}}}};var Ap=As?"checkPrice":"clearSelection";k.fireEvent("remove-all-component-messages");k.fireEvent("to-ajax",{cfg:Ao,actionCode:Ap})}function K(){g=[];Ae(true);var An={data:{requestPartials:[f]},on:{end:function(){Ae(false)},success:function(Aq,Ao){if(Ao){W=Ao.model;var Ap=Ao.partials[f];i(Ap);Ac(W.total);k.fireEvent("cleared")}}}};k.fireEvent("to-ajax",{cfg:An,actionCode:"clearSelection"})}function b(){Ae(true);var An={data:{requestPartials:[Aj]},on:{end:function(){Ae(false)},success:function(Ap,Ao){if(Ao){W=Ao.model;i(Ao.partials[Aj])}}}};k.fireEvent("to-ajax",{cfg:An,actionCode:"refresh"})}function B(An){if(An&&An.priceAlternatives){return An.priceAlternatives}return{}}function O(Ao){if(!Ao||!Ao.segments){return null}var Ap=[];for(var Aq=0;Aq<Ao.segments.length;Aq++){var Ar=Ao.segments[Aq];var An={departure:Ar.departureDate,arrival:Ar.arrivalDate,departureAirport:Ar.departureCode,arrivalAirport:Ar.arrivalCode,flightNumber:Ar.flightNumber[0],airlineCode:Ar.airlineCodes[0],operatingAirlineCode:Ar.operatingCarrier[0],brandId:Ao.fareFamily,bookingClass:Ar.bookingClass,fareBasis:Ar.fareBasis,cabinClass:Ar.classOfService[0],nextDayIndicator:Ar.nextDayIndicator};Ap.push(An)}return{segments:Ap}}function AC(At,Aq){var Ar=[];var Ap,As;for(Ap=0;Ap<At.length;Ap++){var An=O(At[Ap]);Ar.push(An)}var Ao=[];if(Aq&&Ar.length===2){for(Ap=0;Ap<2;Ap++){As=B(AD[Ap]);Ao[Ap]={parts:Ar[Ap]?[Ar[Ap]]:null,fareAmount:As}}}else{As=B(AD[0]);Ao[0]={parts:Ar,fareAmount:As}}k.fireEvent("update-data",{data:{selectedOffers:Ao}})}function Ac(An){k.fireEvent("update-data",{data:{total:B(An)}})}function P(Ar){var Aq=Ar.currentTarget;var Ap=Aq.one("a");var Ao=Aq.ancestor("div.cart-pax");if(Ao){var An=Ao.one("ol");if(An){isOpen=Ap.hasClass("open");if(isOpen){Ap.removeClass("open");Ap.addClass("translate");Ap.setAttribute("wl:translate","label.cart.priceSummary.view");An.setStyle("display","none")}else{Ap.addClass("open");Ap.addClass("translate");Ap.setAttribute("wl:translate","label.cart.priceSummary.hide");An.setStyle("display","block")}}}k.translateTemplate(AK,Aq);A.fire("cart:sizeChanged");Ar.preventDefault()}function z(An){e(An,true)}function e(Au,Aq){var At=Au.currentTarget;var As=At.ancestor("li");var Ao=As.one("ol");var Ap=At.one("a").hasClass("open");var Ar=At.one("a");if(Ap){Ar.removeClass("open");if(!Aq){Ar.addClass("translate");Ar.setAttribute("wl:translate","label.cart.priceSummary.view")}if(Ao){Ao.setStyle("display","none")}}else{Ar.addClass("open");if(!Aq){Ar.addClass("translate");Ar.setAttribute("wl:translate","label.cart.priceSummary.hide")}if(Ao){Ao.setStyle("display","block");Ao.setAttribute("style","display: block;")}}var An=A.all(".cartPrices");An.each(function(Av){k.translateTemplate(AK,Av)});A.fire("cart:sizeChanged");Au.preventDefault()}function Ag(Aq){var Ar=Aq.currentTarget;var Ap=Ar.one("a");var Ao=Ap.hasClass("open");var An=Ar.one("div.fare-summary");if(Ao){Ap.removeClass("open");Ap.setAttribute("wl:translate","label.cart.fareSummary.viewDetails");Ap.addClass("translate");if(An){An.setStyle("display","none")}}else{Ap.addClass("open");Ap.setAttribute("wl:translate","label.cart.fareSummary.hideDetails");Ap.addClass("translate");if(An){An.setStyle("display","block");An.setAttribute("style","display: block;")}}A.translateNode(Ar);A.fire("cart:sizeChanged");Aq.preventDefault()}function H(Ao){var Ap="initialized";var An;for(An in Ao){Ap=(!Ao||!A.Lang.isArray(Ao.segments)||Ao.segments[0].blank)?"initialized":"flightSelected"}return Ap}function E(Ao,An,Aq){var Ap=A.all(An);Ap.each(function(As){var At=k.getPartial(Aq,Ao);var Ar=A.Node.create(At);As.set("innerHTML",Ar.get("innerHTML"));A.translateNode(As);Ar=null})}function AH(){var An=AE();if(A.one("#cart-total-price")){A.one("#cart-total-price").remove(true)}E(An,".cart-price-details-container","_priceInfo");E(An,"#price-summary","_flightChanged_PriceInfo");E(An,"#price-info-exchange","_priceInfoExchangeReview")}function AE(){var An={};An.farePrice=AZ("fare");An.taxesPrice=AZ("taxes");An.discountPrice="";An.feesPrice=AZ("fees");An.insurancePrice="";if(AK.state==="exchangeReview"){An.newTripTotalPrice=AZ("newTrip")}else{An.newTripTotalPrice=AZ("newPrice")}An.originalTripPrice=AZ("originalPrice");An.changeFeePrice=AZ("changeFee");An.ancillariesPrice=AZ("ancillaries");An.seatsPrice=AZ("seats");An.uniqueFareIndicators="";return An}function AZ(An){return k.getPartial("_priceInfoItem",{pricePartType:An,pricePartLink:"",pricePartValue:""})}function AX(Ao,An){if(!W.showClassOfServicePerSegment){return k.getPartial("_chosenClass_cabinClass",{classOfService:A.translateParametrized("Cabin."+Ao),index:An})}return""}function X(An){var A5="";var A9,A7;var Av=[];var Az=H(An);var A6=[];var Aw=[];var BB=(A9==0)?"outbound":"inbound";var As=An.flightAdvisors;var Ar;var A0=An.fareFamily;if(A0&&An.basketsRef){Ar=An.basketsRef[A0];As=Ar.flightAdvisors}if(An.segments&&An.segments.length>0){var A4=An.segments[0].arrivalDate;for(A7=0;A7<An.segments.length;A7++){var A1;var Ap=An.segments[A7];var A3=Ap.departureCode;var Ax=Ap.departureDate;var BA=Ap.arrivalCode;var Au=Ar?Ar.classOfService:Ap.classOfService;var Ao=Ar?Ar.fareBasis:Ap.fareBasis;if(A.Lang.isArray(Au)&&Au.length>0){A1=Au[0];A5=A1}Ao=Ao.replace(/\/.*/g,"");var Aq=(A7==0)?"depart":"connection";A6.push(v(A3,A4,Ax,Ao,Aq,A9,A7,A1));A6.push(Ah(A9,A7,A1));var A8=AM(Ap.flightNumber[0],Ap.airlineCodes[0],Ap.operatingCarrier[0]);Aw.push(A8);A4=Ap.arrivalDate}A6.push(v(BA,A4,Ax,Ao,"arrive",A9,A7))}if(A.Lang.isArray(An.overrideClassOfService)&&An.overrideClassOfService.length>0){A5=An.overrideClassOfService[0]}var BC={direction:BB,itineraryPrice:(An&&An.price&&An.price.amount!=0&&!Af)?AN(An.price):"",partSegments:A6.join(""),flightNumbers:Aw.join(" | "),fareFamily:"",cabinClass:AX(A5,A9),flightAdvisors:m(As)};if(A0){var Ay=A.decodeHtmlEntities(AO(A0));var At=W.fareFamilyGroupDataMap[A0];var A2=At?At.familyGroupId:"undefinedGroup";BC.fareFamily=k.getPartial("_chosenClass_fareFamily",{fareFamily:AU(A0),fareFamilyKey:A0,fareFamilyGroupKey:A2,fareSummary:Ay,index:A9})}return k.getPartials("_flightDetails_"+Az,BC)}function m(An){if(An){var Ao="";A.Array.each(An,function(Ap){Ao+=k.getPartial("_fareIndicator",{name:Ap.name,iconUrl:Ap.iconUrl,translationKey:Ap.translationKey})});return k.getPartial("_fareIndicators",{flightAdvisors:Ao})}return""}function Ah(Ap,Ao,An){if(W.showClassOfServicePerSegment){var Aq={part_index:Ap,segment_index:Ao+1,classOfService:A.translateParametrized("Cabin."+An)};return k.getPartial("_segmentClassOfService",Aq)}return""}function Ai(Ao,Ar){var An=W.fareFamilyDataMap[Ao];if(An){var Ap=A.getCurrentLanguage();var Aq=An.localizedData[Ap];if(Aq&&Aq[Ar]){return Aq[Ar]}}return"&nbsp;"}function AU(An){return Ai(An,"label")}function AO(An){return Ai(An,"marketingText")}function AM(Aq,Ap,An){var Ao=Ak.flightNumberFormat;var Ar=A.getFullAirlineName(An);return k.getPartial("_flightNumber_"+Ao.toLowerCase(),{flightNumber:Aq,airlineCode:Ap,operatingCarrier:Ar})}function v(Ao,At,Au,Av,Ap,As,Aq){var An=A.airports[Ao];var Ar={flightCode:Ao,cityCode:An&&An.city||Ao,stateCode:An&&An.stateProvince||Ao,countryCode:An&&An.country||Ao,arrivalFlightDate:At,departureFlightDate:Au,fareBasis:Av,flightType:Ap,partIndex:As,segmentIndex:Aq+1};if(Ap=="depart"){return k.getPartial("_segmentDetailsForDeparture",Ar)}else{if(Ap=="arrive"){return k.getPartial("_segmentDetailsForArrival",Ar)}}return k.getPartial("_segmentDetailsForConnection",Ar)}function AN(An){return A.formatPrice(An,{currencyCodeSeparator:"&nbsp;"})}function Al(){k.fireEvent("unblock_submit")}function c(){k.fireEvent("block_submit")}function AJ(Ao,An){setTimeout(function(){k.fireEvent("refresh_flc",{data:{direction:Ao,brandedBasketHashRef:An}})},100)}function j(An){k.fireEvent("refresh_lazy_flc",{data:{index:An,selectedHashRefs:g}})}function Z(){g=[];k.fireEvent("reset_selection")}}});YUI.add("wl-yui2-log-control",function(A){if(YAHOO&&YAHOO.widget){YAHOO.widget.Logger=function(){};YAHOO.widget.LogWriter=function(){return{log:function(){}}}}},"1.0.0");(function(){YAHOO.util.Config=function(D){if(D){this.init(D)}if(!D){YAHOO.log("No owner specified for Config object","error","Config")}};var B=YAHOO.lang,C=YAHOO.util.CustomEvent,A=YAHOO.util.Config;A.CONFIG_CHANGED_EVENT="configChanged";A.BOOLEAN_TYPE="boolean";A.prototype={owner:null,queueInProgress:false,config:null,initialConfig:null,eventQueue:null,configChangedEvent:null,init:function(D){this.owner=D;this.configChangedEvent=this.createEvent(A.CONFIG_CHANGED_EVENT);this.configChangedEvent.signature=C.LIST;this.queueInProgress=false;this.config={};this.initialConfig={};this.eventQueue=[]},checkBoolean:function(D){return(typeof D==A.BOOLEAN_TYPE)},checkNumber:function(D){return(!isNaN(D))},fireEvent:function(D,F){YAHOO.log("Firing Config event: "+D+"="+F,"info","Config");var E=this.config[D];if(E&&E.event){E.event.fire(F)}},addProperty:function(E,D){E=E.toLowerCase();YAHOO.log("Added property: "+E,"info","Config");this.config[E]=D;D.event=this.createEvent(E,{scope:this.owner});D.event.signature=C.LIST;D.key=E;if(D.handler){D.event.subscribe(D.handler,this.owner)}this.setProperty(E,D.value,true);if(!D.suppressEvent){this.queueProperty(E,D.value)}},getConfig:function(){var D={},F=this.config,G,E;for(G in F){if(B.hasOwnProperty(F,G)){E=F[G];if(E&&E.event){D[G]=E.value}}}return D},getProperty:function(D){var E=this.config[D.toLowerCase()];if(E&&E.event){return E.value}else{return undefined}},resetProperty:function(D){D=D.toLowerCase();var E=this.config[D];if(E&&E.event){if(this.initialConfig[D]&&!B.isUndefined(this.initialConfig[D])){this.setProperty(D,this.initialConfig[D]);return true}}else{return false}},setProperty:function(E,G,D){var F;E=E.toLowerCase();YAHOO.log("setProperty: "+E+"="+G,"info","Config");if(this.queueInProgress&&!D){this.queueProperty(E,G);return true}else{F=this.config[E];if(F&&F.event){if(F.validator&&!F.validator(G)){return false}else{F.value=G;if(!D){this.fireEvent(E,G);this.configChangedEvent.fire([E,G])}return true}}else{return false}}},queueProperty:function(S,P){S=S.toLowerCase();YAHOO.log("queueProperty: "+S+"="+P,"info","Config");var R=this.config[S],K=false,J,G,H,I,O,Q,F,M,N,D,L,T,E;if(R&&R.event){if(!B.isUndefined(P)&&R.validator&&!R.validator(P)){return false}else{if(!B.isUndefined(P)){R.value=P}else{P=R.value}K=false;J=this.eventQueue.length;for(L=0;L<J;L++){G=this.eventQueue[L];if(G){H=G[0];I=G[1];if(H==S){this.eventQueue[L]=null;this.eventQueue.push([S,(!B.isUndefined(P)?P:I)]);K=true;break}}}if(!K&&!B.isUndefined(P)){this.eventQueue.push([S,P])}}if(R.supercedes){O=R.supercedes.length;for(T=0;T<O;T++){Q=R.supercedes[T];F=this.eventQueue.length;for(E=0;E<F;E++){M=this.eventQueue[E];if(M){N=M[0];D=M[1];if(N==Q.toLowerCase()){this.eventQueue.push([N,D]);this.eventQueue[E]=null;break}}}}}YAHOO.log("Config event queue: "+this.outputEventQueue(),"info","Config");return true}else{return false}},refireEvent:function(D){D=D.toLowerCase();var E=this.config[D];if(E&&E.event&&!B.isUndefined(E.value)){if(this.queueInProgress){this.queueProperty(D)}else{this.fireEvent(D,E.value)}}},applyConfig:function(D,G){var F,E;if(G){E={};for(F in D){if(B.hasOwnProperty(D,F)){E[F.toLowerCase()]=D[F]}}this.initialConfig=E}for(F in D){if(B.hasOwnProperty(D,F)){this.queueProperty(F,D[F])}}},refresh:function(){var D;for(D in this.config){if(B.hasOwnProperty(this.config,D)){this.refireEvent(D)}}},fireQueue:function(){var E,H,D,G,F;this.queueInProgress=true;for(E=0;E<this.eventQueue.length;E++){H=this.eventQueue[E];if(H){D=H[0];G=H[1];F=this.config[D];F.value=G;this.eventQueue[E]=null;this.fireEvent(D,G)}}this.queueInProgress=false;this.eventQueue=[]},subscribeToConfigEvent:function(D,E,G,H){var F=this.config[D.toLowerCase()];if(F&&F.event){if(!A.alreadySubscribed(F.event,E,G)){F.event.subscribe(E,G,H)}return true}else{return false}},unsubscribeFromConfigEvent:function(D,E,G){var F=this.config[D.toLowerCase()];if(F&&F.event){return F.event.unsubscribe(E,G)}else{return false}},toString:function(){var D="Config";if(this.owner){D+=" ["+this.owner.toString()+"]"}return D},outputEventQueue:function(){var D="",G,E,F=this.eventQueue.length;for(E=0;E<F;E++){G=this.eventQueue[E];if(G){D+=G[0]+"="+G[1]+", "}}return D},destroy:function(){var E=this.config,D,F;for(D in E){if(B.hasOwnProperty(E,D)){F=E[D];F.event.unsubscribeAll();F.event=null}}this.configChangedEvent.unsubscribeAll();this.configChangedEvent=null;this.owner=null;this.config=null;this.initialConfig=null;this.eventQueue=null}};A.alreadySubscribed=function(E,H,I){var F=E.subscribers.length,D,G;if(F>0){G=F-1;do{D=E.subscribers[G];if(D&&D.obj==I&&D.fn==H){return true}}while(G--)}return false};YAHOO.lang.augmentProto(A,YAHOO.util.EventProvider)}());YAHOO.widget.DateMath={DAY:"D",WEEK:"W",YEAR:"Y",MONTH:"M",ONE_DAY_MS:1000*60*60*24,WEEK_ONE_JAN_DATE:1,add:function(A,D,C){var F=new Date(A.getTime());switch(D){case this.MONTH:var E=A.getMonth()+C;var B=0;if(E<0){while(E<0){E+=12;B-=1}}else{if(E>11){while(E>11){E-=12;B+=1}}}F.setMonth(E);F.setFullYear(A.getFullYear()+B);break;case this.DAY:this._addDays(F,C);break;case this.YEAR:F.setFullYear(A.getFullYear()+C);break;case this.WEEK:this._addDays(F,(C*7));break}return F},_addDays:function(D,C){if(YAHOO.env.ua.webkit&&YAHOO.env.ua.webkit<420){if(C<0){for(var B=-128;C<B;C-=B){D.setDate(D.getDate()+B)}}else{for(var A=96;C>A;C-=A){D.setDate(D.getDate()+A)}}}D.setDate(D.getDate()+C)},subtract:function(A,C,B){return this.add(A,C,(B*-1))},before:function(C,B){var A=B.getTime();if(C.getTime()<A){return true}else{return false}},after:function(C,B){var A=B.getTime();if(C.getTime()>A){return true}else{return false}},between:function(B,A,C){if(this.after(B,A)&&this.before(B,C)){return true}else{return false}},getJan1:function(A){return this.getDate(A,0,1)},getDayOffset:function(B,D){var C=this.getJan1(D);var A=Math.ceil((B.getTime()-C.getTime())/this.ONE_DAY_MS);return A},getWeekNumber:function(D,B,G){B=B||0;G=G||this.WEEK_ONE_JAN_DATE;var H=this.clearTime(D),L,M;if(H.getDay()===B){L=H}else{L=this.getFirstDayOfWeek(H,B)}var I=L.getFullYear();M=new Date(L.getTime()+6*this.ONE_DAY_MS);var F;if(I!==M.getFullYear()&&M.getDate()>=G){F=1}else{var E=this.clearTime(this.getDate(I,0,G)),A=this.getFirstDayOfWeek(E,B);var J=Math.round((H.getTime()-A.getTime())/this.ONE_DAY_MS);var K=J%7;var C=(J-K)/7;F=C+1}return F},getFirstDayOfWeek:function(D,A){A=A||0;var B=D.getDay(),C=(B-A+7)%7;return this.subtract(D,this.DAY,C)},isYearOverlapWeek:function(A){var C=false;var B=this.add(A,this.DAY,6);if(B.getFullYear()!=A.getFullYear()){C=true}return C},isMonthOverlapWeek:function(A){var C=false;var B=this.add(A,this.DAY,6);if(B.getMonth()!=A.getMonth()){C=true}return C},findMonthStart:function(A){var B=this.getDate(A.getFullYear(),A.getMonth(),1);return B},findMonthEnd:function(B){var D=this.findMonthStart(B);var C=this.add(D,this.MONTH,1);var A=this.subtract(C,this.DAY,1);return A},clearTime:function(A){A.setHours(12,0,0,0);return A},getDate:function(D,A,C){var B=null;if(YAHOO.lang.isUndefined(C)){C=1}if(D>=100){B=new Date(D,A,C)}else{B=new Date();B.setFullYear(D);B.setMonth(A);B.setDate(C);B.setHours(0,0,0,0)}return B}};(function(){var C=YAHOO.util.Dom,A=YAHOO.util.Event,E=YAHOO.lang,D=YAHOO.widget.DateMath;function F(I,G,H){this.init.apply(this,arguments)}F.IMG_ROOT=null;F.DATE="D";F.MONTH_DAY="MD";F.WEEKDAY="WD";F.RANGE="R";F.MONTH="M";F.DISPLAY_DAYS=42;F.STOP_RENDER="S";F.SHORT="short";F.LONG="long";F.MEDIUM="medium";F.ONE_CHAR="1char";F.DEFAULT_CONFIG={YEAR_OFFSET:{key:"year_offset",value:0,supercedes:["pagedate","selected","mindate","maxdate"]},TODAY:{key:"today",value:new Date(),supercedes:["pagedate"]},PAGEDATE:{key:"pagedate",value:null},SELECTED:{key:"selected",value:[]},TITLE:{key:"title",value:""},CLOSE:{key:"close",value:false},IFRAME:{key:"iframe",value:(YAHOO.env.ua.ie&&YAHOO.env.ua.ie<=6)?true:false},MINDATE:{key:"mindate",value:null},MAXDATE:{key:"maxdate",value:null},MULTI_SELECT:{key:"multi_select",value:false},START_WEEKDAY:{key:"start_weekday",value:0},SHOW_WEEKDAYS:{key:"show_weekdays",value:true},SHOW_WEEK_HEADER:{key:"show_week_header",value:false},SHOW_WEEK_FOOTER:{key:"show_week_footer",value:false},HIDE_BLANK_WEEKS:{key:"hide_blank_weeks",value:false},NAV_ARROW_LEFT:{key:"nav_arrow_left",value:null},NAV_ARROW_RIGHT:{key:"nav_arrow_right",value:null},MONTHS_SHORT:{key:"months_short",value:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},MONTHS_LONG:{key:"months_long",value:["January","February","March","April","May","June","July","August","September","October","November","December"]},WEEKDAYS_1CHAR:{key:"weekdays_1char",value:["S","M","T","W","T","F","S"]},WEEKDAYS_SHORT:{key:"weekdays_short",value:["Su","Mo","Tu","We","Th","Fr","Sa"]},WEEKDAYS_MEDIUM:{key:"weekdays_medium",value:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},WEEKDAYS_LONG:{key:"weekdays_long",value:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},LOCALE_MONTHS:{key:"locale_months",value:"long"},LOCALE_WEEKDAYS:{key:"locale_weekdays",value:"short"},DATE_DELIMITER:{key:"date_delimiter",value:","},DATE_FIELD_DELIMITER:{key:"date_field_delimiter",value:"/"},DATE_RANGE_DELIMITER:{key:"date_range_delimiter",value:"-"},MY_MONTH_POSITION:{key:"my_month_position",value:1},MY_YEAR_POSITION:{key:"my_year_position",value:2},MD_MONTH_POSITION:{key:"md_month_position",value:1},MD_DAY_POSITION:{key:"md_day_position",value:2},MDY_MONTH_POSITION:{key:"mdy_month_position",value:1},MDY_DAY_POSITION:{key:"mdy_day_position",value:2},MDY_YEAR_POSITION:{key:"mdy_year_position",value:3},MY_LABEL_MONTH_POSITION:{key:"my_label_month_position",value:1},MY_LABEL_YEAR_POSITION:{key:"my_label_year_position",value:2},MY_LABEL_MONTH_SUFFIX:{key:"my_label_month_suffix",value:" "},MY_LABEL_YEAR_SUFFIX:{key:"my_label_year_suffix",value:""},NAV:{key:"navigator",value:null},STRINGS:{key:"strings",value:{previousMonth:"Previous Month",nextMonth:"Next Month",close:"Close"},supercedes:["close","title"]}};F._DEFAULT_CONFIG=F.DEFAULT_CONFIG;var B=F.DEFAULT_CONFIG;F._EVENT_TYPES={BEFORE_SELECT:"beforeSelect",SELECT:"select",BEFORE_DESELECT:"beforeDeselect",DESELECT:"deselect",CHANGE_PAGE:"changePage",BEFORE_RENDER:"beforeRender",RENDER:"render",BEFORE_DESTROY:"beforeDestroy",DESTROY:"destroy",RESET:"reset",CLEAR:"clear",BEFORE_HIDE:"beforeHide",HIDE:"hide",BEFORE_SHOW:"beforeShow",SHOW:"show",BEFORE_HIDE_NAV:"beforeHideNav",HIDE_NAV:"hideNav",BEFORE_SHOW_NAV:"beforeShowNav",SHOW_NAV:"showNav",BEFORE_RENDER_NAV:"beforeRenderNav",RENDER_NAV:"renderNav"};F.STYLES={CSS_ROW_HEADER:"calrowhead",CSS_ROW_FOOTER:"calrowfoot",CSS_CELL:"calcell",CSS_CELL_SELECTOR:"selector",CSS_CELL_SELECTED:"selected",CSS_CELL_SELECTABLE:"selectable",CSS_CELL_RESTRICTED:"restricted",CSS_CELL_TODAY:"today",CSS_CELL_OOM:"oom",CSS_CELL_OOB:"previous",CSS_HEADER:"calheader",CSS_HEADER_TEXT:"calhead",CSS_BODY:"calbody",CSS_WEEKDAY_CELL:"calweekdaycell",CSS_WEEKDAY_ROW:"calweekdayrow",CSS_FOOTER:"calfoot",CSS_CALENDAR:"yui-calendar",CSS_SINGLE:"single",CSS_CONTAINER:"yui-calcontainer",CSS_NAV_LEFT:"calnavleft",CSS_NAV_RIGHT:"calnavright",CSS_NAV:"calnav",CSS_CLOSE:"calclose",CSS_CELL_TOP:"calcelltop",CSS_CELL_LEFT:"calcellleft",CSS_CELL_RIGHT:"calcellright",CSS_CELL_BOTTOM:"calcellbottom",CSS_CELL_HOVER:"calcellhover",CSS_CELL_HIGHLIGHT1:"highlight1",CSS_CELL_HIGHLIGHT2:"highlight2",CSS_CELL_HIGHLIGHT3:"highlight3",CSS_CELL_HIGHLIGHT4:"highlight4",CSS_WITH_TITLE:"withtitle",CSS_FIXED_SIZE:"fixedsize",CSS_LINK_CLOSE:"link-close"};F._STYLES=F.STYLES;F.prototype={Config:null,parent:null,index:-1,cells:null,cellDates:null,id:null,containerId:null,oDomContainer:null,today:null,renderStack:null,_renderStack:null,oNavigator:null,_selectedDates:null,domEventMap:null,_parseArgs:function(H){var G={id:null,container:null,config:null};if(H&&H.length&&H.length>0){switch(H.length){case 1:G.id=null;G.container=H[0];G.config=null;break;case 2:if(E.isObject(H[1])&&!H[1].tagName&&!(H[1] instanceof String)){G.id=null;G.container=H[0];G.config=H[1]}else{G.id=H[0];G.container=H[1];G.config=null}break;default:G.id=H[0];G.container=H[1];G.config=H[2];break}}else{this.logger.log("Invalid constructor/init arguments","error")}return G},init:function(J,H,I){var G=this._parseArgs(arguments);J=G.id;H=G.container;I=G.config;this.oDomContainer=C.get(H);if(!this.oDomContainer){this.logger.log("Container not found in document.","error")}if(!this.oDomContainer.id){this.oDomContainer.id=C.generateId()}if(!J){J=this.oDomContainer.id+"_t"}this.id=J;this.containerId=this.oDomContainer.id;this.logger=new YAHOO.widget.LogWriter("Calendar "+this.id);this.initEvents();this.cfg=new YAHOO.util.Config(this);this.Options={};this.Locale={};this.initStyles();C.addClass(this.oDomContainer,this.Style.CSS_CONTAINER);C.addClass(this.oDomContainer,this.Style.CSS_SINGLE);this.cellDates=[];this.cells=[];this.renderStack=[];this._renderStack=[];this.setupConfig();if(I){this.cfg.applyConfig(I,true)}this.cfg.fireQueue();this.today=this.cfg.getProperty("today")},configIframe:function(I,H,J){var G=H[0];if(!this.parent){if(C.inDocument(this.oDomContainer)){if(G){var K=C.getStyle(this.oDomContainer,"position");if(K=="absolute"||K=="relative"){if(!C.inDocument(this.iframe)){this.iframe=document.createElement("iframe");this.iframe.src="javascript:false;";C.setStyle(this.iframe,"opacity","0");if(YAHOO.env.ua.ie&&YAHOO.env.ua.ie<=6){C.addClass(this.iframe,this.Style.CSS_FIXED_SIZE)}this.oDomContainer.insertBefore(this.iframe,this.oDomContainer.firstChild)}}}else{if(this.iframe){if(this.iframe.parentNode){this.iframe.parentNode.removeChild(this.iframe)}this.iframe=null}}}}},configTitle:function(H,G,I){var K=G[0];if(K){this.createTitleBar(K)}else{var J=this.cfg.getProperty(B.CLOSE.key);if(!J){this.removeTitleBar()}else{this.createTitleBar("&#160;")}}},configClose:function(H,G,I){var K=G[0],J=this.cfg.getProperty(B.TITLE.key);if(K){if(!J){this.createTitleBar("&#160;")}this.createCloseButton()}else{this.removeCloseButton();if(!J){this.removeTitleBar()}}},initEvents:function(){var G=F._EVENT_TYPES,I=YAHOO.util.CustomEvent,H=this;H.beforeSelectEvent=new I(G.BEFORE_SELECT);H.selectEvent=new I(G.SELECT);H.beforeDeselectEvent=new I(G.BEFORE_DESELECT);H.deselectEvent=new I(G.DESELECT);H.changePageEvent=new I(G.CHANGE_PAGE);H.beforeRenderEvent=new I(G.BEFORE_RENDER);H.renderEvent=new I(G.RENDER);H.beforeDestroyEvent=new I(G.BEFORE_DESTROY);H.destroyEvent=new I(G.DESTROY);H.resetEvent=new I(G.RESET);H.clearEvent=new I(G.CLEAR);H.beforeShowEvent=new I(G.BEFORE_SHOW);H.showEvent=new I(G.SHOW);H.beforeHideEvent=new I(G.BEFORE_HIDE);H.hideEvent=new I(G.HIDE);H.beforeShowNavEvent=new I(G.BEFORE_SHOW_NAV);H.showNavEvent=new I(G.SHOW_NAV);H.beforeHideNavEvent=new I(G.BEFORE_HIDE_NAV);H.hideNavEvent=new I(G.HIDE_NAV);H.beforeRenderNavEvent=new I(G.BEFORE_RENDER_NAV);H.renderNavEvent=new I(G.RENDER_NAV);H.beforeSelectEvent.subscribe(H.onBeforeSelect,this,true);H.selectEvent.subscribe(H.onSelect,this,true);H.beforeDeselectEvent.subscribe(H.onBeforeDeselect,this,true);H.deselectEvent.subscribe(H.onDeselect,this,true);H.changePageEvent.subscribe(H.onChangePage,this,true);H.renderEvent.subscribe(H.onRender,this,true);H.resetEvent.subscribe(H.onReset,this,true);H.clearEvent.subscribe(H.onClear,this,true)},doPreviousMonthNav:function(H,G){A.preventDefault(H);setTimeout(function(){G.previousMonth();var J=C.getElementsByClassName(G.Style.CSS_NAV_LEFT,"a",G.oDomContainer);if(J&&J[0]){try{J[0].focus()}catch(I){}}},0)},doNextMonthNav:function(H,G){A.preventDefault(H);setTimeout(function(){G.nextMonth();var J=C.getElementsByClassName(G.Style.CSS_NAV_RIGHT,"a",G.oDomContainer);if(J&&J[0]){try{J[0].focus()}catch(I){}}},0)},doSelectCell:function(M,G){var R,O,I,L;var N=A.getTarget(M),H=N.tagName.toLowerCase(),K=false;while(H!="td"&&!C.hasClass(N,G.Style.CSS_CELL_SELECTABLE)){if(!K&&H=="a"&&C.hasClass(N,G.Style.CSS_CELL_SELECTOR)){K=true}N=N.parentNode;H=N.tagName.toLowerCase();if(N==this.oDomContainer||H=="html"){return }}if(K){A.preventDefault(M)}R=N;if(C.hasClass(R,G.Style.CSS_CELL_SELECTABLE)){L=G.getIndexFromId(R.id);if(L>-1){O=G.cellDates[L];if(O){I=D.getDate(O[0],O[1]-1,O[2]);var Q;G.logger.log("Selecting cell "+L+" via click","info");if(G.Options.MULTI_SELECT){Q=R.getElementsByTagName("a")[0];if(Q){Q.blur()}var J=G.cellDates[L];var P=G._indexOfSelectedFieldArray(J);if(P>-1){G.deselectCell(L)}else{G.selectCell(L)}}else{Q=R.getElementsByTagName("a")[0];if(Q){Q.blur()}G.selectCell(L)}}}}},doCellMouseOver:function(I,H){var G;if(I){G=A.getTarget(I)}else{G=this}while(G.tagName&&G.tagName.toLowerCase()!="td"){G=G.parentNode;if(!G.tagName||G.tagName.toLowerCase()=="html"){return }}if(C.hasClass(G,H.Style.CSS_CELL_SELECTABLE)){C.addClass(G,H.Style.CSS_CELL_HOVER)}},doCellMouseOut:function(I,H){var G;if(I){G=A.getTarget(I)}else{G=this}while(G.tagName&&G.tagName.toLowerCase()!="td"){G=G.parentNode;if(!G.tagName||G.tagName.toLowerCase()=="html"){return }}if(C.hasClass(G,H.Style.CSS_CELL_SELECTABLE)){C.removeClass(G,H.Style.CSS_CELL_HOVER)}},setupConfig:function(){var G=this.cfg;G.addProperty(B.TODAY.key,{value:new Date(B.TODAY.value.getTime()),supercedes:B.TODAY.supercedes,handler:this.configToday,suppressEvent:true});G.addProperty(B.PAGEDATE.key,{value:B.PAGEDATE.value||new Date(B.TODAY.value.getTime()),handler:this.configPageDate});G.addProperty(B.SELECTED.key,{value:B.SELECTED.value.concat(),handler:this.configSelected});G.addProperty(B.TITLE.key,{value:B.TITLE.value,handler:this.configTitle});G.addProperty(B.CLOSE.key,{value:B.CLOSE.value,handler:this.configClose});G.addProperty(B.IFRAME.key,{value:B.IFRAME.value,handler:this.configIframe,validator:G.checkBoolean});G.addProperty(B.MINDATE.key,{value:B.MINDATE.value,handler:this.configMinDate});G.addProperty(B.MAXDATE.key,{value:B.MAXDATE.value,handler:this.configMaxDate});G.addProperty(B.MULTI_SELECT.key,{value:B.MULTI_SELECT.value,handler:this.configOptions,validator:G.checkBoolean});G.addProperty(B.START_WEEKDAY.key,{value:B.START_WEEKDAY.value,handler:this.configOptions,validator:G.checkNumber});G.addProperty(B.SHOW_WEEKDAYS.key,{value:B.SHOW_WEEKDAYS.value,handler:this.configOptions,validator:G.checkBoolean});G.addProperty(B.SHOW_WEEK_HEADER.key,{value:B.SHOW_WEEK_HEADER.value,handler:this.configOptions,validator:G.checkBoolean});G.addProperty(B.SHOW_WEEK_FOOTER.key,{value:B.SHOW_WEEK_FOOTER.value,handler:this.configOptions,validator:G.checkBoolean});G.addProperty(B.HIDE_BLANK_WEEKS.key,{value:B.HIDE_BLANK_WEEKS.value,handler:this.configOptions,validator:G.checkBoolean});G.addProperty(B.NAV_ARROW_LEFT.key,{value:B.NAV_ARROW_LEFT.value,handler:this.configOptions});G.addProperty(B.NAV_ARROW_RIGHT.key,{value:B.NAV_ARROW_RIGHT.value,handler:this.configOptions});G.addProperty(B.MONTHS_SHORT.key,{value:B.MONTHS_SHORT.value,handler:this.configLocale});G.addProperty(B.MONTHS_LONG.key,{value:B.MONTHS_LONG.value,handler:this.configLocale});G.addProperty(B.WEEKDAYS_1CHAR.key,{value:B.WEEKDAYS_1CHAR.value,handler:this.configLocale});G.addProperty(B.WEEKDAYS_SHORT.key,{value:B.WEEKDAYS_SHORT.value,handler:this.configLocale});G.addProperty(B.WEEKDAYS_MEDIUM.key,{value:B.WEEKDAYS_MEDIUM.value,handler:this.configLocale});G.addProperty(B.WEEKDAYS_LONG.key,{value:B.WEEKDAYS_LONG.value,handler:this.configLocale});var H=function(){G.refireEvent(B.LOCALE_MONTHS.key);G.refireEvent(B.LOCALE_WEEKDAYS.key)};G.subscribeToConfigEvent(B.START_WEEKDAY.key,H,this,true);G.subscribeToConfigEvent(B.MONTHS_SHORT.key,H,this,true);G.subscribeToConfigEvent(B.MONTHS_LONG.key,H,this,true);G.subscribeToConfigEvent(B.WEEKDAYS_1CHAR.key,H,this,true);G.subscribeToConfigEvent(B.WEEKDAYS_SHORT.key,H,this,true);G.subscribeToConfigEvent(B.WEEKDAYS_MEDIUM.key,H,this,true);G.subscribeToConfigEvent(B.WEEKDAYS_LONG.key,H,this,true);G.addProperty(B.LOCALE_MONTHS.key,{value:B.LOCALE_MONTHS.value,handler:this.configLocaleValues});G.addProperty(B.LOCALE_WEEKDAYS.key,{value:B.LOCALE_WEEKDAYS.value,handler:this.configLocaleValues});G.addProperty(B.YEAR_OFFSET.key,{value:B.YEAR_OFFSET.value,supercedes:B.YEAR_OFFSET.supercedes,handler:this.configLocale});G.addProperty(B.DATE_DELIMITER.key,{value:B.DATE_DELIMITER.value,handler:this.configLocale});G.addProperty(B.DATE_FIELD_DELIMITER.key,{value:B.DATE_FIELD_DELIMITER.value,handler:this.configLocale});G.addProperty(B.DATE_RANGE_DELIMITER.key,{value:B.DATE_RANGE_DELIMITER.value,handler:this.configLocale});G.addProperty(B.MY_MONTH_POSITION.key,{value:B.MY_MONTH_POSITION.value,handler:this.configLocale,validator:G.checkNumber});G.addProperty(B.MY_YEAR_POSITION.key,{value:B.MY_YEAR_POSITION.value,handler:this.configLocale,validator:G.checkNumber});G.addProperty(B.MD_MONTH_POSITION.key,{value:B.MD_MONTH_POSITION.value,handler:this.configLocale,validator:G.checkNumber});G.addProperty(B.MD_DAY_POSITION.key,{value:B.MD_DAY_POSITION.value,handler:this.configLocale,validator:G.checkNumber});G.addProperty(B.MDY_MONTH_POSITION.key,{value:B.MDY_MONTH_POSITION.value,handler:this.configLocale,validator:G.checkNumber});G.addProperty(B.MDY_DAY_POSITION.key,{value:B.MDY_DAY_POSITION.value,handler:this.configLocale,validator:G.checkNumber});G.addProperty(B.MDY_YEAR_POSITION.key,{value:B.MDY_YEAR_POSITION.value,handler:this.configLocale,validator:G.checkNumber});G.addProperty(B.MY_LABEL_MONTH_POSITION.key,{value:B.MY_LABEL_MONTH_POSITION.value,handler:this.configLocale,validator:G.checkNumber});G.addProperty(B.MY_LABEL_YEAR_POSITION.key,{value:B.MY_LABEL_YEAR_POSITION.value,handler:this.configLocale,validator:G.checkNumber});G.addProperty(B.MY_LABEL_MONTH_SUFFIX.key,{value:B.MY_LABEL_MONTH_SUFFIX.value,handler:this.configLocale});G.addProperty(B.MY_LABEL_YEAR_SUFFIX.key,{value:B.MY_LABEL_YEAR_SUFFIX.value,handler:this.configLocale});G.addProperty(B.NAV.key,{value:B.NAV.value,handler:this.configNavigator});G.addProperty(B.STRINGS.key,{value:B.STRINGS.value,handler:this.configStrings,validator:function(I){return E.isObject(I)},supercedes:B.STRINGS.supercedes})},configStrings:function(H,G,I){var J=E.merge(B.STRINGS.value,G[0]);this.cfg.setProperty(B.STRINGS.key,J,true)},configPageDate:function(H,G,I){this.cfg.setProperty(B.PAGEDATE.key,this._parsePageDate(G[0]),true)},configMinDate:function(H,G,I){var J=G[0];if(E.isString(J)){J=this._parseDate(J);this.cfg.setProperty(B.MINDATE.key,D.getDate(J[0],(J[1]-1),J[2]))}},configMaxDate:function(H,G,I){var J=G[0];if(E.isString(J)){J=this._parseDate(J);this.cfg.setProperty(B.MAXDATE.key,D.getDate(J[0],(J[1]-1),J[2]))}},configToday:function(I,H,J){var K=H[0];if(E.isString(K)){K=this._parseDate(K)}var G=D.clearTime(K);if(!this.cfg.initialConfig[B.PAGEDATE.key]){this.cfg.setProperty(B.PAGEDATE.key,G)}this.today=G;this.cfg.setProperty(B.TODAY.key,G,true)},configSelected:function(I,G,K){var H=G[0],J=B.SELECTED.key;if(H){if(E.isString(H)){this.cfg.setProperty(J,this._parseDates(H),true)}}if(!this._selectedDates){this._selectedDates=this.cfg.getProperty(J)}},configOptions:function(H,G,I){this.Options[H.toUpperCase()]=G[0]},configLocale:function(H,G,I){this.Locale[H.toUpperCase()]=G[0];this.cfg.refireEvent(B.LOCALE_MONTHS.key);this.cfg.refireEvent(B.LOCALE_WEEKDAYS.key)},configLocaleValues:function(J,I,K){J=J.toLowerCase();var M=I[0],H=this.cfg,N=this.Locale;switch(J){case B.LOCALE_MONTHS.key:switch(M){case F.SHORT:N.LOCALE_MONTHS=H.getProperty(B.MONTHS_SHORT.key).concat();break;case F.LONG:N.LOCALE_MONTHS=H.getProperty(B.MONTHS_LONG.key).concat();break}break;case B.LOCALE_WEEKDAYS.key:switch(M){case F.ONE_CHAR:N.LOCALE_WEEKDAYS=H.getProperty(B.WEEKDAYS_1CHAR.key).concat();break;case F.SHORT:N.LOCALE_WEEKDAYS=H.getProperty(B.WEEKDAYS_SHORT.key).concat();break;case F.MEDIUM:N.LOCALE_WEEKDAYS=H.getProperty(B.WEEKDAYS_MEDIUM.key).concat();break;case F.LONG:N.LOCALE_WEEKDAYS=H.getProperty(B.WEEKDAYS_LONG.key).concat();break}var L=H.getProperty(B.START_WEEKDAY.key);if(L>0){for(var G=0;G<L;++G){N.LOCALE_WEEKDAYS.push(N.LOCALE_WEEKDAYS.shift())}}break}},configNavigator:function(H,G,I){var J=G[0];if(YAHOO.widget.CalendarNavigator&&(J===true||E.isObject(J))){if(!this.oNavigator){this.oNavigator=new YAHOO.widget.CalendarNavigator(this);this.beforeRenderEvent.subscribe(function(){if(!this.pages){this.oNavigator.erase()}},this,true)}}else{if(this.oNavigator){this.oNavigator.destroy();this.oNavigator=null}}},initStyles:function(){var G=F.STYLES;this.Style={CSS_ROW_HEADER:G.CSS_ROW_HEADER,CSS_ROW_FOOTER:G.CSS_ROW_FOOTER,CSS_CELL:G.CSS_CELL,CSS_CELL_SELECTOR:G.CSS_CELL_SELECTOR,CSS_CELL_SELECTED:G.CSS_CELL_SELECTED,CSS_CELL_SELECTABLE:G.CSS_CELL_SELECTABLE,CSS_CELL_RESTRICTED:G.CSS_CELL_RESTRICTED,CSS_CELL_TODAY:G.CSS_CELL_TODAY,CSS_CELL_OOM:G.CSS_CELL_OOM,CSS_CELL_OOB:G.CSS_CELL_OOB,CSS_HEADER:G.CSS_HEADER,CSS_HEADER_TEXT:G.CSS_HEADER_TEXT,CSS_BODY:G.CSS_BODY,CSS_WEEKDAY_CELL:G.CSS_WEEKDAY_CELL,CSS_WEEKDAY_ROW:G.CSS_WEEKDAY_ROW,CSS_FOOTER:G.CSS_FOOTER,CSS_CALENDAR:G.CSS_CALENDAR,CSS_SINGLE:G.CSS_SINGLE,CSS_CONTAINER:G.CSS_CONTAINER,CSS_NAV_LEFT:G.CSS_NAV_LEFT,CSS_NAV_RIGHT:G.CSS_NAV_RIGHT,CSS_NAV:G.CSS_NAV,CSS_CLOSE:G.CSS_CLOSE,CSS_CELL_TOP:G.CSS_CELL_TOP,CSS_CELL_LEFT:G.CSS_CELL_LEFT,CSS_CELL_RIGHT:G.CSS_CELL_RIGHT,CSS_CELL_BOTTOM:G.CSS_CELL_BOTTOM,CSS_CELL_HOVER:G.CSS_CELL_HOVER,CSS_CELL_HIGHLIGHT1:G.CSS_CELL_HIGHLIGHT1,CSS_CELL_HIGHLIGHT2:G.CSS_CELL_HIGHLIGHT2,CSS_CELL_HIGHLIGHT3:G.CSS_CELL_HIGHLIGHT3,CSS_CELL_HIGHLIGHT4:G.CSS_CELL_HIGHLIGHT4,CSS_WITH_TITLE:G.CSS_WITH_TITLE,CSS_FIXED_SIZE:G.CSS_FIXED_SIZE,CSS_LINK_CLOSE:G.CSS_LINK_CLOSE}},buildMonthLabel:function(){return this._buildMonthLabel(this.cfg.getProperty(B.PAGEDATE.key))},_buildMonthLabel:function(G){var I=this.Locale.LOCALE_MONTHS[G.getMonth()]+this.Locale.MY_LABEL_MONTH_SUFFIX,H=(G.getFullYear()+this.Locale.YEAR_OFFSET)+this.Locale.MY_LABEL_YEAR_SUFFIX;if(this.Locale.MY_LABEL_MONTH_POSITION==2||this.Locale.MY_LABEL_YEAR_POSITION==1){return H+I}else{return I+H}},buildDayLabel:function(G){return G.getDate()},createTitleBar:function(G){var H=C.getElementsByClassName(YAHOO.widget.CalendarGroup.CSS_2UPTITLE,"div",this.oDomContainer)[0]||document.createElement("div");H.className=YAHOO.widget.CalendarGroup.CSS_2UPTITLE;H.innerHTML=G;this.oDomContainer.insertBefore(H,this.oDomContainer.firstChild);C.addClass(this.oDomContainer,this.Style.CSS_WITH_TITLE);return H},removeTitleBar:function(){var G=C.getElementsByClassName(YAHOO.widget.CalendarGroup.CSS_2UPTITLE,"div",this.oDomContainer)[0]||null;if(G){A.purgeElement(G);this.oDomContainer.removeChild(G)}C.removeClass(this.oDomContainer,this.Style.CSS_WITH_TITLE)},createCloseButton:function(){var K=YAHOO.widget.CalendarGroup.CSS_2UPCLOSE,J=this.Style.CSS_LINK_CLOSE,M="us/my/bn/x_d.gif",L=C.getElementsByClassName(J,"a",this.oDomContainer)[0],G=this.cfg.getProperty(B.STRINGS.key),H=(G&&G.close)?G.close:"";if(!L){L=document.createElement("a");A.addListener(L,"click",function(O,N){N.hide();A.preventDefault(O)},this)}L.href="#";L.className=J;if(F.IMG_ROOT!==null){var I=C.getElementsByClassName(K,"img",L)[0]||document.createElement("img");I.src=F.IMG_ROOT+M;I.className=K;L.appendChild(I)}else{L.innerHTML='<span class="'+K+" "+this.Style.CSS_CLOSE+'">'+H+"</span>"}this.oDomContainer.appendChild(L);return L},removeCloseButton:function(){var G=C.getElementsByClassName(this.Style.CSS_LINK_CLOSE,"a",this.oDomContainer)[0]||null;if(G){A.purgeElement(G);this.oDomContainer.removeChild(G)}},renderHeader:function(Q){this.logger.log("Rendering header","render");var P=7,O="us/tr/callt.gif",G="us/tr/calrt.gif",N=this.cfg,K=N.getProperty(B.PAGEDATE.key),L=N.getProperty(B.STRINGS.key),V=(L&&L.previousMonth)?L.previousMonth:"",H=(L&&L.nextMonth)?L.nextMonth:"",M;if(N.getProperty(B.SHOW_WEEK_HEADER.key)){P+=1}if(N.getProperty(B.SHOW_WEEK_FOOTER.key)){P+=1}Q[Q.length]="<thead>";Q[Q.length]="<tr>";Q[Q.length]='<th colspan="'+P+'" class="'+this.Style.CSS_HEADER_TEXT+'">';Q[Q.length]='<div class="'+this.Style.CSS_HEADER+'">';var X,U=false;if(this.parent){if(this.index===0){X=true}if(this.index==(this.parent.cfg.getProperty("pages")-1)){U=true}}else{X=true;U=true}if(X){M=this._buildMonthLabel(D.subtract(K,D.MONTH,1));var R=N.getProperty(B.NAV_ARROW_LEFT.key);if(R===null&&F.IMG_ROOT!==null){R=F.IMG_ROOT+O}var I=(R===null)?"":' style="background-image:url('+R+')"';Q[Q.length]='<a class="'+this.Style.CSS_NAV_LEFT+'"'+I+' href="#">'+V+" ("+M+")</a>"}var W=this.buildMonthLabel();var S=this.parent||this;if(S.cfg.getProperty("navigator")){W='<a class="'+this.Style.CSS_NAV+'" href="#">'+W+"</a>"}Q[Q.length]=W;if(U){M=this._buildMonthLabel(D.add(K,D.MONTH,1));var T=N.getProperty(B.NAV_ARROW_RIGHT.key);if(T===null&&F.IMG_ROOT!==null){T=F.IMG_ROOT+G}var J=(T===null)?"":' style="background-image:url('+T+')"';Q[Q.length]='<a class="'+this.Style.CSS_NAV_RIGHT+'"'+J+' href="#">'+H+" ("+M+")</a>"}Q[Q.length]="</div>\n</th>\n</tr>";if(N.getProperty(B.SHOW_WEEKDAYS.key)){Q=this.buildWeekdays(Q)}Q[Q.length]="</thead>";return Q},buildWeekdays:function(H){H[H.length]='<tr class="'+this.Style.CSS_WEEKDAY_ROW+'">';if(this.cfg.getProperty(B.SHOW_WEEK_HEADER.key)){H[H.length]="<th>&#160;</th>"}for(var G=0;G<this.Locale.LOCALE_WEEKDAYS.length;++G){H[H.length]='<th class="'+this.Style.CSS_WEEKDAY_CELL+'">'+this.Locale.LOCALE_WEEKDAYS[G]+"</th>"}if(this.cfg.getProperty(B.SHOW_WEEK_FOOTER.key)){H[H.length]="<th>&#160;</th>"}H[H.length]="</tr>";return H},renderBody:function(m,k){this.logger.log("Rendering body","render");var AK=this.cfg.getProperty(B.START_WEEKDAY.key);this.preMonthDays=m.getDay();if(AK>0){this.preMonthDays-=AK}if(this.preMonthDays<0){this.preMonthDays+=7}this.monthDays=D.findMonthEnd(m).getDate();this.postMonthDays=F.DISPLAY_DAYS-this.preMonthDays-this.monthDays;this.logger.log(this.preMonthDays+" preciding out-of-month days","render");this.logger.log(this.monthDays+" month days","render");this.logger.log(this.postMonthDays+" post-month days","render");m=D.subtract(m,D.DAY,this.preMonthDays);this.logger.log("Calendar page starts on "+m,"render");var Y,N,M="w",f="_cell",c="wd",w="d",P,u,AC=this.today,O=this.cfg,W=AC.getFullYear(),v=AC.getMonth(),J=AC.getDate(),AB=O.getProperty(B.PAGEDATE.key),I=O.getProperty(B.HIDE_BLANK_WEEKS.key),j=O.getProperty(B.SHOW_WEEK_FOOTER.key),b=O.getProperty(B.SHOW_WEEK_HEADER.key),U=O.getProperty(B.MINDATE.key),a=O.getProperty(B.MAXDATE.key),T=this.Locale.YEAR_OFFSET;if(U){U=D.clearTime(U)}if(a){a=D.clearTime(a)}k[k.length]='<tbody class="m'+(AB.getMonth()+1)+" "+this.Style.CSS_BODY+'">';var AI=0,Q=document.createElement("div"),l=document.createElement("td");Q.appendChild(l);var AA=this.parent||this;for(var AE=0;AE<6;AE++){Y=D.getWeekNumber(m,AK);N=M+Y;if(AE!==0&&I===true&&m.getMonth()!=AB.getMonth()){break}else{k[k.length]='<tr class="'+N+'">';if(b){k=this.renderRowHeader(Y,k)}for(var AJ=0;AJ<7;AJ++){P=[];this.clearElement(l);l.className=this.Style.CSS_CELL;l.id=this.id+f+AI;this.logger.log("Rendering cell "+l.id+" ("+m.getFullYear()+T+"-"+(m.getMonth()+1)+"-"+m.getDate()+")","cellrender");if(m.getDate()==J&&m.getMonth()==v&&m.getFullYear()==W){P[P.length]=AA.renderCellStyleToday}var Z=[m.getFullYear(),m.getMonth()+1,m.getDate()];this.cellDates[this.cellDates.length]=Z;if(m.getMonth()!=AB.getMonth()){P[P.length]=AA.renderCellNotThisMonth}else{C.addClass(l,c+m.getDay());C.addClass(l,w+m.getDate());for(var AD=0;AD<this.renderStack.length;++AD){u=null;var y=this.renderStack[AD],AL=y[0],H,e,L;switch(AL){case F.DATE:H=y[1][1];e=y[1][2];L=y[1][0];if(m.getMonth()+1==H&&m.getDate()==e&&m.getFullYear()==L){u=y[2];this.renderStack.splice(AD,1)}break;case F.MONTH_DAY:H=y[1][0];e=y[1][1];if(m.getMonth()+1==H&&m.getDate()==e){u=y[2];this.renderStack.splice(AD,1)}break;case F.RANGE:var h=y[1][0],g=y[1][1],n=h[1],S=h[2],X=h[0],AH=D.getDate(X,n-1,S),K=g[1],q=g[2],G=g[0],AG=D.getDate(G,K-1,q);if(m.getTime()>=AH.getTime()&&m.getTime()<=AG.getTime()){u=y[2];if(m.getTime()==AG.getTime()){this.renderStack.splice(AD,1)}}break;case F.WEEKDAY:var R=y[1][0];if(m.getDay()+1==R){u=y[2]}break;case F.MONTH:H=y[1][0];if(m.getMonth()+1==H){u=y[2]}break}if(u){P[P.length]=u}}}if(this._indexOfSelectedFieldArray(Z)>-1){P[P.length]=AA.renderCellStyleSelected}if((U&&(m.getTime()<U.getTime()))||(a&&(m.getTime()>a.getTime()))){P[P.length]=AA.renderOutOfBoundsDate}else{P[P.length]=AA.styleCellDefault;P[P.length]=AA.renderCellDefault}for(var z=0;z<P.length;++z){this.logger.log("renderer["+z+"] for ("+m.getFullYear()+T+"-"+(m.getMonth()+1)+"-"+m.getDate()+")","cellrender");if(P[z].call(AA,m,l)==F.STOP_RENDER){break}}m.setTime(m.getTime()+D.ONE_DAY_MS);m=D.clearTime(m);if(AI>=0&&AI<=6){C.addClass(l,this.Style.CSS_CELL_TOP)}if((AI%7)===0){C.addClass(l,this.Style.CSS_CELL_LEFT)}if(((AI+1)%7)===0){C.addClass(l,this.Style.CSS_CELL_RIGHT)}var o=this.postMonthDays;if(I&&o>=7){var V=Math.floor(o/7);for(var AF=0;AF<V;++AF){o-=7}}if(AI>=((this.preMonthDays+o+this.monthDays)-7)){C.addClass(l,this.Style.CSS_CELL_BOTTOM)}k[k.length]=Q.innerHTML;AI++}if(j){k=this.renderRowFooter(Y,k)}k[k.length]="</tr>"}}k[k.length]="</tbody>";return k},renderFooter:function(G){return G},render:function(){this.beforeRenderEvent.fire();var H=D.findMonthStart(this.cfg.getProperty(B.PAGEDATE.key));this.resetRenderers();this.cellDates.length=0;A.purgeElement(this.oDomContainer,true);var G=[];G[G.length]='<table cellSpacing="0" class="'+this.Style.CSS_CALENDAR+" y"+(H.getFullYear()+this.Locale.YEAR_OFFSET)+'" id="'+this.id+'">';G=this.renderHeader(G);G=this.renderBody(H,G);G=this.renderFooter(G);G[G.length]="</table>";this.oDomContainer.innerHTML=G.join("\n");this.applyListeners();this.cells=C.getElementsByClassName(this.Style.CSS_CELL,"td",this.id);this.cfg.refireEvent(B.TITLE.key);this.cfg.refireEvent(B.CLOSE.key);this.cfg.refireEvent(B.IFRAME.key);this.renderEvent.fire()},applyListeners:function(){var P=this.oDomContainer,H=this.parent||this,L="a",S="click";var M=C.getElementsByClassName(this.Style.CSS_NAV_LEFT,L,P),I=C.getElementsByClassName(this.Style.CSS_NAV_RIGHT,L,P);if(M&&M.length>0){this.linkLeft=M[0];A.addListener(this.linkLeft,S,this.doPreviousMonthNav,H,true)}if(I&&I.length>0){this.linkRight=I[0];A.addListener(this.linkRight,S,this.doNextMonthNav,H,true)}if(H.cfg.getProperty("navigator")!==null){this.applyNavListeners()}if(this.domEventMap){var J,G;for(var R in this.domEventMap){if(E.hasOwnProperty(this.domEventMap,R)){var N=this.domEventMap[R];if(!(N instanceof Array)){N=[N]}for(var K=0;K<N.length;K++){var Q=N[K];G=C.getElementsByClassName(R,Q.tag,this.oDomContainer);for(var O=0;O<G.length;O++){J=G[O];A.addListener(J,Q.event,Q.handler,Q.scope,Q.correct)}}}}}A.addListener(this.oDomContainer,"click",this.doSelectCell,this);A.addListener(this.oDomContainer,"mouseover",this.doCellMouseOver,this);A.addListener(this.oDomContainer,"mouseout",this.doCellMouseOut,this)},applyNavListeners:function(){var H=this.parent||this,I=this,G=C.getElementsByClassName(this.Style.CSS_NAV,"a",this.oDomContainer);if(G.length>0){A.addListener(G,"click",function(N,M){var L=A.getTarget(N);if(this===L||C.isAncestor(this,L)){A.preventDefault(N)}var J=H.oNavigator;if(J){var K=I.cfg.getProperty("pagedate");J.setYear(K.getFullYear()+I.Locale.YEAR_OFFSET);J.setMonth(K.getMonth());J.show()}})}},getDateByCellId:function(H){var G=this.getDateFieldsByCellId(H);return(G)?D.getDate(G[0],G[1]-1,G[2]):null},getDateFieldsByCellId:function(G){G=this.getIndexFromId(G);return(G>-1)?this.cellDates[G]:null},getCellIndex:function(I){var H=-1;if(I){var G=I.getMonth(),N=I.getFullYear(),M=I.getDate(),K=this.cellDates;for(var J=0;J<K.length;++J){var L=K[J];if(L[0]===N&&L[1]===G+1&&L[2]===M){H=J;break}}}return H},getIndexFromId:function(I){var H=-1,G=I.lastIndexOf("_cell");if(G>-1){H=parseInt(I.substring(G+5),10)}return H},renderOutOfBoundsDate:function(H,G){C.addClass(G,this.Style.CSS_CELL_OOB);G.innerHTML=H.getDate();return F.STOP_RENDER},renderRowHeader:function(H,G){G[G.length]='<th class="'+this.Style.CSS_ROW_HEADER+'">'+H+"</th>";return G},renderRowFooter:function(H,G){G[G.length]='<th class="'+this.Style.CSS_ROW_FOOTER+'">'+H+"</th>";return G},renderCellDefault:function(H,G){G.innerHTML='<a href="#" class="'+this.Style.CSS_CELL_SELECTOR+'">'+this.buildDayLabel(H)+"</a>"},styleCellDefault:function(H,G){C.addClass(G,this.Style.CSS_CELL_SELECTABLE)},renderCellStyleHighlight1:function(H,G){C.addClass(G,this.Style.CSS_CELL_HIGHLIGHT1)},renderCellStyleHighlight2:function(H,G){C.addClass(G,this.Style.CSS_CELL_HIGHLIGHT2)},renderCellStyleHighlight3:function(H,G){C.addClass(G,this.Style.CSS_CELL_HIGHLIGHT3)},renderCellStyleHighlight4:function(H,G){C.addClass(G,this.Style.CSS_CELL_HIGHLIGHT4)},renderCellStyleToday:function(H,G){C.addClass(G,this.Style.CSS_CELL_TODAY)},renderCellStyleSelected:function(H,G){C.addClass(G,this.Style.CSS_CELL_SELECTED)},renderCellNotThisMonth:function(H,G){C.addClass(G,this.Style.CSS_CELL_OOM);G.innerHTML=H.getDate();return F.STOP_RENDER},renderBodyCellRestricted:function(H,G){C.addClass(G,this.Style.CSS_CELL);C.addClass(G,this.Style.CSS_CELL_RESTRICTED);G.innerHTML=H.getDate();return F.STOP_RENDER},addMonths:function(I){var H=B.PAGEDATE.key,J=this.cfg.getProperty(H),G=D.add(J,D.MONTH,I);this.cfg.setProperty(H,G);this.resetRenderers();this.changePageEvent.fire(J,G)},subtractMonths:function(G){this.addMonths(-1*G)},addYears:function(I){var H=B.PAGEDATE.key,J=this.cfg.getProperty(H),G=D.add(J,D.YEAR,I);this.cfg.setProperty(H,G);this.resetRenderers();this.changePageEvent.fire(J,G)},subtractYears:function(G){this.addYears(-1*G)},nextMonth:function(){this.addMonths(1)},previousMonth:function(){this.addMonths(-1)},nextYear:function(){this.addYears(1)},previousYear:function(){this.addYears(-1)},reset:function(){this.cfg.resetProperty(B.SELECTED.key);this.cfg.resetProperty(B.PAGEDATE.key);this.resetEvent.fire()},clear:function(){this.cfg.setProperty(B.SELECTED.key,[]);this.cfg.setProperty(B.PAGEDATE.key,new Date(this.today.getTime()));this.clearEvent.fire()},select:function(I){this.logger.log("Select: "+I,"info");var L=this._toFieldArray(I),H=[],K=[],M=B.SELECTED.key;this.logger.log("Selection field array: "+L,"info");for(var G=0;G<L.length;++G){var J=L[G];if(!this.isDateOOB(this._toDate(J))){if(H.length===0){this.beforeSelectEvent.fire();K=this.cfg.getProperty(M)}H.push(J);if(this._indexOfSelectedFieldArray(J)==-1){K[K.length]=J}}}if(H.length===0){this.logger.log("All provided dates were OOB. beforeSelect and select events not fired","info")}if(H.length>0){if(this.parent){this.parent.cfg.setProperty(M,K)}else{this.cfg.setProperty(M,K)}this.selectEvent.fire(H)}return this.getSelectedDates()},selectCell:function(J){var H=this.cells[J],N=this.cellDates[J],M=this._toDate(N),I=C.hasClass(H,this.Style.CSS_CELL_SELECTABLE);this.logger.log("Select: "+M,"info");if(!I){this.logger.log("The cell at cellIndex:"+J+" is not a selectable cell. beforeSelect, select events not fired","info")}if(I){this.beforeSelectEvent.fire();var L=B.SELECTED.key;var K=this.cfg.getProperty(L);var G=N.concat();if(this._indexOfSelectedFieldArray(G)==-1){K[K.length]=G}if(this.parent){this.parent.cfg.setProperty(L,K)}else{this.cfg.setProperty(L,K)}this.renderCellStyleSelected(M,H);this.selectEvent.fire([G]);this.doCellMouseOut.call(H,null,this)}return this.getSelectedDates()},deselect:function(K){this.logger.log("Deselect: "+K,"info");var G=this._toFieldArray(K),J=[],M=[],N=B.SELECTED.key;this.logger.log("Deselection field array: "+G,"info");for(var H=0;H<G.length;++H){var L=G[H];if(!this.isDateOOB(this._toDate(L))){if(J.length===0){this.beforeDeselectEvent.fire();M=this.cfg.getProperty(N)}J.push(L);var I=this._indexOfSelectedFieldArray(L);if(I!=-1){M.splice(I,1)}}}if(J.length===0){this.logger.log("All provided dates were OOB. beforeDeselect and deselect events not fired")}if(J.length>0){if(this.parent){this.parent.cfg.setProperty(N,M)}else{this.cfg.setProperty(N,M)}this.deselectEvent.fire(J)}return this.getSelectedDates()},deselectCell:function(K){var H=this.cells[K],N=this.cellDates[K],I=this._indexOfSelectedFieldArray(N);var J=C.hasClass(H,this.Style.CSS_CELL_SELECTABLE);if(!J){this.logger.log("The cell at cellIndex:"+K+" is not a selectable/deselectable cell","info")}if(J){this.beforeDeselectEvent.fire();var L=this.cfg.getProperty(B.SELECTED.key),M=this._toDate(N),G=N.concat();if(I>-1){if(this.cfg.getProperty(B.PAGEDATE.key).getMonth()==M.getMonth()&&this.cfg.getProperty(B.PAGEDATE.key).getFullYear()==M.getFullYear()){C.removeClass(H,this.Style.CSS_CELL_SELECTED)}L.splice(I,1)}if(this.parent){this.parent.cfg.setProperty(B.SELECTED.key,L)}else{this.cfg.setProperty(B.SELECTED.key,L)}this.deselectEvent.fire([G])}return this.getSelectedDates()},deselectAll:function(){this.beforeDeselectEvent.fire();var J=B.SELECTED.key,G=this.cfg.getProperty(J),H=G.length,I=G.concat();if(this.parent){this.parent.cfg.setProperty(J,[])}else{this.cfg.setProperty(J,[])}if(H>0){this.deselectEvent.fire(I)}return this.getSelectedDates()},_toFieldArray:function(H){var G=[];if(H instanceof Date){G=[[H.getFullYear(),H.getMonth()+1,H.getDate()]]}else{if(E.isString(H)){G=this._parseDates(H)}else{if(E.isArray(H)){for(var I=0;I<H.length;++I){var J=H[I];G[G.length]=[J.getFullYear(),J.getMonth()+1,J.getDate()]}}}}return G},toDate:function(G){return this._toDate(G)},_toDate:function(G){if(G instanceof Date){return G}else{return D.getDate(G[0],G[1]-1,G[2])}},_fieldArraysAreEqual:function(I,H){var G=false;if(I[0]==H[0]&&I[1]==H[1]&&I[2]==H[2]){G=true}return G},_indexOfSelectedFieldArray:function(K){var J=-1,G=this.cfg.getProperty(B.SELECTED.key);for(var I=0;I<G.length;++I){var H=G[I];if(K[0]==H[0]&&K[1]==H[1]&&K[2]==H[2]){J=I;break}}return J},isDateOOM:function(G){return(G.getMonth()!=this.cfg.getProperty(B.PAGEDATE.key).getMonth())},isDateOOB:function(I){var J=this.cfg.getProperty(B.MINDATE.key),K=this.cfg.getProperty(B.MAXDATE.key),H=D;if(J){J=H.clearTime(J)}if(K){K=H.clearTime(K)}var G=new Date(I.getTime());G=H.clearTime(G);return((J&&G.getTime()<J.getTime())||(K&&G.getTime()>K.getTime()))},_parsePageDate:function(G){var J;if(G){if(G instanceof Date){J=D.findMonthStart(G)}else{var K,I,H;H=G.split(this.cfg.getProperty(B.DATE_FIELD_DELIMITER.key));K=parseInt(H[this.cfg.getProperty(B.MY_MONTH_POSITION.key)-1],10)-1;I=parseInt(H[this.cfg.getProperty(B.MY_YEAR_POSITION.key)-1],10)-this.Locale.YEAR_OFFSET;J=D.getDate(I,K,1)}}else{J=D.getDate(this.today.getFullYear(),this.today.getMonth(),1)}return J},onBeforeSelect:function(){if(this.cfg.getProperty(B.MULTI_SELECT.key)===false){if(this.parent){this.parent.callChildFunction("clearAllBodyCellStyles",this.Style.CSS_CELL_SELECTED);this.parent.deselectAll()}else{this.clearAllBodyCellStyles(this.Style.CSS_CELL_SELECTED);this.deselectAll()}}},onSelect:function(G){},onBeforeDeselect:function(){},onDeselect:function(G){},onChangePage:function(){this.render()},onRender:function(){},onReset:function(){this.render()},onClear:function(){this.render()},validate:function(){return true},_parseDate:function(I){var J=I.split(this.Locale.DATE_FIELD_DELIMITER),G;if(J.length==2){G=[J[this.Locale.MD_MONTH_POSITION-1],J[this.Locale.MD_DAY_POSITION-1]];G.type=F.MONTH_DAY}else{G=[J[this.Locale.MDY_YEAR_POSITION-1]-this.Locale.YEAR_OFFSET,J[this.Locale.MDY_MONTH_POSITION-1],J[this.Locale.MDY_DAY_POSITION-1]];G.type=F.DATE}for(var H=0;H<G.length;H++){G[H]=parseInt(G[H],10)}return G},_parseDates:function(H){var O=[],N=H.split(this.Locale.DATE_DELIMITER);for(var M=0;M<N.length;++M){var L=N[M];if(L.indexOf(this.Locale.DATE_RANGE_DELIMITER)!=-1){var G=L.split(this.Locale.DATE_RANGE_DELIMITER),K=this._parseDate(G[0]),P=this._parseDate(G[1]),J=this._parseRange(K,P);O=O.concat(J)}else{var I=this._parseDate(L);O.push(I)}}return O},_parseRange:function(G,K){var H=D.add(D.getDate(G[0],G[1]-1,G[2]),D.DAY,1),J=D.getDate(K[0],K[1]-1,K[2]),I=[];I.push(G);while(H.getTime()<=J.getTime()){I.push([H.getFullYear(),H.getMonth()+1,H.getDate()]);H=D.add(H,D.DAY,1)}return I},resetRenderers:function(){this.renderStack=this._renderStack.concat()},removeRenderers:function(){this._renderStack=[];this.renderStack=[]},clearElement:function(G){G.innerHTML="&#160;";G.className=""},addRenderer:function(G,H){var J=this._parseDates(G);for(var I=0;I<J.length;++I){var K=J[I];if(K.length==2){if(K[0] instanceof Array){this._addRenderer(F.RANGE,K,H)}else{this._addRenderer(F.MONTH_DAY,K,H)}}else{if(K.length==3){this._addRenderer(F.DATE,K,H)}}}},_addRenderer:function(H,I,G){var J=[H,I,G];this.renderStack.unshift(J);this._renderStack=this.renderStack.concat()},addMonthRenderer:function(H,G){this._addRenderer(F.MONTH,[H],G)},addWeekdayRenderer:function(H,G){this._addRenderer(F.WEEKDAY,[H],G)},clearAllBodyCellStyles:function(G){for(var H=0;H<this.cells.length;++H){C.removeClass(this.cells[H],G)}},setMonth:function(I){var G=B.PAGEDATE.key,H=this.cfg.getProperty(G);H.setMonth(parseInt(I,10));this.cfg.setProperty(G,H)},setYear:function(H){var G=B.PAGEDATE.key,I=this.cfg.getProperty(G);I.setFullYear(parseInt(H,10)-this.Locale.YEAR_OFFSET);this.cfg.setProperty(G,I)},getSelectedDates:function(){var I=[],H=this.cfg.getProperty(B.SELECTED.key);for(var K=0;K<H.length;++K){var J=H[K];var G=D.getDate(J[0],J[1]-1,J[2]);I.push(G)}I.sort(function(M,L){return M-L});return I},hide:function(){if(this.beforeHideEvent.fire()){this.oDomContainer.style.display="none";this.hideEvent.fire()}},show:function(){if(this.beforeShowEvent.fire()){this.oDomContainer.style.display="block";this.showEvent.fire()}},browser:(function(){var G=navigator.userAgent.toLowerCase();if(G.indexOf("opera")!=-1){return"opera"}else{if(G.indexOf("msie 7")!=-1){return"ie7"}else{if(G.indexOf("msie")!=-1){return"ie"}else{if(G.indexOf("safari")!=-1){return"safari"}else{if(G.indexOf("gecko")!=-1){return"gecko"}else{return false}}}}}})(),toString:function(){return"Calendar "+this.id},destroy:function(){if(this.beforeDestroyEvent.fire()){var G=this;if(G.navigator){G.navigator.destroy()}if(G.cfg){G.cfg.destroy()}A.purgeElement(G.oDomContainer,true);C.removeClass(G.oDomContainer,G.Style.CSS_WITH_TITLE);C.removeClass(G.oDomContainer,G.Style.CSS_CONTAINER);C.removeClass(G.oDomContainer,G.Style.CSS_SINGLE);G.oDomContainer.innerHTML="";G.oDomContainer=null;G.cells=null;this.destroyEvent.fire()}}};YAHOO.widget.Calendar=F;YAHOO.widget.Calendar_Core=YAHOO.widget.Calendar;YAHOO.widget.Cal_Core=YAHOO.widget.Calendar})();(function(){var D=YAHOO.util.Dom,F=YAHOO.widget.DateMath,A=YAHOO.util.Event,E=YAHOO.lang,G=YAHOO.widget.Calendar;function B(J,H,I){if(arguments.length>0){this.init.apply(this,arguments)}}B.DEFAULT_CONFIG=B._DEFAULT_CONFIG=G.DEFAULT_CONFIG;B.DEFAULT_CONFIG.PAGES={key:"pages",value:2};var C=B.DEFAULT_CONFIG;B.prototype={init:function(K,I,J){var H=this._parseArgs(arguments);K=H.id;I=H.container;J=H.config;this.oDomContainer=D.get(I);if(!this.oDomContainer){this.logger.log("Container not found in document.","error")}if(!this.oDomContainer.id){this.oDomContainer.id=D.generateId()}if(!K){K=this.oDomContainer.id+"_t"}this.id=K;this.containerId=this.oDomContainer.id;this.logger=new YAHOO.widget.LogWriter("CalendarGroup "+this.id);this.initEvents();this.initStyles();this.pages=[];D.addClass(this.oDomContainer,B.CSS_CONTAINER);D.addClass(this.oDomContainer,B.CSS_MULTI_UP);this.cfg=new YAHOO.util.Config(this);this.Options={};this.Locale={};this.setupConfig();if(J){this.cfg.applyConfig(J,true)}this.cfg.fireQueue();if(YAHOO.env.ua.opera){this.renderEvent.subscribe(this._fixWidth,this,true);this.showEvent.subscribe(this._fixWidth,this,true)}this.logger.log("Initialized "+this.pages.length+"-page CalendarGroup","info")},setupConfig:function(){var H=this.cfg;H.addProperty(C.PAGES.key,{value:C.PAGES.value,validator:H.checkNumber,handler:this.configPages});H.addProperty(C.YEAR_OFFSET.key,{value:C.YEAR_OFFSET.value,handler:this.delegateConfig,supercedes:C.YEAR_OFFSET.supercedes,suppressEvent:true});H.addProperty(C.TODAY.key,{value:new Date(C.TODAY.value.getTime()),supercedes:C.TODAY.supercedes,handler:this.configToday,suppressEvent:false});H.addProperty(C.PAGEDATE.key,{value:C.PAGEDATE.value||new Date(C.TODAY.value.getTime()),handler:this.configPageDate});H.addProperty(C.SELECTED.key,{value:[],handler:this.configSelected});H.addProperty(C.TITLE.key,{value:C.TITLE.value,handler:this.configTitle});H.addProperty(C.CLOSE.key,{value:C.CLOSE.value,handler:this.configClose});H.addProperty(C.IFRAME.key,{value:C.IFRAME.value,handler:this.configIframe,validator:H.checkBoolean});H.addProperty(C.MINDATE.key,{value:C.MINDATE.value,handler:this.delegateConfig});H.addProperty(C.MAXDATE.key,{value:C.MAXDATE.value,handler:this.delegateConfig});H.addProperty(C.MULTI_SELECT.key,{value:C.MULTI_SELECT.value,handler:this.delegateConfig,validator:H.checkBoolean});H.addProperty(C.START_WEEKDAY.key,{value:C.START_WEEKDAY.value,handler:this.delegateConfig,validator:H.checkNumber});H.addProperty(C.SHOW_WEEKDAYS.key,{value:C.SHOW_WEEKDAYS.value,handler:this.delegateConfig,validator:H.checkBoolean});H.addProperty(C.SHOW_WEEK_HEADER.key,{value:C.SHOW_WEEK_HEADER.value,handler:this.delegateConfig,validator:H.checkBoolean});H.addProperty(C.SHOW_WEEK_FOOTER.key,{value:C.SHOW_WEEK_FOOTER.value,handler:this.delegateConfig,validator:H.checkBoolean});H.addProperty(C.HIDE_BLANK_WEEKS.key,{value:C.HIDE_BLANK_WEEKS.value,handler:this.delegateConfig,validator:H.checkBoolean});H.addProperty(C.NAV_ARROW_LEFT.key,{value:C.NAV_ARROW_LEFT.value,handler:this.delegateConfig});H.addProperty(C.NAV_ARROW_RIGHT.key,{value:C.NAV_ARROW_RIGHT.value,handler:this.delegateConfig});H.addProperty(C.MONTHS_SHORT.key,{value:C.MONTHS_SHORT.value,handler:this.delegateConfig});H.addProperty(C.MONTHS_LONG.key,{value:C.MONTHS_LONG.value,handler:this.delegateConfig});H.addProperty(C.WEEKDAYS_1CHAR.key,{value:C.WEEKDAYS_1CHAR.value,handler:this.delegateConfig});H.addProperty(C.WEEKDAYS_SHORT.key,{value:C.WEEKDAYS_SHORT.value,handler:this.delegateConfig});H.addProperty(C.WEEKDAYS_MEDIUM.key,{value:C.WEEKDAYS_MEDIUM.value,handler:this.delegateConfig});H.addProperty(C.WEEKDAYS_LONG.key,{value:C.WEEKDAYS_LONG.value,handler:this.delegateConfig});H.addProperty(C.LOCALE_MONTHS.key,{value:C.LOCALE_MONTHS.value,handler:this.delegateConfig});H.addProperty(C.LOCALE_WEEKDAYS.key,{value:C.LOCALE_WEEKDAYS.value,handler:this.delegateConfig});H.addProperty(C.DATE_DELIMITER.key,{value:C.DATE_DELIMITER.value,handler:this.delegateConfig});H.addProperty(C.DATE_FIELD_DELIMITER.key,{value:C.DATE_FIELD_DELIMITER.value,handler:this.delegateConfig});H.addProperty(C.DATE_RANGE_DELIMITER.key,{value:C.DATE_RANGE_DELIMITER.value,handler:this.delegateConfig});H.addProperty(C.MY_MONTH_POSITION.key,{value:C.MY_MONTH_POSITION.value,handler:this.delegateConfig,validator:H.checkNumber});H.addProperty(C.MY_YEAR_POSITION.key,{value:C.MY_YEAR_POSITION.value,handler:this.delegateConfig,validator:H.checkNumber});H.addProperty(C.MD_MONTH_POSITION.key,{value:C.MD_MONTH_POSITION.value,handler:this.delegateConfig,validator:H.checkNumber});H.addProperty(C.MD_DAY_POSITION.key,{value:C.MD_DAY_POSITION.value,handler:this.delegateConfig,validator:H.checkNumber});H.addProperty(C.MDY_MONTH_POSITION.key,{value:C.MDY_MONTH_POSITION.value,handler:this.delegateConfig,validator:H.checkNumber});H.addProperty(C.MDY_DAY_POSITION.key,{value:C.MDY_DAY_POSITION.value,handler:this.delegateConfig,validator:H.checkNumber});H.addProperty(C.MDY_YEAR_POSITION.key,{value:C.MDY_YEAR_POSITION.value,handler:this.delegateConfig,validator:H.checkNumber});H.addProperty(C.MY_LABEL_MONTH_POSITION.key,{value:C.MY_LABEL_MONTH_POSITION.value,handler:this.delegateConfig,validator:H.checkNumber});H.addProperty(C.MY_LABEL_YEAR_POSITION.key,{value:C.MY_LABEL_YEAR_POSITION.value,handler:this.delegateConfig,validator:H.checkNumber});H.addProperty(C.MY_LABEL_MONTH_SUFFIX.key,{value:C.MY_LABEL_MONTH_SUFFIX.value,handler:this.delegateConfig});H.addProperty(C.MY_LABEL_YEAR_SUFFIX.key,{value:C.MY_LABEL_YEAR_SUFFIX.value,handler:this.delegateConfig});H.addProperty(C.NAV.key,{value:C.NAV.value,handler:this.configNavigator});H.addProperty(C.STRINGS.key,{value:C.STRINGS.value,handler:this.configStrings,validator:function(I){return E.isObject(I)},supercedes:C.STRINGS.supercedes})},initEvents:function(){var J=this,L="Event",M=YAHOO.util.CustomEvent;var I=function(O,R,N){for(var Q=0;Q<J.pages.length;++Q){var P=J.pages[Q];P[this.type+L].subscribe(O,R,N)}};var H=function(N,Q){for(var P=0;P<J.pages.length;++P){var O=J.pages[P];O[this.type+L].unsubscribe(N,Q)}};var K=G._EVENT_TYPES;J.beforeSelectEvent=new M(K.BEFORE_SELECT);J.beforeSelectEvent.subscribe=I;J.beforeSelectEvent.unsubscribe=H;J.selectEvent=new M(K.SELECT);J.selectEvent.subscribe=I;J.selectEvent.unsubscribe=H;J.beforeDeselectEvent=new M(K.BEFORE_DESELECT);J.beforeDeselectEvent.subscribe=I;J.beforeDeselectEvent.unsubscribe=H;J.deselectEvent=new M(K.DESELECT);J.deselectEvent.subscribe=I;J.deselectEvent.unsubscribe=H;J.changePageEvent=new M(K.CHANGE_PAGE);J.changePageEvent.subscribe=I;J.changePageEvent.unsubscribe=H;J.beforeRenderEvent=new M(K.BEFORE_RENDER);J.beforeRenderEvent.subscribe=I;J.beforeRenderEvent.unsubscribe=H;J.renderEvent=new M(K.RENDER);J.renderEvent.subscribe=I;J.renderEvent.unsubscribe=H;J.resetEvent=new M(K.RESET);J.resetEvent.subscribe=I;J.resetEvent.unsubscribe=H;J.clearEvent=new M(K.CLEAR);J.clearEvent.subscribe=I;J.clearEvent.unsubscribe=H;J.beforeShowEvent=new M(K.BEFORE_SHOW);J.showEvent=new M(K.SHOW);J.beforeHideEvent=new M(K.BEFORE_HIDE);J.hideEvent=new M(K.HIDE);J.beforeShowNavEvent=new M(K.BEFORE_SHOW_NAV);J.showNavEvent=new M(K.SHOW_NAV);J.beforeHideNavEvent=new M(K.BEFORE_HIDE_NAV);J.hideNavEvent=new M(K.HIDE_NAV);J.beforeRenderNavEvent=new M(K.BEFORE_RENDER_NAV);J.renderNavEvent=new M(K.RENDER_NAV);J.beforeDestroyEvent=new M(K.BEFORE_DESTROY);J.destroyEvent=new M(K.DESTROY)},configPages:function(T,R,N){var L=R[0],J=C.PAGEDATE.key,W="_",M,O=null,S="groupcal",V="first-of-type",K="last-of-type";for(var I=0;I<L;++I){var U=this.id+W+I,Q=this.containerId+W+I,P=this.cfg.getConfig();P.close=false;P.title=false;P.navigator=null;if(I>0){M=new Date(O);this._setMonthOnDate(M,M.getMonth()+I);P.pageDate=M}var H=this.constructChild(U,Q,P);D.removeClass(H.oDomContainer,this.Style.CSS_SINGLE);D.addClass(H.oDomContainer,S);if(I===0){O=H.cfg.getProperty(J);D.addClass(H.oDomContainer,V)}if(I==(L-1)){D.addClass(H.oDomContainer,K)}H.parent=this;H.index=I;this.pages[this.pages.length]=H}},configPageDate:function(O,N,L){var J=N[0],M;var K=C.PAGEDATE.key;for(var I=0;I<this.pages.length;++I){var H=this.pages[I];if(I===0){M=H._parsePageDate(J);H.cfg.setProperty(K,M)}else{var P=new Date(M);this._setMonthOnDate(P,P.getMonth()+I);H.cfg.setProperty(K,P)}}},configSelected:function(J,H,L){var K=C.SELECTED.key;this.delegateConfig(J,H,L);var I=(this.pages.length>0)?this.pages[0].cfg.getProperty(K):[];this.cfg.setProperty(K,I,true)},delegateConfig:function(I,H,L){var M=H[0];var K;for(var J=0;J<this.pages.length;J++){K=this.pages[J];K.cfg.setProperty(I,M)}},setChildFunction:function(K,I){var H=this.cfg.getProperty(C.PAGES.key);for(var J=0;J<H;++J){this.pages[J][K]=I}},callChildFunction:function(M,I){var H=this.cfg.getProperty(C.PAGES.key);for(var L=0;L<H;++L){var K=this.pages[L];if(K[M]){var J=K[M];J.call(K,I)}}},constructChild:function(K,I,J){var H=document.getElementById(I);if(!H){H=document.createElement("div");H.id=I;this.oDomContainer.appendChild(H)}return new G(K,I,J)},setMonth:function(L){L=parseInt(L,10);var M;var I=C.PAGEDATE.key;for(var K=0;K<this.pages.length;++K){var J=this.pages[K];var H=J.cfg.getProperty(I);if(K===0){M=H.getFullYear()}else{H.setFullYear(M)}this._setMonthOnDate(H,L+K);J.cfg.setProperty(I,H)}},setYear:function(J){var I=C.PAGEDATE.key;J=parseInt(J,10);for(var L=0;L<this.pages.length;++L){var K=this.pages[L];var H=K.cfg.getProperty(I);if((H.getMonth()+1)==1&&L>0){J+=1}K.setYear(J)}},render:function(){this.renderHeader();for(var I=0;I<this.pages.length;++I){var H=this.pages[I];H.render()}this.renderFooter()},select:function(H){for(var J=0;J<this.pages.length;++J){var I=this.pages[J];I.select(H)}return this.getSelectedDates()},selectCell:function(H){for(var J=0;J<this.pages.length;++J){var I=this.pages[J];I.selectCell(H)}return this.getSelectedDates()},deselect:function(H){for(var J=0;J<this.pages.length;++J){var I=this.pages[J];I.deselect(H)}return this.getSelectedDates()},deselectAll:function(){for(var I=0;I<this.pages.length;++I){var H=this.pages[I];H.deselectAll()}return this.getSelectedDates()},deselectCell:function(H){for(var J=0;J<this.pages.length;++J){var I=this.pages[J];I.deselectCell(H)}return this.getSelectedDates()},reset:function(){for(var I=0;I<this.pages.length;++I){var H=this.pages[I];H.reset()}},clear:function(){for(var I=0;I<this.pages.length;++I){var H=this.pages[I];H.clear()}this.cfg.setProperty(C.SELECTED.key,[]);this.cfg.setProperty(C.PAGEDATE.key,new Date(this.pages[0].today.getTime()));this.render()},nextMonth:function(){for(var I=0;I<this.pages.length;++I){var H=this.pages[I];H.nextMonth()}},previousMonth:function(){for(var I=this.pages.length-1;I>=0;--I){var H=this.pages[I];H.previousMonth()}},nextYear:function(){for(var I=0;I<this.pages.length;++I){var H=this.pages[I];H.nextYear()}},previousYear:function(){for(var I=0;I<this.pages.length;++I){var H=this.pages[I];H.previousYear()}},getSelectedDates:function(){var J=[];var I=this.cfg.getProperty(C.SELECTED.key);for(var L=0;L<I.length;++L){var K=I[L];var H=F.getDate(K[0],K[1]-1,K[2]);J.push(H)}J.sort(function(N,M){return N-M});return J},addRenderer:function(H,I){for(var K=0;K<this.pages.length;++K){var J=this.pages[K];J.addRenderer(H,I)}},addMonthRenderer:function(K,H){for(var J=0;J<this.pages.length;++J){var I=this.pages[J];I.addMonthRenderer(K,H)}},addWeekdayRenderer:function(I,H){for(var K=0;K<this.pages.length;++K){var J=this.pages[K];J.addWeekdayRenderer(I,H)}},removeRenderers:function(){this.callChildFunction("removeRenderers")},renderHeader:function(){},renderFooter:function(){},addMonths:function(H){this.callChildFunction("addMonths",H)},subtractMonths:function(H){this.callChildFunction("subtractMonths",H)},addYears:function(H){this.callChildFunction("addYears",H)},subtractYears:function(H){this.callChildFunction("subtractYears",H)},getCalendarPage:function(K){var M=null;if(K){var N=K.getFullYear(),J=K.getMonth();var I=this.pages;for(var L=0;L<I.length;++L){var H=I[L].cfg.getProperty("pagedate");if(H.getFullYear()===N&&H.getMonth()===J){M=I[L];break}}}return M},_setMonthOnDate:function(I,J){if(YAHOO.env.ua.webkit&&YAHOO.env.ua.webkit<420&&(J<0||J>11)){var H=F.add(I,F.MONTH,J-I.getMonth());I.setTime(H.getTime())}else{I.setMonth(J)}},_fixWidth:function(){var H=0;for(var J=0;J<this.pages.length;++J){var I=this.pages[J];H+=I.oDomContainer.offsetWidth}if(H>0){this.oDomContainer.style.width=H+"px"}},toString:function(){return"CalendarGroup "+this.id},destroy:function(){if(this.beforeDestroyEvent.fire()){var J=this;if(J.navigator){J.navigator.destroy()}if(J.cfg){J.cfg.destroy()}A.purgeElement(J.oDomContainer,true);D.removeClass(J.oDomContainer,B.CSS_CONTAINER);D.removeClass(J.oDomContainer,B.CSS_MULTI_UP);for(var I=0,H=J.pages.length;I<H;I++){J.pages[I].destroy();J.pages[I]=null}J.oDomContainer.innerHTML="";J.oDomContainer=null;this.destroyEvent.fire()}}};B.CSS_CONTAINER="yui-calcontainer";B.CSS_MULTI_UP="multi";B.CSS_2UPTITLE="title";B.CSS_2UPCLOSE="close-icon";YAHOO.lang.augmentProto(B,G,"buildDayLabel","buildMonthLabel","renderOutOfBoundsDate","renderRowHeader","renderRowFooter","renderCellDefault","styleCellDefault","renderCellStyleHighlight1","renderCellStyleHighlight2","renderCellStyleHighlight3","renderCellStyleHighlight4","renderCellStyleToday","renderCellStyleSelected","renderCellNotThisMonth","renderBodyCellRestricted","initStyles","configTitle","configClose","configIframe","configStrings","configToday","configNavigator","createTitleBar","createCloseButton","removeTitleBar","removeCloseButton","hide","show","toDate","_toDate","_parseArgs","browser");YAHOO.widget.CalGrp=B;YAHOO.widget.CalendarGroup=B;YAHOO.widget.Calendar2up=function(J,H,I){this.init(J,H,I)};YAHOO.extend(YAHOO.widget.Calendar2up,B);YAHOO.widget.Cal2up=YAHOO.widget.Calendar2up})();YAHOO.widget.CalendarNavigator=function(A){this.init(A)};(function(){var A=YAHOO.widget.CalendarNavigator;A.CLASSES={NAV:"yui-cal-nav",NAV_VISIBLE:"yui-cal-nav-visible",MASK:"yui-cal-nav-mask",YEAR:"yui-cal-nav-y",MONTH:"yui-cal-nav-m",BUTTONS:"yui-cal-nav-b",BUTTON:"yui-cal-nav-btn",ERROR:"yui-cal-nav-e",YEAR_CTRL:"yui-cal-nav-yc",MONTH_CTRL:"yui-cal-nav-mc",INVALID:"yui-invalid",DEFAULT:"yui-default"};A.DEFAULT_CONFIG={strings:{month:"Month",year:"Year",submit:"Okay",cancel:"Cancel",invalidYear:"Year needs to be a number"},monthFormat:YAHOO.widget.Calendar.LONG,initialFocus:"year"};A._DEFAULT_CFG=A.DEFAULT_CONFIG;A.ID_SUFFIX="_nav";A.MONTH_SUFFIX="_month";A.YEAR_SUFFIX="_year";A.ERROR_SUFFIX="_error";A.CANCEL_SUFFIX="_cancel";A.SUBMIT_SUFFIX="_submit";A.YR_MAX_DIGITS=4;A.YR_MINOR_INC=1;A.YR_MAJOR_INC=10;A.UPDATE_DELAY=50;A.YR_PATTERN=/^\d+$/;A.TRIM=/^\s*(.*?)\s*$/})();YAHOO.widget.CalendarNavigator.prototype={id:null,cal:null,navEl:null,maskEl:null,yearEl:null,monthEl:null,errorEl:null,submitEl:null,cancelEl:null,firstCtrl:null,lastCtrl:null,_doc:null,_year:null,_month:0,__rendered:false,init:function(A){var C=A.oDomContainer;this.cal=A;this.id=C.id+YAHOO.widget.CalendarNavigator.ID_SUFFIX;this._doc=C.ownerDocument;var B=YAHOO.env.ua.ie;this.__isIEQuirks=(B&&((B<=6)||(this._doc.compatMode=="BackCompat")))},show:function(){var A=YAHOO.widget.CalendarNavigator.CLASSES;if(this.cal.beforeShowNavEvent.fire()){if(!this.__rendered){this.render()}this.clearErrors();this._updateMonthUI();this._updateYearUI();this._show(this.navEl,true);this.setInitialFocus();this.showMask();YAHOO.util.Dom.addClass(this.cal.oDomContainer,A.NAV_VISIBLE);this.cal.showNavEvent.fire()}},hide:function(){var A=YAHOO.widget.CalendarNavigator.CLASSES;if(this.cal.beforeHideNavEvent.fire()){this._show(this.navEl,false);this.hideMask();YAHOO.util.Dom.removeClass(this.cal.oDomContainer,A.NAV_VISIBLE);this.cal.hideNavEvent.fire()}},showMask:function(){this._show(this.maskEl,true);if(this.__isIEQuirks){this._syncMask()}},hideMask:function(){this._show(this.maskEl,false)},getMonth:function(){return this._month},getYear:function(){return this._year},setMonth:function(A){if(A>=0&&A<12){this._month=A}this._updateMonthUI()},setYear:function(B){var A=YAHOO.widget.CalendarNavigator.YR_PATTERN;if(YAHOO.lang.isNumber(B)&&A.test(B+"")){this._year=B}this._updateYearUI()},render:function(){this.cal.beforeRenderNavEvent.fire();if(!this.__rendered){this.createNav();this.createMask();this.applyListeners();this.__rendered=true}this.cal.renderNavEvent.fire()},createNav:function(){var B=YAHOO.widget.CalendarNavigator;var C=this._doc;var D=C.createElement("div");D.className=B.CLASSES.NAV;var A=this.renderNavContents([]);D.innerHTML=A.join("");this.cal.oDomContainer.appendChild(D);this.navEl=D;this.yearEl=C.getElementById(this.id+B.YEAR_SUFFIX);this.monthEl=C.getElementById(this.id+B.MONTH_SUFFIX);this.errorEl=C.getElementById(this.id+B.ERROR_SUFFIX);this.submitEl=C.getElementById(this.id+B.SUBMIT_SUFFIX);this.cancelEl=C.getElementById(this.id+B.CANCEL_SUFFIX);if(YAHOO.env.ua.gecko&&this.yearEl&&this.yearEl.type=="text"){this.yearEl.setAttribute("autocomplete","off")}this._setFirstLastElements()},createMask:function(){var B=YAHOO.widget.CalendarNavigator.CLASSES;var A=this._doc.createElement("div");A.className=B.MASK;this.cal.oDomContainer.appendChild(A);this.maskEl=A},_syncMask:function(){var B=this.cal.oDomContainer;if(B&&this.maskEl){var A=YAHOO.util.Dom.getRegion(B);YAHOO.util.Dom.setStyle(this.maskEl,"width",A.right-A.left+"px");YAHOO.util.Dom.setStyle(this.maskEl,"height",A.bottom-A.top+"px")}},renderNavContents:function(A){var D=YAHOO.widget.CalendarNavigator,E=D.CLASSES,B=A;B[B.length]='<div class="'+E.MONTH+'">';this.renderMonth(B);B[B.length]="</div>";B[B.length]='<div class="'+E.YEAR+'">';this.renderYear(B);B[B.length]="</div>";B[B.length]='<div class="'+E.BUTTONS+'">';this.renderButtons(B);B[B.length]="</div>";B[B.length]='<div class="'+E.ERROR+'" id="'+this.id+D.ERROR_SUFFIX+'"></div>';return B},renderMonth:function(D){var G=YAHOO.widget.CalendarNavigator,H=G.CLASSES;var I=this.id+G.MONTH_SUFFIX,F=this.__getCfg("monthFormat"),A=this.cal.cfg.getProperty((F==YAHOO.widget.Calendar.SHORT)?"MONTHS_SHORT":"MONTHS_LONG"),E=D;if(A&&A.length>0){E[E.length]='<label for="'+I+'">';E[E.length]=this.__getCfg("month",true);E[E.length]="</label>";E[E.length]='<select name="'+I+'" id="'+I+'" class="'+H.MONTH_CTRL+'">';for(var B=0;B<A.length;B++){E[E.length]='<option value="'+B+'">';E[E.length]=A[B];E[E.length]="</option>"}E[E.length]="</select>"}return E},renderYear:function(B){var E=YAHOO.widget.CalendarNavigator,F=E.CLASSES;var G=this.id+E.YEAR_SUFFIX,A=E.YR_MAX_DIGITS,D=B;D[D.length]='<label for="'+G+'">';D[D.length]=this.__getCfg("year",true);D[D.length]="</label>";D[D.length]='<input type="text" name="'+G+'" id="'+G+'" class="'+F.YEAR_CTRL+'" maxlength="'+A+'"/>';return D},renderButtons:function(A){var D=YAHOO.widget.CalendarNavigator.CLASSES;var B=A;B[B.length]='<span class="'+D.BUTTON+" "+D.DEFAULT+'">';B[B.length]='<button type="button" id="'+this.id+'_submit">';B[B.length]=this.__getCfg("submit",true);B[B.length]="</button>";B[B.length]="</span>";B[B.length]='<span class="'+D.BUTTON+'">';B[B.length]='<button type="button" id="'+this.id+'_cancel">';B[B.length]=this.__getCfg("cancel",true);B[B.length]="</button>";B[B.length]="</span>";return B},applyListeners:function(){var B=YAHOO.util.Event;function A(){if(this.validate()){this.setYear(this._getYearFromUI())}}function C(){this.setMonth(this._getMonthFromUI())}B.on(this.submitEl,"click",this.submit,this,true);B.on(this.cancelEl,"click",this.cancel,this,true);B.on(this.yearEl,"blur",A,this,true);B.on(this.monthEl,"change",C,this,true);if(this.__isIEQuirks){YAHOO.util.Event.on(this.cal.oDomContainer,"resize",this._syncMask,this,true)}this.applyKeyListeners()},purgeListeners:function(){var A=YAHOO.util.Event;A.removeListener(this.submitEl,"click",this.submit);A.removeListener(this.cancelEl,"click",this.cancel);A.removeListener(this.yearEl,"blur");A.removeListener(this.monthEl,"change");if(this.__isIEQuirks){A.removeListener(this.cal.oDomContainer,"resize",this._syncMask)}this.purgeKeyListeners()},applyKeyListeners:function(){var D=YAHOO.util.Event,A=YAHOO.env.ua;var C=(A.ie||A.webkit)?"keydown":"keypress";var B=(A.ie||A.opera||A.webkit)?"keydown":"keypress";D.on(this.yearEl,"keypress",this._handleEnterKey,this,true);D.on(this.yearEl,C,this._handleDirectionKeys,this,true);D.on(this.lastCtrl,B,this._handleTabKey,this,true);D.on(this.firstCtrl,B,this._handleShiftTabKey,this,true)},purgeKeyListeners:function(){var D=YAHOO.util.Event,A=YAHOO.env.ua;var C=(A.ie||A.webkit)?"keydown":"keypress";var B=(A.ie||A.opera||A.webkit)?"keydown":"keypress";D.removeListener(this.yearEl,"keypress",this._handleEnterKey);D.removeListener(this.yearEl,C,this._handleDirectionKeys);D.removeListener(this.lastCtrl,B,this._handleTabKey);D.removeListener(this.firstCtrl,B,this._handleShiftTabKey)},submit:function(){if(this.validate()){this.hide();this.setMonth(this._getMonthFromUI());this.setYear(this._getYearFromUI());var B=this.cal;var A=YAHOO.widget.CalendarNavigator.UPDATE_DELAY;if(A>0){var C=this;window.setTimeout(function(){C._update(B)},A)}else{this._update(B)}}},_update:function(B){var A=YAHOO.widget.DateMath.getDate(this.getYear()-B.cfg.getProperty("YEAR_OFFSET"),this.getMonth(),1);B.cfg.setProperty("pagedate",A);B.render()},cancel:function(){this.hide()},validate:function(){if(this._getYearFromUI()!==null){this.clearErrors();return true}else{this.setYearError();this.setError(this.__getCfg("invalidYear",true));return false}},setError:function(A){if(this.errorEl){this.errorEl.innerHTML=A;this._show(this.errorEl,true)}},clearError:function(){if(this.errorEl){this.errorEl.innerHTML="";this._show(this.errorEl,false)}},setYearError:function(){YAHOO.util.Dom.addClass(this.yearEl,YAHOO.widget.CalendarNavigator.CLASSES.INVALID)},clearYearError:function(){YAHOO.util.Dom.removeClass(this.yearEl,YAHOO.widget.CalendarNavigator.CLASSES.INVALID)},clearErrors:function(){this.clearError();this.clearYearError()},setInitialFocus:function(){var A=this.submitEl,C=this.__getCfg("initialFocus");if(C&&C.toLowerCase){C=C.toLowerCase();if(C=="year"){A=this.yearEl;try{this.yearEl.select()}catch(B){}}else{if(C=="month"){A=this.monthEl}}}if(A&&YAHOO.lang.isFunction(A.focus)){try{A.focus()}catch(D){}}},erase:function(){if(this.__rendered){this.purgeListeners();this.yearEl=null;this.monthEl=null;this.errorEl=null;this.submitEl=null;this.cancelEl=null;this.firstCtrl=null;this.lastCtrl=null;if(this.navEl){this.navEl.innerHTML=""}var B=this.navEl.parentNode;if(B){B.removeChild(this.navEl)}this.navEl=null;var A=this.maskEl.parentNode;if(A){A.removeChild(this.maskEl)}this.maskEl=null;this.__rendered=false}},destroy:function(){this.erase();this._doc=null;this.cal=null;this.id=null},_show:function(B,A){if(B){YAHOO.util.Dom.setStyle(B,"display",(A)?"block":"none")}},_getMonthFromUI:function(){if(this.monthEl){return this.monthEl.selectedIndex}else{return 0}},_getYearFromUI:function(){var B=YAHOO.widget.CalendarNavigator;var A=null;if(this.yearEl){var C=this.yearEl.value;C=C.replace(B.TRIM,"$1");if(B.YR_PATTERN.test(C)){A=parseInt(C,10)}}return A},_updateYearUI:function(){if(this.yearEl&&this._year!==null){this.yearEl.value=this._year}},_updateMonthUI:function(){if(this.monthEl){this.monthEl.selectedIndex=this._month}},_setFirstLastElements:function(){this.firstCtrl=this.monthEl;this.lastCtrl=this.cancelEl;if(this.__isMac){if(YAHOO.env.ua.webkit&&YAHOO.env.ua.webkit<420){this.firstCtrl=this.monthEl;this.lastCtrl=this.yearEl}if(YAHOO.env.ua.gecko){this.firstCtrl=this.yearEl;this.lastCtrl=this.yearEl}}},_handleEnterKey:function(B){var A=YAHOO.util.KeyListener.KEY;if(YAHOO.util.Event.getCharCode(B)==A.ENTER){YAHOO.util.Event.preventDefault(B);this.submit()}},_handleDirectionKeys:function(H){var G=YAHOO.util.Event,A=YAHOO.util.KeyListener.KEY,D=YAHOO.widget.CalendarNavigator;var F=(this.yearEl.value)?parseInt(this.yearEl.value,10):null;if(isFinite(F)){var B=false;switch(G.getCharCode(H)){case A.UP:this.yearEl.value=F+D.YR_MINOR_INC;B=true;break;case A.DOWN:this.yearEl.value=Math.max(F-D.YR_MINOR_INC,0);B=true;break;case A.PAGE_UP:this.yearEl.value=F+D.YR_MAJOR_INC;B=true;break;case A.PAGE_DOWN:this.yearEl.value=Math.max(F-D.YR_MAJOR_INC,0);B=true;break;default:break}if(B){G.preventDefault(H);try{this.yearEl.select()}catch(C){}}}},_handleTabKey:function(D){var C=YAHOO.util.Event,A=YAHOO.util.KeyListener.KEY;if(C.getCharCode(D)==A.TAB&&!D.shiftKey){try{C.preventDefault(D);this.firstCtrl.focus()}catch(B){}}},_handleShiftTabKey:function(D){var C=YAHOO.util.Event,A=YAHOO.util.KeyListener.KEY;if(D.shiftKey&&C.getCharCode(D)==A.TAB){try{C.preventDefault(D);this.lastCtrl.focus()}catch(B){}}},__getCfg:function(D,B){var C=YAHOO.widget.CalendarNavigator.DEFAULT_CONFIG;var A=this.cal.cfg.getProperty("navigator");if(B){return(A!==true&&A.strings&&A.strings[D])?A.strings[D]:C.strings[D]}else{return(A!==true&&A[D])?A[D]:C[D]}},__isMac:(navigator.userAgent.toLowerCase().indexOf("macintosh")!=-1)};YAHOO.register("calendar",YAHOO.widget.Calendar,{version:"2.8.0r4",build:"2449"});YUI.add("wl-calendar",function(C){var D={};var O=[];var H=[];var K={};var E=sabre.config.global.currentTimeInMillis;C.wlCalendar={reset:function(){O=[]},setFlightDates:function(R,S){O=[];var T=R.previous();var Q=T?C.DataType.Date.parse(T.get("value")):new Date(E);if(!Q){Q=new Date()}H[S]=H[S]||{};H[S].date=Q;H[S].textInput=R;H[S].hiddenInput=R.previous();H[S].calendar=null},loadCalendar:function(R,T,S){K.dateFormat=S.dateFormat;K.showCalendar=S.show;K.onSelectCallback=S.onSelectCallback||function(){};var Q=R.get("id");R=C.one("#"+Q);var U=F(Q);if(!D[Q]){D[Q]=L(Q);T.registerContainer(D[Q]);D[Q].hideEvent.subscribe(function(){C.wlValidation.validate(null,R.previous());var W=C.one(O[U].oDomContainer);W.removeClass("calendar-container");W.addClass("hidden")})}I(Q);var V=C.one(D[Q].body);V.addClass("loadingContainer");D[Q].show();C.later(5,C,function(){C.use("yui2-calendar",function(Z){if(!Z.Lang.isValue(O[U])){O[U]=new YAHOO.widget.CalendarGroup("calendar-"+Q,{iframe:false});O[U].selectEvent.subscribe(function(i,Y,j){B(j,D[Q],Q,K.dateFormat,T);K.onSelectCallback()},O[U],true);O[U].renderEvent.subscribe(function(){Z.one(O[U].oDomContainer).removeClass("hidden");D[Q].fireEvent("changeContent")});H[U].calendar=O[U]}var f=new Date(E);var e=O[U]&&O[U].getSelectedDates()[0];var d=YAHOO.widget.DateMath;if(document.getElementById("formattedOutboundDepartureDate")&&document.getElementById("formattedOutboundDepartureDate").value){var W=Z.DataType.Date.parse(document.getElementById("formattedOutboundDepartureDate").value)}else{var a=H[U-1];var W=a?Z.DataType.Date.parse(a.hiddenInput.get("value"))||f:f}var g=d.add(f,d.DAY,365);var c=Z.one("#date"+(U+1));if(c&&c.get("disabled")){var h=Z.one("#date_hidden"+(U+1));if(h){g=Z.DataType.Date.parse(h.get("value"))}}var X=e||W;var b=O[U].cfg;b.setProperty("locale_weekdays","medium");b.setProperty("mindate",W);b.setProperty("maxdate",g);b.setProperty("pagedate",X);b.setProperty("start_weekday",sabre.config.satConfiguration.calendarStartDay);if(T.getTripType()==="oneway"){O[U].removeRenderers()}else{G(O,U)}J(O[U]);O[U].render();Z.on("keyup",function(Y){if(Y.charCode===27){D[Q].hide()}});V.addClass("calendar-container");V.removeClass("loadingContainer");I(Q)})})}};function L(R){var Q=new YAHOO.widget.Panel("container-"+R,{visible:false,draggable:false,zIndex:520,close:true});Q.showEvent.subscribe(function(){Q.fireEvent("changeContent")});Q.setBody('<div class="calendar-container" id="calendar-'+R+'"></div>');Q.render(document.body);return Q}function B(a,b,Q,d,c){var S=C.one("#"+Q);var j=S.previous();var V;var W;if(a.getSelectedDates().length>0){var R=a.getSelectedDates()[0];var f=R.getDate();var l=R.getMonth();var Y=R.getFullYear();V=C.DataType.Date.format(R,{format:d});W=M(Y,l,f);var k=(l+1)+"/"+f+"/"+Y;var g,X,Z,e;var U=F(Q);for(g=U+1;g<H.length;g++){e=H[g];var T=e.calendar&&e.calendar.getSelectedDates()[0]||e.date;if(R>T){e.calendar&&e.calendar.select(k);e.date=R;X=H[g].textInput;if(X){X.set("value",V);Z=e.hiddenInput;Z.set("value",W)}}}for(g=U-1;g>-1;g--){e=H[g];var h=e.calendar&&e.calendar.getSelectedDates()[0]||e.date;if(R<h){e.calendar&&e.calendar.select(k);e.date=R;X=e.textInput;if(X){X.set("value",V);Z=e.hiddenInput;Z.set("value",W)}}}}else{V="";W=0}S.set("value",V);j.set("value",W);b.hide();if(c.persistInputState){c.persistInputState(Q,W);c.persistInputState("textForField"+Q,V)}}function M(R,S,Q){return C.DataType.Date.format(new Date(R,S,Q),{format:sabre.config.dateInputFormat})}function F(R){var S=new RegExp("^[a-z_\\-]+(\\d+)$","i");var Q=R.match(S);return Q?C.DataType.Number.parse(Q[1]):null}function G(T,U){var W=T[U];var V;var Q;for(var R=0;R<T.length;R++){var S=T[R]&&T[R].getSelectedDates()[0]||H[R].date;if(S){if(!V&&!Q){V=S;Q=S}if(S<V){V=S}if(S>Q){Q=S}}}V=V||new Date(E);Q=Q||new Date(E);W.removeRenderers();W.addRenderer(A(W,V,Q),W.renderCellStyleHighlight1)}function A(T,Q,R){var S=T.cfg.getProperty(YAHOO.widget.CalendarGroup._DEFAULT_CONFIG.DATE_RANGE_DELIMITER.key);return(N(T,Q)+S+N(T,R))}function N(U,T){var R=YAHOO.widget.CalendarGroup._DEFAULT_CONFIG;var Q=[];Q[U.cfg.getProperty(R.MDY_MONTH_POSITION.key)-1]=(T.getMonth()+1);Q[U.cfg.getProperty(R.MDY_DAY_POSITION.key)-1]=T.getDate();Q[U.cfg.getProperty(R.MDY_YEAR_POSITION.key)-1]=T.getFullYear();var S=U.cfg.getProperty(R.DATE_FIELD_DELIMITER.key);return Q.join(S)}function J(S){var T=C.config.locale;if(C.DataType.Date.Locale){var R=C.DataType.Date.Locale[T];P(R,S)}else{var Q=T.replace("_","-");C.use("lang/datatype-date-format_"+Q,function(V){V.Intl.setLang("datatype-date-format",Q);var U=V.Intl.get("datatype-date-format");P(U,S)})}}function P(Q,T){if(Q){var R={b:"MONTHS_SHORT",B:"MONTHS_LONG",a:"WEEKDAYS_MEDIUM",A:"WEEKDAYS_LONG"};for(var S in R){if(R.hasOwnProperty(S)){T.cfg.setProperty(R[S],Q[S])}}T.render()}}function I(R){var S=C.isCurrentLanguageRtl();var T=S?"br":"bl";var Q=S?"tr":"tl";D[R].cfg.setProperty("context",[R,Q,T,["beforeShow","windowResize"]])}},"1.0.0",{requires:[]});YUI.add("wl-airport-finder",function(A){A.wlAirportFinder=function(j,V,W){var h;var E;var G={};var I="";var g="";var S=[];var K=[];var i={};W=W||{};var n=W.cityListFormat||"%airport (%code)";var m=W.defaultOriginLabel||"";var H=W.defaultDestinationLabel||"";var a=W.maxRowCount||16;var Z='<div class="table-container"><table><tbody><tr class="ondhead"><td id="originInfoErrorMessage" class="translate" wl:translate="label.fsc.noOriginMatch"></td></tr><tr class="foot"><td colspan="5"></td></tr></tbody></table></div>';var O=false;return{showAirportList:N,createAirportList:B,updateAirportInputTranslation:Y,formatCityList:P,setRbeBooking:L};function L(o){O=o}function N(r,q,p,o){A.use("wl-routes",function(s){b(r,q,p,o)})}function M(p,r){var q=A.isCurrentLanguageRtl();var s=q?"br":"bl";var o=q?"tr":"tl";p.cfg.setProperty("context",[r.get("id"),o,s,["beforeShow","windowResize"]])}function b(x,z,o,AD){var AE;var AA;var AB;var y;var u;B(z);var t=z.hasClass("origin_airport");var s=z.get("id");var v=z.previous();if(!v){A.log("Cannot show airport finder - unable to find connected input control","warn");return }if(t){AA=v.get("id");y=s;AB=AA.replace("origin","destination");u=y.replace("origin","destination");h=AE=G[y];E=G[u]}else{AB=v.get("id");u=s;AA=AB.replace("destination","origin");y=u.replace("destination","origin");E=AE=G[u];h=G[y]}var AC=x&&x.type==="keyup"?x.charCode:null;var r=AE.cfg.getProperty("visible");if(AC===27||AC===13){AE.hide();if(t){K=R(null,A.one(E.body),AB,AA,o);if(!e(AB)){A.one("#"+AB).next().fire("originChosen")}var w=AB[AB.length-1];d(w)}}else{if(!r||AC!==null){var q=[9,13];AC=!AC||A.Array.indexOf(q,AC)!==-1?null:AC;var p=A.one(AE.body);p.addClass("loadingContainer");AE.cfg.setProperty("visible",true);M(AE,z);i=A.routes||[];p.removeClass("loadingContainer");if(t){S=l(AC,p,AA,AD)}else{K=R(AC,p,AB,AA,o)}AE.fireEvent("changeContent");if(AC===null){J(s);z.select()}if(t){A.on("click",function(){K=R(null,A.one(E.body),AB,AA,o);if(!e(AB)){U(AB)}},A.one(h.element).one("a.container-close"))}}}M(AE,z)}function J(o){U(o,F(o))}function P(u){var p=A.airports[u]||{};var q=p.code||u;var t=p.city||q;var s=A.translateParametrized("Airport."+q);var w=A.translateParametrized("AirportShort."+q);var v=A.translateParametrized("City."+t);var o=A.translateParametrized("StateProvince."+p.stateProvince);var r=A.translateParametrized("Country."+p.country);return A.formatText(n,{code:q,airport:s||"",airportShort:w||"",cityCode:t||"",city:v||"",stateProvince:o||"",country:r||""})}function e(o){return !!F(o).length}function F(v){var s=A.one("#"+v);var r=A.Lang.trim(s.get("value"));if(r.length>0){var q=s.hasClass("origin_airport")?S:K;for(var p=0;p<q.length;p++){var u=q[p][0];var t=P(u);if(t===r){return[t,u]}var o=new RegExp(r,"i");if(t.search(o)>-1){return[t,u]}}}return[]}function X(o,p,q){p=p||"";q=q||"";o.previous().set("value",q);o.previous().set("wl:value",q);o.set("wl:value","");o.set("value",p)}function U(t,p){var o=A.one("#"+t);if(p&&p.length===2){X(o,p[0],p[1])}else{var s=o.hasClass("origin_airport");var r=A.getCurrentTranslations();var q=s?r[m]:r[H];X(o,q)}}function T(r,u,s,w,v){var p=null;var q=u.get("id");var t={visible:false,draggable:false,zIndex:520,close:true};var o=new YAHOO.widget.Panel(r,t);var x;o.setBody("");o.renderEvent.subscribe(function(){x=A.one("#"+r);x.setStyles({display:"none"});A.delegate("click",function(AB){var AA=AB.target;u=A.one("#"+q);u.set("value",AA.get("innerHTML"));var y=u.previous();y.set("value",AA.get("rel"));if(s){K=R(null,A.one(E.body),w,v,p);if(!e(w)){A.one("#"+w).next().fire("originChosen")}var z=q.charAt(q.length-1);d(z)}o.hide();AB.preventDefault()},o.element,"span")});o.render(document.body);o.cfg.setProperty("context",[q,"tl","bl",["beforeShow","windowResize"]]);o.hideEvent.subscribe(function(){u=A.one("#"+q);J(q);if(V.persistInputState){V.persistInputState(q,u.previous().get("value"))}if(V.getTripType()==="roundtrip"){C(W.airportInputsIds,q,u.previous().get("value"))}A.fire("fsc:inputChanged");A.wlValidation.validate(null,u.previous());x.setStyles({display:"none"});if(o.handle){o.handle.detach();o.handle=null}});o.showEvent.subscribe(function(){x.setStyles({display:"block"});o.focus();A.Lang.later(10,null,function(){if(!o.handle){o.handle=A.on("click",function(z){var y=z.target;if(!y.inRegion(o.element,true)){o.hide()}},document)}})});V.registerContainer(o);return o}function d(p){var o=A.one("#destination_airport"+p);o.simulate("click")}function B(q){var o=q.get("id");var s;var r;var t=q.hasClass("origin_airport");if(t){s=q.previous().get("id");r=s.replace("origin","destination")}else{r=q.previous().get("id");s=r.replace("destination","origin")}if(!G[o]){var p=o+"-cont";G[o]=T(p,q,t,r,s)}}function C(o,p,t){var s=new RegExp("^([a-z_]+)(\\d+)$","i");var r=p.match(s);if(r){var q=r[1];if(q===o.departure){q=o.arrival}else{if(q===o.arrival){q=o.departure}}if(V.setStoredInputValue){V.setStoredInputValue(q,1,t)}}}function D(p){p=p||[];for(var o in p){if(f(p[o])){return true}}return false}function f(o){return o===1||(A.Lang.isObject(o)&&((!O&&o.b2c!==0)||(O&&o.rbe!==0)))}function l(y,q,t,z){var v=[];var AA=A.one("#"+t);var r=A.Lang.trim(AA.next().get("value"));var w=r||"";w=c(w);var p=new RegExp("^"+w,"i");var o=new RegExp(",\\s"+w,"i");var u=t.split("origin_airport_hidden")[1];for(var x in i){if(!D(i[x])){continue}if(A.airports[x]){if(!z||z.length===0||z.length===1&&u>1||u>=z.length||z[u]===null||A.airports[x].country===z[u]){var s=P(x);if(y!=null&&(A.Lang.trim(w)!=""&&A.Lang.trim(w)!=g)){if(x.match(p)||s.match(p)||s.match(o)){v.push(new Array(x,s))}}else{v.push(new Array(x,s))}}}else{A.log("origin airport not found:"+x,"warn")}}k(v,q,"origins");return v}function R(AI,v,r,u,o){var AE=[];var AH=A.one("#"+r);var AG=A.one("#"+u);var y=A.Lang.trim(AH.next().get("value"));var AF=y||"";AF=c(AF);var AC=new RegExp("^"+AF,"i");var AB=new RegExp(",\\s"+AF,"i");var AD=[];var x=i[AG.get("value")];if(A.Lang.isValue(x)){AD=x}else{var AA=[];for(var q in i){AA.push(q)}for(var t=0;t<AA.length;t++){for(var s in i[AA[t]]){AD[s]=i[AA[t]][s]}}}var w=r.split("destination_airport_hidden")[1];for(var z in AD){if(!f(AD[z])){continue}if(A.airports[z]){if(!o||o.length===0||w>=o.length||o[w]===null||A.airports[z].country===o[w]){var p=P(z)||"";if(AI!=null&&(A.Lang.trim(AF)!=""&&A.Lang.trim(AF)!=I)){if(z.match(AC)||p.match(AC)||p.match(AB)){AE.push([z,p])}}else{AE.push([z,p])}}}else{A.log("destination airport not found: "+z,"warn")}}k(AE,v,"destinations");return AE}function Y(){A.all(".airport-picker").each(function(q){var p=q.previous();o(q,p)});function o(q,p){if(!q||!p){return }var r=p.get("value");if(!r){return }var s=P(r);q.set("value",s);q.setAttribute("wl:value",s)}}function k(v,q,x){v.sort(Q);q.addClass("airportsList");if(v.length==0){q.set("innerHTML",Z);q.translate();return }if(!q.one("table")){var y=A.Node.create('<div class="table-container"><table><tbody><tr></tr></tbody></table></div>');q.set("innerHTML","");q.append(y)}var w=q.one("table").one("tr");w.all("td").remove();var o;var r;for(var s=0;s<v.length;s++){var p=v[s][0];var AA=P(p);var z=A.Node.create("<li></li>");var u=A.Node.create('<span class="airport-name" id="'+x+"-"+p+'" rel="'+p+'">'+AA+"</span>");z.append(u);if(s===0||(s%a)===0){r=A.Node.create("<ul></ul>");r.append(z);var t=document.createElement("td");o=A.one(t);o.append(r);w.append(o)}else{if((s%a)!==0){r.append(z)}}}}function c(p){var o=new RegExp("[.*+?|()\\[\\]{}\\\\]","g");return p.replace(o,"\\$&")}function Q(p,o){if(p[0]===""){return -1}if(o[0]===""){return 1}if(p[1]<o[1]){return -1}if(o[1]<p[1]){return 1}return 0}}});YUI.add("wl-fsc-multicity",function(E){var D;var C={init:function(F){D=F}};C.commonMulticityDomEvents=function(G){var F=G.one("#addMoreFlights");if(F){F.on("click",B)}E.on("click",A,".multiFlight-delete-leg")};function B(F){F.preventDefault();D.addFlight()}function A(G){G.preventDefault();var F=E.DataType.Number.parse(this.get("id"));D.removeFlight(F)}E.widgets=E.widgets||{};E.widgets.multicity=C});YUI.add("wl-fsc-modifySearch",function(D){var B;var G;var C,I;var E;var F=false;var H={init:function(L,O,M,K){G=K.errorMsg||"";I=L;C=O;var N=D.one("#"+M);E=N?N.get("innerHTML"):""},create:function(N,K,L){var M={visible:true,draggable:false,fixedcenter:"contained",modal:true,close:true,postmethod:"form",hideaftersubmit:false,monitorresize:true,constraintoviewport:true};var P=D.merge(M,L);if(B){B.destroy()}var O=D.one("#"+N);if(!O){O=D.Node.create('<div id="'+N+'"></div>');O.set("innerHTML",E);if(F){D.translateNode(O)}D.one("body").appendChild(O)}B=new YAHOO.widget.Dialog(N,P);B.renderEvent.subscribe(function(){this.cfg.setProperty("zIndex",100);this.sizeMask();var Q=D.one("#modify-search");Q.removeClass("hidden");B.center();D.on("modifySearchOverlay|click",A,"#btn-modify-search");D.on("modifySearchOverlay|click",function(){B.hide()},"#btn-cancel");if(G){J(G)}if(D.Lang.isFunction(K.render)){K.render.call(this,this)}I.fireEvent("modify_search_rendered")});B.hideEvent.subscribe(function(){D.detach("modifySearchOverlay|*");D.wlValidation.errorRendering.hideAllOverlays();if(D.Lang.isFunction(K.hide)){K.hide.call(this,this)}});B.render(document.body)},updateErrorMessages:function(K){G=K;J(K)},getErrorMessages:function(){return G},setTranslationRequired:function(){F=true}};D.widgets=D.widgets||{};D.widgets.modifySearch=H;function A(){D.one(B.element).addClass("loading");B.submit()}function J(L){var K=D.one("#errors");var M={message:L};I.renderPartialInNode("_flowMessage",M,K,true);K.removeClass("hidden")}});YUI.add("wl-fsc",function(B){var A={ONE_WAY:"oneway",ROUND_TRIP:"roundtrip",MULTI_CITY:"multicity"};B.components.Fsc=function(AD){var l=this;var Y=AD.initData||{};var Aa=AD.compInstConfig||{};var C=new YAHOO.widget.OverlayManager();var m=Aa.dateFormat;var o=Aa.originCityDefaultValueKey||"";var u=Aa.destinationCityDefaultValueKey||"";var r=Y.destinationAirportCountriesFilter;var D=Y.originAirportCountriesFilter;var H=Y.restrictOriginAndDestination&&Y.nonRefundableAncillariesIncluded;var S=Y.mybWasAwardBooking;var J=Y.frequentFlyerUserLoggedIn||false;var AR=sabre.config.satConfiguration.frequentFlyer.requireLogin;var N=sabre.config.satConfiguration.frequentFlyer.allowedJourneyTypes;var AF=sabre.config.techSwitchesConfiguration.profileSystemAvailable;var AP=sabre.config.techSwitchesConfiguration.loyaltyProgramAvailable;var d=Y.awardBooking||false;var L=(!d&&Y.redeemMiles)||false;var AX=Aa.rbeTabEnabled||false;var j=Aa.awardBookingEnabled&&AP;var AV=Y.partialExchange;var F=!AF&&AR;var AO=S||!j||F;var AI=Y.journey||Aa.journey.defaultValue;var w=A[AI];var g={};var k="INF_id";var AM="redeem_miles";B.widgets.multicity.init(g);var AS=B.wlAirportFinder(l,g,{cityListFormat:Aa.cityListFormat,maxRowCount:Aa.maxRowCount,defaultOriginLabel:o,defaultDestinationLabel:u,airportInputsIds:{departure:"origin_airport",arrival:"destination_airport"}});var x;l.incomingEvents={load_overlay:function(Af){g.setTripType(Y.journey);O(Af.errorMessage)},change_lang:function(){b();if(AD.state==="modifySearch"){B.widgets.modifySearch.setTranslationRequired()}},"ff-logged-in":function(){J=true;AB();K();Q()},"logged-in":function(){AB();K()},"logged-out":function(){J=false;AB();K();Q()}};l.onRenderState={exchange:function(Af){Ab(Af)},modifySearch:function(Ag){var Af=B.Lang.isObject(AD.validationMessages)&&B.Object.size(AD.validationMessages)?"validationError":null;B.widgets.modifySearch.init(l,g,"modify-search",{errorMsg:Af});if(Af||Y.alwaysShowModifySearch){O()}},searchPage:function(Af){B.wlProfiler.add("fsc rendered");Ab(Af);G(Af)}};g.getTripType=function(){return w};g.setTripType=function(Af){AI=A[Af]?Af:"ROUND_TRIP";w=A[Af];return w};g.getTripTypeKey=function(Af){return A[Af]};g.registerContainer=function(Af){C.register(Af)};g.toggleRedemptionSearchAllowed=function(){var Ai=false;if(!T(AI)){Ai=true}else{var Ah=l.node.one("#"+k);if(Ah){var Ag=Ah.get("value");if(Ag>0){Ai=true}}}var Af=l.node.one("#"+AM);AQ(Af,Ai);AB()};g.addFlight=function(){AW()};g.removeFlight=function(Af){p(Af)};function O(Af){if(Af){B.widgets.modifySearch.updateErrorMessages(Af)}B.widgets.modifySearch.create("modify-search",{render:function(Ag){l.node=B.one(Ag.element);Ab(l.node)},hide:function(Ag){AG(Y.journey);C.hideAll()}})}function Ab(Ah){Ah.delegate("click",a,".trip-type-input");Ah.delegate("click",V,".fsc-tab");if(!H){Ah.delegate("click",Ae,".airport-trigger")}if(H){AJ()}var Af=Ah.one(".componentContentHolder")||Ah;Af.addClass(w);AC(Ah);var Ag=Ah.one("#ADT_id");if(Ag){f.apply(Ag);if(B.UA.ie){Ag.on("change",f)}else{Ah.delegate("change",f,"#ADT_id")}}AB();AE(AO);if(j&&!AX){W();g.toggleRedemptionSearchAllowed();Ah.delegate("click",h,"#"+AM);Q();M(Ah)}K()}function G(Af){Af.delegate("change",i,"#fsc-pointOfSale")}function AJ(){for(var Af in A){var Ag=l.node.one("#journey_"+Af+"_el");if(Ag&&!Ag.get("checked")){AQ(Ag,true)}}}function AC(Af){Ad(Af);Af.all(".airport-picker").each(function(Ag){if(!Ag.get("disabled")){Ag.on("click",AY);Ag.on("keyup",AK);Ag.on("key",AL,"down:13");v(Ag)}});b();Af.all(".date_departure_inp, .date_return_inp").each(function(Ah,Ag){AU(Ah,Ag);if(!Ah.get("disabled")){Ah.on("focus",U)}});Af.all("input, select").on("blur",AN);if(w==="multicity"){B.widgets.multicity.commonMulticityDomEvents(Af)}}function Ad(Af){B.wlValidation.initializeForPartial(AD.getType(),B.wlValidation.validationEngineRules,B.wlValidation.validationConfiguration,Af)}function b(){AS.updateAirportInputTranslation();C.hideAll()}function AE(Af){var Ag=l.node.one("#redeemMiles");if(Ag&&Af){Ag.addClass("hidden")}}function Q(){if(J){return }var Af=l.node.one(".redeem-miles-label");if(Af){if(!L){Af.removeClass("warning")}else{if(j&&!J&&AR){Af.addClass("warning")}}}}function M(Ag){var Ah;if(j){for(Ah in A){var Af=Ag.one("#journey_"+Ah+"_el");var Ai=!T(Ah)&&L;AQ(Af,Ai)}var Al=Ag.one("#cabin_class");var Aj=Ag.one("#fare_type");var Ao=Ag.one("#travelOptionsHotelReservation");var Ak=Ag.one("#travelOptionsCarRental");AQ(Al,L);AQ(Aj,L);AQ(Ao,L);AQ(Ak,L);var Am=Ag.one("#travelOptionsNumberOfRooms");if(L&&Am){Am.set("value",1)}AQ(Am,L);var An=Ag.one("#"+k);if(L&&An){An.set("value",0)}AQ(An,L)}}function h(Af){L=Af.currentTarget.get("checked");M(l.node);K();AB();Q();R(L)}function W(){L=Y.redeemMiles||false;var Af=l.node.one("#"+AM);if(Af){Af.set("checked",L)}R(L)}function R(Af){var Ah=l.node.one("#"+AM+"_val_holder");if(Ah){Ah.set("value",Af?"true":"false")}var Ag=l.node.one("#award_booking_val_holder");if(Ag){Ag.set("value",Af?"true":"false")}}function T(Af){return(B.Array.indexOf(N,Af)>-1)}function U(Af){C.hideAll();B.wlCalendar.loadCalendar(Af.target,g,{dateFormat:m,show:true})}function AU(Ag,Af){B.wlCalendar.setFlightDates(Ag,Af)}function v(Af){if(AD.state!=="modifySearch"){B.use("wl-routes",function(Ag){l.node.all(".origin_airport").removeClass("disabled");l.node.all(".destination_airport").removeClass("disabled")})}AS.createAirportList(Af)}function AA(){C.hideAll()}function AY(Af){C.hideAll();AS.showAirportList(Af,Af.currentTarget,r,D)}function Ae(Ag){Ag.preventDefault();var Af=this.previous();C.hideAll();AS.showAirportList(null,Af,r,D)}function AK(Af){if(Af.charCode===9){C.hideAll()}AS.showAirportList(Af,Af.currentTarget,r,D)}function AL(Af){Af.halt()}function K(){if(J||!(L||d)){t()}else{if(AR&&(L||d)){t();AH()}}}function t(){var Af=l.node.one(".redeem-miles-label");if(Af){Af.removeClass("warning")}s("#flow-message-ffNotLoggedIn");s("#flow-message-ffLoginNeeded");s("#flow-message-ffInvalidProfileType")}function s(Af){var Ag=B.one(Af);if(Ag){Ag.addClass("hidden")}}function AH(){var Ag=l.node.one(".redeem-miles-label");var Af=B.one("#flow-message-ffNotLoggedIn");var Aj=B.one("#flow-message-ffLoginNeeded");var Ai=B.one("#flow-message-ffInvalidProfileType");var Ah=(Af!=null||Aj!=null||Ai!=null);if(Ai){Ai.removeClass("hidden")}else{if(Aj){Aj.removeClass("hidden")}else{if(Af){Af.removeClass("hidden")}}}if(Ag&&Ah){Ag.addClass("warning")}}function AB(){if(!J&&AR&&(L||d)){B.on("pageHtmlLoaded",e);e()}else{B.on("pageHtmlLoaded",Ac);Ac()}}function e(){if(AD.state!=="modifySearch"){l.fireEvent("block_submit")}else{var Af=l.node.one("#btn-modify-search");if(Af){Af.set("disabled","disabled");Af.addClass("disabled")}}}function Ac(){if(AD.state!=="modifySearch"){l.fireEvent("unblock_submit");l.fireEvent("unblock_submit",{data:{},type:"flomes",forceInitialize:true})}else{var Af=l.node.one("#btn-modify-search");if(Af){Af.removeAttribute("disabled");Af.removeClass("disabled")}}}function AQ(Ag,Af){if(Ag){if(Af){Ag.set("disabled",true);Ag.addClass("disabled");Ag.set("checked",false)}else{Ag.removeAttribute("disabled");Ag.removeClass("disabled")}}}function q(Af){return parseInt(Af.get("value"),10)}function y(Ah,Af){var Ag="";Af.purge(true);x=x||Af.all("option");x.each(function(Ai){var Aj=parseInt(Ai.get("value"),10);if(Aj<=Ah){Ag+='<option value="'+Aj+'">'+Aj+"</option>"}});Af.setContent(Ag)}function I(Af,Ai,Ag){var Aj=parseInt(Af,10);var Ah=Aj>Ai?Ai:Aj;Ag.set("selectedIndex",Ah)}function f(){var Ah=q(this);var Af=l.node.one("#"+k);if(Af){var Ag=Af.get("value");y(Ah,Af);I(Ag,Ah,Af);AZ()}}function AN(Af){if(!this.hasClass("airport-picker")&&!this.hasClass("date-picker")){B.wlValidation.validate(Af)}}function AZ(){B.on("change",g.toggleRedemptionSearchAllowed,"#"+k)}function AT(Ag,Af){Ag.purge(true);Ag.set("innerHTML",B.decodeHtmlEntities(Af));AC(Ag)}function z(Ah,Af){var Ag=l.node.one("#"+Ah+Af);return Ag?Ag.get("value"):null}function c(Ag){if(!Ag){return null}var Af=B.DataType.Date.parse(Ag,sabre.config.dateInputFormat);return B.DataType.Date.format(Af,{format:sabre.config.dateTimeJSONFormat})}function V(Af){d=this.hasClass("fsc-tab-rbe");K();AB();n({isRbe:d});Af.preventDefault()}function a(Ag){var Af=Ag.target;var Ah=Af.get("value");AG(Ah)}function AG(Af){l.node.removeClass(w);var Ag=X();g.setTripType(Af);l.node.addClass(w);Z({actionCode:"changeTripType",itineraryParts:Ag})}function E(Af){return{origin:z("origin_airport_hidden",Af),destination:z("destination_airport_hidden",Af),date:c(z("date_hidden",Af)),timeRange:z("time_range",Af)}}function P(Af){return Af.origin||Af.destination||Af.date||Af.timeRange}function X(){var Ah=[];for(var Ag=0;;Ag++){var Af=E(Ag);if(P(Af)){Ah.push(Af)}else{break}}if("roundtrip"==w&&Ah.length>1){Ah[1].origin=Ah[0].destination;Ah[1].destination=Ah[0].origin}return Ah}function p(Af){Z({actionCode:"deleteFlight",deletedFlightIndex:Af})}function AW(){Z({actionCode:"addFlight"})}function n(Ah){var Ag=l.node;if(!Ag){return }l.addLoadingOverlay();var Af={data:{rbeTabSelected:Ah.isRbe,journey:AI,requestPartials:[AD.state]},on:{success:function(Aj,Ai){if(Ai){Ag.purge(true);Ag.set("innerHTML",B.decodeHtmlEntities(Ai.partials[AD.state]));AC(Ag);K();AS.setRbeBooking(Ah.isRbe);if(AD.state==="modifySearch"){l.onRenderState.modifySearch(Ag);O()}}},complete:function(){l.removeLoadingOverlay()}}};l.fireEvent("to-ajax",{cfg:Af,actionCode:"loadFscPartial"})}function Z(Ak){var Aj=Ak.itineraryParts||X();var Ag="__"+(AD.state==="modifySearch"?"modifySearch":"searchPage")+"_"+AI.toLowerCase();var Ai=l.node.one("#airports-dates-container");if(!Ai){return }var Ah=l.node.all(".trip-type-input");Ai.addClass("loading");Ah.each(function(Al){Al.set("disabled","disabled")});var Af={data:{actionCode:Ak.actionCode,deletedFlightIndex:Ak.deletedFlightIndex,requestPartials:[Ag],journey:AI,fscItineraryParts:Aj},on:{success:function(Am,Al){if(Al){AT(Ai,Al.partials[Ag]);g.toggleRedemptionSearchAllowed()}},complete:function(){Ai.removeClass("loading");Ah.each(function(Al){if(!Al.hasClass("disabled")){Al.removeAttribute("disabled")}})}}};l.fireEvent("to-ajax",{cfg:Af,actionCode:"loadFscPartial"})}function i(Ag){var Ai=l.node.one("#fsc-pointOfSale");var Aj=Ai.ancestor(".component-section");if(Aj){Aj.addClass("loading")}var Ah=Ai.get("value");var Af={data:{pointOfSale:Ah},on:{end:function(){if(Aj){Aj.removeClass("loading")}},success:function(Al,Ak){l.fireEvent("update-data",{data:{pointOfSale:Ah}})}}};l.fireEvent("to-ajax",{cfg:Af,actionCode:"changePointOfSale"})}}});YUI.add("wl-googleanalytics",function(A){A.components.Googleanalytics=function(B){this.create=false;this.render=false}});