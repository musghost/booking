YUI.add("wl-scc",function(A){A.components.Scc=function(C){var E=this;var H=C.compInstConfig;E.incomingEvents={hide:function(J){var I=A.Lang.isArray(J.componentsToHide)?J.componentsToHide:[];if(A.Array.indexOf(E.getId(),I)){C.state="empty";E.renderHtml(C,E.node)}},show:function(){}};E.onCreate=function(I,J){if(I.state==="text"){var K=H.textKey;if(K){E.renderHtml({textKey:K})}}};E.onRenderState={script:function(J){var L=H.functionName;var I=window[L];A.log("Executing "+L+" function from file "+H.scriptPath);if(typeof I==="function"){try{I(A.Node.getDOMNode(J))}catch(K){A.log("Error executing script: "+L+" "+K.message,"error")}}else{A.log("Cannot find function named: "+L,"error")}E.translateTemplate(C,J)},text:function(){var I=E.node.one(".scc-text");if(I){I.removeClass("hidden")}}};var D=function(I){if(typeof Array.prototype.indexOf==="function"){D=Array.prototype.indexOf}else{D=function(K){for(var J=0;J<this.length;J++){if(this[J]===K){return J}}return -1}}return D.call(this,I)};var G=function(I){return D.call(H.scriptsForcedToStayInHead,I)===-1};if(C.state==="header"||C.state==="footer"){E.create=false;E.node=A.one("#"+C.getId());E.node.set("innerHTML",A.replaceTemplateData(null,E.node.get("innerHTML")));E.node.translate()}else{if(C.state==="script"){E.render=false;var B="wl-custom_script-"+C.getId();var F=sabre.config.global.commonResourcesPath+"js/"+H.scriptPath;sabre.config.groups["wl-noncombine"].modules[B]={fullpath:F};if(G(H.scriptPath)){E.node=A.one("#"+B);if(E.node){E.onRenderState.script(E.node)}else{A.log("Cannot load custom script "+B+". There is no script node for "+F,"warn")}C.componentRendered()}else{A.use(B,function(J,I){if(I.success){E.onRenderState.script(E.node)}else{J.log("Cannot load custom script. "+I.msg,"warn")}C.componentRendered()})}}}}});YUI.add("wl-prbar",function(A){A.components.Prbar=function(B,H){var G=this;var C={REINITIALIZE:"reinitialize"};G.incomingEvents={flight_changed:F,ancillary_changed:F,state_changed:function(){I(J)}};G.onRenderState={initialized:function(K){A.delegate("click",function(L){L.preventDefault()},K,".stepFuture a, .lastStep a")}};function I(L){var M="_elements";var K={data:{requestPartials:[M]},on:{end:function(){},success:function(O,N){if(N){L(N,M)}}}};G.fireEvent("to-ajax",{cfg:K,actionCode:C.REINITIALIZE})}function J(L,M){var K=G.node.one("#booking-process");K.set("innerHTML",A.decodeHtmlEntities(L.partials[M]));F()}function E(K,L){K.setAttribute("class",L.join(" "))}function D(){var N=G.node.all("li");var M=G.node.one("li.stepCurrent");var L=N.indexOf(M);var K=N._nodes.slice(L+1);return A.all(K)}function F(){var K=D();var L=K.size()-1;K.each(function(N,M){var O=["stepFuture"];if(M===0){O.push("prevCurrent");O.push("stepFuture_prevCurrent")}else{O.push("prevFuture");O.push("stepFuture_prevFuture")}if(M===L){O.push("lastStep");O.push("stepFuture_lastStep")}E(N,O)})}}});YUI.add("wl-flomes",function(A){A.components.Flomes=function(D,B){var F=this;F.incomingEvents={"add-messages":function(L){var K=L.data.messages;var J=G(K);var O="flow-messages-component-"+L.type;var N=A.one("#"+O);var I=A.one("#flow-messages-component");if(!N){N=A.Node.create('<div id="'+O+'"></div>');I.append(N)}N.set("innerHTML",J);I.translate();N.removeClass("hidden");var M=I.getXY();window.scrollTo(M[0],M[1])},"show-messages":function(L){var K=L.data.messages||[];for(var J=0;J<K.length;J++){var N=K[J];var M=N.id||N;var I=A.one("#flow-message-"+M);if(I){I.removeClass("hidden")}}var P=A.one("#flow-messages-component");var O=P.getXY();window.scrollTo(O[0],O[1])},"remove-messages":function(L){var K=L.data.messages||[];for(var J=0;J<K.length;J++){var N=K[J];var M=N.id||N;var I=A.one("#flow-message-"+M);if(I){I.addClass("hidden")}}},"remove-all-messages":function(){A.all(".flow-message-error").each(function(I){I.remove()})},"remove-all-component-messages":function(I){var K="flow-messages-component-"+I.type;var J=A.one("#"+K);if(J){J.set("innerHTML","")}},"block-discrepancy-confirm":function(J){var I=A.one("#accept-new-price-btn");if(I){I.set("disabled","disabled").addClass("disabled")}},"unblock-discrepancy-confirm":function(J){var I=A.one("#accept-new-price-btn");if(I){I.removeAttribute("disabled");I.removeClass("disabled")}}};F.onRenderState={initialized:function(K){var J=D.initData.messages;for(var I in J){if(E[J[I].id]){E[J[I].id]()}}}};function G(K){var M="";for(var I in K){var J=K[I];var L=J.id;var N=F.getHtml("_flowMessage_"+L);if(!N){N=F.getHtml("_flowMessage")}M+=F.replaceData({level:J.level,id:J.id,code:J.code,originalMessage:J.originalMessage},N);if(null!==A.one("#flow-message-"+L)){A.one("#flow-message-"+L).remove(true)}}return M}var E={priceDiscrepancyError:function(){A.on("click",H,"#select-flights-link");A.on("click",C,"#accept-new-price-btn")},ssrInsufficientInfantProvision:function(){F.fireEvent("block_submit",{forceInitialize:true})}};function H(I){location.href=A.utilsUrl.buildExecutionUrl("_eventId=goto&gotoPageCode=AIR_SELECT_PAGE")}function C(I){F.fireEvent("sbmt-after-price-discrepancy")}}});YUI.add("popupWidget",function(B){var A=function(E,H,D){var G=this;var K=false;var C;var J;var I;if(D!=null&&D.header!=null){I=function(M,L){return B.Node.create('<div id="'+M+'" class="messagePopup" ><div class="hd">'+D.header+'</div><div class="bd">'+L+'</div><div class="ft">&nbsp;</div></div>')}}else{I=function(M,L){return B.Node.create('<div id="'+M+'" class="messagePopup" ><div class="hd">&nbsp;</div><div class="bd">'+L+'</div><div class="ft">&nbsp;</div></div>')}}if(YAHOO.lang.isString(H)){C="popup"+YAHOO.util.Dom.generateId();J=I(C,H);E.append(J)}else{C=H.getAttribute("id");J=H}var F={width:"400px",height:"150px",fixedcenter:true,constraintoviewport:true,close:true,visible:false,draggable:false,modal:true,zIndex:10,buttons:[],needTranslation:true};D=YAHOO.lang.merge(F,D||{});if(D.autofillheight!=null){D.height=null}G.dialog=new YAHOO.widget.Dialog(C,D);G.hide=function(){if(K){G.dialog.hide();if(J){J.addClass("hidden")}}};G.destroy=function(){if(K){G.dialog.destroy()}};G.dialog.hideEvent.subscribe(G.hide);if(D.closeHandler){G.dialog.hideEvent.subscribe(D.closeHandler)}G.addUniqueID=function(N){var M=G.dialog.getButtons();for(var L=0;L<M.length;L++){M[L].id=""+N+""+L}};G.render=function(){G.dialog.render();if(J&&D.needTranslation){J.translate()}K=true};G.center=function(){if(!K){G.render()}G.dialog.center()};G.show=function(){if(!K){G.render()}if(J){J.removeClass("hidden")}G.dialog.show()};G.node=function(){return J};G.update=function(L){G.dialog.setBody(L);K=false};G.id=function(){return C}};B.widgets=B.widgets||{};B.widgets.PopupWidget=A},"1.0.0",{requires:[]});YUI.add("array-extras",function(E){var C=E.Lang,D=Array.prototype,B=E.Array;B.lastIndexOf=(D.lastIndexOf)?function(A,F){return A.lastIndexOf(F)}:function(A,G){for(var F=A.length-1;F>=0;F=F-1){if(A[F]===G){break}}return F};B.unique=function(F,H){var A=F.slice(),G=0,J=-1,I=null;while(G<A.length){I=A[G];while((J=B.lastIndexOf(A,I))!==G){A.splice(J,1)}G+=1}if(H){if(C.isNumber(A[0])){A.sort(B.numericSort)}else{A.sort()}}return A};B.filter=(D.filter)?function(A,F,G){return D.filter.call(A,F,G)}:function(A,G,H){var F=[];B.each(A,function(K,J,I){if(G.call(H,K,J,I)){F.push(K)}});return F};B.reject=function(A,F,G){return B.filter(A,function(J,I,H){return !F.call(G,J,I,H)})};B.every=(D.every)?function(A,F,G){return D.every.call(A,F,G)}:function(F,H,I){for(var G=0,A=F.length;G<A;G=G+1){if(!H.call(I,F[G],G,F)){return false}}return true};B.map=(D.map)?function(A,F,G){return D.map.call(A,F,G)}:function(A,G,H){var F=[];B.each(A,function(K,J,I){F.push(G.call(H,K,J,I))});return F};B.reduce=(D.reduce)?function(A,H,F,G){return D.reduce.call(A,function(L,K,J,I){return F.call(G,L,K,J,I)},H)}:function(A,I,G,H){var F=I;B.each(A,function(L,K,J){F=G.call(H,F,L,K,J)});return F};B.find=function(F,H,I){for(var G=0,A=F.length;G<A;G++){if(H.call(I,F[G],G,F)){return F[G]}}return null};B.grep=function(A,F){return B.filter(A,function(H,G){return F.test(H)})};B.partition=function(A,G,H){var F={matches:[],rejects:[]};B.each(A,function(J,I){var K=G.call(H,J,I,A)?F.matches:F.rejects;K.push(J)});return F};B.zip=function(F,A){var G=[];B.each(F,function(I,H){G.push([I,A[H]])});return G};B.forEach=B.each},"3.1.2");YUI.add("wl-pnrinfo",function(A){A.components.Pnrinfo=function(AK){var t=this;var G=AK.initData;var AD=AK.compInstConfig;var AE=sabre.config.satConfiguration;var x=AD.airportsFormat;var Z=AD.dateFormat;var AB="_cancelFlightsOverlay";var C="_changeFlightsOverlay";var L="_upgradeFlightsOverlay";var j="_editPassengerDetailsOverlay";var K="_ancillariesOverlay";var d="_seatsOverlay";var AM=AD.remotePaymentUrl;var AF="_claimPnrResult";var b="changeFlightsDialog";var AH="upgradeFlightsDialog";var AL="cancelFlightsDialog";var f="editPassengerDetailsDialog";var B="ancillariesDialog";var Y="seatsDialog";var h=AD.timeOfHideOverlayDelay||0;var c;var l={};t.onCreate=function(AN,AO){c=I();t.renderHtml(g(G))};t.onRenderState={initialized:p,initialized_bnpl:p};function p(AO){var AN=false;if(location.hash==AD.tabHash||location.hash=="#"||!location.hash){AN=true}t.fireEvent("add_tab",{context:AK,type:"pnrinfo",data:{node:t.node,label:"label.tabs.mytrips",index:0,active:AN,tabHash:"#mytrips",beforeActiveChange:function(AQ){var AP=[t.node];if(AQ.newValue){A.Array.each(AP,function(AR){AR.removeClass("hidden")})}else{A.Array.each(AP,function(AR){AR.addClass("hidden")})}}}});AJ(AO);r(AO);AC(AO);u();T();s();c.addMakeChangesButtonClickHandler();t.fireEvent("add-me-to-login",{trigger:"login",actionCode:"login"})}t.incomingEvents={"before-login":F,"logged-out":function(){var AN=A.one(".claimPnrLinkHolder");if(AN){AN.addClass("hidden")}}};function s(){var AN=A.one(".pnrinfo .button-toggle-details");var AO=A.one(".pnrinfo .flight-details-table");if(AN&&AO){A.on("click",function(AP){AP.preventDefault();var AQ=AO.getStyle("display");if("table"==AQ){AO.addClass("hidden");AN.removeClass("active")}else{AO.removeClass("hidden");AN.addClass("active")}return false},AN)}}function F(){var AN={on:{success:function(AQ,AP){if(AP){if(AP.model!=null){G=AP.model}var AO=A.one(".claimPnrLinkHolder");if(AO){AO.removeClass("hidden");T()}}}}};t.fireEvent("to-ajax",{cfg:AN,actionCode:"canClaimPnr"})}function AJ(AN){var AO=G.migratedBooking;if(AO){J(AN,"flightExchangeLink",AD.displayExchangeLinkMigrated);J(AN,"flightUpgradeLink",AD.displayUpgradeLinkMigrated);J(AN,"flightCancelLink",AD.displayCancelLinkMigrated);J(AN,"editPassengerDetailsLink",AD.displayEditLinkMigrated)}}function J(AO,AQ,AP){if(!AP){var AN=AO.one("a."+AQ);if(AN){AN.remove(true)}}}function r(AO){if(sabre.config.pageCode!=="CONFIRMATION_PAGE"){var AP=AO.one("#exchangeAndCancelLinksHolder");if(AP){var AN=AO.one(".flightCancelLink");if(AN&&!G.ancillariesCancelAvailable){AN.addClass("hidden")}var AR=AO.one(".flightExchangeLink");if(AR&&!G.ancillariesExchangeAvailable){AR.addClass("hidden")}AP.removeClass("hidden")}var AQ=AO.one("div.trip-actions-makeChanges");if(AQ){AQ.removeClass("hidden")}}}function w(){var AO=t.getHtml("_linkHoldRemotePayment");var AN;if(sabre.config.pageCode==="VIEW_ITINERARY_PAGE"){AN=n(AM)}else{AN={payUrl:"#",reloc:"",timeParameters:"",translationKey:""}}return t.replaceData(AN,AO)}function W(){var AO=t.getHtml("_linkHoldBNPLPayment");var AN=n("onhold.html?viewReloc=");return t.replaceData(AN,AO)}function n(AO){var AP=G.expiryTime;var AN=(function(){var AU=[AP.days,AP.hours,AP.minutes];var AT="";A.Array.every(AU,function(AW,AV){if(AW>0){AT=AV;return false}return true});return AT})();var AS=(["Days","Hours","Minutes"])[AN];var AR=[AP.days,AP.hours,AP.minutes].splice(AN,3-AN).join("|");var AQ={payUrl:AO,reloc:G.reloc,timeParameters:AR,translationKey:AS};return AQ}function y(AN,AP){var AO=H(AN);return A.DataType.Date.format(AO,{format:AP})||null}function H(AN){var AO=A.DataType.Date.parse(AN);if(AO==null&&AN){var AP=AN.match(/^(\d\d\d\d)-(\d\d)-(\d\d)$/);AO=new Date(AP[1],AP[2]-1,AP[3])}return AO}function g(AO){var AN={};AN.reloc=AO.reloc||"";AN.backToHref=AO.backToHref||"";AN.backToPageKey=AO.backToPageKey||"";AN.origin=A.formatAirport(AO.originCode,x);AN.destination=A.formatAirport(AO.destinationCode,x);AN.departureDate=y(AO.departureDate,AD.dateFormat);AN.arrivalDate=y(AO.arrivalDate,AD.dateFormat);AN.sourcePageCode=sabre.config.pageCode;AN.status=N(AO.status);AN.returnDate=Q(AO,AN.arrivalDate);AN.additionalLinks="";AN.purchaseNowLink="";if(AO.status==="cancelled"){AN.additionalLinks=A.templateHtml.pnrinfo._linkCancelled}else{if(AO.paymentLinkType==="RemotePayment"){AN.additionalLinks=w()}else{if(AO.paymentLinkType==="BNPLPayment"){AN.purchaseNowLink=W()}}}V(AN,AN.reloc);AN.servicingOptionsLinks=c.prepareServicingOptionsLinks(AN.reloc);AN.flightDetailsTable=R(AO);return AN}function R(AP){if(AP.flightDetailsTable.render){var AN="";A.Array.each(AP.flightDetailsTable.header,function(AR,AQ){AN+=t.getPartial("_flightDetailsTableHeaderCell",{item:AR})});var AO="";A.Array.each(AP.flightDetailsTable.rows,function(AT,AR){var AU="";for(var AS in AT.content){var AQ="";A.Array.each(AT.content[AS],function(AW,AV){AQ+=t.getPartial("_flightDetailsTableCellContent",{key:AS,value:AW})});AU+=t.getPartial("_flightDetailsTableCell",{content:AQ})}AO+=t.getPartial("_flightDetailsTableRow",{row:AU})});return t.getPartial("_flightDetailsTable",{headerCells:AN,rows:AO})}return""}function N(AN){if(AN){return t.getPartial("_status",{status:AN})}return""}function Q(AO,AN){if(!AO.oneWay){return t.getPartial("_oneWay",{arrivalDate:AN})}return""}function V(AO,AN){if(sabre.config.pageCode==="CONFIRMATION_PAGE"){AO.sourcePage=""}else{AO.sourcePage=A.utilsUrl.buildExecutionUrl("reloc="+AN)}}function AI(AO){var AN=AO.one(".claimPnrLinkHolder");return G.showClaimPnrButton&&AN&&!AN.hasClass("hidden")}function AC(AP){X();var AO=AP.one("div.trip-actions");var AN=AI(AO);if(AO&&AO.all("li").isEmpty()&&!AN){AO.addClass("hidden")}i(AP,"flightExchangeLink",E);i(AP,"onHoldPaymentLink",AA);i(AP,"flightUpgradeLink",AG);i(AP,"flightCancelLink",m);i(AP,"editPassengerDetailsLink",S);a()}function i(AO,AP,AQ){var AN=AO.one("a."+AP);if(AN){A.on("click",AQ,AN)}}function k(AQ,AP,AS,AR,AN,AO){AP.preventDefault();if(AS.successful){O(AQ.getAttribute("rel"))}else{U(AS,AR,AN,AO)}}function U(AU,AS,AT,AP){var AN="#"+AT;var AR=AU.variant||"disallow";var AO=AS+"."+AU.failureReason.replace(/\[.*\]/g,"")+"."+AR.toLowerCase();var AQ=A.one(AN+" div.bd");AQ.set("innerHTML",t.getPartial(AP,{key:AO}));AQ.translate();l[AT].show()}function E(AN){k(this,AN,G.exchangable,"errorMessages",b,C)}function AA(AN){}function AG(AN){k(this,AN,G.upgradeable,"errorMessages.upgrade",AH,L)}function m(AN){k(this,AN,G.cancellable,"errorMessages.cancel",AL,AB)}function S(AN){k(this,AN,G.editable,"errorMessages.edit",f,j)}function P(AN){k(this,AN,G.ancillariesChangeable,"errorMessages.ancillaries",B,K)}function e(AN){k(this,AN,G.seatsChangeable,"errorMessages.seats",Y,d)}function O(AN){window.location.href=AN}function u(){if(G.aerCancelRetainStatus){var AO="";if(G.aerCancelRetainStatus==="AER_REFUND_REJECTED"){AO="aer.refundRejected"}else{if(G.aerCancelRetainStatus==="AER_COMM_ERROR"){AO="aer.commError"}else{if(G.aerCancelRetainStatus==="AER_REFUND_NOT_ALLOWED"){AO="aer.refundNotAllowed"}else{if(G.aerCancelRetainStatus==="AER_REFUND_TO_CC_NOT_ALLOWED"){AO="aer.refundToCCNotAllowed"}}}}var AN="errorMessages.cancel."+AO;var AP=A.one("#cancelFlightsDialog div.bd");AP.set("innerHTML",t.getPartial(AB,{key:AN}));AP.translate();l[AL].show()}}function X(){M(C,b);M(L,AH);M(AB,AL);M(j,f);M(K,B);M(d,Y)}function M(AN,AP){A.one("#ROOT > div:first-child").insert(t.getPartial(AN),"before");var AO=new YAHOO.widget.Dialog(AP,{visible:false,draggable:false,zIndex:100,close:true,fixedcenter:true,modal:true});AO.render();l[AP]=AO}function a(){if(!G.aerSystemAvailable){var AN=A.all("li.trip-link");if(AN){AN.addClass("hidden")}}}function T(){if(G.showClaimPnrButton){var AO=A.one("input.claimPnrLink");if(AO){if(AE.claimPnrConfiguration.creditCardNumberSecurityCheck==="NONE"){A.on("click",v,AO)}else{A.on("click",D,AO)}}}else{var AN=A.one(".claimPnrLinkHolder");if(AN){AN.addClass("hidden")}}}var I=function(){var AY;var AU=false;var AN=h!=0;var Af,AS,AQ;function AW(){Af=A.one("#ROOT");AS=Af?Af.one("div.pnr-info"):null;AQ=AS?AS.one(".makeChangesOverlayDiv"):null}function AR(){if(AY){AY.cancel()}}function Ae(){if(AU){if(AY){AY.cancel()}AY=A.later(2*h,this,Ad)}}function Ad(){AX(this)}function AX(Ai){var Aj=Ai.ancestor(".trip-actions-makeChanges");if(Aj){var Ak=Aj.one(".makeChangesOverlayDiv");if(Ak){Ak.addClass("hidden");AU=false}}}function AV(Ai){var Aj=Ai.ancestor(".trip-actions-makeChanges");if(Aj){var Ak=Aj.one(".makeChangesOverlayDiv");if(Ak){Ak.removeClass("hidden");AU=true}}}function Ag(){if(AY){AY.cancel()}AY=A.later(h,this,function(){this.addClass("hidden");AU=false})}function Ac(){this.addClass("makeChangesOverlayItem-hover")}function AO(){this.removeClass("makeChangesOverlayItem-hover")}function AZ(){if(AU){if(AQ){AU=false;AQ.addClass("hidden")}}}function Aa(Ai){Ai.preventDefault();Ai.stopPropagation();AT(this)}function AT(Ai){if(AU){AX(Ai)}else{AV(Ai)}}function Ab(){if(AS){if(AN){AS.delegate("mouseenter",Ac,"li.makeChangesOverlayItem");AS.delegate("mouseleave",AO,"li.makeChangesOverlayItem");AS.delegate("mouseenter",AR,"div.makeChangesOverlayDiv");AS.delegate("mouseleave",Ag,"div.makeChangesOverlayDiv");AS.delegate("mouseenter",AR,".makeChangesButton input");AS.delegate("mouseleave",Ae,".makeChangesButton input");AS.delegate("mouseenter",AR,"span.trip-actions-decorator")}else{if(Af){Af.on("click",AZ)}}AS.delegate("click",P,"li.makeChangesOverlayItem-ANCILLARIES_MTO");AS.delegate("click",e,"li.makeChangesOverlayItem-SEATS_MTO");AS.delegate("click",Aa,".makeChangesButton input");AS.delegate("click",Aa,"span.trip-actions-decorator")}}function Ah(Ai){var Ak=G.servicingOptions;var Aj="";A.Array.each(Ak,function(Am){var Al={};Al.name=Am.name;Al.option=Am.allowedOption;Al.url=Am.url;Al.type=(Am.name=="SEATS_MTO")?"SEATS_MTO":"ANCILLARIES_MTO";Al.reloc=Ai;Al.sourcePage=A.utilsUrl.buildExecutionUrl("reloc="+Ai);Al.additionalParams=AP(Am);Aj=Aj+t.getPartial("_servicingOptionLink",Al)});return Aj}function AP(Aj){var Ai="";if(Aj.group){Ai="&ancillaryGroupCode="+Aj.name}else{if(Aj.subcode){Ai="&ancillaryCode="+Aj.name}}return Ai}return{addMakeChangesButtonClickHandler:function(){AW();Ab()},prepareServicingOptionsLinks:function(Ai){return Ah(Ai)}}};function q(AP){var AQ=[{text:'<span class="translate" wl:translate="label.pnrinfo.claimPnr.closeButton"></span>',handler:function(){this.hide()}}];var AO={buttons:AQ,close:true,modal:true};var AN=new A.widgets.PopupWidget(A.one(document.body),AP,AO);AN.show()}function o(){var AP={result:"success"};var AO=t.getPartial(AF,AP);q(AO);var AN=A.one(".claimPnrLinkHolder");if(AN){AN.addClass("hidden")}}function z(){var AO={result:"error"};var AN=t.getPartial(AF,AO);q(AN)}function D(){t.fireEvent("show_purchaser_check",{data:{reloc:G.reloc,onSuccess:o,onFailure:z}})}function v(){var AO=A.one("#pnr-info");AO.addClass("loading");var AN={data:{reloc:G.reloc},on:{complete:function(){AO.removeClass("loading")},success:function(AQ,AP){if(AP.checkPassed){o()}else{z()}},failure:function(){z()}}};t.fireEvent("to-ajax",{cfg:AN,actionCode:"claimPnr"})}}});YUI.add("onTimePerformanceWidget",function(B){var A=function(E,R){var L=this;var H=B.one("body");var C="onTimePerformance";var M;if(E.otpDialog){E.otpDialog.hide();E.otpDialog.destroy()}var G=sabre.config.satConfiguration.onTimePerformanceConfiguration;var N="_onTimePerformanceOverlay";var D=G.width;var Q=G.height;var O=P();var F={visible:false,draggable:false,zIndex:520,close:true,fixedcenter:true};if(G.displayInNewWindow){window.open(O,"FlightPerformance","width="+D+", height="+Q)}else{var J={link:O,width:D,height:Q};var I=E.component.getPartial(N,J);H.append(I);M=new YAHOO.widget.Dialog(C,F);var K=true;M.showEvent.subscribe(function(){B.one(this.element).translate();B.on(C+"|click",function(U){if(K){K=false}else{var T=U.target;if(!T.inRegion(M.element,true)){M.hide()}}},document)});M.hideEvent.subscribe(function(){B.detach(C+"|click");K=true});M.render(document.body);E.otpDialog=M}function P(){var V=B.DataType.Date.parse(R.departureDate);var T={flightNumber:R.flightNumber[0],origin:R.departureCode,destination:R.arrivalCode,departureDate:S(V,G.dateFormat),departureTime:S(V,G.timeFormat)};var U=B.decodeHtmlEntities(G.url);return E.component.replaceData(T,U)}function S(T,U){return B.DataType.Date.format(T,{format:U})||null}L.show=function(){M.show()}};B.widgets=B.widgets||{};B.widgets.OnTimePerformanceWidget=A},"1.0.0",{requires:[]});YUI.add("wl-flightsdetails",function(A){A.components.Flightsdetails=function(C,S){var L=this;var G=C.initData;var O=C.compInstConfig;var M=O.dateFormat;var E=O.timeFormat;var R=O.airlineFullNameEnabled;var V=O.nextDayIndicatorEnabled;var B=O.flightNumberEnabled;var H=O.passengersEnabled;var X=O.optionsEnabled;L.onRenderState={initialized:function(b){Q(G.itineraryParts,G.passengers,G.ancillariesBreakdowns);L.translateTemplate(C,b);if(G.onTimePerformanceAvailable){A.delegate("click",a,b,".flight-number")}if(O.tabHash){A.on("pageHtmlLoaded",function(){L.fireEvent("add_tabs_callback",{data:{tabHash:O.tabHash,additionalCallback:function(c){if(c.newValue){b.removeClass("hidden")}else{b.addClass("hidden")}}}})})}}};function Q(n,u,g){var h=A.one("#vic-flights");if(!h){return }var o=L.getHtml("_itineraryWrapper");var c=L.getHtml("_itineraryContent");var m=false;var p=n.length;for(var i=0;i<p;i++){var v=A.Node.create(o);h.append(v);var k=v.one(".itinerary-info");var b=n[i];var s=b.segments;for(var r=0;r<s.length;r++){var d=s[r];if(d.nextDayArrival){m=true}var f=A.Node.create(c);k.append(f);if(s[r+1]){f.addClass("layover")}var l=P(r,d);f.append(l);var q=U(r,d,i);f.append(q);var t=K(d);f.append(t);var e=W(u,d,r);f.append(e);var j=J(r,d,g);f.append(j);k.appendChild(f)}}if(m){h.append(N())}}function D(b,f){var c;if(f){for(var d=0;d<f.length;d++){c=f[d];if(c.type=="SEGMENT"){var e=c.segment;if(e.departureCode==b.origin.code&&e.arrivalCode==b.destination.code&&e.departureDate==b.departure){return c}}}}}function N(){return L.getHtml("_nextDayLegend")}function P(e,b){var f=L.getHtml("_flightSummary1");var d=e==0?"depart":"connection";var c={flightType:d,date:b.departure+","+M||"",originAirportCode:A.formatAirport(b.origin.code,O.airportsFormat),destinationAirportCode:A.formatAirport(b.destination.code,O.airportsFormat)};return L.replaceData(c,f)}function U(h,j,b){var e=L.getHtml("_flightSummary2");var p=j.airlineCode;var c=p!=j.operatingAirlineCode;var n=!!j.wetLessor;var m=(c||n?" *":"");var l=R?A.getFullAirlineName(p):p;var f=(j.nextDayArrival&&V)?L.getHtml("_nextDaySymbol"):"";var o;var k;var i=!j.durationInHours&&!j.durationInMinutes;if(i){o='<span class="translate" wl:translate="label.flightsdetails.flown"></span>';k=o}else{o=Y(j.departure,E);k=Y(j.arrival,E)}var g=p+" "+j.flightNumber+m||"";if(G.onTimePerformanceAvailable){g="<p class='flight-number'><a class='translate' href='#' itineraryPartIndex='"+b+"' segmentIndex='"+h+"' wl:title='label.flightsdetails.onTimePerformance.tooltip'>"+g+"</a></p>"}var d={airline:l,flightNumber:g,departureTime:o,arrivalTime:k,departureDirection:"departing",arrivalDirection:"arriving",arrivalNextDay:f,departureNextDay:""};return L.replaceData(d,e)}function K(g){var n=L.getHtml("_flightParticulars");var i=G.brandsGroupsCodes||[],d=g.brandId||"",e=i[d]||"undefinedGroup";var j=g.cabinClass;var l=g.equipment&&g.equipment.equipmentCode||"";var f="";var h="";var m="";if(g.durationInHours===0&&g.durationInMinutes===0){m="hidden "}else{f=I(g.durationInHours,"0",2);h=I(g.durationInMinutes,"0",2)}var k="";if(B){var b=(g.airlineCode!=g.operatingAirlineCode);if(b){k=L.replaceData({operatingAirlineCode:g.operatingAirlineCode},L.getHtml("_flightParticularsNotes"))}else{if(g.wetLessor){k=L.replaceData({wetLessor:g.wetLessor},L.getHtml("_flightParticularsWetLeased"))}}}var c={fareFamilyGroupKey:e,cabinClass:j,aircraft:l,flightDurationHours:f,flightDurationMinutes:h,flightNotes:k,flightDurationClass:m};return L.replaceData(c,n)}function W(g,n,d){if(H){var l="";var m=L.getHtml("_passengerEntry");for(var e=0;e<g.length;e++){var c=g[e];var f=c.firstName+" "+(c.middleName||"")+" "+c.lastName+" "+(c.suffix||"");var h;if(c.type&&c.type.code=="INF"){h='<span class="translate" wl:translate="label.flightsdetails.seats.infant"></span>'}else{h=c.sectorSeats&&F(c.sectorSeats,n,e,d);if(h==null){h='<span class="translate" wl:translate="label.flightsdetails.seats.noSeatsSelected"></span>'}}var b="changePassengerDetails.html?viewReloc="+G.reservationNumber+"&activePaxIndex="+e+"&sourcePage="+sabre.config.pageCode;var o=G.passengerChangesEnabled?L.getHtml("_passengerEdit"):"";var j=L.replaceData({editPassengersLink:b},o);l+=L.replaceData({passengerName:f,passengerNotes:h,passengerEdit:j,ffNumber:T(c.frequentFlyer)},m)}var k=L.replaceData({passengersList:l},L.getHtml("_flightPassengers"));return A.Node.create(k)}return""}function J(d,j,c){var q=c?D(j,c):null;if(q&&X){var f=q.ancillaries;var m=L.getHtml("_flightOption");var l="";for(var e=0;e<f.length;e++){var h=f[e];var o="";for(var b=0;b<h.passengers.length;b++){var g=h.passengers[b];o+=g.firstName+" "+g.lastName;if(b<h.passengers.length-1){o+=", "}}var n=L.replaceData({it:(e+1),segmentIndex:d+1,name:h.code,quantity:h.quantity,passengerNames:o},m);if(h.type=="INCLUDED"){n=L.replaceData({included:'<div class="included translate" wl:translate="label.flightsdetails.flightoptions.included"></div>'},n)}else{n=L.replaceData({included:""},n);if(h.servicingOptionOffered){n=L.replaceData({modifiable:'class="modifiable"'},n)}else{n=L.replaceData({modifiable:""},n)}}l+=n}var k=L.replaceData({flightOptions:l,segmentIndex:d+1},L.getHtml("_flightOptions"));return A.Node.create(k)}return""}function F(e,f,c,g){for(var d=0;d<e.length;d++){if(Z(e[d].sectorKey,f)){if(e[d].requestGranted){var b='<span id="s'+(g+1)+"_p"+(c+1)+"_"+e[d].seatCode+'">'+e[d].seatCode;if(e[d].seatLabel==""){return b+' <span class="translate" wl:translate="Ancillary.name.seat"></span></span>'}else{return b+' <span class="translate" wl:translate="Ancillary.name.seat_'+e[d].seatLabel+'"></span></span>'}}else{return null}}}}function Z(c,b){return c.origin===b.origin.code&&c.destination===b.destination.code&&c.airline===b.airlineCode&&c.flightNumber===b.flightNumber&&c.departureDate===b.departure}function T(c){var g="";for(var b=0;b<c.length;b++){var d=L.getHtml("_frequentFlyerNumber");var e=A.getFullAirlineName(c[b].airline);var f=c[b].number;g+=L.replaceData({ffId:f,ffAirline:e},d)}return g}function I(d,e,b){d=""+d;if(d.length<b){d=e+d+"";return I(d,e,b)}return d}function Y(b,d){var c=A.DataType.Date.parse(b);return A.DataType.Date.format(c,{format:d})||""}function a(h){h.preventDefault();var f=h.target.getAttribute("itineraryPartIndex");var i=h.target.getAttribute("segmentIndex");var b=G.itineraryParts[f];var g=b.segments[i];var d={departureCode:g.origin.code,arrivalCode:g.destination.code,flightNumber:[g.flightNumber],departureDate:g.departure};var c=new A.widgets.OnTimePerformanceWidget(C,d);c.show()}}});YUI.add("wl-paymentsummary",function(A){A.components.Paymentsummary=function(B){var H=this;var F=B.initData;var C=B.compInstConfig;H.onCreate=function(O,P){N(O.state,O,P)};function N(Q,O,P){if(A.Lang.isFunction(M[Q])){M[Q](O,P)}}var M={initialized:function(O,P){if(F.payments){J(P)}},paymentMultiFop:function(O,P){D(P)},paymentMultiFopDetailsBelow:function(O,P){D(P)},refundConfirmation:function(O,P){J(P)}};function D(O){J(O);L(O);E(O)}function G(Q){Q.preventDefault();var O=Q.currentTarget;var P=O.ancestor("div").one(".togglee");if(O.hasClass("open")){O.removeClass("open");if(P){P.setStyle("display","none")}}else{O.addClass("open");if(P){P.setStyle("display","block");P.setAttribute("style","display: block;")}}}function J(O){if(C.tabHash){A.on("pageHtmlLoaded",function(){H.fireEvent("add_tabs_callback",{data:{tabHash:C.tabHash,additionalCallback:function(P){if(P.newValue){O.removeClass("hidden")}else{O.addClass("hidden")}}}})})}}function L(P){A.delegate("click",G,"#payment-summary","a.toggler");var Q=A.one(".details-button",P);if(Q){A.on("click",I,Q,P)}var O=A.one(".details-trigger",P);if(O){A.on("click",I,O,P)}}function I(Q,O){Q.preventDefault();var P=A.one(".details-content",O);if(P){P.toggleClass("hidden");A.all(".details-button span",O).toggleClass("hidden");A.all(".details-trigger",O).toggleClass("open")}}function E(O){if(K()){var P=A.one(".details-button-container",O);if(P){P.removeClass("hidden")}}}function K(){return C.detailsSectionEnabled&&F.hasDetails}this.callCustomScript=function(){A.log("override this in customscript")}}});YUI.add("wl-bagfee",function(A){A.components.Bagfee=function(G){var H=this;var D;var F="bagFeePopupContent";var B="__content";H.onRenderState={overlay:function(K){var J=A.one("#bagfee-anchor");if(J){E();J.on("click",I)}},initialized:function(J){}};function I(L){L.preventDefault();var K="default";var J={data:{actionCode:K,requestPartials:[B]},on:{end:function(){D.node().one(".bd").removeClass("loading")},success:function(N,M){if(M){C(M);D.node().one(".bd").removeClass("loading")}else{A.log("No Data returned from server","error")}}}};D.show();D.node().one(".bd").addClass("loading");H.fireEvent("to-ajax",{cfg:J,actionCode:K})}function C(J){var K=J.partials[B];var L=A.one("#"+F);if(L){L.set("innerHTML",A.decodeHtmlEntities(K))}}function E(){var K='<h4 class="bagfee-overlay-title" >'+A.translateParametrized("label.bagfee.overlay.title")+"</h4>";var J={buttons:[],header:K,close:true,width:"600px",autofillheight:"body"};D=new A.widgets.PopupWidget(A.one(document.body),'<div id="'+F+'"></div>',J)}}},"1.0.0",{requires:[]});YUI.add("forgotPassword",function(C){var R=function(T,S){T.preventDefault();L(S)};var G={NOT_AVAILABLE:"notAvailable"};var N;function L(T){var V=T.component.node;var S=V.one(".username");var X="send";var Z="label.login.forgotPasswordOverlayContinue";var U=null;var a="_forgotPasswordOverlayForm";var Y;if(S){var W=S.get("value");if(W==""){Y=T.getId()||T.initData.contextId;U={forgotPasswordError:"",contextId:Y};I(V,T,a,U,{buttonText:Z,mode:X,contextId:Y},P)}else{E(W,V,T)}}}function E(W,V,T){if(O(T.component.node)){return }I(V,T,"_loading");var U={overlayPartial:"_forgotPasswordOverlaySuccess",overlayData:null,buttonText:"label.login.close",buttonMode:"close"};var S={overlayPartial:"_forgotPasswordOverlayForm",overlayData:{forgotPasswordError:"label.login.usernameError",contextId:T.getId()},buttonText:"label.login.forgotPasswordOverlayContinue",buttonMode:"send"};M(V,T,W,U,S)}function O(S){return S.hasClass("loading")}function I(V,T,c,U,a,W){var Z=T.component;var e=A(T);var X=T.getId()||T.initData.contextId;var b="";if(c=="_forgotPasswordOverlaySuccess"){b=D()}else{if(c=="_forgotPasswordOverlayForm"){b=B(T,U.forgotPasswordError)}else{if(c=="_loading"){b=F()}}}var Y=a?K(X,a.mode,a.buttonText):"";var d=C.one(e.element);d.one(".overlay-content").set("innerHTML",b);d.one(".buttons").set("innerHTML",Y);if(C.Lang.isFunction(W)){W(V,T,d)}function S(){e.show()}Z.translateTemplate(T,C.one(e.element),S)}function M(X,V,Y,Z,U){var W=V.component;var T=function(c,b){Z=U;if(!c){Z.overlayData={forgotPasswordError:"label.login.ajaxError"}}else{if(G[b]){Z.overlayData={forgotPasswordError:"label.login."+G[b]}}}var a={buttonText:Z.buttonText,mode:Z.buttonMode};I(X,V,Z.overlayPartial,Z.overlayData,a,P)};var S={data:{username:escape((Y=="")?" ":Y)},on:{success:function(b,a){var c=a.verificationResult;if(c!=="OK"){T(true,c)}else{I(X,V,Z.overlayPartial,Z.overlayData,{buttonText:Z.buttonText,mode:Z.buttonMode},Q)}},failure:T}};W.fireEvent("to-ajax",{componentType:"login",cfg:S,actionCode:"resetPassword"})}function P(V,T,U){U.detach("forgetPassw|*");C.on("forgetPassw|click",function(W){J(W,U,V,T)},U.one(".btn-send-forgotten-password"));C.on("keypress",S,U.one(".ovUsername"));function S(W){if(W.charCode===13){J(W,U,V,T)}}}function J(V,T,U,S){V.halt();var W=T.one(".ovUsername").get("value");E(W,U,S)}function A(S){var U=S.component;if(!N){U.node.append(H());var V=U.node.one(".forgotPasswordOverlay");var T=C.Node.getDOMNode(V);U.translateTemplate(S,V);N=new YAHOO.widget.Dialog(T,{width:"320px",fixedcenter:true,draggable:false,close:true,visible:false,modal:false,zIndex:10});N.render(document.body)}return N}function Q(V,S,U){var T=A(S);U.on("forgetPassw|click",function(){T.hide()},".btn-send-forgotten-password")}function D(){return'<p class="translate" wl:translate="label.login.forgotPassword"></p>'}function B(V,U){var S=V.compInstConfig.maxLength;var T=V.getId()||V.initData.contextId;return'<p class="error translate" wl:translate="'+U+'"></p><p class="translate" wl:translate="label.login.forgotPasswordOverlayDescription"></p><p><label for="ovUsername-'+T+'" class="translate" wl:translate="label.login.forgotPasswordOverlayUsername"></label> <input id="ovUsername-'+T+'" class="textfield ovUsername" type="text" name="username" maxlength="'+S+'"/></p>'}function H(){return'<div class="forgotPasswordOverlay"><div class="forgot-password-form"><div class="hd">&nbsp;</div><div class="bd"><h3 class="translate" wl:translate="label.login.forgotPasswordOverlayHeader"></h3><div class="overlay-content"></div></div><div class="ft buttons"></div><div class="clear-both" /></div></div>'}function F(){return'<p class="loadingContainer"></p>'}function K(S,U,T){return'<div class="button button-smaller align-right"><input type="button" id="btn-send-forgotten-password-'+S+'" class="translate '+U+' btn-send-forgotten-password" wl:translate="'+T+'"/></div>'}C.widgets=C.widgets||{};C.widgets.ForgotPassword=R},"1.0.0",{requires:[]});YUI.add("wl-login",function(A){A.components.Login=function(t){var b=this;t.form=true;var h=false;var E;var k=false;b.incomingEvents={loginCheck:function(){if(k){b.fireEvent("logged-in");return true}return false},"block-submit":function(){h=true},travelBankViewBalance:function(){w()},"in-logged-out":function(y){if(x()){if(t.initData.redemptionSearch){b.node.one(".login-component").removeClass("hidden");e();k=false;t.initData.user=null}}else{u()}},"in-internal-logged-in":function(y){t.initData.user=y.user;k=true;if(x()){if(t.initData.redemptionSearch){b.node.one(".login-component").addClass("hidden");e()}}else{if(y.updateContent){b.node.addClass("loading");N(y.user)}}},"set-logout-confirm":function(y){H=y.callback}};b.onRenderState={initialized:function(y){i(y)},rbeSelectFlights:function(y){i(y);q()},mybLanding:function(z){z.removeClass("loading");z.purge(true,"submit");A.on("login|submit",g,z);A.on("blur",A.wlValidation.validate,z.all("input.textfield"));if(t.compInstConfig.forgotPasswordPopUpEnabled){A.on("click",a,z.all(".forgot-password"))}var y=t.initData.loginActionResult.authenticationResult;if(y&&y!="SUCCESSFUL"){O(y,z)}else{z.one("input.username").setAttribute("wl:value","")}}};function i(y){D(y);if(t.initData.loggedIn){S(y,t.initData.user)}}function e(){b.node.one("input.username").set("value","");b.node.one("input.password").set("value","");p(b.node.one(".component-section-error"),"")}function S(AA,z){k=true;if(z.travelBankCredentials){V(z)}if(sabre.config.satConfiguration.travelBankConfiguration.balanceUrlEnabled&&z.travelBankCredentials){var y=AA.one("#loginComponentTraveBankViewDetailsLink");if(y){A.on("click",v,y)}}else{F()}J(z);AA.removeClass("loading");if(B()){A.on("login|click",P,AA.all(".logout"))}else{if(t.compInstConfig.agentUserConfiguration.logoutRedirectToAgentHome){A.on("login|click",Y,AA.all(".logout"))}}}function B(){return t.compInstConfig.byAjaxLogout}var H=function(){return false};function V(y){var AA=A.one("#ExternalForms");if(AA){var z=AA.one("#TravelBankViewDetailsForm");if(z){G(AA,y)}else{s(AA,y)}}else{A.log("Cannot find #ExternalForms node.","warn")}}function G(z,y){var AB=z.one("#loginComponentTraveBankViewDetailsUsername");if(AB){AB.set("value",y.travelBankCredentials.username)}else{A.log("Cannot find #loginComponentTraveBankViewDetailsUsername node.","warn")}var AA=z.one("#loginComponentTraveBankViewDetailsPassword");if(AA){AA.set("value",y.travelBankCredentials.password)}else{A.log("Cannot find #loginComponentTraveBankViewDetailsPassword node.","warn")}}function F(){var y=A.one("#TravelBankViewDetailsForm");if(y){y.remove()}}function s(z,y){var AA={username:y.travelBankCredentials.username,password:y.travelBankCredentials.password};b.renderPartialInNode("_travelBankViewDetailsForm",AA,z,false)}function v(y){y.preventDefault();w();return false}function w(){document.TBDetails.action=sabre.config.satConfiguration.travelBankConfiguration.balanceUrlKey;document.TBDetails.method="POST";document.TBDetails.submit()}function J(AD){if(!AD){return }if(AD.frequentFlyerProfile){A.one("#loginComponentLoyaltyDiv").removeClass("hidden")}else{A.one("#loginComponentLoyaltyDiv").addClass("hidden")}if(AD.travelBankCredentials&&(sabre.config.satConfiguration.travelBankConfiguration.balanceUrlEnabled||R(AD))){A.one("#loginComponentTraveBankDiv").removeClass("hidden")}else{A.one("#loginComponentTraveBankDiv").addClass("hidden")}var AF=AD.loyaltyTier;if(AF){var z=A.translateParametrized("TierLevel."+AF);var AK="label.login.member|"+z;var AI=A.translateParametrized(AK);var AG=A.one("#loyaltyTier");AG.setAttribute("wl:translate",AK);AG.setContent(AI)}if(AD.loyaltyBalanceRetrievalError){A.one("#balanceNotAvailable").removeClass("hidden");return }if(AD.agentProfile){var AH=false;A.one("#loginComponentAgencyBalanceDiv").removeClass("hidden");var AA=AD.agentInfoTO.superUser;T(AA,AH,"agentName","agentNameEnabled",AD.firstName+" "+AD.lastName);T(AA,AH,"agencyName","agencyNameEnabled",AD.agencyInfoTO.travelAgencyName);T(AA,AH,"agencyIdentifier","agencyIATAEnabled",AD.agencyInfoTO.travelAgencyIdentifier);if(AD.creditLimitRetrievalError){A.one("#loginComponentAgencyBalanceDiv").addClass("hidden");return }T(AA,AH,"agencyCreditLimit","creditLimitEnabled",X(AD.creditLimitInformationTO.nonConvertedAccountCreditLimit),"creditLimitDd");T(AA,AH,"agencyBalance","balanceEnabled",X(AD.creditLimitInformationTO.nonConvertedAccountBalance),"balanceDd");if(AD.creditLimitInformationTO.differentBalanceAndBookingCurrency&&sabre.config.satConfiguration.travelBankConfiguration.convertAgentCreditLimit){T(AA,AH,"creditLimitInBookingCurrency","creditLimitEnabled");T(AA,AH,"convertedAgencyCreditLimit","creditLimitEnabled",X(AD.creditLimitInformationTO.accountCreditLimit),"convertedCreditLimitDd");T(AA,AH,"convertedAgencyBalance","balanceEnabled",X(AD.creditLimitInformationTO.accountBalance),"convertedBalanceDd")}}else{if(AD.agencyProfile){var AH=true;A.one("#loginComponentAgencyBalanceDiv").removeClass("hidden");T(AA,AH,"agencyContactName","agencyContactNameEnabled",AD.firstName+" "+AD.lastName);T(AA,AH,"agencyName","agencyNameEnabled",AD.agencyInfoTO.travelAgencyName);T(AA,AH,"agencyCreditLimit","creditLimitEnabled",X(AD.creditLimitInformationTO.nonConvertedAccountCreditLimit),"creditLimitDd");T(AA,AH,"agencyBalance","balanceEnabled",X(AD.creditLimitInformationTO.nonConvertedAccountBalance),"balanceDd")}else{A.one("#loginComponentAgencyBalanceDiv").addClass("hidden")}}if(AD.loyaltyBalance==""){return }A.one("#balanceAmount").removeClass("hidden");A.one("#balanceAvailable").removeClass("hidden");var AL={thousandsSeparator:","};var AE=A.DataType.Number.format(parseInt(AD.loyaltyBalance,10),AL);K(AE);var AC=AD.balanceDate;if(AC!=0){var y=sabre.config.satConfiguration.dateFormat;var AB=A.DataType.Date.format(new Date(AC),{format:y});var AN="label.login.balanceDate|"+AB;var AJ=A.translateParametrized(AN);var AM=A.one("#balanceDate");if(AM){AM.setContent(AJ);AM.setAttribute("wl:translate",AN);AM.removeClass("hidden")}}}function T(AC,AF,AA,AE,AB,y){var AD=A.one("#"+AA);var z=t.compInstConfig.agentUserConfiguration;if(AC){z=t.compInstConfig.agentSuperUserConfiguration}else{if(AF){z=t.compInstConfig.agencyUserConfiguration}}if(z[AE]){if(y!=undefined){A.one("#"+y).setContent(AB)}else{if(AB!=undefined){AD.setContent(AB)}}AD.removeClass("hidden")}else{AD.addClass("hidden")}}function R(y){if(y.agentProfile){var z=t.compInstConfig.agentUserConfiguration;if(y.agentInfoTO.superUser){z=t.compInstConfig.agentSuperUserConfiguration}return z.viewBalanceEnabled}else{if(y.agencyProfile){return t.compInstConfig.agencyUserConfiguration.viewBalanceEnabled}}return false}function X(y){if(!y){return""}var AA={decimalPlaces:A.getDecimals(y.currency.code)};var z=A.DataType.Number.format(parseFloat(y.amount),AA);return A.formatPrice({value:z,currencyCode:y.currency.code},{currencyCodeSeparator:" "})}function K(z){var y=A.one("#amount");y.setContent(z);var AB=sabre.config.satConfiguration.frequentFlyer.denomination||"";var AA=A.one("#denomination");AA.setContent("&nbsp;"+A.translateParametrized(AB));AA.setAttribute("wl:translate",AB)}function D(y){y.removeClass("loading");y.purge(true,"submit");A.on("login|submit",Z,y);if(t.compInstConfig.forgotPasswordPopUpEnabled){y.delegate("click",a,".forgot-password")}y.delegate("click",W,".toggler");y.delegate("blur",A.wlValidation.validate,"input.textfield")}function O(z,AB){var y;switch(z){case"FAILED":y="_loginFailedAuthentication";break;case"SYSTEM_ERROR":y="_loginFailedSystemError";break;case"NOT_ALLOWED":y="_loginFailedStatusIsNotAllowed";break;default:var AA="No such result implemented "+z;A.log(AA,"error");throw AA}AB.one(".login-mybooking .field").prepend(b.getHtml(y));b.translateTemplate(t,AB.one(".login-mybooking .field"))}function Q(){var z=b.node;var y={togglee:z.one(".togglee"),toggler:z.one(".toggler a")};return y.togglee&&y.toggler?y:null}function W(){var y=Q();if(y){y.togglee.toggleClass("hidden");y.toggler.toggleClass("open")}}function I(){var y=Q();if(y){y.togglee.removeClass("hidden");y.toggler.addClass("open")}}function r(){return h||b.node.hasClass("loading")}function Z(y){y.preventDefault();if(r()){return }if(!o()){return }b.node.addClass("loading");n();var z=b.node.ancestor("form");if(x()){f(z)}else{U(z)}}function x(){return t.state==="rbeSelectFlights"}function g(y){y.preventDefault();if(!o()){return }var z=b.node.ancestor("form");z.submit()}function o(){A.wlValidation.validate(null,b.node.one(".username"));A.wlValidation.validate(null,b.node.one(".password"));return !b.node.one(".username").hasClass("error")&&!b.node.one(".password").hasClass("error")}function Y(AA){var AC=[{text:'<span class="translate" wl:translate="label.login.logoutPopup.cancel"></span>',handler:function(){this.hide()}},{text:"<span class='translate' wl:translate='label.login.logoutPopup.continue'></span>",handler:function(){window.location.href=t.initData.logoutUrl;this.hide()}}];var z={buttons:AC,close:true,needTranslation:true};var AB='<h3><span class="translate" wl:translate="label.login.logoutPopup.title"></span></h3><p><span class="translate" wl:translate="label.login.logoutPopup.message"></span></p>';var y=new A.widgets.PopupWidget(A.one(document.body),AB,z);y.show();AA.preventDefault()}function P(y){y.preventDefault();if(r()||H(M)){return }M()}function M(){b.node.addClass("loading");j()}function q(){var y=A.one("#login_2");if(y&&!k&&t.initData.redemptionSearch){var z=A.one("#flow-message-ffNotLoggedIn");if(z&&z.hasClass("hidden")){z.removeClass("hidden")}I()}}function c(){A.wlValidation.initializeForPartial(t.getType(),A.wlValidation.validationEngineRules,A.wlValidation.validationConfiguration,b.node)}function a(y){new A.widgets.ForgotPassword(y,t)}function n(){if(E){E.destroy();E=null}}function u(){k=false;t.initData.user=null;W();c();D(b.node)}function j(){var y={data:{requestPartials:["initialized"]},on:{success:function(AD,AC){var AA=AC.partials.initialized;L(AA);b.fireEvent("remove-all-messages");b.fireEvent("add-messages",{data:{messages:AC.flowMessagesToEnable}});b.fireEvent("logged-out");var AB=null;C(AB);if(!t.compInstConfig.folded){I()}}}};var z={cfg:y,actionCode:"logout"};if(!B()){z.url=t.initData.logoutUrl}b.fireEvent("to-ajax",z)}function C(y){b.fireEvent("update-data",{data:{loggedUser:y}})}function N(z){var y={data:{requestPartials:["initialized"]},on:{end:function(){b.node.removeClass("loading")},success:function(AC,AB){var AA=AB.partials.initialized;L(AA);S(b.node,z)}}};b.fireEvent("to-ajax",{cfg:y,actionCode:"getLoginContent"})}function d(y){return{username:escape(y.one(".username").get("value")),password:escape(y.one(".password").get("value"))}}function f(z){var y={data:d(z),on:{end:function(){b.node.removeClass("loading")},success:function(AB,AA){switch(AA.authenticationResult){case"SUCCESSFUL":k=true;m(AA,true);break;case"TRAVEL_BANK_UNAVAILABLE":k=true;m(AA,true);break;case"FAILED":t.initData.username=AA.username;l("_loginFailedAuthentication");break;case"SYSTEM_ERROR":I();l("_loginFailedSystemError");break;case"NOT_ALLOWED":I();l("_loginFailedStatusIsNotAllowed");break;default:break}}}};b.fireEvent("to-ajax",{cfg:y,actionCode:"login"})}function U(z){var AA=d(z);AA.requestPartials=["initialized"];var y={data:AA,on:{end:function(){b.node.removeClass("loading")},success:function(AD,AC){var AB=AC.partials.initialized;L(AB);switch(AC.authenticationResult){case"SUCCESSFUL":S(b.node,AC.user);m(AC,false);break;case"TRAVEL_BANK_UNAVAILABLE":S(b.node,AC.user);m(AC,false);break;case"FAILED":t.initData.username=AC.username;l("_loginFailedAuthentication");break;case"SYSTEM_ERROR":l("_loginFailedSystemError");break;case"NOT_ALLOWED":l("_loginFailedStatusIsNotAllowed");break;default:break}}}};b.fireEvent("to-ajax",{cfg:y,actionCode:"login"})}function l(z){I();var y=b.node.one(".component-section-error");p(y,b.getHtml(z));b.translateTemplate(t,y);c()}function L(y){p(b.node,A.decodeHtmlEntities(y));b.translateTemplate(t,b.node)}function p(z,y){z.set("innerHTML",y)}function m(AA,y){b.fireEvent("remove-all-messages");b.fireEvent("add-messages",{data:{messages:AA.flowMessagesToEnable}});b.fireEvent("out-internal-logged-in",{user:AA.user,updateContent:y});if(AA.user.frequentFlyerProfile){b.fireEvent("ff-logged-in",{data:{forceRedemptionFaresReload:false}})}b.fireEvent("logged-in",AA);var z={prefix:AA.user.prefix,firstName:AA.user.firstName,lastName:AA.user.lastName,tierLevel:AA.user.loyaltyTier,ffNumber:AA.user.ffNumber,emails:AA.user.emails};C(z);if(!t.compInstConfig.byAjaxLogin){window.location.reload()}}}});YUI.add("wl-customhtml",function(A){A.components.Customhtml=function(B){}});YUI.add("wl-lang",function(A){A.components.Lang=function(E){var G=this;G.onRenderState={initialized:function(){L();if(sabre.config.satConfiguration.globalCurrencyConfiguration.currencySelectionEnabled){G.fireEvent("add-me-to-pos-change",{trigger:"fsc",actionCode:"changePointOfSale"})}},hidden:function(){L()}};G.incomingEvents={changeLanguage:D,change_lang:function(){O()},"before-changePointOfSale":F};function L(){A.on("change",K,"#select-language");if(A.one("#select-currency")){G.node.delegate("change",P,"#select-currency")}H();I(E.initData.currency)}function O(){var R=A.config.locale;var Q="pageTitle."+sabre.config.pageCode;if(A.translations[R]&&A.translations[R][Q]){document.title=A.translations[R][Q]}}function P(R){var Q=R.currentTarget.get("value");N(Q)}function I(R){var Q=G.node.one("#select-currency");if(Q){Q.setStyle("visibility","visible");if(R){A.config.currency=R;Q.set("value",R)}}return R}function D(R){var Q=R.currentTarget.get("id");B(Q)}function K(R){var Q=R.currentTarget.get("value");B(Q)}function H(S){S=S||sabre.config.global.language||sabre.config.defaultLang;var Q=A.one("body");if(A.config.locale&&A.config.locale!==S){Q.removeClass("LANGUAGE_"+A.config.locale)}Q.addClass("LANGUAGE_"+S);Q.setAttribute("lang",S.replace("_","-"));A.config.locale=S;sabre.config.global.language=S;var R=G.node.one("#select-language");if(R){R.set("value",S);if(E.state!="hidden"){R.setStyle("visibility","visible")}}return S}function B(S){var R="wl-lang-"+S;var Q=sabre.config.global.storefrontResourcesPath;if(sabre.config.global.configurationVersion){Q+=sabre.config.global.configurationVersion+"/"}Q+=sabre.config.templateFolder+sabre.config.translationDir+"/";sabre.config.groups["wl-noncombine"].modules[R]={fullpath:Q+S+".js"+sabre.config.global.versionNumber};A.use(R,function(U,T){U.translations[S]=T.success?U.translations[S]:"Translations not found";J(S)})}function J(S){var Q=sabre.config.global.language;H(S);var R={data:{selectedLang:S},on:{success:function(){G.fireEvent("change_lang",{data:S});A.wlValidation.refreshOverlaysAlignment(Q);G.fireEvent("update-data",{data:{language:S}})},complete:function(){var T=A.one("#progressContainer");if(T){T.remove()}}}};G.fireEvent("to-ajax",{cfg:R,actionCode:"setSelectedLang"})}function N(S){var R=G.node.one("#language-content");R.addClass("loading");M();var Q={data:{selectedCurrency:S},on:{complete:function(){R.removeClass("loading")},success:function(){C();G.fireEvent("change_currency",{data:S});G.fireEvent("update-data",{data:{currency:S}})}}};G.fireEvent("to-ajax",{cfg:Q,actionCode:"setSelectedCurrency"})}function M(){G.fireEvent("block_submit")}function C(){G.fireEvent("unblock_submit",{data:{}})}function F(){var R=G.node.one("#language-content");R.addClass("loading");M();var S="__currency";var Q={data:{requestPartials:[S]},on:{end:function(){R.removeClass("loading")},success:function(X,V){C();var U=G.node.one(".currency-section");if(U){var W=A.Node.create(A.decodeHtmlEntities(V.partials[S]));U.replace(W);var T=G.node.one("#select-currency").get("value");G.fireEvent("change_currency",{data:T});G.fireEvent("update-data",{data:{currency:T}})}}}};G.fireEvent("to-ajax",{cfg:Q,actionCode:"setDefaultCurrency"})}}});YUI.add("wl-nstep",function(A){A.components.Nstep=function(C,B){}});YUI.add("wl-ibedata",function(A){A.components.Ibedata=function(C){var D=this;var B=C.initData;D.onRenderState={initialized:function(){WhiteLabel.setIbeData(B)}};D.incomingEvents={"update-data":function(E){if(E.data){B=A.merge(B,E.data);WhiteLabel.setIbeData(B)}}}}});YUI.add("wl-googleanalytics",function(A){A.components.Googleanalytics=function(B){this.create=false;this.render=false}});